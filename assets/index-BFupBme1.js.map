{"version":3,"file":"index-BFupBme1.js","sources":["../../src/js/animations/particle-physics.js","../../src/js/animations/classical-mechanics.js","../../src/js/animations/wave-phenomena.js","../../src/js/animations/elelectro-magnetism.js","../../src/js/animations/quantum-physics.js","../../src/js/animations/nuclear-physics.js","../../src/js/animations/fluid-dynamics.js","../../src/js/animations/computer-science.js","../../src/js/animations/blockchain.js","../../src/js/animations.js","../../src/js/main.js"],"sourcesContent":["// Particle Physics Animations\n// Brownian Motion Simulation\nexport class BrownianMotion {\n    constructor(ctx) {\n        this.ctx = ctx;\n        this.particles = [];\n        this.particleCount = 15;\n        this.speed = 1;\n        this.temperature = 1;\n        this.showTrails = false;\n        this.showVelocityVectors = false;\n        this.showTemperatureHeatmap = false;\n        this.showVelocityDistribution = false;\n        this.showMeanFreePath = false;\n        this.particleSize = 4;\n        this.time = 0;\n        this.collisionCount = 0;\n        this.meanFreePath = 0;\n        this.velocityData = [];\n        \n        this.initializeParticles();\n    }\n    \n    initializeParticles() {\n        this.particles = [];\n        for (let i = 0; i < this.particleCount; i++) {\n            const vx = (Math.random() - 0.5) * 2;\n            const vy = (Math.random() - 0.5) * 2;\n            const velocity = Math.sqrt(vx * vx + vy * vy);\n            \n            this.particles.push({\n                x: Math.random() * this.ctx.canvas.width,\n                y: Math.random() * this.ctx.canvas.height,\n                vx: vx,\n                vy: vy,\n                velocity: velocity,\n                trail: [],\n                lastCollisionTime: 0,\n                distanceTraveled: 0\n            });\n        }\n    }\n    \n    setParticleCount(count) {\n        this.particleCount = count;\n        this.initializeParticles();\n    }\n    \n    setSpeed(speed) {\n        this.speed = speed;\n    }\n    \n    setTemperature(temp) {\n        this.temperature = temp;\n    }\n    \n    setShowTrails(show) {\n        this.showTrails = show;\n        if (!show) {\n            this.particles.forEach(p => p.trail = []);\n        }\n    }\n    \n    setShowVelocityVectors(show) {\n        this.showVelocityVectors = show;\n    }\n    \n    setShowTemperatureHeatmap(show) {\n        this.showTemperatureHeatmap = show;\n    }\n    \n    setShowVelocityDistribution(show) {\n        this.showVelocityDistribution = show;\n    }\n    \n    setShowMeanFreePath(show) {\n        this.showMeanFreePath = show;\n    }\n    \n    setParticleSize(size) {\n        this.particleSize = size;\n    }\n    \n    reset() {\n        this.time = 0;\n        this.collisionCount = 0;\n        this.velocityData = [];\n        this.initializeParticles();\n    }\n    \n    update(deltaTime) {\n        this.time += deltaTime;\n        const dt = (deltaTime / 1000) * this.speed * 2; // Standardized time step scaling\n        \n        // Store old positions for collision detection\n        const oldPositions = this.particles.map(p => ({ x: p.x, y: p.y }));\n        \n        this.particles.forEach((particle, index) => {\n            // Add random motion based on temperature (Brownian motion)\n            particle.vx += (Math.random() - 0.5) * this.temperature * 0.1;\n            particle.vy += (Math.random() - 0.5) * this.temperature * 0.1;\n            \n            // Apply damping\n            particle.vx *= 0.99;\n            particle.vy *= 0.99;\n            \n            // Update position\n            const oldX = particle.x;\n            const oldY = particle.y;\n            particle.x += particle.vx * dt * 50;\n            particle.y += particle.vy * dt * 50;\n            \n            // Update velocity magnitude\n            particle.velocity = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\n            \n            // Update distance traveled for mean free path\n            particle.distanceTraveled += Math.sqrt(\n                (particle.x - oldX) * (particle.x - oldX) + \n                (particle.y - oldY) * (particle.y - oldY)\n            );\n            \n            // Bounce off walls\n            if (particle.x < 0 || particle.x > this.ctx.canvas.width) {\n                particle.vx *= -0.8;\n                particle.x = Math.max(0, Math.min(this.ctx.canvas.width, particle.x));\n                this.collisionCount++;\n                particle.lastCollisionTime = this.time;\n            }\n            if (particle.y < 0 || particle.y > this.ctx.canvas.height) {\n                particle.vy *= -0.8;\n                particle.y = Math.max(0, Math.min(this.ctx.canvas.height, particle.y));\n                this.collisionCount++;\n                particle.lastCollisionTime = this.time;\n            }\n            \n            // Check particle-to-particle collisions\n            for (let j = index + 1; j < this.particles.length; j++) {\n                const other = this.particles[j];\n                const dx = particle.x - other.x;\n                const dy = particle.y - other.y;\n                const distance = Math.sqrt(dx * dx + dy * dy);\n                \n                if (distance < this.particleSize * 2) {\n                    // Simple elastic collision\n                    const angle = Math.atan2(dy, dx);\n                    const speed1 = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\n                    const speed2 = Math.sqrt(other.vx * other.vx + other.vy * other.vy);\n                    \n                    // Swap velocities\n                    const tempVx = particle.vx;\n                    const tempVy = particle.vy;\n                    particle.vx = other.vx;\n                    particle.vy = other.vy;\n                    other.vx = tempVx;\n                    other.vy = tempVy;\n                    \n                    this.collisionCount++;\n                    particle.lastCollisionTime = this.time;\n                    other.lastCollisionTime = this.time;\n                    \n                    // Separate particles\n                    const overlap = this.particleSize * 2 - distance;\n                    const moveX = (overlap * dx) / distance / 2;\n                    const moveY = (overlap * dy) / distance / 2;\n                    particle.x += moveX;\n                    particle.y += moveY;\n                    other.x -= moveX;\n                    other.y -= moveY;\n                }\n            }\n            \n            // Update trail\n\n        });\n        \n        // Update velocity distribution data\n        if (this.showVelocityDistribution) {\n            this.velocityData.push(...this.particles.map(p => p.velocity));\n            if (this.velocityData.length > 1000) {\n                this.velocityData = this.velocityData.slice(-500);\n            }\n        }\n        \n        // Calculate mean free path\n        if (this.showMeanFreePath && this.collisionCount > 0) {\n            const totalDistance = this.particles.reduce((sum, p) => sum + p.distanceTraveled, 0);\n            this.meanFreePath = totalDistance / this.collisionCount;\n        }\n    }\n    \n    render() {\n        // Draw temperature heatmap\n        if (this.showTemperatureHeatmap) {\n            this.drawTemperatureHeatmap();\n        }\n        \n        // Draw velocity distribution\n        if (this.showVelocityDistribution) {\n            this.drawVelocityDistribution();\n        }\n        \n        // Draw mean free path info\n        if (this.showMeanFreePath) {\n            this.drawMeanFreePathInfo();\n        }\n        \n        this.particles.forEach(particle => {\n            // Draw particle with velocity-based color\n            this.ctx.beginPath();\n            this.ctx.fillStyle = this.getVelocityColor(particle.velocity);\n            this.ctx.arc(particle.x, particle.y, this.particleSize, 0, Math.PI * 2);\n            this.ctx.fill();\n            \n            // Add particle border\n            this.ctx.strokeStyle = '#fff';\n            this.ctx.lineWidth = 1;\n            this.ctx.stroke();\n        });\n        \n        // Draw canvas labels\n        this.drawBrownianLabels();\n    }\n    \n    getVelocityColor(velocity) {\n        // Color particles based on velocity (red = fast, blue = slow)\n        const maxVelocity = 3;\n        const normalizedVelocity = Math.min(velocity / maxVelocity, 1);\n        \n        if (normalizedVelocity < 0.5) {\n            // Blue to green\n            const t = normalizedVelocity * 2;\n            return `rgb(0, ${Math.floor(255 * t)}, ${Math.floor(255 * (1 - t))})`;\n        } else {\n            // Green to red\n            const t = (normalizedVelocity - 0.5) * 2;\n            return `rgb(${Math.floor(255 * t)}, ${Math.floor(255 * (1 - t))}, 0)`;\n        }\n    }\n    \n    drawTemperatureHeatmap() {\n        const gridSize = 20;\n        const cols = Math.ceil(this.ctx.canvas.width / gridSize);\n        const rows = Math.ceil(this.ctx.canvas.height / gridSize);\n        \n        for (let i = 0; i < rows; i++) {\n            for (let j = 0; j < cols; j++) {\n                const centerX = j * gridSize + gridSize / 2;\n                const centerY = i * gridSize + gridSize / 2;\n                \n                // Calculate local temperature based on nearby particles\n                let localTemp = 0;\n                let particleCount = 0;\n                \n                this.particles.forEach(particle => {\n                    const dx = particle.x - centerX;\n                    const dy = particle.y - centerY;\n                    const distance = Math.sqrt(dx * dx + dy * dy);\n                    \n                    if (distance < gridSize) {\n                        localTemp += particle.velocity;\n                        particleCount++;\n                    }\n                });\n                \n                if (particleCount > 0) {\n                    localTemp /= particleCount;\n                    const alpha = Math.min(localTemp / 3, 0.3);\n                    this.ctx.fillStyle = `rgba(255, 100, 100, ${alpha})`;\n                    this.ctx.fillRect(j * gridSize, i * gridSize, gridSize, gridSize);\n                }\n            }\n        }\n    }\n    \n    drawVelocityDistribution() {\n        const graphWidth = 200;\n        const graphHeight = 100;\n        const graphX = this.ctx.canvas.width - graphWidth - 20;\n        const graphY = 120; // Moved down to avoid overlap with main labels\n        \n        // Background\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\n        this.ctx.fillRect(graphX, graphY, graphWidth, graphHeight);\n        this.ctx.strokeStyle = '#333';\n        this.ctx.lineWidth = 1;\n        this.ctx.strokeRect(graphX, graphY, graphWidth, graphHeight);\n        \n        if (this.velocityData.length > 0) {\n            // Create histogram\n            const bins = 20;\n            const histogram = new Array(bins).fill(0);\n            const maxVelocity = Math.max(...this.velocityData);\n            \n            this.velocityData.forEach(velocity => {\n                const binIndex = Math.floor((velocity / maxVelocity) * (bins - 1));\n                if (binIndex >= 0 && binIndex < bins) {\n                    histogram[binIndex]++;\n                }\n            });\n            \n            // Draw histogram\n            const maxCount = Math.max(...histogram);\n            const barWidth = graphWidth / bins;\n            \n            this.ctx.fillStyle = '#4ECDC4';\n            for (let i = 0; i < bins; i++) {\n                const barHeight = (histogram[i] / maxCount) * (graphHeight - 20);\n                this.ctx.fillRect(\n                    graphX + i * barWidth + 2, \n                    graphY + graphHeight - 10 - barHeight, \n                    barWidth - 4, \n                    barHeight\n                );\n            }\n        }\n        \n        // Labels\n        this.ctx.fillStyle = '#333';\n        this.ctx.font = '14px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'center';\n        this.ctx.fillText('Velocity Distribution', graphX + graphWidth / 2, graphY - 5);\n    }\n    \n    drawMeanFreePathInfo() {\n        const infoX = 20;\n        const infoY = 120; // Moved down to avoid overlap with main labels\n        \n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\n        this.ctx.fillRect(infoX, infoY, 200, 80);\n        this.ctx.strokeStyle = '#333';\n        this.ctx.lineWidth = 1;\n        this.ctx.strokeRect(infoX, infoY, 200, 80);\n        \n        this.ctx.fillStyle = '#333';\n        this.ctx.font = '14px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'left';\n        this.ctx.fillText(`Collisions: ${this.collisionCount}`, infoX + 10, infoY + 20);\n        this.ctx.fillText(`Mean Free Path: ${this.meanFreePath.toFixed(1)}`, infoX + 10, infoY + 40);\n        this.ctx.fillText(`Temperature: ${this.temperature.toFixed(1)}`, infoX + 10, infoY + 60);\n    }\n    \n    getStats() {\n        const avgSpeed = this.particles.reduce((sum, p) => \n            sum + Math.sqrt(p.vx * p.vx + p.vy * p.vy), 0) / this.particles.length;\n        \n        return {\n            particleCount: this.particles.length,\n            avgSpeed: avgSpeed,\n            time: this.time,\n            collisionCount: this.collisionCount,\n            meanFreePath: this.meanFreePath,\n            temperature: this.temperature\n        };\n    }\n    \n    drawBrownianLabels() {\n        // Draw elegant labels on the canvas\n        this.ctx.save();\n        \n        // Set up text styling\n        this.ctx.font = 'bold 16px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'center';\n        \n        // Draw animation type label\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.9)';\n        this.ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';\n        this.ctx.shadowBlur = 2;\n        this.ctx.fillText('Brownian Motion', this.ctx.canvas.width / 2, 25);\n        \n        // Draw mathematical formulas in a more compact format\n        this.ctx.font = '12px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\n        this.ctx.fillText(`⟨v²⟩ = 3kBT/m  |  λ = 1/(√2πd²n)  |  D = kBT/(6πηr)`, \n                          this.ctx.canvas.width / 2, 45);\n        \n        // Reset shadow\n        this.ctx.shadowBlur = 0;\n        this.ctx.restore();\n    }\n}\n\n// Diffusion Simulation\nexport class Diffusion {\n    constructor(ctx) {\n        this.ctx = ctx;\n        this.particles = [];\n        this.particleCount = 200;\n        this.speed = 1;\n        this.diffusionRate = 1;\n        this.concentrationGradient = 1;\n        this.showConcentration = true; // Default to showing concentration\n        this.particleSize = 4;\n        this.time = 0;\n        this.concentrationMap = [];\n        this.diffusionStarted = false; // New: control when diffusion starts\n        this.showConcentrationProfile = true; // New: show concentration profile\n        this.showParticleTrails = false; // New: show particle trails\n        \n        this.initializeParticles();\n        this.initializeConcentrationMap();\n    }\n    \n    initializeParticles() {\n        this.particles = [];\n        const startRegion = this.ctx.canvas.width * 0.2; // Concentrated in left 20%\n        \n        for (let i = 0; i < this.particleCount; i++) {\n            this.particles.push({\n                x: Math.random() * startRegion, // Start in concentrated region\n                y: Math.random() * this.ctx.canvas.height,\n                vx: 0,\n                vy: 0,\n                color: '#FF6B6B', // Consistent red color for better visibility\n                trail: [] // New: store trail positions\n            });\n        }\n    }\n    \n    initializeConcentrationMap() {\n        this.concentrationMap = [];\n        const gridSize = 15; // Smaller grid for better resolution\n        const cols = Math.ceil(this.ctx.canvas.width / gridSize);\n        const rows = Math.ceil(this.ctx.canvas.height / gridSize);\n        \n        for (let i = 0; i < rows; i++) {\n            this.concentrationMap[i] = [];\n            for (let j = 0; j < cols; j++) {\n                // Gentler concentration gradient - high on left, low on right\n                const x = j / cols;\n                this.concentrationMap[i][j] = Math.max(0, 1 - x * 1.5); // Gentler gradient\n            }\n        }\n    }\n    \n    setParticleCount(count) {\n        this.particleCount = count;\n        this.initializeParticles();\n    }\n    \n    setSpeed(speed) {\n        this.speed = speed;\n    }\n    \n    setDiffusionRate(rate) {\n        this.diffusionRate = rate;\n    }\n    \n    setConcentrationGradient(gradient) {\n        this.concentrationGradient = gradient;\n        this.initializeConcentrationMap();\n    }\n    \n    setParticleSize(size) {\n        this.particleSize = size;\n    }\n    \n    setShowConcentration(show) {\n        this.showConcentration = show;\n    }\n    \n    setShowConcentrationProfile(show) {\n        this.showConcentrationProfile = show;\n    }\n    \n    setShowParticleTrails(show) {\n        this.showParticleTrails = show;\n    }\n    \n    startDiffusion() {\n        this.diffusionStarted = true;\n    }\n    \n    reset() {\n        this.time = 0;\n        this.diffusionStarted = false;\n        this.initializeParticles();\n    }\n    \n    update(deltaTime) {\n        this.time += deltaTime;\n        const dt = (deltaTime / 1000) * this.speed * 20; // Much faster animation\n        \n        // Only update particles if diffusion has started\n        if (!this.diffusionStarted) return;\n        \n        this.particles.forEach(particle => {\n            // Check if particle coordinates are valid before updating\n            if (!isFinite(particle.x) || !isFinite(particle.y) || \n                isNaN(particle.x) || isNaN(particle.y)) {\n                // Reset invalid particle to a valid position\n                particle.x = Math.random() * this.ctx.canvas.width * 0.2;\n                particle.y = Math.random() * this.ctx.canvas.height;\n                particle.vx = 0;\n                particle.vy = 0;\n                return;\n            }\n            \n            // Add random diffusion motion\n            particle.vx += (Math.random() - 0.5) * this.diffusionRate * 0.5;\n            particle.vy += (Math.random() - 0.5) * this.diffusionRate * 0.5;\n            \n            // Apply concentration gradient force (particles move from high to low concentration)\n            const gridX = Math.floor(particle.x / 15);\n            const gridY = Math.floor(particle.y / 15);\n            if (gridX > 0 && gridX < this.concentrationMap[0].length - 1 && \n                gridY >= 0 && gridY < this.concentrationMap.length) {\n                const concentrationDiff = this.concentrationMap[gridY]?.[gridX] - this.concentrationMap[gridY]?.[gridX + 1];\n                // Reduce gradient force over time to allow for uniform distribution\n                const timeFactor = Math.max(0.1, 1 - (this.time / 10000)); // Gradually reduce force\n                particle.vx += concentrationDiff * 0.1 * timeFactor; // Weaker, time-dependent gradient force\n            }\n            \n            // Apply damping\n            particle.vx *= 0.98;\n            particle.vy *= 0.98;\n            \n            // Update position\n            particle.x += particle.vx * dt * 30;\n            particle.y += particle.vy * dt * 30;\n            \n            // Update particle trail\n            if (this.showParticleTrails) {\n                particle.trail.push({ x: particle.x, y: particle.y });\n                if (particle.trail.length > 20) {\n                    particle.trail.shift();\n                }\n            }\n            \n            // Realistic boundary conditions - particles stay within canvas\n            if (particle.x < 0) {\n                particle.x = 0;\n                particle.vx *= -0.5; // Bounce with energy loss\n            }\n            if (particle.x > this.ctx.canvas.width) {\n                particle.x = this.ctx.canvas.width;\n                particle.vx *= -0.5; // Bounce with energy loss\n            }\n            if (particle.y < 0) {\n                particle.y = 0;\n                particle.vy *= -0.5; // Bounce with energy loss\n            }\n            if (particle.y > this.ctx.canvas.height) {\n                particle.y = this.ctx.canvas.height;\n                particle.vy *= -0.5; // Bounce with energy loss\n            }\n            \n            // Final validation check\n            if (!isFinite(particle.x) || !isFinite(particle.y) || \n                isNaN(particle.x) || isNaN(particle.y)) {\n                // Reset if still invalid after update\n                particle.x = Math.random() * this.ctx.canvas.width * 0.2;\n                particle.y = Math.random() * this.ctx.canvas.height;\n                particle.vx = 0;\n                particle.vy = 0;\n            }\n        });\n    }\n    \n    render() {\n        // Draw enhanced concentration heatmap with modern gradient\n        if (this.showConcentration) {\n            const gridSize = 15;\n            for (let i = 0; i < this.concentrationMap.length; i++) {\n                for (let j = 0; j < this.concentrationMap[i].length; j++) {\n                    const concentration = this.concentrationMap[i][j];\n                    const alpha = concentration * 0.8; // Enhanced visibility\n                    \n                    // Create gradient for each grid cell\n                    const gradient = this.ctx.createLinearGradient(\n                        j * gridSize, i * gridSize,\n                        (j + 1) * gridSize, (i + 1) * gridSize\n                    );\n                    gradient.addColorStop(0, `rgba(102, 126, 234, ${alpha * 0.8})`);\n                    gradient.addColorStop(0.5, `rgba(118, 75, 162, ${alpha})`);\n                    gradient.addColorStop(1, `rgba(102, 126, 234, ${alpha * 0.6})`);\n                    \n                    this.ctx.fillStyle = gradient;\n                    this.ctx.fillRect(j * gridSize, i * gridSize, gridSize, gridSize);\n                    \n                    // Add subtle border for grid definition\n                    this.ctx.strokeStyle = `rgba(255, 255, 255, ${alpha * 0.1})`;\n                    this.ctx.lineWidth = 0.5;\n                    this.ctx.strokeRect(j * gridSize, i * gridSize, gridSize, gridSize);\n                }\n            }\n        }\n        \n        // Draw enhanced particle trails with gradient\n        if (this.showParticleTrails) {\n            this.particles.forEach(particle => {\n                if (particle.trail.length > 1) {\n                    // Create gradient trail\n                    const gradient = this.ctx.createLinearGradient(\n                        particle.trail[0].x, particle.trail[0].y,\n                        particle.trail[particle.trail.length - 1].x, \n                        particle.trail[particle.trail.length - 1].y\n                    );\n                    gradient.addColorStop(0, 'rgba(255, 107, 107, 0.8)');\n                    gradient.addColorStop(0.5, 'rgba(255, 107, 107, 0.4)');\n                    gradient.addColorStop(1, 'rgba(255, 107, 107, 0.1)');\n                    \n                    this.ctx.beginPath();\n                    this.ctx.strokeStyle = gradient;\n                    this.ctx.lineWidth = 2;\n                    this.ctx.lineCap = 'round';\n                    this.ctx.moveTo(particle.trail[0].x, particle.trail[0].y);\n                    for (let i = 1; i < particle.trail.length; i++) {\n                        this.ctx.lineTo(particle.trail[i].x, particle.trail[i].y);\n                    }\n                    this.ctx.stroke();\n                }\n            });\n        }\n        \n        // Draw particles with modern enhanced styling\n        this.particles.forEach(particle => {\n            // Check if particle coordinates are valid\n            if (!isFinite(particle.x) || !isFinite(particle.y) || \n                isNaN(particle.x) || isNaN(particle.y)) {\n                return; // Skip invalid particles\n            }\n            \n            // Calculate particle velocity for dynamic effects\n            const velocity = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\n            const velocityFactor = Math.min(velocity / 5, 1); // Normalize velocity\n            \n            // Enhanced glow effect based on velocity\n            this.ctx.shadowColor = `rgba(255, 107, 107, ${0.4 + velocityFactor * 0.3})`;\n            this.ctx.shadowBlur = 12 + velocityFactor * 8;\n            \n            // Create dynamic gradient based on velocity\n            const gradient = this.ctx.createRadialGradient(\n                particle.x, particle.y, 0,\n                particle.x, particle.y, this.particleSize * (1 + velocityFactor * 0.3)\n            );\n            \n            // Dynamic colors based on velocity\n            const baseColor = velocityFactor > 0.5 ? 255 : 200;\n            const alpha = 0.9 + velocityFactor * 0.1;\n            \n            gradient.addColorStop(0, `rgba(${baseColor}, 107, 107, ${alpha})`);\n            gradient.addColorStop(0.6, `rgba(255, 107, 107, ${0.8 - velocityFactor * 0.2})`);\n            gradient.addColorStop(1, `rgba(255, 107, 107, 0.4)`);\n            \n            this.ctx.beginPath();\n            this.ctx.fillStyle = gradient;\n            this.ctx.arc(particle.x, particle.y, this.particleSize * (1 + velocityFactor * 0.2), 0, Math.PI * 2);\n            this.ctx.fill();\n            \n            // Enhanced border with velocity-based opacity\n            this.ctx.shadowBlur = 0;\n            this.ctx.strokeStyle = `rgba(255, 255, 255, ${0.9 + velocityFactor * 0.1})`;\n            this.ctx.lineWidth = 1.5;\n            this.ctx.stroke();\n            \n            // Add inner highlight for depth\n            this.ctx.beginPath();\n            this.ctx.fillStyle = `rgba(255, 255, 255, ${0.3 + velocityFactor * 0.2})`;\n            this.ctx.arc(particle.x - this.particleSize * 0.3, particle.y - this.particleSize * 0.3, \n                         this.particleSize * 0.3, 0, Math.PI * 2);\n            this.ctx.fill();\n        });\n        \n        // Draw concentration profile\n        if (this.showConcentrationProfile) {\n            this.drawConcentrationProfile();\n        }\n        \n        // Draw start barrier if diffusion hasn't started\n        if (!this.diffusionStarted) {\n            this.drawStartBarrier();\n        }\n        \n        // Draw canvas labels\n        this.drawDiffusionLabels();\n    }\n    \n    drawConcentrationProfile() {\n        const profileHeight = 100;\n        const profileY = this.ctx.canvas.height - profileHeight - 25;\n        const profileWidth = this.ctx.canvas.width - 50;\n        \n        // Enhanced background with glassmorphism effect\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';\n        this.ctx.fillRect(25, profileY, profileWidth, profileHeight);\n        \n        // Add subtle border and shadow\n        this.ctx.strokeStyle = 'rgba(102, 126, 234, 0.3)';\n        this.ctx.lineWidth = 2;\n        this.ctx.strokeRect(25, profileY, profileWidth, profileHeight);\n        \n        // Add inner shadow effect\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';\n        this.ctx.fillRect(27, profileY + 2, profileWidth - 4, profileHeight - 4);\n        \n        // Calculate concentration profile\n        const bins = 50;\n        const binWidth = profileWidth / bins;\n        const concentrationProfile = new Array(bins).fill(0);\n        \n        this.particles.forEach(particle => {\n            const binIndex = Math.floor((particle.x / this.ctx.canvas.width) * bins);\n            if (binIndex >= 0 && binIndex < bins) {\n                concentrationProfile[binIndex]++;\n            }\n        });\n        \n        // Normalize to fit in profile height\n        const maxConcentration = Math.max(...concentrationProfile);\n        const scale = (profileHeight - 20) / Math.max(maxConcentration, 1);\n        \n        // Draw enhanced concentration profile with gradient\n        const gradient = this.ctx.createLinearGradient(25, profileY, 25 + profileWidth, profileY);\n        gradient.addColorStop(0, '#FF6B6B');\n        gradient.addColorStop(0.5, '#667eea');\n        gradient.addColorStop(1, '#764ba2');\n        \n        this.ctx.strokeStyle = gradient;\n        this.ctx.lineWidth = 3;\n        this.ctx.lineCap = 'round';\n        this.ctx.lineJoin = 'round';\n        this.ctx.beginPath();\n        this.ctx.moveTo(25, profileY + profileHeight - 15);\n        \n        for (let i = 0; i < bins; i++) {\n            const x = 25 + i * binWidth;\n            const y = profileY + profileHeight - 15 - (concentrationProfile[i] * scale);\n            this.ctx.lineTo(x, y);\n        }\n        this.ctx.stroke();\n        \n        // Add area fill under the curve\n        this.ctx.fillStyle = 'rgba(255, 107, 107, 0.2)';\n        this.ctx.beginPath();\n        this.ctx.moveTo(25, profileY + profileHeight - 15);\n        for (let i = 0; i < bins; i++) {\n            const x = 25 + i * binWidth;\n            const y = profileY + profileHeight - 15 - (concentrationProfile[i] * scale);\n            this.ctx.lineTo(x, y);\n        }\n        this.ctx.lineTo(25 + profileWidth, profileY + profileHeight - 15);\n        this.ctx.closePath();\n        this.ctx.fill();\n        \n        // Enhanced labels with better styling\n        this.ctx.fillStyle = '#333';\n        this.ctx.font = 'bold 16px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'center';\n        this.ctx.fillText('Concentration Profile', this.ctx.canvas.width / 2, profileY - 8);\n        \n        // Add gradient text effect for labels\n        const labelGradient = this.ctx.createLinearGradient(30, profileY + 15, this.ctx.canvas.width - 30, profileY + 15);\n        labelGradient.addColorStop(0, '#FF6B6B');\n        labelGradient.addColorStop(1, '#764ba2');\n        \n        this.ctx.fillStyle = labelGradient;\n        this.ctx.font = 'bold 14px Inter';\n        this.ctx.fillText('High Concentration', 35, profileY + 20);\n        this.ctx.fillText('Low Concentration', this.ctx.canvas.width - 35, profileY + 20);\n    }\n    \n    drawStartBarrier() {\n        // Draw enhanced barrier with gradient and glow\n        const barrierX = this.ctx.canvas.width * 0.2;\n        \n        // Create gradient for barrier\n        const barrierGradient = this.ctx.createLinearGradient(barrierX - 2, 0, barrierX + 2, 0);\n        barrierGradient.addColorStop(0, 'rgba(255, 0, 0, 0.8)');\n        barrierGradient.addColorStop(0.5, 'rgba(255, 107, 107, 1)');\n        barrierGradient.addColorStop(1, 'rgba(255, 0, 0, 0.8)');\n        \n        this.ctx.strokeStyle = barrierGradient;\n        this.ctx.lineWidth = 4;\n        this.ctx.setLineDash([15, 8]);\n        this.ctx.lineCap = 'round';\n        \n        // Add glow effect\n        this.ctx.shadowColor = 'rgba(255, 0, 0, 0.6)';\n        this.ctx.shadowBlur = 10;\n        \n        this.ctx.beginPath();\n        this.ctx.moveTo(barrierX, 0);\n        this.ctx.lineTo(barrierX, this.ctx.canvas.height);\n        this.ctx.stroke();\n        \n        this.ctx.setLineDash([]);\n        this.ctx.shadowBlur = 0;\n        \n        // Enhanced instruction text with modern styling\n        const text = 'Click or tap to start diffusion';\n        const textWidth = this.ctx.measureText(text).width;\n        \n        // Create glassmorphism background\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';\n        this.ctx.fillRect(this.ctx.canvas.width / 2 - textWidth / 2 - 20, \n                         this.ctx.canvas.height - 60, textWidth + 40, 40);\n        \n        // Add border and shadow\n        this.ctx.strokeStyle = 'rgba(102, 126, 234, 0.3)';\n        this.ctx.lineWidth = 2;\n        this.ctx.strokeRect(this.ctx.canvas.width / 2 - textWidth / 2 - 20, \n                           this.ctx.canvas.height - 60, textWidth + 40, 40);\n        \n        // Add gradient text\n        const textGradient = this.ctx.createLinearGradient(\n            this.ctx.canvas.width / 2 - textWidth / 2, this.ctx.canvas.height - 50,\n            this.ctx.canvas.width / 2 + textWidth / 2, this.ctx.canvas.height - 50\n        );\n        textGradient.addColorStop(0, '#667eea');\n        textGradient.addColorStop(1, '#764ba2');\n        \n        this.ctx.fillStyle = textGradient;\n        this.ctx.font = 'bold 18px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'center';\n        this.ctx.fillText(text, this.ctx.canvas.width / 2, this.ctx.canvas.height - 35);\n    }\n    \n    getStats() {\n        const avgSpeed = this.particles.reduce((sum, p) => \n            sum + Math.sqrt(p.vx * p.vx + p.vy * p.vy), 0) / this.particles.length;\n        \n        // Calculate concentration spread\n        const leftParticles = this.particles.filter(p => p.x < this.ctx.canvas.width / 2).length;\n        const rightParticles = this.particles.length - leftParticles;\n        const concentrationSpread = Math.abs(leftParticles - rightParticles) / this.particles.length;\n        \n        return {\n            particleCount: this.particles.length,\n            avgSpeed: avgSpeed,\n            concentrationSpread: concentrationSpread,\n            time: this.time\n        };\n    }\n    \n    drawDiffusionLabels() {\n        // Draw elegant labels on the canvas\n        this.ctx.save();\n        \n        // Set up text styling\n        this.ctx.font = 'bold 16px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'center';\n        \n        // Draw animation type label\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.9)';\n        this.ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';\n        this.ctx.shadowBlur = 2;\n        this.ctx.fillText('Particle Diffusion', this.ctx.canvas.width / 2, 25);\n        \n        // Draw mathematical formulas in a more compact format\n        this.ctx.font = '12px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\n        this.ctx.fillText(`∂c/∂t = D∇²c  |  J = -D∇c  |  D = kBT/(6πηr)`, \n                          this.ctx.canvas.width / 2, 45);\n        \n        // Reset shadow\n        this.ctx.shadowBlur = 0;\n        this.ctx.restore();\n    }\n}\n\n// Gas Laws Simulation\nexport class GasLaws {\n    constructor(ctx) {\n        this.ctx = ctx;\n        this.particles = [];\n        this.particleCount = 50;\n        this.temperature = 300; // Kelvin\n        this.volume = 300; // Container height\n        this.pressure = 1.0; // External pressure\n        this.speed = 1.0;\n        this.showPressureGauge = true;\n        this.showParticleTrails = false;\n        this.showGasLaws = false;\n        this.showPressureHeatmap = false;\n        this.showVelocityDistribution = false;\n        this.showGasLawGraph = false;\n        this.showParticleCollisions = false;\n        this.lawType = 'boyle';\n        this.time = 0;\n        this.containerWidth = 200;\n        this.containerX = 300;\n        this.pistonY = 400 - this.volume;\n        this.collisionCount = 0;\n        this.velocityData = [];\n        this.pressureHistory = [];\n        this.volumeHistory = [];\n        this.temperatureHistory = [];\n        this.initialConditions = {\n            pressure: 1.0,\n            volume: 300,\n            temperature: 300\n        };\n        \n        this.initializeParticles();\n    }\n    \n    initializeParticles() {\n        this.particles = [];\n        for (let i = 0; i < this.particleCount; i++) {\n            this.particles.push({\n                x: this.containerX + Math.random() * this.containerWidth,\n                y: this.pistonY + this.volume + Math.random() * (this.volume * 0.8),\n                vx: (Math.random() - 0.5) * this.temperature * 0.1,\n                vy: (Math.random() - 0.5) * this.temperature * 0.1\n            });\n        }\n    }\n    \n    setSpeed(speed) {\n        this.speed = speed;\n    }\n    \n    setParticleCount(count) {\n        this.particleCount = count;\n        this.initializeParticles();\n    }\n    \n    setTemperature(temp) {\n        this.temperature = temp;\n        // Adjust particle velocities based on temperature\n        this.particles.forEach(particle => {\n            const speedFactor = Math.sqrt(temp / 300);\n            particle.vx *= speedFactor;\n            particle.vy *= speedFactor;\n        });\n    }\n    \n    setVolume(vol) {\n        this.volume = vol;\n        this.pistonY = 400 - this.volume;\n        // Adjust particle positions to stay in container\n        this.particles.forEach(particle => {\n            if (particle.y > this.pistonY + this.volume) {\n                particle.y = this.pistonY + this.volume - 10;\n            }\n        });\n    }\n    \n    setPressure(pressure) {\n        this.pressure = pressure;\n    }\n    \n    setShowPressureGauge(show) {\n        this.showPressureGauge = show;\n    }\n    \n    setShowPressureHeatmap(show) {\n        this.showPressureHeatmap = show;\n    }\n    \n    setShowVelocityDistribution(show) {\n        this.showVelocityDistribution = show;\n    }\n    \n    setShowGasLawGraph(show) {\n        this.showGasLawGraph = show;\n    }\n    \n    setShowParticleCollisions(show) {\n        this.showParticleCollisions = show;\n    }\n    \n    setLawType(law) {\n        this.lawType = law;\n        // Reset to initial conditions when changing law\n        this.pressure = this.initialConditions.pressure;\n        this.volume = this.initialConditions.volume;\n        this.temperature = this.initialConditions.temperature;\n        this.pistonY = 400 - this.volume;\n        this.reset();\n    }\n    \n    reset() {\n        this.time = 0;\n        this.collisionCount = 0;\n        this.velocityData = [];\n        this.pressureHistory = [];\n        this.volumeHistory = [];\n        this.temperatureHistory = [];\n        this.initializeParticles();\n    }\n    \n    update(deltaTime) {\n        this.time += deltaTime;\n        const dt = (deltaTime / 1000) * this.speed * 2; // Standardized time step scaling\n        \n        // Update particles with collision detection\n        this.particles.forEach((particle, index) => {\n            // Update position\n            particle.x += particle.vx * dt * 30;\n            particle.y += particle.vy * dt * 30;\n            \n            // Bounce off container walls\n            if (particle.x < this.containerX || particle.x > this.containerX + this.containerWidth) {\n                particle.vx *= -0.8;\n                particle.x = Math.max(this.containerX, Math.min(this.containerX + this.containerWidth, particle.x));\n                this.collisionCount++;\n            }\n            \n            // Bounce off piston and bottom\n            if (particle.y < this.pistonY || particle.y > this.pistonY + this.volume) {\n                particle.vy *= -0.8;\n                particle.y = Math.max(this.pistonY, Math.min(this.pistonY + this.volume, particle.y));\n                this.collisionCount++;\n            }\n            \n            // Particle-to-particle collisions\n            if (this.showParticleCollisions) {\n                for (let j = index + 1; j < this.particles.length; j++) {\n                    const other = this.particles[j];\n                    const dx = particle.x - other.x;\n                    const dy = particle.y - other.y;\n                    const distance = Math.sqrt(dx * dx + dy * dy);\n                    \n                    if (distance < 6) { // Collision radius\n                        // Simple elastic collision\n                        const tempVx = particle.vx;\n                        const tempVy = particle.vy;\n                        particle.vx = other.vx;\n                        particle.vy = other.vy;\n                        other.vx = tempVx;\n                        other.vy = tempVy;\n                        \n                        this.collisionCount++;\n                        \n                        // Separate particles\n                        const overlap = 6 - distance;\n                        const moveX = (overlap * dx) / distance / 2;\n                        const moveY = (overlap * dy) / distance / 2;\n                        particle.x += moveX;\n                        particle.y += moveY;\n                        other.x -= moveX;\n                        other.y -= moveY;\n                    }\n                }\n            }\n            \n\n        });\n        \n        // Update velocity distribution data\n        if (this.showVelocityDistribution) {\n            this.velocityData.push(...this.particles.map(p => Math.sqrt(p.vx * p.vx + p.vy * p.vy)));\n            if (this.velocityData.length > 1000) {\n                this.velocityData = this.velocityData.slice(-500);\n            }\n        }\n        \n        // Update history data for graphs (always collect data)\n        const currentPressure = this.calculatePressure();\n        this.pressureHistory.push(currentPressure);\n        this.volumeHistory.push(this.volume);\n        this.temperatureHistory.push(this.temperature);\n        \n        if (this.pressureHistory.length > 100) {\n            this.pressureHistory.shift();\n            this.volumeHistory.shift();\n            this.temperatureHistory.shift();\n        }\n        \n        // Calculate and apply pressure effects\n        this.calculatePressure();\n    }\n    \n    calculatePressure() {\n        // Calculate pressure based on particle collisions and container volume\n        const particleDensity = this.particles.length / (this.containerWidth * this.volume);\n        const avgSpeed = this.particles.reduce((sum, p) => \n            sum + Math.sqrt(p.vx * p.vx + p.vy * p.vy), 0) / this.particles.length;\n        \n        // Pressure is proportional to particle density and average kinetic energy\n        const calculatedPressure = particleDensity * avgSpeed * avgSpeed * 0.01;\n        \n        // Apply gas law relationships based on current law type\n        this.applyGasLaw();\n        \n        // Adjust piston position based on pressure difference\n        const pressureDiff = calculatedPressure - this.pressure;\n        this.pistonY += pressureDiff * 0.1;\n        this.pistonY = Math.max(100, Math.min(350, this.pistonY)); // Limit piston movement\n        this.volume = 400 - this.pistonY;\n        \n        return calculatedPressure;\n    }\n    \n    applyGasLaw() {\n        switch(this.lawType) {\n            case 'boyle':\n                // Boyle's Law: P₁V₁ = P₂V₂ (constant temperature)\n                const boyleConstant = this.initialConditions.pressure * this.initialConditions.volume;\n                if (this.volume !== this.initialConditions.volume) {\n                    this.pressure = boyleConstant / this.volume;\n                }\n                break;\n                \n            case 'charles':\n                // Charles's Law: V₁/T₁ = V₂/T₂ (constant pressure)\n                const charlesConstant = this.initialConditions.volume / this.initialConditions.temperature;\n                if (this.temperature !== this.initialConditions.temperature) {\n                    this.volume = charlesConstant * this.temperature;\n                    this.pistonY = 400 - this.volume;\n                }\n                break;\n                \n            case 'gay-lussac':\n                // Gay-Lussac's Law: P₁/T₁ = P₂/T₂ (constant volume)\n                const gayLussacConstant = this.initialConditions.pressure / this.initialConditions.temperature;\n                if (this.temperature !== this.initialConditions.temperature) {\n                    this.pressure = gayLussacConstant * this.temperature;\n                }\n                break;\n                \n            case 'combined':\n                // Combined Gas Law: P₁V₁/T₁ = P₂V₂/T₂\n                const combinedConstant = (this.initialConditions.pressure * this.initialConditions.volume) / this.initialConditions.temperature;\n                if (this.volume !== this.initialConditions.volume || this.temperature !== this.initialConditions.temperature) {\n                    this.pressure = (combinedConstant * this.temperature) / this.volume;\n                }\n                break;\n        }\n    }\n    \n    render() {\n        // Draw pressure heatmap\n        if (this.showPressureHeatmap) {\n            this.drawPressureHeatmap();\n        }\n        \n        // Draw velocity distribution\n        if (this.showVelocityDistribution) {\n            this.drawVelocityDistribution();\n        }\n        \n        // Draw gas law graph\n        if (this.showGasLawGraph) {\n            this.drawGasLawGraph();\n        }\n        \n        // Draw enhanced container with better visual design\n        this.drawEnhancedContainer();\n        \n        // Draw particles with temperature-based coloring\n            this.particles.forEach(particle => {\n            // Draw particle with temperature-based color\n                this.ctx.beginPath();\n            this.ctx.fillStyle = this.getTemperatureColor(particle);\n            this.ctx.arc(particle.x, particle.y, 3, 0, Math.PI * 2);\n                this.ctx.fill();\n            \n            // Add particle border\n            this.ctx.strokeStyle = '#fff';\n            this.ctx.lineWidth = 1;\n            this.ctx.stroke();\n        });\n        \n        // Draw pressure gauge\n        if (this.showPressureGauge) {\n            this.drawPressureGauge();\n        }\n        \n        // Draw law description and formula on canvas\n        this.drawLawDescription();\n        \n        // Draw canvas labels\n        this.drawGasLabels();\n    }\n    \n    drawEnhancedContainer() {\n        // Draw container with gradient and better styling\n        const gradient = this.ctx.createLinearGradient(\n            this.containerX, this.pistonY, \n            this.containerX + this.containerWidth, this.pistonY + this.volume\n        );\n        gradient.addColorStop(0, 'rgba(200, 220, 255, 0.1)');\n        gradient.addColorStop(1, 'rgba(150, 180, 255, 0.2)');\n        \n        this.ctx.fillStyle = gradient;\n        this.ctx.fillRect(this.containerX, this.pistonY, this.containerWidth, this.volume);\n        \n        // Draw container border\n        this.ctx.strokeStyle = '#2C3E50';\n        this.ctx.lineWidth = 4;\n        this.ctx.strokeRect(this.containerX, this.pistonY, this.containerWidth, this.volume);\n        \n        // Draw piston with enhanced styling\n        this.ctx.fillStyle = '#34495E';\n        this.ctx.fillRect(this.containerX - 8, this.pistonY - 15, this.containerWidth + 16, 30);\n        \n        // Piston border\n        this.ctx.strokeStyle = '#2C3E50';\n        this.ctx.lineWidth = 3;\n        this.ctx.strokeRect(this.containerX - 8, this.pistonY - 15, this.containerWidth + 16, 30);\n        \n        // Piston handle\n        this.ctx.fillStyle = '#E74C3C';\n        this.ctx.fillRect(this.containerX + this.containerWidth/2 - 15, this.pistonY - 25, 30, 10);\n        \n        // Add labels\n        this.ctx.fillStyle = '#2C3E50';\n        this.ctx.font = 'bold 18px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'center';\n        this.ctx.fillText('GAS', this.containerX + this.containerWidth/2, this.pistonY + this.volume/2);\n        \n        // Volume indicator\n        this.ctx.font = '14px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.fillStyle = '#7F8C8D';\n        this.ctx.fillText(`Volume: ${this.volume}`, this.containerX + this.containerWidth/2, this.pistonY + this.volume + 25);\n    }\n    \n    drawLawDescription() {\n        const canvasWidth = this.ctx.canvas.width;\n        const canvasHeight = this.ctx.canvas.height;\n        \n        // Position the description panel on the right side (reduced width to avoid overlap)\n        const panelX = canvasWidth - 220;\n        const panelY = 20;\n        const panelWidth = 200;\n        const panelHeight = 220;\n        \n        // Background panel\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';\n        this.ctx.fillRect(panelX, panelY, panelWidth, panelHeight);\n        this.ctx.strokeStyle = '#2C3E50';\n        this.ctx.lineWidth = 2;\n        this.ctx.strokeRect(panelX, panelY, panelWidth, panelHeight);\n        \n        this.ctx.fillStyle = '#2C3E50';\n        this.ctx.font = 'bold 18px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'left';\n        \n        let y = panelY + 30;\n        \n        // Law title\n        const lawNames = {\n            'boyle': \"Boyle's Law\",\n            'charles': \"Charles's Law\", \n            'gay-lussac': \"Gay-Lussac's Law\",\n            'combined': \"Combined Gas Law\"\n        };\n        \n        this.ctx.fillText(lawNames[this.lawType], panelX + 10, y);\n        y += 30;\n        \n        // Formula\n        this.ctx.font = 'bold 18px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.fillStyle = '#E74C3C';\n        \n        switch(this.lawType) {\n            case 'boyle':\n                this.ctx.fillText('P₁V₁ = P₂V₂', panelX + 10, y);\n                y += 25;\n                this.ctx.font = '14px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n                this.ctx.fillStyle = '#7F8C8D';\n                this.ctx.fillText('At constant temperature', panelX + 10, y);\n                y += 18;\n                this.ctx.fillText('Pressure ∝ 1/Volume', panelX + 10, y);\n                break;\n            case 'charles':\n                this.ctx.fillText('V₁/T₁ = V₂/T₂', panelX + 10, y);\n                y += 25;\n                this.ctx.font = '14px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n                this.ctx.fillStyle = '#7F8C8D';\n                this.ctx.fillText('At constant pressure', panelX + 10, y);\n                y += 18;\n                this.ctx.fillText('Volume ∝ Temperature', panelX + 10, y);\n                break;\n            case 'gay-lussac':\n                this.ctx.fillText('P₁/T₁ = P₂/T₂', panelX + 10, y);\n                y += 25;\n                this.ctx.font = '14px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n                this.ctx.fillStyle = '#7F8C8D';\n                this.ctx.fillText('At constant volume', panelX + 10, y);\n                y += 18;\n                this.ctx.fillText('Pressure ∝ Temperature', panelX + 10, y);\n                break;\n            case 'combined':\n                this.ctx.fillText('P₁V₁/T₁ = P₂V₂/T₂', panelX + 10, y);\n                y += 25;\n                this.ctx.font = '14px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n                this.ctx.fillStyle = '#7F8C8D';\n                this.ctx.fillText('Combines all three laws', panelX + 10, y);\n                y += 18;\n                this.ctx.fillText('PV/T = constant', panelX + 10, y);\n                break;\n        }\n        \n        // Current values\n        y += 30;\n        this.ctx.font = 'bold 14px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.fillStyle = '#2C3E50';\n        this.ctx.fillText('Current Values:', panelX + 10, y);\n        y += 20;\n        \n        this.ctx.font = '13px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.fillStyle = '#7F8C8D';\n        this.ctx.fillText(`P = ${this.pressure.toFixed(2)} atm`, panelX + 10, y);\n        y += 16;\n        this.ctx.fillText(`V = ${this.volume.toFixed(0)} units`, panelX + 10, y);\n        y += 16;\n        this.ctx.fillText(`T = ${this.temperature} K`, panelX + 10, y);\n    }\n    \n    getTemperatureColor(particle) {\n        const velocity = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\n        const maxVelocity = this.temperature * 0.2;\n        const normalizedVelocity = Math.min(velocity / maxVelocity, 1);\n        \n        if (normalizedVelocity < 0.5) {\n            // Blue to green\n            const t = normalizedVelocity * 2;\n            return `rgb(0, ${Math.floor(255 * t)}, ${Math.floor(255 * (1 - t))})`;\n        } else {\n            // Green to red\n            const t = (normalizedVelocity - 0.5) * 2;\n            return `rgb(${Math.floor(255 * t)}, ${Math.floor(255 * (1 - t))}, 0)`;\n        }\n    }\n    \n    drawPressureGauge() {\n        const gaugeX = 50;\n        const gaugeY = 150; // Moved down to avoid overlap with main labels\n        const gaugeRadius = 30;\n        \n        // Draw gauge background\n        this.ctx.beginPath();\n        this.ctx.fillStyle = '#f0f0f0';\n        this.ctx.arc(gaugeX, gaugeY, gaugeRadius, 0, Math.PI * 2);\n        this.ctx.fill();\n        this.ctx.strokeStyle = '#333';\n        this.ctx.lineWidth = 2;\n        this.ctx.stroke();\n        \n        // Calculate pressure value (0-1 scale)\n        const particleDensity = this.particles.length / (this.containerWidth * this.volume);\n        const avgSpeed = this.particles.reduce((sum, p) => \n            sum + Math.sqrt(p.vx * p.vx + p.vy * p.vy), 0) / this.particles.length;\n        \n        // Use the actual pressure value from gas law calculations\n        const pressureValue = Math.min(this.pressure / 2.0, 1.0); // Scale to 0-1 range\n        \n        // Draw pressure needle\n        const angle = -Math.PI/2 + pressureValue * Math.PI;\n        this.ctx.beginPath();\n        this.ctx.strokeStyle = '#FF6B6B';\n        this.ctx.lineWidth = 3;\n        this.ctx.moveTo(gaugeX, gaugeY);\n        this.ctx.lineTo(\n            gaugeX + Math.cos(angle) * (gaugeRadius - 5),\n            gaugeY + Math.sin(angle) * (gaugeRadius - 5)\n        );\n        this.ctx.stroke();\n        \n        // Draw pressure label\n        this.ctx.fillStyle = '#333';\n        this.ctx.font = '14px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'center';\n        this.ctx.fillText('Pressure', gaugeX, gaugeY + gaugeRadius + 15);\n        this.ctx.fillText(pressureValue.toFixed(2), gaugeX, gaugeY + gaugeRadius + 30);\n    }\n    \n    drawPressureHeatmap() {\n        const gridSize = 15;\n        const cols = Math.ceil(this.containerWidth / gridSize);\n        const rows = Math.ceil(this.volume / gridSize);\n        \n        for (let i = 0; i < rows; i++) {\n            for (let j = 0; j < cols; j++) {\n                const centerX = this.containerX + j * gridSize + gridSize / 2;\n                const centerY = this.pistonY + i * gridSize + gridSize / 2;\n                \n                // Calculate local pressure based on nearby particles\n                let localPressure = 0;\n                let particleCount = 0;\n                \n                this.particles.forEach(particle => {\n                    const dx = particle.x - centerX;\n                    const dy = particle.y - centerY;\n                    const distance = Math.sqrt(dx * dx + dy * dy);\n                    \n                    if (distance < gridSize) {\n                        const velocity = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\n                        localPressure += velocity * velocity;\n                        particleCount++;\n                    }\n                });\n                \n                if (particleCount > 0) {\n                    localPressure /= particleCount;\n                    const alpha = Math.min(localPressure / 100, 0.4);\n                    this.ctx.fillStyle = `rgba(255, 100, 100, ${alpha})`;\n                    this.ctx.fillRect(\n                        this.containerX + j * gridSize, \n                        this.pistonY + i * gridSize, \n                        gridSize, \n                        gridSize\n                    );\n                }\n            }\n        }\n    }\n    \n    drawVelocityDistribution() {\n        const graphWidth = 200;\n        const graphHeight = 100;\n        const graphX = this.ctx.canvas.width - graphWidth - 20;\n        const graphY = 120; // Moved down to avoid overlap with main labels\n        \n        // Background\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\n        this.ctx.fillRect(graphX, graphY, graphWidth, graphHeight);\n        this.ctx.strokeStyle = '#333';\n        this.ctx.lineWidth = 1;\n        this.ctx.strokeRect(graphX, graphY, graphWidth, graphHeight);\n        \n        if (this.velocityData.length > 0) {\n            // Create histogram\n            const bins = 20;\n            const histogram = new Array(bins).fill(0);\n            const maxVelocity = Math.max(...this.velocityData);\n            \n            this.velocityData.forEach(velocity => {\n                const binIndex = Math.floor((velocity / maxVelocity) * (bins - 1));\n                if (binIndex >= 0 && binIndex < bins) {\n                    histogram[binIndex]++;\n                }\n            });\n            \n            // Draw histogram\n            const maxCount = Math.max(...histogram);\n            const barWidth = graphWidth / bins;\n            \n            this.ctx.fillStyle = '#4ECDC4';\n            for (let i = 0; i < bins; i++) {\n                const barHeight = (histogram[i] / maxCount) * (graphHeight - 20);\n                this.ctx.fillRect(\n                    graphX + i * barWidth + 2, \n                    graphY + graphHeight - 10 - barHeight, \n                    barWidth - 4, \n                    barHeight\n                );\n            }\n        }\n        \n        // Labels\n        this.ctx.fillStyle = '#333';\n        this.ctx.font = '14px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'center';\n        this.ctx.fillText('Velocity Distribution', graphX + graphWidth / 2, graphY - 5);\n    }\n    \n    drawGasLawGraph() {\n        const graphWidth = 300;\n        const graphHeight = 150;\n        const graphX = 20;\n        const graphY = this.ctx.canvas.height - graphHeight - 20;\n        \n        // Background\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\n        this.ctx.fillRect(graphX, graphY, graphWidth, graphHeight);\n        this.ctx.strokeStyle = '#333';\n        this.ctx.lineWidth = 1;\n        this.ctx.strokeRect(graphX, graphY, graphWidth, graphHeight);\n        \n        if (this.pressureHistory.length > 1) {\n            // Calculate data ranges for proper scaling\n            const maxPressure = Math.max(...this.pressureHistory);\n            const minPressure = Math.min(...this.pressureHistory);\n            const maxVolume = Math.max(...this.volumeHistory);\n            const minVolume = Math.min(...this.volumeHistory);\n            const maxTemp = Math.max(...this.temperatureHistory);\n            const minTemp = Math.min(...this.temperatureHistory);\n            \n            // Draw graph based on current law type\n            this.ctx.strokeStyle = '#FF6B6B';\n            this.ctx.lineWidth = 2;\n            this.ctx.beginPath();\n            \n            for (let i = 0; i < this.pressureHistory.length; i++) {\n                let x, y;\n                \n                switch(this.lawType) {\n                    case 'boyle':\n                        // P vs V (inverse relationship)\n                        x = graphX + ((this.volumeHistory[i] - minVolume) / (maxVolume - minVolume)) * graphWidth;\n                        y = graphY + graphHeight - ((this.pressureHistory[i] - minPressure) / (maxPressure - minPressure)) * graphHeight;\n                        break;\n                    case 'charles':\n                        // V vs T (linear relationship)\n                        x = graphX + ((this.temperatureHistory[i] - minTemp) / (maxTemp - minTemp)) * graphWidth;\n                        y = graphY + graphHeight - ((this.volumeHistory[i] - minVolume) / (maxVolume - minVolume)) * graphHeight;\n                        break;\n                    case 'gay-lussac':\n                        // P vs T (linear relationship)\n                        x = graphX + ((this.temperatureHistory[i] - minTemp) / (maxTemp - minTemp)) * graphWidth;\n                        y = graphY + graphHeight - ((this.pressureHistory[i] - minPressure) / (maxPressure - minPressure)) * graphHeight;\n                        break;\n                    default:\n                        x = graphX + (i / this.pressureHistory.length) * graphWidth;\n                        y = graphY + graphHeight - ((this.pressureHistory[i] - minPressure) / (maxPressure - minPressure)) * graphHeight;\n                }\n                \n                // Ensure coordinates are within graph bounds\n                x = Math.max(graphX, Math.min(graphX + graphWidth, x));\n                y = Math.max(graphY, Math.min(graphY + graphHeight, y));\n                \n                if (i === 0) {\n                    this.ctx.moveTo(x, y);\n                } else {\n                    this.ctx.lineTo(x, y);\n                }\n            }\n            this.ctx.stroke();\n            \n            // Draw data points\n            this.ctx.fillStyle = '#FF6B6B';\n            for (let i = 0; i < this.pressureHistory.length; i += 5) { // Draw every 5th point\n                let x, y;\n                \n                switch(this.lawType) {\n                    case 'boyle':\n                        x = graphX + ((this.volumeHistory[i] - minVolume) / (maxVolume - minVolume)) * graphWidth;\n                        y = graphY + graphHeight - ((this.pressureHistory[i] - minPressure) / (maxPressure - minPressure)) * graphHeight;\n                        break;\n                    case 'charles':\n                        x = graphX + ((this.temperatureHistory[i] - minTemp) / (maxTemp - minTemp)) * graphWidth;\n                        y = graphY + graphHeight - ((this.volumeHistory[i] - minVolume) / (maxVolume - minVolume)) * graphHeight;\n                        break;\n                    case 'gay-lussac':\n                        x = graphX + ((this.temperatureHistory[i] - minTemp) / (maxTemp - minTemp)) * graphWidth;\n                        y = graphY + graphHeight - ((this.pressureHistory[i] - minPressure) / (maxPressure - minPressure)) * graphHeight;\n                        break;\n                    default:\n                        x = graphX + (i / this.pressureHistory.length) * graphWidth;\n                        y = graphY + graphHeight - ((this.pressureHistory[i] - minPressure) / (maxPressure - minPressure)) * graphHeight;\n                }\n                \n                x = Math.max(graphX, Math.min(graphX + graphWidth, x));\n                y = Math.max(graphY, Math.min(graphY + graphHeight, y));\n                \n                this.ctx.beginPath();\n                this.ctx.arc(x, y, 2, 0, Math.PI * 2);\n                this.ctx.fill();\n            }\n        }\n        \n        // Labels\n        this.ctx.fillStyle = '#333';\n        this.ctx.font = '14px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'center';\n        \n        let xLabel, yLabel;\n        switch(this.lawType) {\n            case 'boyle':\n                xLabel = 'Volume';\n                yLabel = 'Pressure';\n                break;\n            case 'charles':\n                xLabel = 'Temperature (K)';\n                yLabel = 'Volume';\n                break;\n            case 'gay-lussac':\n                xLabel = 'Temperature (K)';\n                yLabel = 'Pressure';\n                break;\n            default:\n                xLabel = 'Time';\n                yLabel = 'Pressure';\n        }\n        \n        this.ctx.fillText(`${yLabel} vs ${xLabel}`, graphX + graphWidth / 2, graphY - 5);\n    }\n    \n    getStats() {\n        const particleDensity = this.particles.length / (this.containerWidth * this.volume);\n        const avgSpeed = this.particles.reduce((sum, p) => \n            sum + Math.sqrt(p.vx * p.vx + p.vy * p.vy), 0) / this.particles.length;\n        const calculatedPressure = particleDensity * avgSpeed * avgSpeed * 0.01;\n        \n        return {\n            particleCount: this.particles.length,\n            temperature: this.temperature,\n            pressure: calculatedPressure,\n            volume: Math.round(this.volume),\n            collisionCount: this.collisionCount,\n            lawType: this.lawType\n        };\n    }\n    \n    drawGasLabels() {\n        // Draw elegant labels on the canvas\n        this.ctx.save();\n        \n        // Set up text styling\n        this.ctx.font = 'bold 16px Inter';\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\n        this.ctx.textAlign = 'center';\n        \n        // Draw animation type label only (no formulas to avoid overlap with law info container)\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.9)';\n        this.ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';\n        this.ctx.shadowBlur = 2;\n        this.ctx.fillText('Gas Laws', this.ctx.canvas.width / 2, 25);\n        \n        // Reset shadow\n        this.ctx.shadowBlur = 0;\n        this.ctx.restore();\n    }\n}","// Classical Mechanics Animations\r\n\r\n// Pendulum Simulation\r\n// Pendulum Simulation\r\nexport class Pendulum {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.length = 120;\r\n        this.angle = Math.PI / 4; // 45 degrees\r\n        this.angularVelocity = 0;\r\n        this.gravity = 1;\r\n        this.damping = 0.01;\r\n        this.speed = 1;\r\n        this.mass = 1.0; // New: bob mass\r\n        this.showPath = false;\r\n        this.showVelocityVectors = false; // New: show velocity vectors\r\n        this.showForceVectors = false; // New: show force vectors\r\n        this.showEnergyInfo = false; // New: show energy information\r\n        this.showPhaseSpace = false; // New: show phase space plot\r\n        this.time = 0;\r\n        this.path = [];\r\n        this.phaseSpaceData = []; // New: store phase space data\r\n        this.energyHistory = []; // New: store energy data\r\n        this.initialAngle = Math.PI / 4;\r\n        this.maxAmplitude = Math.PI / 4; // Track maximum amplitude\r\n        this.periods = []; // Track periods\r\n        this.lastZeroCrossing = 0; // For period calculation\r\n        this.crossingCount = 0; // Count zero crossings\r\n    }\r\n    \r\n    setLength(length) {\r\n        this.length = length;\r\n    }\r\n    \r\n    setSpeed(speed) {\r\n        this.speed = speed;\r\n    }\r\n    \r\n    setInitialAngle(angle) {\r\n        this.initialAngle = angle * Math.PI / 180;\r\n        this.angle = this.initialAngle;\r\n    }\r\n    \r\n    setGravity(gravity) {\r\n        this.gravity = gravity;\r\n    }\r\n    \r\n    setDamping(damping) {\r\n        this.damping = damping;\r\n    }\r\n    \r\n    setShowPath(show) {\r\n        this.showPath = show;\r\n        if (!show) this.path = [];\r\n    }\r\n    \r\n    setMass(mass) {\r\n        this.mass = mass;\r\n    }\r\n    \r\n    setShowVelocityVectors(show) {\r\n        this.showVelocityVectors = show;\r\n    }\r\n    \r\n    setShowForceVectors(show) {\r\n        this.showForceVectors = show;\r\n    }\r\n    \r\n    setShowEnergyInfo(show) {\r\n        this.showEnergyInfo = show;\r\n    }\r\n    \r\n    setShowPhaseSpace(show) {\r\n        this.showPhaseSpace = show;\r\n        if (!show) this.phaseSpaceData = [];\r\n    }\r\n    \r\n    reset() {\r\n        this.angle = this.initialAngle;\r\n        this.angularVelocity = 0;\r\n        this.time = 0;\r\n        this.path = [];\r\n        this.phaseSpaceData = [];\r\n        this.energyHistory = [];\r\n        this.maxAmplitude = Math.abs(this.initialAngle);\r\n        this.periods = [];\r\n        this.lastZeroCrossing = 0;\r\n        this.crossingCount = 0;\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        this.time += deltaTime;\r\n        const dt = (deltaTime / 1000) * this.speed * 3; // Reduced scaling for moderate speed\r\n        \r\n        // Pendulum physics with enhanced air resistance modeling\r\n        const acceleration = -(this.gravity * 9.8) / (this.length / 100) * Math.sin(this.angle);\r\n        \r\n        // Enhanced air resistance: velocity-dependent damping\r\n        const velocityMagnitude = Math.abs(this.angularVelocity);\r\n        const airResistanceForce = this.damping * velocityMagnitude * velocityMagnitude;\r\n        const dampingAcceleration = -Math.sign(this.angularVelocity) * airResistanceForce;\r\n        \r\n        this.angularVelocity += (acceleration + dampingAcceleration) * dt;\r\n        this.angle += this.angularVelocity * dt;\r\n        \r\n        // Track maximum amplitude\r\n        this.maxAmplitude = Math.max(this.maxAmplitude, Math.abs(this.angle));\r\n        \r\n        // Period calculation (zero crossing detection)\r\n        if (this.angle * this.angularVelocity < 0 && this.angularVelocity > 0) {\r\n            // Positive zero crossing\r\n            if (this.crossingCount > 0) {\r\n                const period = this.time - this.lastZeroCrossing;\r\n                this.periods.push(period);\r\n                if (this.periods.length > 10) {\r\n                    this.periods.shift();\r\n                }\r\n            }\r\n            this.lastZeroCrossing = this.time;\r\n            this.crossingCount++;\r\n        }\r\n        \r\n        // Update path\r\n        if (this.showPath) {\r\n            const x = this.ctx.canvas.width / 2 + this.length * Math.sin(this.angle);\r\n            const y = this.ctx.canvas.height / 2 + this.length * Math.cos(this.angle);\r\n            this.path.push({ x, y });\r\n            if (this.path.length > 100) {\r\n                this.path.shift();\r\n            }\r\n        }\r\n        \r\n        // Update phase space data\r\n        if (this.showPhaseSpace) {\r\n            this.phaseSpaceData.push({ angle: this.angle, velocity: this.angularVelocity });\r\n            if (this.phaseSpaceData.length > 200) {\r\n                this.phaseSpaceData.shift();\r\n            }\r\n        }\r\n        \r\n        // Update energy history\r\n        if (this.showEnergyInfo) {\r\n            const kineticEnergy = 0.5 * this.mass * this.length * this.length * this.angularVelocity * this.angularVelocity;\r\n            const potentialEnergy = this.mass * this.gravity * 9.8 * this.length * (1 - Math.cos(this.angle));\r\n            this.energyHistory.push({ kinetic: kineticEnergy, potential: potentialEnergy, total: kineticEnergy + potentialEnergy });\r\n            if (this.energyHistory.length > 100) {\r\n                this.energyHistory.shift();\r\n            }\r\n        }\r\n    }\r\n    \r\n    render() {\r\n        const centerX = this.ctx.canvas.width / 2;\r\n        const centerY = this.ctx.canvas.height * 0.3; // Move pendulum higher up\r\n        const bobX = centerX + this.length * Math.sin(this.angle);\r\n        const bobY = centerY + this.length * Math.cos(this.angle);\r\n        \r\n        // Calculate energy for color coding\r\n        const kineticEnergy = 0.5 * this.mass * this.length * this.length * this.angularVelocity * this.angularVelocity;\r\n        const potentialEnergy = this.mass * this.gravity * 9.8 * this.length * (1 - Math.cos(this.angle));\r\n        const totalEnergy = kineticEnergy + potentialEnergy;\r\n        const energyRatio = kineticEnergy / totalEnergy;\r\n        \r\n        // Draw phase space plot\r\n        if (this.showPhaseSpace) {\r\n            this.drawPhaseSpacePlot();\r\n        }\r\n        \r\n        // Draw energy bar\r\n        if (this.showEnergyInfo) {\r\n            this.drawEnergyBar();\r\n        }\r\n        \r\n        // Draw path with energy-based color\r\n        if (this.showPath && this.path.length > 1) {\r\n            this.ctx.beginPath();\r\n            this.ctx.strokeStyle = `hsl(${200 + energyRatio * 60}, 70%, 50%, 0.6)`;\r\n            this.ctx.lineWidth = 3;\r\n            this.ctx.moveTo(this.path[0].x, this.path[0].y);\r\n            for (let i = 1; i < this.path.length; i++) {\r\n                this.ctx.lineTo(this.path[i].x, this.path[i].y);\r\n            }\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Draw enhanced pivot\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = '#2c3e50';\r\n        this.ctx.arc(centerX, centerY, 8, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        this.ctx.strokeStyle = '#34495e';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.stroke();\r\n        \r\n        // Draw pivot shadow\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.arc(centerX + 2, centerY + 2, 8, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Draw string with shadow\r\n        this.ctx.beginPath();\r\n        this.ctx.strokeStyle = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.moveTo(centerX + 1, centerY + 1);\r\n        this.ctx.lineTo(bobX + 1, bobY + 1);\r\n        this.ctx.stroke();\r\n        \r\n        this.ctx.beginPath();\r\n        this.ctx.strokeStyle = '#34495e';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.moveTo(centerX, centerY);\r\n        this.ctx.lineTo(bobX, bobY);\r\n        this.ctx.stroke();\r\n        \r\n        // Draw force vectors\r\n        if (this.showForceVectors) {\r\n            this.drawForceVectors(centerX, centerY, bobX, bobY);\r\n        }\r\n        \r\n        // Draw velocity vector\r\n        if (this.showVelocityVectors) {\r\n            this.drawVelocityVector(bobX, bobY);\r\n        }\r\n        \r\n        // Draw enhanced bob with energy-based color\r\n        const bobColor = `hsl(${200 + energyRatio * 60}, 70%, 50%)`;\r\n        \r\n        // Bob shadow\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.arc(bobX + 2, bobY + 2, 18, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Bob main\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = bobColor;\r\n        this.ctx.arc(bobX, bobY, 18, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Bob highlight\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';\r\n        this.ctx.arc(bobX - 5, bobY - 5, 6, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Bob border\r\n        this.ctx.strokeStyle = '#2c3e50';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.stroke();\r\n        \r\n        // Draw pendulum info\r\n        if (this.showEnergyInfo) {\r\n            this.drawPendulumInfo();\r\n        }\r\n        \r\n        // Draw canvas labels\r\n        this.drawPendulumLabels();\r\n    }\r\n    \r\n    drawForceVectors(centerX, centerY, bobX, bobY) {\r\n        // Gravity force vector\r\n        const gravityForce = this.mass * this.gravity * 9.8;\r\n        const gravityLength = 50; // Increased from 30\r\n        \r\n        this.ctx.beginPath();\r\n        this.ctx.strokeStyle = '#e74c3c';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.moveTo(bobX, bobY);\r\n        this.ctx.lineTo(bobX, bobY + gravityLength);\r\n        this.ctx.stroke();\r\n        \r\n        // Arrow head for gravity\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(bobX, bobY + gravityLength);\r\n        this.ctx.lineTo(bobX - 6, bobY + gravityLength - 10);\r\n        this.ctx.lineTo(bobX + 6, bobY + gravityLength - 10);\r\n        this.ctx.closePath();\r\n        this.ctx.fillStyle = '#e74c3c';\r\n        this.ctx.fill();\r\n        \r\n        // Gravity force label\r\n        this.ctx.fillStyle = '#e74c3c';\r\n        this.ctx.font = 'bold 14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('Fg', bobX + 15, bobY + gravityLength / 2);\r\n        \r\n        // Tension force vector (along the string)\r\n        const tensionLength = 40; // Increased from 25\r\n        const tensionX = bobX - centerX;\r\n        const tensionY = bobY - centerY;\r\n        const tensionMagnitude = Math.sqrt(tensionX * tensionX + tensionY * tensionY);\r\n        \r\n        if (tensionMagnitude > 0) {\r\n            const unitX = tensionX / tensionMagnitude;\r\n            const unitY = tensionY / tensionMagnitude;\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.strokeStyle = '#3498db';\r\n            this.ctx.lineWidth = 3;\r\n            this.ctx.moveTo(bobX, bobY);\r\n            this.ctx.lineTo(bobX - unitX * tensionLength, bobY - unitY * tensionLength);\r\n            this.ctx.stroke();\r\n            \r\n            // Arrow head for tension\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(bobX - unitX * tensionLength, bobY - unitY * tensionLength);\r\n            this.ctx.lineTo(bobX - unitX * tensionLength + unitY * 6, bobY - unitY * tensionLength - unitX * 6);\r\n            this.ctx.lineTo(bobX - unitX * tensionLength - unitY * 6, bobY - unitY * tensionLength + unitX * 6);\r\n            this.ctx.closePath();\r\n            this.ctx.fillStyle = '#3498db';\r\n            this.ctx.fill();\r\n            \r\n            // Tension force label\r\n            this.ctx.fillStyle = '#3498db';\r\n            this.ctx.font = 'bold 14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.fillText('T', bobX - unitX * tensionLength / 2 + 15, bobY - unitY * tensionLength / 2 - 10);\r\n        }\r\n        \r\n        // Air resistance force vector (if damping is significant)\r\n        if (this.damping > 0.001 && Math.abs(this.angularVelocity) > 0.1) {\r\n            const velocityX = this.length * this.angularVelocity * Math.cos(this.angle);\r\n            const velocityY = -this.length * this.angularVelocity * Math.sin(this.angle);\r\n            const velocityMagnitude = Math.sqrt(velocityX * velocityX + velocityY * velocityY);\r\n            \r\n            if (velocityMagnitude > 0) {\r\n                const airResistanceForce = this.damping * velocityMagnitude * velocityMagnitude;\r\n                const airResistanceLength = Math.min(airResistanceForce * 2, 30); // Scale for visibility\r\n                \r\n                const unitVX = velocityX / velocityMagnitude;\r\n                const unitVY = velocityY / velocityMagnitude;\r\n                \r\n                this.ctx.beginPath();\r\n                this.ctx.strokeStyle = '#e67e22';\r\n                this.ctx.lineWidth = 2;\r\n                this.ctx.moveTo(bobX, bobY);\r\n                this.ctx.lineTo(bobX - unitVX * airResistanceLength, bobY - unitVY * airResistanceLength);\r\n                this.ctx.stroke();\r\n                \r\n                // Arrow head for air resistance\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(bobX - unitVX * airResistanceLength, bobY - unitVY * airResistanceLength);\r\n                this.ctx.lineTo(bobX - unitVX * airResistanceLength + unitVY * 4, bobY - unitVY * airResistanceLength - unitVX * 4);\r\n                this.ctx.lineTo(bobX - unitVX * airResistanceLength - unitVY * 4, bobY - unitVY * airResistanceLength + unitVX * 4);\r\n                this.ctx.closePath();\r\n                this.ctx.fillStyle = '#e67e22';\r\n                this.ctx.fill();\r\n                \r\n                // Air resistance force label\r\n                this.ctx.fillStyle = '#e67e22';\r\n                this.ctx.font = 'bold 12px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n                this.ctx.textAlign = 'center';\r\n                this.ctx.fillText('Fd', bobX - unitVX * airResistanceLength / 2 - 10, bobY - unitVY * airResistanceLength / 2 - 5);\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawVelocityVector(bobX, bobY) {\r\n        const velocityX = this.length * this.angularVelocity * Math.cos(this.angle);\r\n        const velocityY = -this.length * this.angularVelocity * Math.sin(this.angle);\r\n        const velocityMagnitude = Math.sqrt(velocityX * velocityX + velocityY * velocityY);\r\n        \r\n        if (velocityMagnitude > 0.1) {\r\n            const scale = 20 / velocityMagnitude;\r\n            const scaledVX = velocityX * scale;\r\n            const scaledVY = velocityY * scale;\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.strokeStyle = '#f39c12';\r\n            this.ctx.lineWidth = 3;\r\n            this.ctx.moveTo(bobX, bobY);\r\n            this.ctx.lineTo(bobX + scaledVX, bobY + scaledVY);\r\n            this.ctx.stroke();\r\n            \r\n            // Arrow head\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(bobX + scaledVX, bobY + scaledVY);\r\n            this.ctx.lineTo(bobX + scaledVX - scaledVY * 0.3, bobY + scaledVY + scaledVX * 0.3);\r\n            this.ctx.lineTo(bobX + scaledVX + scaledVY * 0.3, bobY + scaledVY - scaledVX * 0.3);\r\n            this.ctx.closePath();\r\n            this.ctx.fillStyle = '#f39c12';\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n    \r\n    drawEnergyBar() {\r\n        const barWidth = 200;\r\n        const barHeight = 20;\r\n        const barX = 20;\r\n        const barY = 20;\r\n        \r\n        // Background\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\r\n        this.ctx.fillRect(barX, barY, barWidth, barHeight);\r\n        this.ctx.strokeStyle = '#333';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.strokeRect(barX, barY, barWidth, barHeight);\r\n        \r\n        // Calculate current energies\r\n        const kineticEnergy = 0.5 * this.mass * this.length * this.length * this.angularVelocity * this.angularVelocity;\r\n        const potentialEnergy = this.mass * this.gravity * 9.8 * this.length * (1 - Math.cos(this.angle));\r\n        const totalEnergy = kineticEnergy + potentialEnergy;\r\n        \r\n        if (totalEnergy > 0) {\r\n            const kineticRatio = kineticEnergy / totalEnergy;\r\n            const potentialRatio = potentialEnergy / totalEnergy;\r\n            \r\n            // Kinetic energy (orange)\r\n            this.ctx.fillStyle = '#f39c12';\r\n            this.ctx.fillRect(barX, barY, barWidth * kineticRatio, barHeight);\r\n            \r\n            // Potential energy (blue)\r\n            this.ctx.fillStyle = '#3498db';\r\n            this.ctx.fillRect(barX + barWidth * kineticRatio, barY, barWidth * potentialRatio, barHeight);\r\n        }\r\n        \r\n        // Labels\r\n        this.ctx.fillStyle = '#333';\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('Energy', barX + barWidth / 2, barY - 5);\r\n        this.ctx.fillText('K', barX + 10, barY + 15);\r\n        this.ctx.fillText('P', barX + barWidth - 10, barY + 15);\r\n    }\r\n    \r\n    drawPhaseSpacePlot() {\r\n        const plotWidth = 200;\r\n        const plotHeight = 150;\r\n        const plotX = this.ctx.canvas.width - plotWidth - 20;\r\n        const plotY = 20;\r\n        \r\n        // Background\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\r\n        this.ctx.fillRect(plotX, plotY, plotWidth, plotHeight);\r\n        this.ctx.strokeStyle = '#333';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.strokeRect(plotX, plotY, plotWidth, plotHeight);\r\n        \r\n        if (this.phaseSpaceData.length > 1) {\r\n            // Find data ranges\r\n            const angles = this.phaseSpaceData.map(d => d.angle);\r\n            const velocities = this.phaseSpaceData.map(d => d.velocity);\r\n            const minAngle = Math.min(...angles);\r\n            const maxAngle = Math.max(...angles);\r\n            const minVel = Math.min(...velocities);\r\n            const maxVel = Math.max(...velocities);\r\n            \r\n            // Draw phase space trajectory\r\n            this.ctx.beginPath();\r\n            this.ctx.strokeStyle = '#9b59b6';\r\n            this.ctx.lineWidth = 2;\r\n            \r\n            for (let i = 0; i < this.phaseSpaceData.length; i++) {\r\n                const x = plotX + ((this.phaseSpaceData[i].angle - minAngle) / (maxAngle - minAngle)) * plotWidth;\r\n                const y = plotY + plotHeight - ((this.phaseSpaceData[i].velocity - minVel) / (maxVel - minVel)) * plotHeight;\r\n                \r\n                if (i === 0) {\r\n                    this.ctx.moveTo(x, y);\r\n                } else {\r\n                    this.ctx.lineTo(x, y);\r\n                }\r\n            }\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Labels\r\n        this.ctx.fillStyle = '#333';\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('Phase Space', plotX + plotWidth / 2, plotY - 5);\r\n        this.ctx.fillText('θ', plotX + plotWidth / 2, plotY + plotHeight + 15);\r\n        this.ctx.fillText('ω', plotX - 10, plotY + plotHeight / 2);\r\n    }\r\n    \r\n    drawPendulumInfo() {\r\n        const infoX = 20;\r\n        const infoY = 60;\r\n        \r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        \r\n        let y = infoY;\r\n        this.ctx.fillText(`Angle: ${(this.angle * 180 / Math.PI).toFixed(1)}°`, infoX, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Angular Velocity: ${this.angularVelocity.toFixed(2)} rad/s`, infoX, y);\r\n        y += 20;\r\n        \r\n        const kineticEnergy = 0.5 * this.mass * this.length * this.length * this.angularVelocity * this.angularVelocity;\r\n        const potentialEnergy = this.mass * this.gravity * 9.8 * this.length * (1 - Math.cos(this.angle));\r\n        this.ctx.fillText(`Kinetic Energy: ${kineticEnergy.toFixed(1)} J`, infoX, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Potential Energy: ${potentialEnergy.toFixed(1)} J`, infoX, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Total Energy: ${(kineticEnergy + potentialEnergy).toFixed(1)} J`, infoX, y);\r\n        y += 20;\r\n        \r\n        // Period information\r\n        if (this.periods.length > 0) {\r\n            const avgPeriod = this.periods.reduce((sum, p) => sum + p, 0) / this.periods.length;\r\n            this.ctx.fillText(`Measured Period: ${avgPeriod.toFixed(2)} s`, infoX, y);\r\n            y += 20;\r\n        }\r\n        \r\n        const theoreticalPeriod = 2 * Math.PI * Math.sqrt(this.length / (this.gravity * 9.8));\r\n        this.ctx.fillText(`Theoretical Period: ${theoreticalPeriod.toFixed(2)} s`, infoX, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Max Amplitude: ${(this.maxAmplitude * 180 / Math.PI).toFixed(1)}°`, infoX, y);\r\n        y += 20;\r\n        \r\n        // Air resistance information\r\n        const velocityMagnitude = Math.abs(this.angularVelocity);\r\n        const airResistanceForce = this.damping * velocityMagnitude * velocityMagnitude;\r\n        this.ctx.fillText(`Air Resistance: ${airResistanceForce.toFixed(3)} N`, infoX, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Damping Coefficient: ${this.damping.toFixed(3)}`, infoX, y);\r\n    }\r\n    \r\n    getStats() {\r\n        const theoreticalPeriod = 2 * Math.PI * Math.sqrt(this.length / (this.gravity * 9.8));\r\n        const kineticEnergy = 0.5 * this.mass * this.length * this.length * this.angularVelocity * this.angularVelocity;\r\n        const potentialEnergy = this.mass * this.gravity * 9.8 * this.length * (1 - Math.cos(this.angle));\r\n        const velocityMagnitude = Math.abs(this.angularVelocity);\r\n        const airResistanceForce = this.damping * velocityMagnitude * velocityMagnitude;\r\n        \r\n        return {\r\n            angle: this.angle * 180 / Math.PI,\r\n            angularVelocity: this.angularVelocity,\r\n            theoreticalPeriod: theoreticalPeriod,\r\n            measuredPeriod: this.periods.length > 0 ? this.periods.reduce((sum, p) => sum + p, 0) / this.periods.length : 0,\r\n            kineticEnergy: kineticEnergy,\r\n            potentialEnergy: potentialEnergy,\r\n            totalEnergy: kineticEnergy + potentialEnergy,\r\n            maxAmplitude: this.maxAmplitude * 180 / Math.PI,\r\n            airResistanceForce: airResistanceForce,\r\n            dampingCoefficient: this.damping,\r\n            time: this.time\r\n        };\r\n    }\r\n    \r\n    drawPendulumLabels() {\r\n        // Draw elegant labels on the canvas\r\n        this.ctx.save();\r\n        \r\n        // Set up text styling\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        \r\n        // Draw animation type label\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.9)';\r\n        this.ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        this.ctx.fillText('Simple Pendulum', this.ctx.canvas.width / 2, 25);\r\n        \r\n        // Draw mathematical formulas in a more compact format\r\n        this.ctx.font = '12px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.fillText(`T = 2π√(L/g)  |  θ̈ + (g/L)sin(θ) = 0  |  E = ½mL²θ̇² + mgL(1-cos(θ))`, \r\n                          this.ctx.canvas.width / 2, 45);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.restore();\r\n    }\r\n}\r\n\r\n// Orbital Motion Simulation\r\nexport class OrbitalMotion {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.centerX = 400;\r\n        this.centerY = 300;\r\n        this.semiMajorAxis = 200;\r\n        this.eccentricity = 0.2;\r\n        this.centralMass = 1.0;\r\n        this.speed = 1.0;\r\n        this.time = 0;\r\n        this.angle = 0;\r\n        this.showOrbitPath = true;\r\n        this.showVelocityVector = false;\r\n        this.showKeplerInfo = false;\r\n        \r\n        // Calculate orbital parameters\r\n        this.calculateOrbitalParameters();\r\n    }\r\n    \r\n    calculateOrbitalParameters() {\r\n        // Calculate semi-minor axis from eccentricity\r\n        this.semiMinorAxis = this.semiMajorAxis * Math.sqrt(1 - this.eccentricity * this.eccentricity);\r\n        \r\n        // Calculate focal distance\r\n        this.focalDistance = this.semiMajorAxis * this.eccentricity;\r\n        \r\n        // Calculate orbital period (Kepler's Third Law)\r\n        this.period = 2 * Math.PI * Math.sqrt(Math.pow(this.semiMajorAxis, 3) / this.centralMass);\r\n        \r\n        // Calculate angular velocity\r\n        this.angularVelocity = 2 * Math.PI / this.period;\r\n        \r\n        // Store orbit path points\r\n        this.orbitPath = [];\r\n        for (let i = 0; i <= 360; i += 2) {\r\n            const angle = (i * Math.PI) / 180;\r\n            const r = this.semiMajorAxis * (1 - this.eccentricity * this.eccentricity) / \r\n                     (1 + this.eccentricity * Math.cos(angle));\r\n            const x = this.centerX + r * Math.cos(angle);\r\n            const y = this.centerY + r * Math.sin(angle);\r\n            this.orbitPath.push({ x, y });\r\n        }\r\n    }\r\n    \r\n    setSpeed(speed) {\r\n        this.speed = speed;\r\n    }\r\n    \r\n    setEccentricity(eccentricity) {\r\n        this.eccentricity = eccentricity;\r\n        this.calculateOrbitalParameters();\r\n    }\r\n    \r\n    setSemiMajorAxis(axis) {\r\n        this.semiMajorAxis = axis;\r\n        this.calculateOrbitalParameters();\r\n    }\r\n    \r\n    setCentralMass(mass) {\r\n        this.centralMass = mass;\r\n        this.calculateOrbitalParameters();\r\n    }\r\n    \r\n    setShowOrbitPath(show) {\r\n        this.showOrbitPath = show;\r\n    }\r\n    \r\n    setShowVelocityVector(show) {\r\n        this.showVelocityVector = show;\r\n    }\r\n    \r\n    setShowKeplerInfo(show) {\r\n        this.showKeplerInfo = show;\r\n    }\r\n    \r\n    reset() {\r\n        this.time = 0;\r\n        this.angle = 0;\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        this.time += deltaTime;\r\n        const dt = (deltaTime / 1000) * this.speed * 2; // Standardized time step scaling\r\n        \r\n        // Update orbital angle\r\n        this.angle += this.angularVelocity * dt * 100;\r\n        if (this.angle > 2 * Math.PI) {\r\n            this.angle -= 2 * Math.PI;\r\n        }\r\n        \r\n        // Calculate current position\r\n        const r = this.semiMajorAxis * (1 - this.eccentricity * this.eccentricity) / \r\n                 (1 + this.eccentricity * Math.cos(this.angle));\r\n        this.currentX = this.centerX + r * Math.cos(this.angle);\r\n        this.currentY = this.centerY + r * Math.sin(this.angle);\r\n        \r\n        // Calculate velocity components\r\n        const velocity = this.angularVelocity * r;\r\n        this.velocityX = -velocity * Math.sin(this.angle);\r\n        this.velocityY = velocity * Math.cos(this.angle);\r\n        \r\n        // Calculate orbital energy\r\n        const kineticEnergy = 0.5 * velocity * velocity;\r\n        const potentialEnergy = -this.centralMass / r;\r\n        this.totalEnergy = kineticEnergy + potentialEnergy;\r\n        \r\n        // Track perigee and apogee\r\n        if (r < this.perigee || this.perigee === undefined) {\r\n            this.perigee = r;\r\n        }\r\n        if (r > this.apogee || this.apogee === undefined) {\r\n            this.apogee = r;\r\n        }\r\n    }\r\n    \r\n    render() {\r\n        // Draw central mass\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = '#FFD700';\r\n        this.ctx.arc(this.centerX, this.centerY, 15, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Add glow effect\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = 'rgba(255, 215, 0, 0.3)';\r\n        this.ctx.arc(this.centerX, this.centerY, 25, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Draw orbit path\r\n        if (this.showOrbitPath && this.orbitPath.length > 1) {\r\n            this.ctx.beginPath();\r\n            this.ctx.strokeStyle = 'rgba(100, 100, 100, 0.5)';\r\n            this.ctx.lineWidth = 1;\r\n            this.ctx.moveTo(this.orbitPath[0].x, this.orbitPath[0].y);\r\n            for (let i = 1; i < this.orbitPath.length; i++) {\r\n                this.ctx.lineTo(this.orbitPath[i].x, this.orbitPath[i].y);\r\n            }\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Draw orbiting object\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.arc(this.currentX, this.currentY, 8, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Add shadow\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';\r\n        this.ctx.arc(this.currentX + 2, this.currentY + 2, 8, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Draw velocity vector with enhanced visualization\r\n        if (this.showVelocityVector) {\r\n            const vectorLength = 40;\r\n            const velocity = Math.sqrt(this.velocityX * this.velocityX + this.velocityY * this.velocityY);\r\n            const normalizedVX = this.velocityX / velocity;\r\n            const normalizedVY = this.velocityY / velocity;\r\n            \r\n            // Draw velocity vector\r\n            this.ctx.beginPath();\r\n            this.ctx.strokeStyle = '#FF6B6B';\r\n            this.ctx.lineWidth = 3;\r\n            this.ctx.moveTo(this.currentX, this.currentY);\r\n            this.ctx.lineTo(\r\n                this.currentX + normalizedVX * vectorLength,\r\n                this.currentY + normalizedVY * vectorLength\r\n            );\r\n            this.ctx.stroke();\r\n            \r\n            // Draw arrowhead\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = '#FF6B6B';\r\n            const angle = Math.atan2(this.velocityY, this.velocityX);\r\n            const arrowLength = 10;\r\n            this.ctx.moveTo(\r\n                this.currentX + normalizedVX * vectorLength,\r\n                this.currentY + normalizedVY * vectorLength\r\n            );\r\n            this.ctx.lineTo(\r\n                this.currentX + normalizedVX * vectorLength - arrowLength * Math.cos(angle - Math.PI / 6),\r\n                this.currentY + normalizedVY * vectorLength - arrowLength * Math.sin(angle - Math.PI / 6)\r\n            );\r\n            this.ctx.lineTo(\r\n                this.currentX + normalizedVX * vectorLength - arrowLength * Math.cos(angle + Math.PI / 6),\r\n                this.currentY + normalizedVY * vectorLength - arrowLength * Math.sin(angle + Math.PI / 6)\r\n            );\r\n            this.ctx.closePath();\r\n            this.ctx.fill();\r\n            \r\n            // Draw velocity label\r\n            this.ctx.fillStyle = '#FF6B6B';\r\n            this.ctx.font = 'bold 14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.fillText(`v = ${velocity.toFixed(1)}`, \r\n                this.currentX + normalizedVX * (vectorLength + 15),\r\n                this.currentY + normalizedVY * (vectorLength + 15));\r\n        }\r\n        \r\n        // Draw perigee and apogee markers\r\n        if (this.showKeplerInfo && this.perigee && this.apogee) {\r\n            // Perigee marker (closest point)\r\n            const perigeeAngle = 0; // Perigee is at angle 0\r\n            const perigeeX = this.centerX + this.perigee * Math.cos(perigeeAngle);\r\n            const perigeeY = this.centerY + this.perigee * Math.sin(perigeeAngle);\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.strokeStyle = '#2ECC71';\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.arc(perigeeX, perigeeY, 12, 0, Math.PI * 2);\r\n            this.ctx.stroke();\r\n            this.ctx.fillStyle = '#2ECC71';\r\n            this.ctx.font = 'bold 12px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.fillText('P', perigeeX - 3, perigeeY + 3);\r\n            \r\n            // Apogee marker (farthest point)\r\n            const apogeeAngle = Math.PI; // Apogee is at angle π\r\n            const apogeeX = this.centerX + this.apogee * Math.cos(apogeeAngle);\r\n            const apogeeY = this.centerY + this.apogee * Math.sin(apogeeAngle);\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.strokeStyle = '#E74C3C';\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.arc(apogeeX, apogeeY, 12, 0, Math.PI * 2);\r\n            this.ctx.stroke();\r\n            this.ctx.fillStyle = '#E74C3C';\r\n            this.ctx.font = 'bold 12px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.fillText('A', apogeeX - 3, apogeeY + 3);\r\n        }\r\n        \r\n        // Draw Kepler's laws information\r\n        if (this.showKeplerInfo) {\r\n            this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n            this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.textAlign = 'left';\r\n            \r\n            // Position text on the right side to avoid cutoff\r\n            const textX = this.ctx.canvas.width - 250;\r\n            const startY = 30;\r\n            \r\n            this.ctx.fillText(`Kepler's 1st Law: Elliptical orbit (e = ${this.eccentricity.toFixed(2)})`, textX, startY);\r\n            this.ctx.fillText(`Kepler's 2nd Law: Equal areas in equal times`, textX, startY + 20);\r\n            this.ctx.fillText(`Kepler's 3rd Law: T^2 ∝ a^3 (T = ${this.period.toFixed(1)}s)`, textX, startY + 40);\r\n            \r\n            // Add orbital mechanics details\r\n            if (this.perigee && this.apogee) {\r\n                this.ctx.fillText(`Perigee: ${this.perigee.toFixed(0)}px`, textX, startY + 60);\r\n                this.ctx.fillText(`Apogee: ${this.apogee.toFixed(0)}px`, textX, startY + 80);\r\n                this.ctx.fillText(`Semi-major axis: ${this.semiMajorAxis}px`, textX, startY + 100);\r\n            }\r\n            \r\n            // Show current orbital position info\r\n            const currentDistance = Math.sqrt(\r\n                Math.pow(this.currentX - this.centerX, 2) + \r\n                Math.pow(this.currentY - this.centerY, 2)\r\n            );\r\n            const currentSpeed = Math.sqrt(this.velocityX * this.velocityX + this.velocityY * this.velocityY);\r\n            this.ctx.fillText(`Current distance: ${currentDistance.toFixed(0)}px`, textX, startY + 120);\r\n            this.ctx.fillText(`Current speed: ${currentSpeed.toFixed(1)}`, textX, startY + 140);\r\n            \r\n            // Show orbital energy\r\n            if (this.totalEnergy !== undefined) {\r\n                this.ctx.fillText(`Total energy: ${this.totalEnergy.toFixed(1)}`, textX, startY + 160);\r\n            }\r\n        }\r\n        \r\n        // Draw canvas labels\r\n        this.drawOrbitalLabels();\r\n    }\r\n    \r\n    getStats() {\r\n        const distance = Math.sqrt(\r\n            Math.pow(this.currentX - this.centerX, 2) + \r\n            Math.pow(this.currentY - this.centerY, 2)\r\n        );\r\n        const speed = Math.sqrt(this.velocityX * this.velocityX + this.velocityY * this.velocityY);\r\n        \r\n        return {\r\n            period: this.period,\r\n            speed: speed,\r\n            distance: distance,\r\n            eccentricity: this.eccentricity,\r\n            perigee: this.perigee,\r\n            apogee: this.apogee,\r\n            semiMajorAxis: this.semiMajorAxis,\r\n            totalEnergy: this.totalEnergy,\r\n            time: this.time\r\n        };\r\n    }\r\n    \r\n    drawOrbitalLabels() {\r\n        // Draw elegant labels on the canvas\r\n        this.ctx.save();\r\n        \r\n        // Set up text styling\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        \r\n        // Draw animation type label\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.9)';\r\n        this.ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        this.ctx.fillText('Orbital Motion', this.ctx.canvas.width / 2, 30);\r\n        \r\n        // Draw mathematical formulas\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.fillText(`r = a(1-e²)/(1+ecos(θ))`, \r\n                          this.ctx.canvas.width / 2, 50);\r\n        \r\n        // Draw Kepler's laws\r\n        this.ctx.fillText(`T² ∝ a³`, \r\n                          this.ctx.canvas.width / 2, 70);\r\n        \r\n        // Draw energy conservation\r\n        this.ctx.fillText(`E = ½mv² - GMm/r`, \r\n                          this.ctx.canvas.width / 2, 90);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.restore();\r\n    }\r\n}\r\n\r\n\r\n// Collision Physics Simulation\r\nexport class CollisionPhysics {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.balls = [];\r\n        this.ballCount = 5;\r\n        this.restitution = 0.8;\r\n        this.gravity = 0.5;\r\n        this.speed = 1.0;\r\n        this.showAnalytics = false;\r\n        this.collisionType = 'elastic';\r\n        this.collisionCount = 0;\r\n        this.collisionEffects = []; // Track collision effects for visual feedback\r\n        \r\n        this.initializeBalls();\r\n    }\r\n    \r\n    setSpeed(speed) {\r\n        this.speed = speed;\r\n    }\r\n    \r\n    setBallCount(count) {\r\n        this.ballCount = count;\r\n        this.initializeBalls();\r\n    }\r\n    \r\n    setRestitution(restitution) {\r\n        this.restitution = restitution;\r\n    }\r\n    \r\n\r\n    \r\n    setGravity(gravity) {\r\n        this.gravity = gravity;\r\n    }\r\n    \r\n    setShowAnalytics(show) {\r\n        this.showAnalytics = show;\r\n    }\r\n    \r\n    setCollisionType(type) {\r\n        this.collisionType = type;\r\n        this.initializeBalls();\r\n    }\r\n    \r\n    initializeBalls() {\r\n        this.balls = [];\r\n        \r\n        if (this.collisionType === 'head-on') {\r\n            // Head-on collision: two balls moving toward each other\r\n            const canvasWidth = this.ctx.canvas.width;\r\n            const canvasHeight = this.ctx.canvas.height;\r\n            this.balls = [\r\n                {\r\n                    x: canvasWidth * 0.25,\r\n                    y: canvasHeight * 0.5,\r\n                    vx: 80,\r\n                    vy: 0,\r\n                    radius: 20,\r\n                    mass: 2\r\n                },\r\n                {\r\n                    x: canvasWidth * 0.75,\r\n                    y: canvasHeight * 0.5,\r\n                    vx: -80,\r\n                    vy: 0,\r\n                    radius: 20,\r\n                    mass: 2\r\n                }\r\n            ];\r\n        } else if (this.collisionType === 'elastic') {\r\n            // Multiple balls with elastic collisions - respect ball count\r\n            const canvasWidth = this.ctx.canvas.width;\r\n            const canvasHeight = this.ctx.canvas.height;\r\n            const positions = [\r\n                {x: canvasWidth * 0.2, y: canvasHeight * 0.25}, {x: canvasWidth * 0.8, y: canvasHeight * 0.25},\r\n                {x: canvasWidth * 0.2, y: canvasHeight * 0.5}, {x: canvasWidth * 0.8, y: canvasHeight * 0.5},\r\n                {x: canvasWidth * 0.5, y: canvasHeight * 0.375}, {x: canvasWidth * 0.375, y: canvasHeight * 0.2}, {x: canvasWidth * 0.625, y: canvasHeight * 0.55},\r\n                {x: canvasWidth * 0.25, y: canvasHeight * 0.55}, {x: canvasWidth * 0.75, y: canvasHeight * 0.2}\r\n            ];\r\n            \r\n            for (let i = 0; i < Math.min(this.ballCount, positions.length); i++) {\r\n                const pos = positions[i];\r\n                this.balls.push({\r\n                    x: pos.x,\r\n                    y: pos.y,\r\n                    vx: (Math.random() - 0.5) * 120,\r\n                    vy: (Math.random() - 0.5) * 120,\r\n                    radius: 15 + Math.random() * 10,\r\n                    mass: 1 + Math.random() * 2\r\n                });\r\n            }\r\n        } else if (this.collisionType === 'inelastic') {\r\n            // Inelastic collisions with energy loss\r\n            const canvasWidth = this.ctx.canvas.width;\r\n            const canvasHeight = this.ctx.canvas.height;\r\n            const positions = [\r\n                {x: canvasWidth * 0.25, y: canvasHeight * 0.25}, {x: canvasWidth * 0.75, y: canvasHeight * 0.25},\r\n                {x: canvasWidth * 0.25, y: canvasHeight * 0.5}, {x: canvasWidth * 0.75, y: canvasHeight * 0.5},\r\n                {x: canvasWidth * 0.5, y: canvasHeight * 0.375}\r\n            ];\r\n            \r\n            for (let i = 0; i < Math.min(this.ballCount, positions.length); i++) {\r\n                const pos = positions[i];\r\n                this.balls.push({\r\n                    x: pos.x,\r\n                    y: pos.y,\r\n                    vx: (Math.random() - 0.5) * 100,\r\n                    vy: (Math.random() - 0.5) * 100,\r\n                    radius: 18 + Math.random() * 8,\r\n                    mass: 1.5 + Math.random() * 1.5\r\n                });\r\n            }\r\n        } else if (this.collisionType === 'mixed') {\r\n            // Mixed collision types with varying properties\r\n            const canvasWidth = this.ctx.canvas.width;\r\n            const canvasHeight = this.ctx.canvas.height;\r\n            const positions = [\r\n                {x: canvasWidth * 0.2, y: canvasHeight * 0.2}, {x: canvasWidth * 0.8, y: canvasHeight * 0.2},\r\n                {x: canvasWidth * 0.2, y: canvasHeight * 0.55}, {x: canvasWidth * 0.8, y: canvasHeight * 0.55},\r\n                {x: canvasWidth * 0.5, y: canvasHeight * 0.375}, {x: canvasWidth * 0.375, y: canvasHeight * 0.3}, {x: canvasWidth * 0.625, y: canvasHeight * 0.45}\r\n            ];\r\n            \r\n            for (let i = 0; i < Math.min(this.ballCount, positions.length); i++) {\r\n                const pos = positions[i];\r\n                this.balls.push({\r\n                    x: pos.x,\r\n                    y: pos.y,\r\n                    vx: (Math.random() - 0.5) * 110,\r\n                    vy: (Math.random() - 0.5) * 110,\r\n                    radius: 12 + Math.random() * 12,\r\n                    mass: 0.8 + Math.random() * 2.4\r\n                });\r\n            }\r\n        } else if (this.collisionType === 'cascade') {\r\n            // Cascade collision - balls in a line\r\n            const canvasWidth = this.ctx.canvas.width;\r\n            const canvasHeight = this.ctx.canvas.height;\r\n            const spacing = canvasWidth * 0.075;\r\n            const startX = canvasWidth * 0.125;\r\n            const y = canvasHeight * 0.375;\r\n            \r\n            for (let i = 0; i < Math.min(this.ballCount, 8); i++) {\r\n                this.balls.push({\r\n                    x: startX + i * spacing,\r\n                    y: y,\r\n                    vx: i === 0 ? 100 : 0, // Only first ball moves\r\n                    vy: 0,\r\n                    radius: 15,\r\n                    mass: 1.5\r\n                });\r\n            }\r\n        }\r\n        \r\n        // Reset collision count\r\n        this.collisionCount = 0;\r\n        this.lastCollision = null;\r\n    }\r\n    \r\n    reset() {\r\n        this.collisionCount = 0;\r\n        this.collisionEffects = [];\r\n        this.initializeBalls();\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        const dt = (deltaTime / 1000) * this.speed * 5; // Fixed time step calculation\r\n        \r\n        // Update collision effects\r\n        this.collisionEffects = this.collisionEffects.filter(effect => {\r\n            effect.time += dt;\r\n            return effect.time < effect.maxTime;\r\n        });\r\n        \r\n        // Update ball positions\r\n        this.balls.forEach(ball => {\r\n            ball.x += ball.vx * dt;\r\n            ball.y += ball.vy * dt;\r\n            \r\n            // Apply gravity\r\n            ball.vy += this.gravity * 9.8 * dt;\r\n            \r\n            // Apply minimal friction for stability\r\n            ball.vx *= (1 - 0.02 * dt);\r\n            ball.vy *= (1 - 0.02 * dt);\r\n            \r\n            // Bounce off canvas boundaries with energy loss\r\n            if (ball.x - ball.radius < 0 || ball.x + ball.radius > this.ctx.canvas.width) {\r\n                ball.vx *= -this.restitution;\r\n                ball.x = Math.max(ball.radius, Math.min(this.ctx.canvas.width - ball.radius, ball.x));\r\n                \r\n                // Add wall collision effect\r\n                this.collisionEffects.push({\r\n                    x: ball.x,\r\n                    y: ball.y,\r\n                    time: 0,\r\n                    maxTime: 0.3,\r\n                    type: 'wall'\r\n                });\r\n            }\r\n            \r\n            if (ball.y - ball.radius < 0 || ball.y + ball.radius > this.ctx.canvas.height) {\r\n                ball.vy *= -this.restitution;\r\n                ball.y = Math.max(ball.radius, Math.min(this.ctx.canvas.height - ball.radius, ball.y));\r\n                \r\n                // Add wall collision effect\r\n                this.collisionEffects.push({\r\n                    x: ball.x,\r\n                    y: ball.y,\r\n                    time: 0,\r\n                    maxTime: 0.3,\r\n                    type: 'wall'\r\n                });\r\n            }\r\n        });\r\n        \r\n        // Check for collisions between balls\r\n        for (let i = 0; i < this.balls.length; i++) {\r\n            for (let j = i + 1; j < this.balls.length; j++) {\r\n                this.checkCollision(this.balls[i], this.balls[j]);\r\n            }\r\n        }\r\n    }\r\n    \r\n    checkCollision(ball1, ball2) {\r\n        const dx = ball2.x - ball1.x;\r\n        const dy = ball2.y - ball1.y;\r\n        const distance = Math.sqrt(dx * dx + dy * dy);\r\n                    \r\n        if (distance < ball1.radius + ball2.radius) {\r\n            this.collisionCount++;\r\n            \r\n            // Add collision effect for visual feedback\r\n            this.collisionEffects.push({\r\n                x: (ball1.x + ball2.x) / 2,\r\n                y: (ball1.y + ball2.y) / 2,\r\n                time: 0,\r\n                maxTime: 0.5,\r\n                type: 'ball'\r\n            });\r\n            \r\n            // Normalize collision vector\r\n            const nx = dx / distance;\r\n            const ny = dy / distance;\r\n            \r\n            // Relative velocity\r\n            const dvx = ball2.vx - ball1.vx;\r\n            const dvy = ball2.vy - ball1.vy;\r\n            const relativeVelocity = dvx * nx + dvy * ny;\r\n            \r\n            // Don't resolve if balls are moving apart\r\n            if (relativeVelocity > 0) return;\r\n            \r\n            // Calculate impulse based on collision type\r\n            let effectiveRestitution = this.restitution;\r\n            if (this.collisionType === 'inelastic') {\r\n                effectiveRestitution = 0.3; // More energy loss\r\n            } else if (this.collisionType === 'mixed') {\r\n                effectiveRestitution = 0.5 + Math.random() * 0.3; // Variable energy loss\r\n            }\r\n            \r\n            // Calculate impulse\r\n            const impulse = -(1 + effectiveRestitution) * relativeVelocity / \r\n                           (1/ball1.mass + 1/ball2.mass);\r\n            \r\n            // Update velocities\r\n            ball1.vx -= (impulse * nx) / ball1.mass;\r\n            ball1.vy -= (impulse * ny) / ball1.mass;\r\n            ball2.vx += (impulse * nx) / ball2.mass;\r\n            ball2.vy += (impulse * ny) / ball2.mass;\r\n            \r\n            // Separate balls to prevent sticking\r\n            const overlap = ball1.radius + ball2.radius - distance;\r\n            const separationX = nx * overlap * 0.5;\r\n            const separationY = ny * overlap * 0.5;\r\n            \r\n            ball1.x -= separationX;\r\n            ball1.y -= separationY;\r\n            ball2.x += separationX;\r\n            ball2.y += separationY;\r\n            \r\n            // Track collision energy\r\n            const preCollisionEnergy = 0.5 * ball1.mass * (ball1.vx * ball1.vx + ball1.vy * ball1.vy) +\r\n                                      0.5 * ball2.mass * (ball2.vx * ball2.vx + ball2.vy * ball2.vy);\r\n            \r\n            // Store collision data for analysis\r\n            this.lastCollision = {\r\n                ball1: { mass: ball1.mass, velocity: Math.sqrt(ball1.vx * ball1.vx + ball1.vy * ball1.vy) },\r\n                ball2: { mass: ball2.mass, velocity: Math.sqrt(ball2.vx * ball2.vx + ball2.vy * ball2.vy) },\r\n                energy: preCollisionEnergy,\r\n                restitution: effectiveRestitution\r\n            };\r\n        }\r\n    }\r\n    \r\n    render() {\r\n        // Draw modern gradient background using full canvas\r\n        const gradient = this.ctx.createLinearGradient(0, 0, 0, this.ctx.canvas.height);\r\n        gradient.addColorStop(0, '#1a1a2e');\r\n        gradient.addColorStop(1, '#16213e');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n        \r\n        // Draw enhanced collision effects with modern styling\r\n        this.collisionEffects.forEach(effect => {\r\n            const alpha = 1 - (effect.time / effect.maxTime);\r\n            const radius = 40 * (1 - effect.time / effect.maxTime);\r\n            \r\n            if (effect.type === 'ball') {\r\n                // Modern ball collision effect with multiple rings\r\n                for (let i = 0; i < 3; i++) {\r\n                    const ringRadius = radius * (0.3 + i * 0.3);\r\n                    const ringAlpha = alpha * (1 - i * 0.3);\r\n                    \r\n                    this.ctx.beginPath();\r\n                    this.ctx.strokeStyle = `rgba(255, 107, 107, ${ringAlpha})`;\r\n                    this.ctx.lineWidth = 3 - i;\r\n                    this.ctx.arc(effect.x, effect.y, ringRadius, 0, Math.PI * 2);\r\n                    this.ctx.stroke();\r\n                }\r\n                \r\n                // Add sparkle effect\r\n                for (let i = 0; i < 8; i++) {\r\n                    const angle = (i * Math.PI * 2) / 8;\r\n                    const sparkleX = effect.x + Math.cos(angle) * radius * 0.8;\r\n                    const sparkleY = effect.y + Math.sin(angle) * radius * 0.8;\r\n                    \r\n                    this.ctx.beginPath();\r\n                    this.ctx.fillStyle = `rgba(255, 255, 255, ${alpha * 0.8})`;\r\n                    this.ctx.arc(sparkleX, sparkleY, 2, 0, Math.PI * 2);\r\n                    this.ctx.fill();\r\n                }\r\n            } else if (effect.type === 'wall') {\r\n                // Modern wall collision effect\r\n                this.ctx.beginPath();\r\n                this.ctx.strokeStyle = `rgba(100, 150, 255, ${alpha})`;\r\n                this.ctx.lineWidth = 4;\r\n                this.ctx.arc(effect.x, effect.y, radius * 0.7, 0, Math.PI * 2);\r\n                this.ctx.stroke();\r\n                \r\n                // Add ripple effect\r\n                this.ctx.beginPath();\r\n                this.ctx.strokeStyle = `rgba(100, 150, 255, ${alpha * 0.5})`;\r\n                this.ctx.lineWidth = 2;\r\n                this.ctx.arc(effect.x, effect.y, radius * 0.4, 0, Math.PI * 2);\r\n                this.ctx.stroke();\r\n            }\r\n        });\r\n        \r\n        // Draw enhanced balls with modern styling\r\n        this.balls.forEach((ball, index) => {\r\n            // Create gradient for each ball based on velocity\r\n            const velocity = Math.sqrt(ball.vx * ball.vx + ball.vy * ball.vy);\r\n            const normalizedVelocity = Math.min(velocity / 100, 1);\r\n            \r\n            // Dynamic color based on velocity and ball index\r\n            const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD', '#98D8C8', '#F7DC6F'];\r\n            const baseColor = colors[index % colors.length];\r\n            \r\n            // Ball shadow with modern blur effect\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';\r\n            this.ctx.arc(ball.x + 3, ball.y + 3, ball.radius, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Ball gradient\r\n            const gradient = this.ctx.createRadialGradient(\r\n                ball.x - ball.radius * 0.3, ball.y - ball.radius * 0.3, 0,\r\n                ball.x, ball.y, ball.radius\r\n            );\r\n            gradient.addColorStop(0, baseColor);\r\n            gradient.addColorStop(0.7, baseColor);\r\n            gradient.addColorStop(1, '#1a1a2e');\r\n            \r\n            // Ball main with gradient\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = gradient;\r\n            this.ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Ball highlight with velocity-based intensity\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = `rgba(255, 255, 255, ${0.3 + normalizedVelocity * 0.4})`;\r\n            this.ctx.arc(ball.x - ball.radius * 0.3, ball.y - ball.radius * 0.3, ball.radius * 0.5, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Ball border with velocity-based color\r\n            this.ctx.strokeStyle = normalizedVelocity > 0.5 ? '#FFD700' : '#333';\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.stroke();\r\n            \r\n            // Draw enhanced momentum vectors with modern styling\r\n            if (this.showAnalytics) {\r\n                const velocity = Math.sqrt(ball.vx * ball.vx + ball.vy * ball.vy);\r\n                if (velocity > 1) { // Only show vectors for moving balls\r\n                    const vectorLength = 50;\r\n                    const normalizedVX = ball.vx / velocity;\r\n                    const normalizedVY = ball.vy / velocity;\r\n                    \r\n                    // Vector glow effect\r\n                this.ctx.beginPath();\r\n                    this.ctx.strokeStyle = `rgba(78, 205, 196, 0.3)`;\r\n                    this.ctx.lineWidth = 6;\r\n                this.ctx.moveTo(ball.x, ball.y);\r\n                    this.ctx.lineTo(ball.x + normalizedVX * vectorLength, ball.y + normalizedVY * vectorLength);\r\n                this.ctx.stroke();\r\n                \r\n                    // Main momentum vector\r\n                this.ctx.beginPath();\r\n                    this.ctx.strokeStyle = '#4ECDC4';\r\n                    this.ctx.lineWidth = 3;\r\n                    this.ctx.moveTo(ball.x, ball.y);\r\n                    this.ctx.lineTo(ball.x + normalizedVX * vectorLength, ball.y + normalizedVY * vectorLength);\r\n                    this.ctx.stroke();\r\n                    \r\n                    // Arrowhead with gradient\r\n                    const angle = Math.atan2(ball.vy, ball.vx);\r\n                    const arrowLength = 12;\r\n                    this.ctx.beginPath();\r\n                    this.ctx.fillStyle = '#4ECDC4';\r\n                    this.ctx.moveTo(ball.x + normalizedVX * vectorLength, ball.y + normalizedVY * vectorLength);\r\n                    this.ctx.lineTo(ball.x + normalizedVX * vectorLength - arrowLength * Math.cos(angle - Math.PI / 6),\r\n                                  ball.y + normalizedVY * vectorLength - arrowLength * Math.sin(angle - Math.PI / 6));\r\n                    this.ctx.lineTo(ball.x + normalizedVX * vectorLength - arrowLength * Math.cos(angle + Math.PI / 6),\r\n                                  ball.y + normalizedVY * vectorLength - arrowLength * Math.sin(angle + Math.PI / 6));\r\n                this.ctx.closePath();\r\n                this.ctx.fill();\r\n                    \r\n                    // Velocity magnitude label with background\r\n                    const labelX = ball.x + normalizedVX * (vectorLength + 20);\r\n                    const labelY = ball.y + normalizedVY * (vectorLength + 20);\r\n                    \r\n                    // Label background\r\n                    this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n                    this.ctx.fillRect(labelX - 25, labelY - 8, 50, 16);\r\n                    \r\n                    // Label text\r\n                    this.ctx.fillStyle = '#4ECDC4';\r\n                    this.ctx.font = 'bold 13px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n                    this.ctx.textAlign = 'center';\r\n                    this.ctx.fillText(`v = ${velocity.toFixed(1)}`, labelX, labelY + 3);\r\n                }\r\n            }\r\n        });\r\n        \r\n        // Draw collision info\r\n        if (this.showAnalytics) {\r\n            this.drawCollisionInfo();\r\n        }\r\n        \r\n        // Draw canvas labels\r\n        this.drawCollisionLabels();\r\n    }\r\n    \r\n    drawCollisionInfo() {\r\n        // Modern info panel background with responsive sizing\r\n        const canvasWidth = this.ctx.canvas.width;\r\n        const canvasHeight = this.ctx.canvas.height;\r\n        \r\n        // Calculate responsive panel size (20% of canvas width, max 300px)\r\n        const panelWidth = Math.min(canvasWidth * 0.2, 300);\r\n        const panelHeight = Math.min(canvasHeight * 0.25, 250);\r\n        const panelX = 10;\r\n        const panelY = 10;\r\n        \r\n        this.ctx.fillStyle = 'rgba(26, 26, 46, 0.9)';\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, panelHeight);\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeRect(panelX, panelY, panelWidth, panelHeight);\r\n        \r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        \r\n        let y = panelY + 25;\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.fillText(`Collision Physics`, panelX + 10, y);\r\n        y += 25;\r\n        \r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.fillText(`Scenario: ${this.collisionType}`, panelX + 10, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Bounciness: ${this.restitution}`, panelX + 10, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Collisions: ${this.collisionCount}`, panelX + 10, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Objects: ${this.balls.length}`, panelX + 10, y);\r\n        y += 25;\r\n        \r\n        // Show last collision analysis with modern styling\r\n        if (this.lastCollision) {\r\n            this.ctx.fillStyle = '#FFD700';\r\n            this.ctx.font = 'bold 14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.fillText(`Last Collision Analysis:`, panelX + 10, y);\r\n            y += 20;\r\n            \r\n            this.ctx.font = '13px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.fillStyle = '#FF6B6B';\r\n            this.ctx.fillText(`  Ball 1: m=${this.lastCollision.ball1.mass}, v=${this.lastCollision.ball1.velocity.toFixed(1)}`, panelX + 10, y);\r\n            y += 15;\r\n            this.ctx.fillStyle = '#4ECDC4';\r\n            this.ctx.fillText(`  Ball 2: m=${this.lastCollision.ball2.mass}, v=${this.lastCollision.ball2.velocity.toFixed(1)}`, panelX + 10, y);\r\n            y += 15;\r\n            this.ctx.fillStyle = '#FFEAA7';\r\n            this.ctx.fillText(`  Energy: ${this.lastCollision.energy.toFixed(1)}`, panelX + 10, y);\r\n            y += 15;\r\n            this.ctx.fillStyle = '#DDA0DD';\r\n            this.ctx.fillText(`  Effective e: ${this.lastCollision.restitution.toFixed(2)}`, panelX + 10, y);\r\n            y += 25;\r\n        }\r\n        \r\n        // Physics principles with modern styling\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillText(`Physics Principles:`, panelX + 10, y);\r\n        y += 20;\r\n        \r\n        this.ctx.font = '13px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.fillText(`  • Momentum conservation`, panelX + 10, y);\r\n        y += 15;\r\n        this.ctx.fillText(`  • Energy transfer in collisions`, panelX + 10, y);\r\n        y += 15;\r\n        this.ctx.fillText(`  • Impulse = Force × Time`, panelX + 10, y);\r\n        y += 15;\r\n        this.ctx.fillStyle = '#96CEB4';\r\n        this.ctx.fillText(`  • Elastic: e = 1 (energy conserved)`, panelX + 10, y);\r\n        y += 15;\r\n        this.ctx.fillStyle = '#FF6B6B';\r\n        this.ctx.fillText(`  • Inelastic: e < 1 (energy lost)`, panelX + 10, y);\r\n    }\r\n    \r\n    getStats() {\r\n        let totalMomentum = 0;\r\n        let totalEnergy = 0;\r\n        \r\n        this.balls.forEach(ball => {\r\n            const momentum = ball.mass * Math.sqrt(ball.vx * ball.vx + ball.vy * ball.vy);\r\n            const energy = 0.5 * ball.mass * (ball.vx * ball.vx + ball.vy * ball.vy);\r\n            totalMomentum += momentum;\r\n            totalEnergy += energy;\r\n        });\r\n        \r\n        return {\r\n            ballCount: this.balls.length,\r\n            totalMomentum: totalMomentum,\r\n            totalEnergy: totalEnergy,\r\n            collisionCount: this.collisionCount\r\n        };\r\n    }\r\n    \r\n    drawCollisionLabels() {\r\n        // Draw elegant labels on the canvas\r\n        this.ctx.save();\r\n        \r\n        // Set up text styling\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        \r\n        // Draw animation type label\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        this.ctx.fillText('Collision Physics', this.ctx.canvas.width / 2, 30);\r\n        \r\n        // Draw mathematical formulas\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';\r\n        this.ctx.fillText(`p = mv`, \r\n                          this.ctx.canvas.width / 2, 50);\r\n        \r\n        // Draw momentum conservation\r\n        this.ctx.fillText(`Σp = constant`, \r\n                          this.ctx.canvas.width / 2, 70);\r\n        \r\n        // Draw energy relation\r\n        this.ctx.fillText(`KE = ½mv²`, \r\n                          this.ctx.canvas.width / 2, 90);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.restore();\r\n    }\r\n}\r\n\r\n// Friction & Inclined Planes Simulation\r\nexport class FrictionInclinedPlanes {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.object = {\r\n            x: 100,\r\n            y: 200,\r\n            vx: 0,\r\n            vy: 0\r\n        };\r\n        this.inclineAngle = 20;\r\n        this.frictionCoefficient = 0.3;\r\n        this.objectMass = 5;\r\n        this.initialVelocity = 50;\r\n        this.gravity = 1.0;\r\n        this.speed = 1.0;\r\n        this.showAnalytics = false;\r\n        \r\n        this.resetObject();\r\n    }\r\n    \r\n    setSpeed(speed) {\r\n        this.speed = speed;\r\n    }\r\n    \r\n    setInclineAngle(angle) {\r\n        this.inclineAngle = angle;\r\n        this.resetObject();\r\n    }\r\n    \r\n    setFrictionCoefficient(coefficient) {\r\n        this.frictionCoefficient = coefficient;\r\n    }\r\n    \r\n    setObjectMass(mass) {\r\n        this.objectMass = mass;\r\n    }\r\n    \r\n    setInitialVelocity(velocity) {\r\n        this.initialVelocity = velocity;\r\n        this.resetObject();\r\n    }\r\n    \r\n    setGravity(gravity) {\r\n        this.gravity = gravity;\r\n    }\r\n    \r\n    setShowAnalytics(show) {\r\n        this.showAnalytics = show;\r\n    }\r\n    \r\n\r\n    \r\n    resetObject() {\r\n        const canvasWidth = this.ctx.canvas.width;\r\n        const canvasHeight = this.ctx.canvas.height;\r\n        const startX = canvasWidth * 0.125;\r\n        this.object.x = startX;\r\n        \r\n        // Calculate adjusted start position based on current angle\r\n        const angleRad = this.inclineAngle * Math.PI / 180;\r\n        const inclineLength = canvasWidth * 0.75;\r\n        const startY = canvasHeight * 0.5;\r\n        const endY = startY + inclineLength * Math.sin(angleRad);\r\n        const maxEndY = canvasHeight * 0.95;\r\n        const verticalOffset = Math.max(0, endY - maxEndY);\r\n        const adjustedStartY = startY - verticalOffset;\r\n        \r\n        this.object.y = adjustedStartY - 15 - 18 * Math.cos(angleRad);\r\n        this.object.vx = this.initialVelocity * Math.cos(angleRad);\r\n        this.object.vy = 0;\r\n    }\r\n    \r\n    reset() {\r\n        this.resetObject();\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        const dt = (deltaTime / 1000) * this.speed * 2; // Standardized time step scaling\r\n        const angleRad = this.inclineAngle * Math.PI / 180;\r\n        \r\n        // Calculate forces\r\n        const weight = this.objectMass * this.gravity * 9.8;\r\n        const normalForce = weight * Math.cos(angleRad);\r\n        const parallelForce = weight * Math.sin(angleRad);\r\n        const frictionForce = this.frictionCoefficient * normalForce;\r\n\r\n        let netForce = 0;\r\n        if (Math.abs(this.object.vx) < 1e-4) {\r\n            // Object is at rest\r\n            if (Math.abs(parallelForce) > frictionForce) {\r\n                // Static friction is overcome, object starts moving\r\n                netForce = parallelForce - Math.sign(parallelForce) * frictionForce;\r\n            } else {\r\n                // Static friction holds object in place\r\n                netForce = 0;\r\n                this.object.vx = 0;\r\n            }\r\n        } else {\r\n            // Object is moving, use kinetic friction (always opposes motion)\r\n            netForce = parallelForce - Math.sign(this.object.vx) * frictionForce;\r\n        }\r\n        const acceleration = netForce / this.objectMass;\r\n        \r\n        // Update velocity\r\n        this.object.vx += acceleration * dt;\r\n        \r\n        // Update position\r\n        this.object.x += this.object.vx * dt;\r\n        \r\n        // Calculate incline length and end position with adjusted start\r\n        const canvasWidth = this.ctx.canvas.width;\r\n        const canvasHeight = this.ctx.canvas.height;\r\n        const inclineLength = canvasWidth * 0.75;\r\n        const startX = canvasWidth * 0.125;\r\n        const startY = canvasHeight * 0.5;\r\n        const endX = startX + inclineLength * Math.cos(angleRad);\r\n        const endY = startY + inclineLength * Math.sin(angleRad);\r\n        \r\n        // Calculate how much to move the incline up to keep it within bounds\r\n        const maxEndY = canvasHeight * 0.95;\r\n        const verticalOffset = Math.max(0, endY - maxEndY);\r\n        const adjustedStartY = startY - verticalOffset;\r\n        \r\n        // Constrain object to stay within the incline\r\n        if (this.object.x > endX) {\r\n            this.object.x = endX;\r\n            this.object.vx = 0;\r\n        }\r\n        \r\n        // Position object ON TOP of the incline surface (not embedded)\r\n        this.object.y = adjustedStartY + (this.object.x - startX) * Math.tan(angleRad) - 15 - 18 * Math.cos(angleRad);\r\n    }\r\n    \r\n    render() {\r\n        // Draw modern gradient background using full canvas\r\n        const gradient = this.ctx.createLinearGradient(0, 0, 0, this.ctx.canvas.height);\r\n        gradient.addColorStop(0, '#1a1a2e');\r\n        gradient.addColorStop(1, '#16213e');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n        \r\n        const angleRad = this.inclineAngle * Math.PI / 180;\r\n        // Use canvas dimensions for incline positioning\r\n        const canvasWidth = this.ctx.canvas.width;\r\n        const canvasHeight = this.ctx.canvas.height;\r\n        const inclineLength = canvasWidth * 0.75;\r\n        const startX = canvasWidth * 0.125;\r\n        const startY = canvasHeight * 0.5;\r\n        const endX = startX + inclineLength * Math.cos(angleRad);\r\n        const endY = startY + inclineLength * Math.sin(angleRad);\r\n        \r\n        // Calculate how much to move the incline up to keep it within bounds\r\n        const maxEndY = canvasHeight * 0.95;\r\n        const verticalOffset = Math.max(0, endY - maxEndY);\r\n        const adjustedStartY = startY - verticalOffset;\r\n        const adjustedEndY = endY - verticalOffset;\r\n        const objectSize = 15;\r\n\r\n        // Draw subtle grid/ruler along the incline\r\n        this.ctx.save();\r\n        this.ctx.strokeStyle = 'rgba(80,80,80,0.25)';\r\n        this.ctx.lineWidth = 1;\r\n        for (let i = 0; i <= inclineLength; i += 40) {\r\n            const x = startX + i * Math.cos(angleRad);\r\n            const y = adjustedStartY + i * Math.sin(angleRad);\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x, y);\r\n            this.ctx.lineTo(x - 8 * Math.sin(angleRad), y + 8 * Math.cos(angleRad));\r\n            this.ctx.stroke();\r\n        }\r\n        this.ctx.restore();\r\n\r\n        // Draw enhanced incline surface with modern styling\r\n        this.ctx.save();\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(startX, adjustedStartY);\r\n        this.ctx.lineTo(endX, adjustedEndY);\r\n        this.ctx.lineTo(endX + 20 * Math.sin(angleRad), adjustedEndY - 20 * Math.cos(angleRad));\r\n        this.ctx.lineTo(startX + 20 * Math.sin(angleRad), adjustedStartY - 20 * Math.cos(angleRad));\r\n        this.ctx.closePath();\r\n        \r\n        // Modern surface colors - use generic surface appearance\r\n        const surfaceColor = '#f5f5f5';\r\n        const textureColor = '#757575';\r\n        \r\n        // Main surface fill\r\n        this.ctx.fillStyle = surfaceColor;\r\n        this.ctx.fill();\r\n        \r\n        // Enhanced gradient shading\r\n        const surfaceGradient = this.ctx.createLinearGradient(startX, adjustedStartY, endX, adjustedEndY);\r\n        surfaceGradient.addColorStop(0, 'rgba(255,255,255,0.3)');\r\n        surfaceGradient.addColorStop(0.5, 'rgba(255,255,255,0.1)');\r\n        surfaceGradient.addColorStop(1, 'rgba(0,0,0,0.2)');\r\n        this.ctx.fillStyle = surfaceGradient;\r\n        this.ctx.fill();\r\n        \r\n        // Enhanced texture pattern\r\n        this.ctx.strokeStyle = textureColor;\r\n        this.ctx.lineWidth = 1.5;\r\n        for (let i = 0; i < inclineLength; i += 20) {\r\n            const x = startX + i * Math.cos(angleRad);\r\n            const y = adjustedStartY + i * Math.sin(angleRad);\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x, y);\r\n            this.ctx.lineTo(x + 15 * Math.sin(angleRad), y - 15 * Math.cos(angleRad));\r\n            this.ctx.stroke();\r\n        }\r\n        this.ctx.restore();\r\n            \r\n        // Draw angle indicator (arc/protractor)\r\n        this.ctx.save();\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.beginPath();\r\n        this.ctx.arc(startX, adjustedStartY, 38, 0, angleRad, false);\r\n            this.ctx.stroke();\r\n        // Angle label\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText(`${this.inclineAngle}°`, startX + 44 * Math.cos(angleRad / 2), adjustedStartY + 44 * Math.sin(angleRad / 2));\r\n        this.ctx.restore();\r\n\r\n        // Draw enhanced object with modern styling\r\n        this.ctx.save();\r\n        this.ctx.translate(this.object.x, this.object.y);\r\n        this.ctx.rotate(angleRad);\r\n        \r\n        // Enhanced 3D shadow effect\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.25)';\r\n        this.ctx.fillRect(-objectSize + 4, -objectSize + 4, objectSize * 2, objectSize * 2);\r\n        \r\n        // Modern gradient for the object\r\n        const objectGradient = this.ctx.createLinearGradient(-objectSize, -objectSize, objectSize, objectSize);\r\n        objectGradient.addColorStop(0, '#ff6b6b');\r\n        objectGradient.addColorStop(0.7, '#ee5a52');\r\n        objectGradient.addColorStop(1, '#c62828');\r\n        \r\n        // Main object body\r\n        this.ctx.fillStyle = objectGradient;\r\n        this.ctx.fillRect(-objectSize, -objectSize, objectSize * 2, objectSize * 2);\r\n        \r\n        // Enhanced highlight effect\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';\r\n        this.ctx.fillRect(-objectSize, -objectSize, objectSize * 2, objectSize * 0.6);\r\n        \r\n        // Modern border\r\n        this.ctx.strokeStyle = '#2c3e50';\r\n        this.ctx.lineWidth = 2.5;\r\n        this.ctx.strokeRect(-objectSize, -objectSize, objectSize * 2, objectSize * 2);\r\n        \r\n        this.ctx.restore();\r\n\r\n        // Draw analytics if enabled\r\n        if (this.showAnalytics) {\r\n            this.drawForceVectors();\r\n            this.drawFrictionInfo();\r\n        }\r\n        \r\n        // Draw canvas labels\r\n        this.drawFrictionLabels();\r\n    }\r\n    \r\n    drawForceVectors() {\r\n        const angleRad = this.inclineAngle * Math.PI / 180;\r\n        const weight = this.objectMass * this.gravity * 9.8;\r\n        const normalForce = weight * Math.cos(angleRad);\r\n        const parallelForce = weight * Math.sin(angleRad);\r\n        const frictionForce = this.frictionCoefficient * normalForce;\r\n        const netForce = (Math.abs(this.object.vx) < 1e-4 && Math.abs(parallelForce) <= frictionForce)\r\n            ? 0\r\n            : parallelForce - Math.sign(this.object.vx || parallelForce) * frictionForce;\r\n        const objectSize = 15;\r\n        const x = this.object.x;\r\n        const y = this.object.y;\r\n\r\n        // Helper to draw an arrow\r\n        const drawArrow = (fromX, fromY, dx, dy, color, label) => {\r\n            const len = Math.sqrt(dx * dx + dy * dy);\r\n            if (len < 1) return; // Reduced minimum threshold\r\n            const normDX = dx / len;\r\n            const normDY = dy / len;\r\n            const arrowLen = Math.max(50, Math.min(120, len));\r\n            const endX = fromX + normDX * arrowLen;\r\n            const endY = fromY + normDY * arrowLen;\r\n            this.ctx.save();\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(fromX, fromY);\r\n            this.ctx.lineTo(endX, endY);\r\n            this.ctx.strokeStyle = color;\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.stroke();\r\n            // Arrowhead\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(endX, endY);\r\n            this.ctx.lineTo(endX - 12 * normDX - 8 * normDY, endY - 12 * normDY + 8 * normDX);\r\n            this.ctx.lineTo(endX - 12 * normDX + 8 * normDY, endY - 12 * normDY - 8 * normDX);\r\n            this.ctx.lineTo(endX, endY);\r\n            this.ctx.fillStyle = color;\r\n            this.ctx.fill();\r\n            // Label\r\n            this.ctx.font = 'bold 14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.fillStyle = color;\r\n            this.ctx.textAlign = 'left';\r\n            this.ctx.fillText(label, endX + 15, endY + 4);\r\n            this.ctx.restore();\r\n        };\r\n\r\n        // Gravity (downward) - Dark Blue\r\n        drawArrow(x, y, 0, weight * 0.12, '#1565C0', 'mg');\r\n        \r\n        // Parallel component of gravity (down the incline) - Orange\r\n        drawArrow(x, y, parallelForce * Math.cos(angleRad) * 0.12, parallelForce * Math.sin(angleRad) * 0.12, '#FF8C00', `mg sin(${this.inclineAngle}°)`);\r\n        \r\n        // Friction (opposes motion, along incline) - Dark Red\r\n        let frictionDir = -1;\r\n        if (Math.abs(this.object.vx) < 1e-4) {\r\n            frictionDir = -Math.sign(parallelForce);\r\n        } else {\r\n            frictionDir = -Math.sign(this.object.vx);\r\n        }\r\n        // Ensure friction force is always visible with minimum length\r\n        const frictionMagnitude = Math.max(frictionForce * 0.12, 20);\r\n        drawArrow(x, y, frictionDir * frictionMagnitude * Math.cos(angleRad), frictionDir * frictionMagnitude * Math.sin(angleRad), '#C62828', 'f');\r\n        \r\n        // Net force (along incline) - Dark Purple\r\n        if (Math.abs(netForce) > 0.1) {\r\n            drawArrow(x, y, netForce * Math.cos(angleRad) * 0.12, netForce * Math.sin(angleRad) * 0.12, '#6A1B9A', 'Fₙₑₜ');\r\n        }\r\n    }\r\n    \r\n    drawFrictionInfo() {\r\n        const angleRad = this.inclineAngle * Math.PI / 180;\r\n        const weight = this.objectMass * this.gravity * 9.8;\r\n        const normalForce = weight * Math.cos(angleRad);\r\n        const parallelForce = weight * Math.sin(angleRad);\r\n        const frictionForce = this.frictionCoefficient * normalForce;\r\n        const netForce = parallelForce - frictionForce;\r\n        const acceleration = netForce / this.objectMass;\r\n        \r\n        // Modern info panel background\r\n        this.ctx.fillStyle = 'rgba(26, 26, 46, 0.9)';\r\n        this.ctx.fillRect(10, 10, 280, 120);\r\n        \r\n        // Border\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeRect(10, 10, 280, 120);\r\n        \r\n        // Modern text styling\r\n        this.ctx.fillStyle = '#ffffff';\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        \r\n        let y = 35;\r\n        this.ctx.fillText(`Friction: ${this.frictionCoefficient.toFixed(2)}`, 20, y);\r\n        y += 25;\r\n        this.ctx.fillText(`Angle: ${this.inclineAngle}°`, 20, y);\r\n        y += 25;\r\n        this.ctx.fillText(`Net Force: ${netForce.toFixed(1)} N`, 20, y);\r\n        y += 25;\r\n        this.ctx.fillText(`Acceleration: ${acceleration.toFixed(2)} m/s²`, 20, y);\r\n    }\r\n    \r\n    getStats() {\r\n        const angleRad = this.inclineAngle * Math.PI / 180;\r\n        const weight = this.objectMass * this.gravity * 9.8;\r\n        const normalForce = weight * Math.cos(angleRad);\r\n        const parallelForce = weight * Math.sin(angleRad);\r\n        const frictionForce = this.frictionCoefficient * normalForce;\r\n        const netForce = parallelForce - frictionForce;\r\n        const acceleration = netForce / this.objectMass;\r\n        \r\n        return {\r\n            frictionCoefficient: this.frictionCoefficient,\r\n            inclineAngle: this.inclineAngle,\r\n            netForce: netForce,\r\n            acceleration: acceleration\r\n        };\r\n    }\r\n    \r\n    drawFrictionLabels() {\r\n        // Draw elegant labels on the canvas\r\n        this.ctx.save();\r\n        \r\n        // Set up text styling\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        \r\n        // Draw animation type label\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        this.ctx.fillText('Friction & Inclined Planes', this.ctx.canvas.width / 2, 30);\r\n        \r\n        // Draw mathematical formulas\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';\r\n        this.ctx.fillText(`F = μN`, \r\n                          this.ctx.canvas.width / 2, 50);\r\n        \r\n        // Draw force components\r\n        this.ctx.fillText(`F∥ = mg sin θ`, \r\n                          this.ctx.canvas.width / 2, 70);\r\n        \r\n        // Draw normal force\r\n        this.ctx.fillText(`N = mg cos θ`, \r\n                          this.ctx.canvas.width / 2, 90);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.restore();\r\n    }\r\n}","\r\n// Wave Propagation Simulation\r\nexport class WavePropagation {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.waveType = 'transverse';\r\n        this.speed = 1;\r\n        this.frequency = 1;\r\n        this.amplitude = 50;\r\n        this.wavelength = 150;\r\n        this.showAnalytics = false;\r\n        this.time = 0;\r\n        this.particles = [];\r\n        this.waveSpeed = 0; // Calculated from frequency and wavelength\r\n        this.energy = 0; // Wave energy\r\n        \r\n        this.initializeParticles();\r\n        this.calculateWaveParameters();\r\n    }\r\n    \r\n    initializeParticles() {\r\n        this.particles = [];\r\n        const particleCount = 80; // Increased for smoother waves\r\n        for (let i = 0; i < particleCount; i++) {\r\n            this.particles.push({\r\n                x: (i / particleCount) * this.ctx.canvas.width,\r\n                y: this.ctx.canvas.height / 2,\r\n                originalY: this.ctx.canvas.height / 2,\r\n                originalX: (i / particleCount) * this.ctx.canvas.width,\r\n                vx: 0,\r\n                vy: 0,\r\n                index: i\r\n            });\r\n        }\r\n    }\r\n    \r\n    calculateWaveParameters() {\r\n        // Calculate wave speed: v = f × λ\r\n        this.waveSpeed = this.frequency * this.wavelength;\r\n        // Calculate wave energy (proportional to amplitude^2 and frequency^2)\r\n        this.energy = 0.5 * this.amplitude * this.amplitude * this.frequency * this.frequency;\r\n    }\r\n    \r\n    setWaveType(type) {\r\n        this.waveType = type;\r\n        \r\n        // Reset all parameters to default values when changing wave type\r\n        this.speed = 1;\r\n        this.frequency = 1;\r\n        this.amplitude = 50;\r\n        this.wavelength = 150;\r\n        this.showAnalytics = false;\r\n        this.time = 0;\r\n        \r\n        // Reinitialize particles\r\n        this.initializeParticles();\r\n        \r\n        // Recalculate wave parameters\r\n        this.calculateWaveParameters();\r\n        \r\n        // Reset all controls to default values\r\n        const speedSlider = document.getElementById('waveSpeed');\r\n        const frequencySlider = document.getElementById('waveFrequency');\r\n        const amplitudeSlider = document.getElementById('waveAmplitude');\r\n        const waveTypeSelect = document.getElementById('waveType');\r\n        const analyticsCheckbox = document.getElementById('waveShowAnalytics');\r\n        \r\n        if (speedSlider) {\r\n            speedSlider.value = this.speed;\r\n            document.getElementById('waveSpeedValue').textContent = this.speed + 'x';\r\n        }\r\n        \r\n        if (frequencySlider) {\r\n            frequencySlider.value = this.frequency;\r\n            document.getElementById('waveFrequencyValue').textContent = this.frequency;\r\n        }\r\n        \r\n        if (amplitudeSlider) {\r\n            amplitudeSlider.value = this.amplitude;\r\n            document.getElementById('waveAmplitudeValue').textContent = this.amplitude;\r\n        }\r\n        \r\n        if (waveTypeSelect) {\r\n            waveTypeSelect.value = this.waveType;\r\n        }\r\n        \r\n        if (analyticsCheckbox) {\r\n            analyticsCheckbox.checked = this.showAnalytics;\r\n        }\r\n    }\r\n    \r\n    setSpeed(speed) {\r\n        this.speed = speed;\r\n        // Don't recalculate wave parameters when user changes speed\r\n        // this.calculateWaveParameters();\r\n    }\r\n    \r\n    setFrequency(freq) {\r\n        this.frequency = freq;\r\n        this.calculateWaveParameters();\r\n    }\r\n    \r\n    setAmplitude(amp) {\r\n        this.amplitude = amp;\r\n        this.calculateWaveParameters();\r\n    }\r\n    \r\n    setWavelength(wavelength) {\r\n        this.wavelength = wavelength;\r\n        this.calculateWaveParameters();\r\n    }\r\n    \r\n    setShowAnalytics(show) {\r\n        this.showAnalytics = show;\r\n    }\r\n    \r\n    reset() {\r\n        // Reset all parameters to initial state\r\n        this.waveType = 'transverse';\r\n        this.speed = 1;\r\n        this.frequency = 1;\r\n        this.amplitude = 50;\r\n        this.wavelength = 150;\r\n        this.showAnalytics = false;\r\n        this.time = 0;\r\n        \r\n        // Reinitialize particles\r\n        this.initializeParticles();\r\n        \r\n        // Recalculate wave parameters\r\n        this.calculateWaveParameters();\r\n        \r\n        // Reset controls to match the reset state\r\n        const speedSlider = document.getElementById('waveSpeed');\r\n        const frequencySlider = document.getElementById('waveFrequency');\r\n        const amplitudeSlider = document.getElementById('waveAmplitude');\r\n        const waveTypeSelect = document.getElementById('waveType');\r\n        const analyticsCheckbox = document.getElementById('waveShowAnalytics');\r\n        \r\n        if (speedSlider) {\r\n            speedSlider.value = this.speed;\r\n            document.getElementById('waveSpeedValue').textContent = this.speed + 'x';\r\n        }\r\n        \r\n        if (frequencySlider) {\r\n            frequencySlider.value = this.frequency;\r\n            document.getElementById('waveFrequencyValue').textContent = this.frequency;\r\n        }\r\n        \r\n        if (amplitudeSlider) {\r\n            amplitudeSlider.value = this.amplitude;\r\n            document.getElementById('waveAmplitudeValue').textContent = this.amplitude;\r\n        }\r\n        \r\n        if (waveTypeSelect) {\r\n            waveTypeSelect.value = this.waveType;\r\n        }\r\n        \r\n        if (analyticsCheckbox) {\r\n            analyticsCheckbox.checked = this.showAnalytics;\r\n        }\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        // Slow down longitudinal waves for better visibility\r\n        const speedMultiplier = this.waveType === 'longitudinal' ? 1 : 5;\r\n        const dt = (deltaTime / 1000) * this.speed * speedMultiplier;\r\n        this.time += dt;\r\n        \r\n        this.particles.forEach((particle, index) => {\r\n            const phase = (particle.x / this.wavelength) * 2 * Math.PI;\r\n            const timePhase = this.time * this.frequency * 2 * Math.PI;\r\n            \r\n            let displacement = 0;\r\n            let velocity = 0;\r\n            \r\n            switch (this.waveType) {\r\n                case 'transverse':\r\n                    displacement = this.amplitude * Math.sin(phase - timePhase);\r\n                    velocity = -this.amplitude * this.frequency * 2 * Math.PI * Math.cos(phase - timePhase);\r\n                    particle.y = particle.originalY + displacement;\r\n                    particle.vy = velocity;\r\n                    break;\r\n\r\n                case 'longitudinal':\r\n                    // Longitudinal wave: particles move horizontally along wave direction\r\n                    // Use smaller amplitude for more visible movement\r\n                    const longitudinalAmplitude = this.amplitude * 0.5;\r\n                    displacement = longitudinalAmplitude * Math.sin(phase - timePhase);\r\n                    velocity = -longitudinalAmplitude * this.frequency * 2 * Math.PI * Math.cos(phase - timePhase);\r\n                    particle.x = particle.originalX + displacement;\r\n                    particle.y = particle.originalY; // Keep vertical position constant\r\n                    particle.vx = velocity;\r\n                    particle.vy = 0;\r\n                    // Store displacement for spring visualization\r\n                    particle.displacement = displacement;\r\n                    break;\r\n                case 'interference':\r\n                    const wave1 = this.amplitude * Math.sin(phase - timePhase);\r\n                    const wave2 = this.amplitude * Math.sin(phase + timePhase);\r\n                    displacement = wave1 + wave2;\r\n                    velocity = -this.amplitude * this.frequency * 2 * Math.PI * \r\n                              (Math.cos(phase - timePhase) - Math.cos(phase + timePhase));\r\n                    particle.y = particle.originalY + displacement;\r\n                    particle.vy = velocity;\r\n                    break;\r\n                case 'standing':\r\n                    displacement = this.amplitude * Math.sin(phase) * Math.cos(timePhase);\r\n                    velocity = -this.amplitude * this.frequency * 2 * Math.PI * Math.sin(phase) * Math.sin(timePhase);\r\n                    particle.y = particle.originalY + displacement;\r\n                    particle.vy = velocity;\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n    \r\n    render() {\r\n        // Draw grid and scale markers\r\n        this.drawGrid();\r\n        \r\n        // Draw waveform based on wave type\r\n        if (this.waveType === 'longitudinal') {\r\n            this.drawLongitudinalWaveform();\r\n        } else {\r\n        this.drawEnhancedWaveform();\r\n        }\r\n        \r\n        // Always draw particles with velocity-based coloring\r\n        this.drawParticles();\r\n        \r\n        // Draw wave direction indicator\r\n        this.drawWaveDirection();\r\n        \r\n        // Draw canvas labels\r\n        this.drawCanvasLabels();\r\n        \r\n        // Draw analytics if enabled\r\n        if (this.showAnalytics) {\r\n            this.drawVelocityVectors();\r\n            this.drawWaveInfo();\r\n            this.drawEnergyVisualization();\r\n        }\r\n    }\r\n    \r\n    drawGrid() {\r\n        // Draw wavelength markers\r\n        this.ctx.strokeStyle = 'rgba(100, 100, 100, 0.3)';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.setLineDash([5, 5]);\r\n        \r\n        for (let x = 0; x < this.ctx.canvas.width; x += this.wavelength) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x, 0);\r\n            this.ctx.lineTo(x, this.ctx.canvas.height);\r\n            this.ctx.stroke();\r\n        }\r\n        this.ctx.setLineDash([]);\r\n        \r\n        // Draw amplitude markers\r\n        const centerY = this.ctx.canvas.height / 2;\r\n        this.ctx.strokeStyle = 'rgba(100, 100, 100, 0.2)';\r\n        this.ctx.lineWidth = 1;\r\n        for (let y = centerY - this.amplitude; y <= centerY + this.amplitude; y += this.amplitude / 2) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(0, y);\r\n            this.ctx.lineTo(this.ctx.canvas.width, y);\r\n            this.ctx.stroke();\r\n        }\r\n    }\r\n    \r\n    drawEnhancedWaveform() {\r\n        this.ctx.beginPath();\r\n        \r\n        // Create gradient for waveform\r\n        const gradient = this.ctx.createLinearGradient(0, 0, this.ctx.canvas.width, 0);\r\n        gradient.addColorStop(0, '#667eea');\r\n        gradient.addColorStop(0.5, '#764ba2');\r\n        gradient.addColorStop(1, '#667eea');\r\n        \r\n        this.ctx.strokeStyle = gradient;\r\n        this.ctx.lineWidth = 4;\r\n        \r\n        // Create smooth waveform with dense interpolation\r\n        if (this.particles.length > 1) {\r\n            const startX = this.particles[0].x;\r\n            const endX = this.particles[this.particles.length - 1].x;\r\n            const numPoints = 300; // Even denser sampling\r\n            \r\n            // For transverse waves, draw vertical waveform\r\n            this.ctx.moveTo(startX, this.particles[0].y);\r\n            \r\n            for (let i = 1; i < numPoints; i++) {\r\n                const t = i / (numPoints - 1);\r\n                const x = startX + t * (endX - startX);\r\n                \r\n                // Find the corresponding y value by interpolating between particles\r\n                const particleIndex = t * (this.particles.length - 1);\r\n                const lowIndex = Math.floor(particleIndex);\r\n                const highIndex = Math.min(lowIndex + 1, this.particles.length - 1);\r\n                const fraction = particleIndex - lowIndex;\r\n                \r\n                const lowY = this.particles[lowIndex].y;\r\n                const highY = this.particles[highIndex].y;\r\n                const y = lowY + fraction * (highY - lowY);\r\n                \r\n                this.ctx.lineTo(x, y);\r\n            }\r\n        }\r\n        this.ctx.stroke();\r\n        \r\n        // Add glow effect\r\n        this.ctx.shadowColor = '#667eea';\r\n        this.ctx.shadowBlur = 10;\r\n        this.ctx.stroke();\r\n        this.ctx.shadowBlur = 0;\r\n    }\r\n    \r\n    drawLongitudinalWaveform() {\r\n        if (this.particles.length < 2) return;\r\n        \r\n        const centerY = this.ctx.canvas.height / 2;\r\n        const springRadius = 20;\r\n        \r\n        // Draw a slinky-like spring with multiple coils\r\n        this.ctx.strokeStyle = '#667eea';\r\n        this.ctx.lineWidth = 4;\r\n        \r\n        // Create a continuous spring path\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.particles[0].x, centerY);\r\n        \r\n        // Draw smooth spring coils along the entire length\r\n        const totalLength = this.particles[this.particles.length - 1].x - this.particles[0].x;\r\n        const numPoints = 200; // Much more points for smooth curve\r\n        \r\n        for (let i = 0; i <= numPoints; i++) {\r\n            const t = i / numPoints;\r\n            const x = this.particles[0].x + t * totalLength;\r\n            \r\n            // Calculate wave displacement at this position\r\n            const phase = (x / this.wavelength) * 2 * Math.PI;\r\n            const timePhase = this.time * this.frequency * 2 * Math.PI;\r\n            const waveDisplacement = this.amplitude * Math.sin(phase - timePhase);\r\n            \r\n            // Add smooth spring coil offset\r\n            const coilOffset = Math.sin(t * Math.PI * 8) * springRadius; // More coils for smoothness\r\n            \r\n            // Combine wave displacement with spring coil\r\n            const y = centerY + coilOffset + waveDisplacement * 0.3;\r\n            \r\n            this.ctx.lineTo(x, y);\r\n        }\r\n        \r\n        this.ctx.stroke();\r\n        \r\n        // Add glow effect\r\n        this.ctx.shadowColor = '#667eea';\r\n        this.ctx.shadowBlur = 10;\r\n        this.ctx.stroke();\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Draw wave direction arrows\r\n        this.drawLongitudinalWaveDirection();\r\n    }\r\n    \r\n    drawLongitudinalWaveDirection() {\r\n        const centerY = this.ctx.canvas.height / 2;\r\n        const waveSpeed = this.frequency * this.wavelength;\r\n        const arrowX = 50 + (this.time * waveSpeed * 0.1) % 100;\r\n        \r\n        // Draw horizontal arrow\r\n        this.ctx.beginPath();\r\n        this.ctx.strokeStyle = '#ff6b6b';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.moveTo(arrowX, centerY);\r\n        this.ctx.lineTo(arrowX + 30, centerY);\r\n        this.ctx.stroke();\r\n        \r\n        // Arrowhead\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = '#ff6b6b';\r\n        this.ctx.moveTo(arrowX + 30, centerY);\r\n        this.ctx.lineTo(arrowX + 25, centerY - 5);\r\n        this.ctx.lineTo(arrowX + 25, centerY + 5);\r\n        this.ctx.closePath();\r\n        this.ctx.fill();\r\n    }\r\n    \r\n    drawCanvasLabels() {\r\n        // Draw elegant labels on the canvas\r\n        this.ctx.save();\r\n        \r\n        // Set up text styling\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        \r\n        // Draw wave type label\r\n        const waveTypeLabel = this.waveType.charAt(0).toUpperCase() + this.waveType.slice(1) + ' Wave';\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.9)';\r\n        this.ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        this.ctx.fillText(waveTypeLabel, this.ctx.canvas.width / 2, 25);\r\n        \r\n        // Draw mathematical formulas in a more compact format\r\n        this.ctx.font = '12px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.fillText(`v = f×λ = ${this.waveSpeed.toFixed(1)} px/s  |  y = A sin(2π(ft-x/λ))  |  E ∝ A²f²`, \r\n                          this.ctx.canvas.width / 2, 45);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.restore();\r\n    }\r\n    \r\n    drawParticles() {\r\n        this.particles.forEach(particle => {\r\n            // Calculate velocity magnitude for coloring\r\n            const velocity = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\r\n            const maxVelocity = this.amplitude * this.frequency * 2 * Math.PI;\r\n            const velocityRatio = Math.min(velocity / maxVelocity, 1);\r\n            \r\n            // Color based on velocity (blue = slow, red = fast)\r\n            const r = Math.floor(100 + velocityRatio * 155);\r\n            const g = Math.floor(100 + (1 - velocityRatio) * 100);\r\n            const b = Math.floor(200 + velocityRatio * 55);\r\n            \r\n            // Make particles larger for longitudinal waves\r\n            const particleSize = this.waveType === 'longitudinal' ? 8 : 5;\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;\r\n            this.ctx.arc(particle.x, particle.y, particleSize, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Add highlight\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';\r\n            this.ctx.arc(particle.x - 1, particle.y - 1, particleSize * 0.4, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            this.ctx.strokeStyle = '#fff';\r\n            this.ctx.lineWidth = 1;\r\n            this.ctx.stroke();\r\n        });\r\n    }\r\n    \r\n    drawVelocityVectors() {\r\n        this.particles.forEach(particle => {\r\n            const velocity = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\r\n            if (velocity > 1) {\r\n                const scale = 0.1;\r\n                const endX = particle.x + particle.vx * scale;\r\n                const endY = particle.y + particle.vy * scale;\r\n                \r\n                this.ctx.beginPath();\r\n                this.ctx.strokeStyle = '#ff6b6b';\r\n                this.ctx.lineWidth = 2;\r\n                this.ctx.moveTo(particle.x, particle.y);\r\n                this.ctx.lineTo(endX, endY);\r\n                this.ctx.stroke();\r\n                \r\n                // Arrowhead\r\n                const angle = Math.atan2(particle.vy, particle.vx);\r\n                this.ctx.beginPath();\r\n                this.ctx.fillStyle = '#ff6b6b';\r\n                this.ctx.moveTo(endX, endY);\r\n                this.ctx.lineTo(endX - 6 * Math.cos(angle - Math.PI / 6), endY - 6 * Math.sin(angle - Math.PI / 6));\r\n                this.ctx.lineTo(endX - 6 * Math.cos(angle + Math.PI / 6), endY - 6 * Math.sin(angle + Math.PI / 6));\r\n                this.ctx.closePath();\r\n                this.ctx.fill();\r\n            }\r\n        });\r\n    }\r\n    \r\n    drawWaveDirection() {\r\n        if (this.waveType !== 'standing') {\r\n            // Animated wave direction indicator - move at wave speed\r\n            const waveSpeed = this.frequency * this.wavelength;\r\n            const arrowX = 50 + (this.time * waveSpeed * 0.1) % 100;\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.strokeStyle = '#ff6b6b';\r\n            this.ctx.lineWidth = 3;\r\n            this.ctx.moveTo(arrowX, 50);\r\n            this.ctx.lineTo(arrowX + 20, 50);\r\n            this.ctx.stroke();\r\n            \r\n            // Arrowhead\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = '#ff6b6b';\r\n            this.ctx.moveTo(arrowX + 20, 50);\r\n            this.ctx.lineTo(arrowX + 15, 45);\r\n            this.ctx.lineTo(arrowX + 15, 55);\r\n            this.ctx.closePath();\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n    \r\n    drawWaveInfo() {\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        \r\n        let y = 120; // Moved down to avoid overlap with main labels\r\n        this.ctx.fillText(`Wave Type: ${this.waveType.charAt(0).toUpperCase() + this.waveType.slice(1)}`, 10, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Frequency: ${this.frequency.toFixed(1)} Hz`, 10, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Wavelength: ${this.wavelength.toFixed(0)} px`, 10, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Amplitude: ${this.amplitude.toFixed(0)} px`, 10, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Wave Speed: ${this.waveSpeed.toFixed(1)} px/s`, 10, y);\r\n        y += 20;\r\n        this.ctx.fillText(`Energy: ${this.energy.toFixed(1)}`, 10, y);\r\n        y += 30;\r\n        \r\n        // Wave equation\r\n        this.ctx.fillText(`Wave Equation: y = A sin(kx - ωt)`, 10, y);\r\n        y += 20;\r\n        this.ctx.fillText(`where: k = 2π/λ, ω = 2πf`, 10, y);\r\n    }\r\n    \r\n    drawEnergyVisualization() {\r\n        // Draw energy bar\r\n        const barWidth = 200;\r\n        const barHeight = 20;\r\n        const barX = this.ctx.canvas.width - barWidth - 20;\r\n        const barY = 120; // Moved down to avoid overlap with main labels\r\n        \r\n        // Background\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.fillRect(barX, barY, barWidth, barHeight);\r\n        \r\n        // Energy level\r\n        const maxEnergy = 0.5 * 100 * 100 * 3 * 3; // Max possible energy\r\n        const energyRatio = Math.min(this.energy / maxEnergy, 1);\r\n        const energyWidth = barWidth * energyRatio;\r\n        \r\n        // Gradient for energy bar\r\n        const energyGradient = this.ctx.createLinearGradient(barX, barY, barX + energyWidth, barY);\r\n        energyGradient.addColorStop(0, '#4CAF50');\r\n        energyGradient.addColorStop(1, '#FF9800');\r\n        \r\n        this.ctx.fillStyle = energyGradient;\r\n        this.ctx.fillRect(barX, barY, energyWidth, barHeight);\r\n        \r\n        // Label\r\n        this.ctx.fillStyle = '#fff';\r\n        this.ctx.font = 'bold 14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText(`Energy: ${this.energy.toFixed(1)}`, barX + barWidth / 2, barY + 15);\r\n    }\r\n    \r\n    getStats() {\r\n        return {\r\n            waveType: this.waveType.charAt(0).toUpperCase() + this.waveType.slice(1),\r\n            frequency: this.frequency.toFixed(1),\r\n            wavelength: this.wavelength.toFixed(0),\r\n            amplitude: this.amplitude.toFixed(0),\r\n            waveSpeed: this.waveSpeed.toFixed(1),\r\n            energy: this.energy.toFixed(1),\r\n            time: this.time.toFixed(1)\r\n        };\r\n    }\r\n}\r\n\r\n// Sound Waves Simulation\r\nexport class SoundWaves {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.particles = [];\r\n        this.frequency = 5; // Hz (low frequency for visualization)\r\n        this.amplitude = 50; // Percentage\r\n        this.waveSpeed = 343; // m/s (speed of sound in air)\r\n        this.particleCount = 15;\r\n        this.waveType = 'transverse'; // 'transverse', 'longitudinal', 'combined'\r\n        this.showPressure = true;\r\n        this.animationSpeed = 1.0;\r\n        this.time = 0;\r\n        \r\n        // Source and receiver properties\r\n        this.sourceX = 100;\r\n        this.sourceY = this.ctx.canvas.height / 2;\r\n        this.receiverX = this.ctx.canvas.width - 100;\r\n        this.receiverY = this.ctx.canvas.height / 2;\r\n        this.showSourceReceiver = true;\r\n        this.sourceActive = true;\r\n        this.pulses = [];\r\n        this.pulseDuration = 2; // number of wavelengths to show\r\n        \r\n        this.initializeParticles();\r\n        this.setupClickEvents();\r\n    }\r\n    \r\n    setupClickEvents() {\r\n        // Add click event listener to canvas for triggering wave pulses\r\n        this.ctx.canvas.addEventListener('click', (e) => {\r\n            const rect = this.ctx.canvas.getBoundingClientRect();\r\n            const x = e.clientX - rect.left;\r\n            const y = e.clientY - rect.top;\r\n            \r\n            // Check if click is near the source\r\n            const distanceFromSource = Math.sqrt((x - this.sourceX) ** 2 + (y - this.sourceY) ** 2);\r\n            if (distanceFromSource < 50) {\r\n                this.triggerWavePulse();\r\n            }\r\n        });\r\n        \r\n        // Add touch event listener for mobile support\r\n        this.ctx.canvas.addEventListener('touchstart', (e) => {\r\n            e.preventDefault();\r\n            const rect = this.ctx.canvas.getBoundingClientRect();\r\n            const touch = e.touches[0];\r\n            const x = touch.clientX - rect.left;\r\n            const y = touch.clientY - rect.top;\r\n            \r\n            // Check if touch is near the source\r\n            const distanceFromSource = Math.sqrt((x - this.sourceX) ** 2 + (y - this.sourceY) ** 2);\r\n            if (distanceFromSource < 50) {\r\n                this.triggerWavePulse();\r\n            }\r\n        });\r\n    }\r\n    \r\n    initializeParticles() {\r\n        this.particles = [];\r\n        const spacing = this.ctx.canvas.width / this.particleCount;\r\n        \r\n        for (let i = 0; i < this.particleCount; i++) {\r\n            this.particles.push({\r\n                x: i * spacing,\r\n                originalX: i * spacing,\r\n                y: this.ctx.canvas.height / 2,\r\n                originalY: this.ctx.canvas.height / 2,\r\n                vx: 0,\r\n                vy: 0,\r\n                size: 4 + Math.random() * 2,\r\n                color: `hsl(${200 + Math.random() * 60}, 70%, 60%)`,\r\n                pressure: 0,\r\n                life: 0\r\n            });\r\n        }\r\n    }\r\n    \r\n    setFrequency(freq) {\r\n        this.frequency = freq;\r\n    }\r\n    \r\n    setAmplitude(amp) {\r\n        this.amplitude = amp;\r\n    }\r\n    \r\n    setWaveSpeed(speed) {\r\n        this.waveSpeed = speed;\r\n    }\r\n    \r\n    setParticleCount(count) {\r\n        this.particleCount = count;\r\n        this.initializeParticles();\r\n    }\r\n    \r\n    setWaveType(type) {\r\n        this.waveType = type;\r\n    }\r\n    \r\n    setShowPressure(show) {\r\n        this.showPressure = show;\r\n    }\r\n    \r\n    setAnimationSpeed(speed) {\r\n        this.animationSpeed = speed;\r\n    }\r\n    \r\n    setShowSourceReceiver(show) {\r\n        this.showSourceReceiver = show;\r\n    }\r\n    \r\n    setSourceActive(active) {\r\n        this.sourceActive = active;\r\n    }\r\n    \r\n    setSourcePosition(x, y) {\r\n        this.sourceX = x;\r\n        this.sourceY = y;\r\n    }\r\n    \r\n    setReceiverPosition(x, y) {\r\n        this.receiverX = x;\r\n        this.receiverY = y;\r\n    }\r\n    \r\n    triggerWavePulse() {\r\n        const pulse = {\r\n            startTime: this.time, // Use animation time instead of Date.now()\r\n            duration: 5.0, // 5 seconds in animation time - longer to ensure wave reaches receiver\r\n            active: true\r\n        };\r\n        this.pulses.push(pulse);\r\n    }\r\n    \r\n    reset() {\r\n        this.time = 0;\r\n        this.pulses = [];\r\n        this.initializeParticles();\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        this.time += deltaTime * this.animationSpeed;\r\n        \r\n        // Update pulses - remove expired ones\r\n        this.pulses = this.pulses.filter(pulse => {\r\n            const elapsed = (this.time - pulse.startTime) / 1000; // Convert to seconds\r\n            return elapsed < pulse.duration;\r\n        });\r\n        \r\n        const wavelength = (this.waveSpeed / this.frequency) * 0.5; // Scale down for visualization but not too much\r\n        const angularFrequency = 2 * Math.PI * this.frequency;\r\n        const amplitude = (this.amplitude / 100) * 50; // Scale amplitude\r\n        \r\n        this.particles.forEach((particle, index) => {\r\n            // Check if any pulse is active\r\n            let waveActive = false;\r\n            let pulsePhase = 0;\r\n            let waveProgress = 0; // How far the wave front has traveled (0 to 1)\r\n            \r\n\r\n            \r\n            this.pulses.forEach(pulse => {\r\n                const elapsed = (this.time - pulse.startTime) / 1000; // Convert to seconds\r\n                const pulseDuration = pulse.duration;\r\n                \r\n                // Check if pulse is active\r\n                if (elapsed >= 0 && elapsed <= pulseDuration) {\r\n                    waveActive = true;\r\n                    \r\n                    // Calculate how far the wave front has traveled - ensure it reaches receiver within pulse duration\r\n                    const totalDistance = this.receiverX - this.sourceX; // Total distance to travel\r\n                    const pulseDuration = pulse.duration; // Duration in seconds\r\n                    \r\n                    // Calculate required wave speed to reach receiver within pulse duration\r\n                    const requiredSpeed = totalDistance / pulseDuration; // pixels per second\r\n                    const waveSpeedScale = requiredSpeed / this.waveSpeed; // Scale factor to match required speed\r\n                    \r\n                    const waveTravelDistance = elapsed * (this.waveSpeed * waveSpeedScale); // Scale for visualization\r\n                    \r\n                    // Calculate wave front progress (0 to 1) - ensure wave reaches receiver\r\n                    waveProgress = Math.min(waveTravelDistance / totalDistance, 1.0);\r\n                    \r\n                    // Calculate phase for this particle based on its position within the wave packet\r\n                    const particleDistance = waveProgress * totalDistance;\r\n                    pulsePhase = (particleDistance / wavelength) * 2 * Math.PI;\r\n                }\r\n            });\r\n            \r\n            if (waveActive) {\r\n                // Calculate wave packet properties\r\n                const wavePacketWidth = 6 * wavelength; // Wave packet spans 6 wavelengths for better visibility\r\n                \r\n                // Calculate wave packet start position - ensure it starts at source and moves forward\r\n                const wavePacketStart = this.sourceX + (this.receiverX - this.sourceX) * waveProgress;\r\n                const wavePacketEnd = Math.min(this.receiverX, wavePacketStart + wavePacketWidth);\r\n                \r\n\r\n                \r\n                // Calculate this particle's position within the wave packet\r\n                const particlePositionInPacket = (index / (this.particleCount - 1)) * (wavePacketEnd - wavePacketStart);\r\n                let particleX = wavePacketStart + particlePositionInPacket;\r\n                \r\n                // Ensure particle is within the wave packet bounds\r\n                if (particleX < wavePacketStart) particleX = wavePacketStart;\r\n                if (particleX > wavePacketEnd) particleX = wavePacketEnd;\r\n                \r\n                // Only show particles that are within the wave packet bounds and between source and receiver\r\n                if (particleX >= this.sourceX && particleX <= this.receiverX && particleX >= wavePacketStart && particleX <= wavePacketEnd) {\r\n                    // Convert amplitude from percentage to actual displacement - make it more visible\r\n                    const amplitudeDisplacement = (this.amplitude / 100) * 120; // Scale amplitude to reasonable pixel values\r\n                    \r\n                    if (this.waveType === 'transverse' || this.waveType === 'combined') {\r\n                        // Transverse wave motion - particle moves horizontally and oscillates vertically\r\n                        particle.x = particleX;\r\n                        particle.y = particle.originalY + amplitudeDisplacement * Math.sin(pulsePhase + (index * 0.2));\r\n                        particle.vy = amplitudeDisplacement * 2 * Math.PI * Math.cos(pulsePhase + (index * 0.2)) * this.animationSpeed * 0.001;\r\n                    }\r\n                    \r\n                    if (this.waveType === 'longitudinal' || this.waveType === 'combined') {\r\n                        // Longitudinal wave motion - particle oscillates around its traveling position\r\n                        particle.x = particleX + amplitudeDisplacement * 0.1 * Math.sin(pulsePhase + (index * 0.2));\r\n                        particle.vx = amplitudeDisplacement * 0.1 * 2 * Math.PI * Math.cos(pulsePhase + (index * 0.2)) * this.animationSpeed * 0.001;\r\n                    }\r\n                    \r\n                    // Calculate pressure for longitudinal waves\r\n                    if (this.waveType === 'longitudinal' || this.waveType === 'combined') {\r\n                        particle.pressure = Math.sin(pulsePhase + (index * 0.2));\r\n                    }\r\n                } else {\r\n                    // Hide particles outside the wave packet\r\n                    particle.x = -100;\r\n                    particle.y = -100;\r\n                    particle.vy = 0;\r\n                    particle.vx = 0;\r\n                    particle.pressure = 0;\r\n                }\r\n            } else {\r\n                // Reset particle to original position when no pulse is active\r\n                particle.y = particle.originalY;\r\n                particle.x = particle.originalX;\r\n                particle.vy = 0;\r\n                particle.vx = 0;\r\n                particle.pressure = 0;\r\n            }\r\n            \r\n            particle.life += deltaTime;\r\n        });\r\n    }\r\n    \r\n    render() {\r\n        this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n        \r\n        // Always draw background and source/receiver\r\n        this.drawBackground();\r\n        if (this.showSourceReceiver) {\r\n            this.drawSourceAndReceiver();\r\n        }\r\n        \r\n        // Draw wave if pulses are active\r\n        if (this.pulses && this.pulses.length > 0) {\r\n            switch (this.waveType) {\r\n                case 'transverse':\r\n                    this.drawTransverseWave();\r\n                    break;\r\n                case 'longitudinal':\r\n                    this.drawLongitudinalWave();\r\n                    break;\r\n                case 'combined':\r\n                    this.drawCombinedWave();\r\n                    break;\r\n            }\r\n        } else {\r\n            // Show instruction when no wave is active\r\n            this.drawInstruction();\r\n        }\r\n        \r\n        // Always show info panels\r\n        this.drawSoundInfo();\r\n        this.drawRealWorldAnalogy();\r\n    }\r\n    \r\n    drawInstruction() {\r\n        // Draw instruction to click on source\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.fillRect(this.ctx.canvas.width / 2 - 200, this.ctx.canvas.height / 2 - 40, 400, 80);\r\n        \r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('🎵 Click the red source to trigger a sound wave!', this.ctx.canvas.width / 2, this.ctx.canvas.height / 2 - 10);\r\n        this.ctx.font = '14px Arial';\r\n        this.ctx.fillText('Watch the wave propagate from source to receiver', this.ctx.canvas.width / 2, this.ctx.canvas.height / 2 + 10);\r\n        this.ctx.fillText('Adjust controls to see different wave behaviors', this.ctx.canvas.width / 2, this.ctx.canvas.height / 2 + 30);\r\n    }\r\n    \r\n    drawBackground() {\r\n        // Draw subtle grid\r\n        this.ctx.strokeStyle = 'rgba(200, 200, 200, 0.2)';\r\n        this.ctx.lineWidth = 1;\r\n        \r\n        // Vertical lines\r\n        for (let x = 0; x < this.ctx.canvas.width; x += 50) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x, 0);\r\n            this.ctx.lineTo(x, this.ctx.canvas.height);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Horizontal lines\r\n        for (let y = 0; y < this.ctx.canvas.height; y += 50) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(0, y);\r\n            this.ctx.lineTo(this.ctx.canvas.width, y);\r\n            this.ctx.stroke();\r\n        }\r\n    }\r\n    \r\n    drawTransverseWave() {\r\n        // Draw wave line\r\n        this.ctx.strokeStyle = '#0066CC';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.beginPath();\r\n        \r\n        this.particles.forEach((particle, index) => {\r\n            if (index === 0) {\r\n                this.ctx.moveTo(particle.x, particle.y);\r\n            } else {\r\n                this.ctx.lineTo(particle.x, particle.y);\r\n            }\r\n        });\r\n        this.ctx.stroke();\r\n        \r\n        // Draw particles\r\n        this.particles.forEach(particle => {\r\n            const velocity = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\r\n            const intensity = Math.min(velocity * 100, 1);\r\n            \r\n            // Color based on velocity\r\n            const hue = 200 + intensity * 60;\r\n            const color = `hsl(${hue}, 80%, 60%)`;\r\n            \r\n            this.ctx.fillStyle = color;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Add glow for fast particles\r\n            if (intensity > 0.5) {\r\n                this.ctx.shadowColor = color;\r\n                this.ctx.shadowBlur = 8;\r\n                this.ctx.fillStyle = color;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(particle.x, particle.y, particle.size + 2, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n                this.ctx.shadowBlur = 0;\r\n            }\r\n        });\r\n        \r\n\r\n    }\r\n    \r\n    drawLongitudinalWave() {\r\n        // Draw air molecules as particles with enhanced pressure visualization\r\n        this.particles.forEach(particle => {\r\n            const pressure = particle.pressure;\r\n            const intensity = Math.abs(pressure);\r\n            \r\n            // Color based on pressure (orange for high, cyan for low)\r\n            let color;\r\n            if (pressure > 0) {\r\n                // High pressure (compression) - subtle orange\r\n                color = `hsl(30, 80%, 60%)`;\r\n            } else {\r\n                // Low pressure (rarefaction) - subtle cyan\r\n                color = `hsl(180, 60%, 60%)`;\r\n            }\r\n            \r\n            // Draw particle with size based on pressure\r\n            const particleSize = particle.size + intensity * 5;\r\n            this.ctx.fillStyle = color;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(particle.x, particle.y, particleSize, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Add glow effect for high pressure particles\r\n            if (intensity > 0.5) {\r\n                this.ctx.shadowColor = color;\r\n                this.ctx.shadowBlur = 8;\r\n                this.ctx.fillStyle = color;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(particle.x, particle.y, particleSize + 2, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n                this.ctx.shadowBlur = 0;\r\n            }\r\n            \r\n            // Add pressure indicator arrows\r\n            if (this.showPressure && intensity > 0.2) {\r\n                this.ctx.strokeStyle = color;\r\n                this.ctx.lineWidth = 3;\r\n                this.ctx.beginPath();\r\n                \r\n                if (pressure > 0) {\r\n                    // Compression arrows pointing inward\r\n                    this.ctx.moveTo(particle.x - 15, particle.y);\r\n                    this.ctx.lineTo(particle.x - 5, particle.y);\r\n                    this.ctx.moveTo(particle.x + 5, particle.y);\r\n                    this.ctx.lineTo(particle.x + 15, particle.y);\r\n                } else {\r\n                    // Rarefaction arrows pointing outward\r\n                    this.ctx.moveTo(particle.x - 5, particle.y);\r\n                    this.ctx.lineTo(particle.x - 15, particle.y);\r\n                    this.ctx.moveTo(particle.x + 15, particle.y);\r\n                    this.ctx.lineTo(particle.x + 5, particle.y);\r\n                }\r\n                this.ctx.stroke();\r\n            }\r\n        });\r\n        \r\n        // Draw pressure zones\r\n        if (this.showPressure) {\r\n            this.drawPressureZones();\r\n        }\r\n    }\r\n    \r\n    drawCombinedWave() {\r\n        // Draw transverse wave as the main wave\r\n        this.drawTransverseWave();\r\n        \r\n        // Draw longitudinal components as pressure indicators\r\n        if (this.showPressure) {\r\n            this.drawPressureZones();\r\n        }\r\n        \r\n        // Draw longitudinal particles as small indicators\r\n        this.particles.forEach(particle => {\r\n            const pressure = particle.pressure;\r\n            const intensity = Math.abs(pressure);\r\n            \r\n            if (intensity > 0.3) {\r\n                // Color based on pressure (red for high, blue for low)\r\n                let color;\r\n                if (pressure > 0) {\r\n                    color = `hsl(0, 80%, 60%)`; // Red for compression\r\n                } else {\r\n                    color = `hsl(240, 80%, 60%)`; // Blue for rarefaction\r\n                }\r\n                \r\n                this.ctx.fillStyle = color;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(particle.x, particle.y + 30, 3, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n            }\r\n        });\r\n    }\r\n    \r\n    drawPressureZones() {\r\n        // Draw pressure zones that move with the wave - using more subtle colors\r\n        const wavelength = this.waveSpeed / this.frequency;\r\n        const waveSpeed = this.waveSpeed;\r\n        const frequency = this.frequency;\r\n        \r\n        // Calculate wave position based on time\r\n        const wavePosition = (this.time * 0.001 * waveSpeed) % wavelength;\r\n        \r\n        // Draw compression and rarefaction zones that move with the wave - only between source and receiver\r\n        const zoneHeight = 80; // Reduced height for pressure zones\r\n        const zoneY = this.sourceY - zoneHeight / 2; // Center zones vertically on the wave path\r\n        \r\n        for (let x = this.sourceX; x <= this.receiverX; x += wavelength / 4) {\r\n            const relativeX = (x - wavePosition) % wavelength;\r\n            const phase = (2 * Math.PI * relativeX) / wavelength;\r\n            const pressure = Math.sin(phase);\r\n            \r\n            if (pressure > 0.5) {\r\n                // High pressure zone (compression) - subtle orange/amber\r\n                this.ctx.fillStyle = 'rgba(255, 165, 0, 0.2)';\r\n                this.ctx.fillRect(x, zoneY, wavelength / 4, zoneHeight);\r\n                \r\n                // Add subtle border\r\n                this.ctx.strokeStyle = 'rgba(255, 165, 0, 0.3)';\r\n                this.ctx.lineWidth = 1;\r\n                this.ctx.strokeRect(x, zoneY, wavelength / 4, zoneHeight);\r\n                \r\n                // Add subtle compression label\r\n                this.ctx.fillStyle = 'rgba(255, 165, 0, 0.7)';\r\n                this.ctx.font = '10px Arial';\r\n                this.ctx.textAlign = 'center';\r\n                this.ctx.fillText('C', x + wavelength / 8, zoneY + 15);\r\n            } else if (pressure < -0.5) {\r\n                // Low pressure zone (rarefaction) - subtle cyan/teal\r\n                this.ctx.fillStyle = 'rgba(0, 128, 128, 0.2)';\r\n                this.ctx.fillRect(x, zoneY, wavelength / 4, zoneHeight);\r\n                \r\n                // Add subtle border\r\n                this.ctx.strokeStyle = 'rgba(0, 128, 128, 0.3)';\r\n                this.ctx.lineWidth = 1;\r\n                this.ctx.strokeRect(x, zoneY, wavelength / 4, zoneHeight);\r\n                \r\n                // Add subtle rarefaction label\r\n                this.ctx.fillStyle = 'rgba(0, 128, 128, 0.7)';\r\n                this.ctx.font = '10px Arial';\r\n                this.ctx.textAlign = 'center';\r\n                this.ctx.fillText('R', x + wavelength / 8, zoneY + 15);\r\n            }\r\n        }\r\n        \r\n\r\n    }\r\n    \r\n        \r\n    drawSourceAndReceiver() {\r\n        // Draw clickable area indicator (for debugging)\r\n        this.ctx.strokeStyle = 'rgba(255, 255, 0, 0.3)';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.sourceX, this.sourceY, 50, 0, Math.PI * 2);\r\n        this.ctx.stroke();\r\n        \r\n        // Draw source (speaker/microphone)\r\n        this.ctx.fillStyle = this.sourceActive ? '#FF6B6B' : '#666666';\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.sourceX, this.sourceY, 25, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Add speaker cone effect when active\r\n        if (this.sourceActive) {\r\n            this.ctx.strokeStyle = '#FF6B6B';\r\n            this.ctx.lineWidth = 3;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(this.sourceX, this.sourceY, 35, 0, Math.PI * 2);\r\n            this.ctx.stroke();\r\n            \r\n            // Add pulsing effect\r\n            const pulse = Math.sin(this.time * 0.01) * 0.3 + 0.7;\r\n            this.ctx.fillStyle = `rgba(255, 107, 107, ${pulse * 0.3})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(this.sourceX, this.sourceY, 40, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n        \r\n        // Draw receiver (ear/microphone)\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.receiverX, this.receiverY, 20, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Add receiver cone\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.receiverX, this.receiverY, 30, 0, Math.PI * 2);\r\n        this.ctx.stroke();\r\n        \r\n        // Draw labels with improved styling\r\n        // Add text shadow for better visibility\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.shadowBlur = 3;\r\n        this.ctx.shadowOffsetX = 1;\r\n        this.ctx.shadowOffsetY = 1;\r\n        \r\n        // Source label\r\n        this.ctx.fillStyle = '#FF6B6B'; // Match source color\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('🎤 Source', this.sourceX, this.sourceY + 50);\r\n        \r\n        // Receiver label\r\n        this.ctx.fillStyle = '#4ECDC4'; // Match receiver color\r\n        this.ctx.fillText('👂 Receiver', this.receiverX, this.receiverY + 50);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.shadowOffsetX = 0;\r\n        this.ctx.shadowOffsetY = 0;\r\n        \r\n        // Draw wave direction arrow\r\n        this.ctx.strokeStyle = '#FFD93D';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.setLineDash([10, 5]);\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.sourceX + 40, this.sourceY);\r\n        this.ctx.lineTo(this.receiverX - 30, this.receiverY);\r\n        this.ctx.stroke();\r\n        this.ctx.setLineDash([]);\r\n        \r\n        // Add arrowhead\r\n        this.ctx.fillStyle = '#FFD93D';\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.receiverX - 30, this.receiverY);\r\n        this.ctx.lineTo(this.receiverX - 40, this.receiverY - 5);\r\n        this.ctx.lineTo(this.receiverX - 40, this.receiverY + 5);\r\n        this.ctx.closePath();\r\n        this.ctx.fill();\r\n    }\r\n    \r\n    drawSoundInfo() {\r\n        // Simple info panel\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.fillRect(10, 10, 320, 180);\r\n        \r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('🎵 Sound Wave Properties', 20, 30);\r\n        \r\n        this.ctx.font = '14px Arial';\r\n        this.ctx.fillText(`Frequency: ${this.frequency} Hz`, 20, 50);\r\n        this.ctx.fillText(`Wavelength: ${(this.waveSpeed / this.frequency).toFixed(1)} m`, 20, 70);\r\n        this.ctx.fillText(`Wave Speed: ${this.waveSpeed} m/s`, 20, 90);\r\n        // Calculate the actual visual speed being used\r\n        const totalDistance = this.receiverX - this.sourceX;\r\n        const pulseDuration = 5.0; // Default pulse duration\r\n        const visualSpeed = totalDistance / pulseDuration;\r\n        this.ctx.fillText(`Visual Speed: ${visualSpeed.toFixed(1)} px/s`, 20, 110);\r\n        this.ctx.fillText(`Amplitude: ${this.amplitude}%`, 20, 130);\r\n        this.ctx.fillText(`Wave Type: ${this.waveType}`, 20, 150);\r\n        this.ctx.fillText(`Particles: ${this.particleCount}`, 20, 170);\r\n    }\r\n    \r\n    drawRealWorldAnalogy() {\r\n        // Simple analogy panel\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.fillRect(this.ctx.canvas.width - 280, 10, 270, 140);\r\n        \r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = 'bold 14px Arial';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('💡 Real-World Examples:', this.ctx.canvas.width - 270, 30);\r\n        \r\n        this.ctx.font = '12px Arial';\r\n        if (this.waveType === 'transverse') {\r\n            this.ctx.fillText('🎸 Guitar/violin strings', this.ctx.canvas.width - 270, 50);\r\n            this.ctx.fillText('🌊 Ocean surface waves', this.ctx.canvas.width - 270, 70);\r\n            this.ctx.fillText('📡 Electromagnetic waves', this.ctx.canvas.width - 270, 90);\r\n            this.ctx.fillText('🎪 Jump rope motion', this.ctx.canvas.width - 270, 110);\r\n        } else if (this.waveType === 'longitudinal') {\r\n            this.ctx.fillText('🔊 Sound waves in air', this.ctx.canvas.width - 270, 50);\r\n            this.ctx.fillText('🎤 Speaker diaphragm', this.ctx.canvas.width - 270, 70);\r\n            this.ctx.fillText('💨 Air compression waves', this.ctx.canvas.width - 270, 90);\r\n            this.ctx.fillText('🌊 Seismic P-waves', this.ctx.canvas.width - 270, 110);\r\n        } else {\r\n            this.ctx.fillText('🎵 Complex wave patterns', this.ctx.canvas.width - 270, 50);\r\n            this.ctx.fillText('🔊 Multiple wave types', this.ctx.canvas.width - 270, 70);\r\n            this.ctx.fillText('📡 Combined phenomena', this.ctx.canvas.width - 270, 90);\r\n            this.ctx.fillText('🎼 Musical instruments', this.ctx.canvas.width - 270, 110);\r\n        }\r\n    }\r\n    \r\n    getStats() {\r\n        return {\r\n            waveType: this.waveType,\r\n            frequency: this.frequency,\r\n            wavelength: this.waveSpeed / this.frequency,\r\n            waveSpeed: this.waveSpeed,\r\n            amplitude: this.amplitude,\r\n            particleCount: this.particleCount,\r\n            time: this.time\r\n        };\r\n    }\r\n}","\r\n\r\n// Electric Fields Simulation - Simplified\r\nexport class ElectricFields {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.charges = [];\r\n        this.testParticles = [];\r\n        this.fieldStrength = 1.0;\r\n        this.speed = 1.0;\r\n        this.particleCount = 20;\r\n        this.showFieldLines = true;\r\n        this.showParticles = true;\r\n        this.showForceArrows = false;\r\n        this.showAnalytics = true; // Enable analytics by default for electric fields\r\n        this.time = 0;\r\n        \r\n        this.initializeTestParticles();\r\n        this.initializeDefaultCharges();\r\n    }\r\n    \r\n    initializeTestParticles() {\r\n        this.testParticles = [];\r\n        for (let i = 0; i < this.particleCount; i++) {\r\n            this.testParticles.push({\r\n                x: Math.random() * this.ctx.canvas.width,\r\n                y: Math.random() * this.ctx.canvas.height,\r\n                vx: 0,\r\n                vy: 0,\r\n                trail: [],\r\n                maxTrailLength: 30\r\n            });\r\n        }\r\n    }\r\n    \r\n    initializeDefaultCharges() {\r\n        // Add some default charges to make the animation interesting\r\n        this.addChargeAtPosition('positive', this.ctx.canvas.width * 0.3, this.ctx.canvas.height * 0.5);\r\n        this.addChargeAtPosition('negative', this.ctx.canvas.width * 0.7, this.ctx.canvas.height * 0.5);\r\n    }\r\n    \r\n    setSpeed(speed) {\r\n        this.speed = speed;\r\n    }\r\n    \r\n    setFieldStrength(strength) {\r\n        this.fieldStrength = strength;\r\n    }\r\n    \r\n    setParticleCount(count) {\r\n        this.particleCount = count;\r\n        this.initializeTestParticles();\r\n    }\r\n    setShowAnalytics(show) {\r\n        this.showAnalytics = show;\r\n    }\r\n    addChargeAtPosition(type, x, y) {\r\n        const charge = {\r\n            x: x,\r\n            y: y,\r\n            type: type, // 'positive' or 'negative'\r\n            magnitude: 1,\r\n            color: type === 'positive' ? '#ff6b6b' : '#667eea'\r\n        };\r\n        this.charges.push(charge);\r\n    }\r\n    \r\n    clearCharges() {\r\n        this.charges = [];\r\n        this.initializeDefaultCharges(); // Re-add default charges after clearing\r\n    }\r\n    \r\n    reset() {\r\n        this.time = 0;\r\n        this.charges = [];\r\n        this.initializeTestParticles();\r\n        this.initializeDefaultCharges();\r\n    }\r\n    \r\n    calculateElectricField(x, y) {\r\n        let ex = 0, ey = 0;\r\n        const k = 500; // Simplified Coulomb's constant\r\n        \r\n        this.charges.forEach(charge => {\r\n            const dx = x - charge.x;\r\n            const dy = y - charge.y;\r\n            const r = Math.sqrt(dx * dx + dy * dy);\r\n            \r\n            if (r > 10) { // Avoid division by zero\r\n                const force = k * charge.magnitude * this.fieldStrength / (r * r);\r\n                const sign = charge.type === 'positive' ? 1 : -1;\r\n                ex += sign * force * dx / r;\r\n                ey += sign * force * dy / r;\r\n            }\r\n        });\r\n        \r\n        return { ex, ey };\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        const dt = (deltaTime / 1000) * this.speed * 20; // Much faster animation\r\n        this.time += dt;\r\n        \r\n        this.testParticles.forEach(particle => {\r\n            const field = this.calculateElectricField(particle.x, particle.y);\r\n            \r\n            // Apply electric force (simplified)\r\n            particle.vx += field.ex * dt * 0.5;\r\n            particle.vy += field.ey * dt * 0.5;\r\n            \r\n            // Add damping to prevent chaos\r\n            particle.vx *= 0.95;\r\n            particle.vy *= 0.95;\r\n            \r\n            // Limit maximum speed\r\n            const speed = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\r\n            if (speed > 100) {\r\n                particle.vx *= 0.8;\r\n                particle.vy *= 0.8;\r\n            }\r\n            \r\n            // Update position\r\n            particle.x += particle.vx * dt;\r\n            particle.y += particle.vy * dt;\r\n            \r\n            // Add to trail\r\n            particle.trail.push({ x: particle.x, y: particle.y });\r\n            if (particle.trail.length > particle.maxTrailLength) {\r\n                particle.trail.shift();\r\n            }\r\n            \r\n            // Wrap around edges\r\n            if (particle.x < 0) particle.x = this.ctx.canvas.width;\r\n            if (particle.x > this.ctx.canvas.width) particle.x = 0;\r\n            if (particle.y < 0) particle.y = this.ctx.canvas.height;\r\n            if (particle.y > this.ctx.canvas.height) particle.y = 0;\r\n        });\r\n    }\r\n    \r\n    render() {\r\n        // Modern dark gradient background\r\n        const gradient = this.ctx.createLinearGradient(0, 0, 0, this.ctx.canvas.height);\r\n        gradient.addColorStop(0, '#181c2b');\r\n        gradient.addColorStop(1, '#232946');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n\r\n        // Show analytics (field lines, particles, force arrows) if enabled\r\n        if (this.showAnalytics) {\r\n            this.drawFieldLines();\r\n            this.drawParticles();\r\n            this.drawForceArrows();\r\n        }\r\n        // Always show charges\r\n        this.drawCharges();\r\n        \r\n        // Draw canvas labels\r\n        this.drawElectricLabels();\r\n    }\r\n    \r\n    drawFieldLines() {\r\n        const spacing = 30; // Reduced spacing for more field lines\r\n        \r\n        for (let x = spacing; x < this.ctx.canvas.width; x += spacing) {\r\n            for (let y = spacing; y < this.ctx.canvas.height; y += spacing) {\r\n                const field = this.calculateElectricField(x, y);\r\n                const magnitude = Math.sqrt(field.ex * field.ex + field.ey * field.ey);\r\n                \r\n                if (magnitude > 0.1) { // Lower threshold to show more field lines\r\n                    const angle = Math.atan2(field.ey, field.ex);\r\n                    const intensity = Math.min(magnitude / 50, 1); // Adjusted intensity scaling\r\n                    \r\n                    this.ctx.beginPath();\r\n                    this.ctx.strokeStyle = `rgba(102, 126, 234, ${intensity})`;\r\n                    this.ctx.lineWidth = 2;\r\n                    this.ctx.moveTo(x, y);\r\n                    this.ctx.lineTo(\r\n                        x + 25 * Math.cos(angle), // Longer arrows\r\n                        y + 25 * Math.sin(angle)\r\n                    );\r\n                    this.ctx.stroke();\r\n                    \r\n                    // Arrowhead\r\n                    this.ctx.beginPath();\r\n                    this.ctx.fillStyle = `rgba(102, 126, 234, ${intensity})`;\r\n                    this.ctx.moveTo(\r\n                        x + 25 * Math.cos(angle),\r\n                        y + 25 * Math.sin(angle)\r\n                    );\r\n                    this.ctx.lineTo(\r\n                        x + 20 * Math.cos(angle - Math.PI / 6),\r\n                        y + 20 * Math.sin(angle - Math.PI / 6)\r\n                    );\r\n                    this.ctx.lineTo(\r\n                        x + 20 * Math.cos(angle + Math.PI / 6),\r\n                        y + 20 * Math.sin(angle + Math.PI / 6)\r\n                    );\r\n                    this.ctx.closePath();\r\n                    this.ctx.fill();\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawCharges() {\r\n        this.charges.forEach(charge => {\r\n            // Modern gradient charge with glow effect\r\n            const gradient = this.ctx.createRadialGradient(\r\n                charge.x - 8, charge.y - 8, 0,\r\n                charge.x, charge.y, 20\r\n            );\r\n            \r\n            if (charge.type === 'positive') {\r\n                gradient.addColorStop(0, '#ff6b6b');\r\n                gradient.addColorStop(0.7, '#ff4757');\r\n                gradient.addColorStop(1, '#ff3838');\r\n            } else {\r\n                gradient.addColorStop(0, '#667eea');\r\n                gradient.addColorStop(0.7, '#5f6fd8');\r\n                gradient.addColorStop(1, '#5352ed');\r\n            }\r\n            \r\n            // Glow effect\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = charge.type === 'positive' ? 'rgba(255, 107, 107, 0.3)' : 'rgba(102, 126, 234, 0.3)';\r\n            this.ctx.arc(charge.x, charge.y, 18, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Main charge circle\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = gradient;\r\n            this.ctx.arc(charge.x, charge.y, 12, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Modern shadow\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';\r\n            this.ctx.arc(charge.x + 2, charge.y + 2, 12, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Charge symbol with modern styling\r\n            this.ctx.fillStyle = '#ffffff';\r\n            this.ctx.font = 'bold 20px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.textBaseline = 'middle';\r\n            this.ctx.fillText(charge.type === 'positive' ? '+' : '−', charge.x, charge.y);\r\n        });\r\n    }\r\n    \r\n    drawParticles() {\r\n        this.testParticles.forEach(particle => {\r\n            // Modern particle trail with gradient\r\n            if (particle.trail.length > 1) {\r\n                this.ctx.beginPath();\r\n                const gradient = this.ctx.createLinearGradient(\r\n                    particle.trail[0].x, particle.trail[0].y,\r\n                    particle.x, particle.y\r\n                );\r\n                gradient.addColorStop(0, 'rgba(255, 255, 255, 0.1)');\r\n                gradient.addColorStop(1, 'rgba(255, 255, 255, 0.6)');\r\n                this.ctx.strokeStyle = gradient;\r\n                this.ctx.lineWidth = 3;\r\n                this.ctx.lineCap = 'round';\r\n                this.ctx.moveTo(particle.trail[0].x, particle.trail[0].y);\r\n                particle.trail.forEach(point => {\r\n                    this.ctx.lineTo(point.x, point.y);\r\n                });\r\n                this.ctx.stroke();\r\n            }\r\n            \r\n            // Modern particle with glow and gradient\r\n            const particleGradient = this.ctx.createRadialGradient(\r\n                particle.x - 3, particle.y - 3, 0,\r\n                particle.x, particle.y, 8\r\n            );\r\n            particleGradient.addColorStop(0, '#ffffff');\r\n            particleGradient.addColorStop(0.7, '#f8f9fa');\r\n            particleGradient.addColorStop(1, '#e9ecef');\r\n            \r\n            // Glow effect\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';\r\n            this.ctx.arc(particle.x, particle.y, 8, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Main particle\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = particleGradient;\r\n            this.ctx.arc(particle.x, particle.y, 4, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Modern shadow\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';\r\n            this.ctx.arc(particle.x + 1, particle.y + 1, 4, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        });\r\n    }\r\n    \r\n    drawForceArrows() {\r\n        this.testParticles.forEach(particle => {\r\n            const field = this.calculateElectricField(particle.x, particle.y);\r\n            const forceMagnitude = Math.sqrt(field.ex * field.ex + field.ey * field.ey);\r\n            \r\n            if (forceMagnitude > 5) {\r\n                const scale = 0.8;\r\n                const endX = particle.x + field.ex * scale;\r\n                const endY = particle.y + field.ey * scale;\r\n                \r\n                // Modern force arrow with gradient and glow\r\n                const arrowGradient = this.ctx.createLinearGradient(\r\n                    particle.x, particle.y, endX, endY\r\n                );\r\n                arrowGradient.addColorStop(0, '#ff6b35');\r\n                arrowGradient.addColorStop(1, '#ff8c42');\r\n                \r\n                // Glow effect\r\n                this.ctx.beginPath();\r\n                this.ctx.strokeStyle = 'rgba(255, 107, 53, 0.4)';\r\n                this.ctx.lineWidth = 6;\r\n                this.ctx.lineCap = 'round';\r\n                this.ctx.moveTo(particle.x, particle.y);\r\n                this.ctx.lineTo(endX, endY);\r\n                this.ctx.stroke();\r\n                \r\n                // Main arrow\r\n                this.ctx.beginPath();\r\n                this.ctx.strokeStyle = arrowGradient;\r\n                this.ctx.lineWidth = 3;\r\n                this.ctx.lineCap = 'round';\r\n                this.ctx.moveTo(particle.x, particle.y);\r\n                this.ctx.lineTo(endX, endY);\r\n                this.ctx.stroke();\r\n                \r\n                // Modern arrowhead\r\n                const angle = Math.atan2(field.ey, field.ex);\r\n                this.ctx.beginPath();\r\n                this.ctx.fillStyle = arrowGradient;\r\n                this.ctx.moveTo(endX, endY);\r\n                this.ctx.lineTo(\r\n                    endX - 10 * Math.cos(angle - Math.PI / 6),\r\n                    endY - 10 * Math.sin(angle - Math.PI / 6)\r\n                );\r\n                this.ctx.lineTo(\r\n                    endX - 10 * Math.cos(angle + Math.PI / 6),\r\n                    endY - 10 * Math.sin(angle + Math.PI / 6)\r\n                );\r\n                this.ctx.closePath();\r\n                this.ctx.fill();\r\n            }\r\n        });\r\n    }\r\n    \r\n    drawInfo() {\r\n        // Modern analytics panel with gradient background\r\n        const panelWidth = 200;\r\n        const panelHeight = 120;\r\n        const panelX = this.ctx.canvas.width - panelWidth - 20;\r\n        const panelY = 20;\r\n        \r\n        // Panel background with gradient\r\n        const panelGradient = this.ctx.createLinearGradient(panelX, panelY, panelX, panelY + panelHeight);\r\n        panelGradient.addColorStop(0, 'rgba(24, 28, 43, 0.95)');\r\n        panelGradient.addColorStop(1, 'rgba(35, 41, 70, 0.95)');\r\n        \r\n        this.ctx.fillStyle = panelGradient;\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, panelHeight);\r\n        \r\n        // Panel border with glow\r\n        this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.strokeRect(panelX, panelY, panelWidth, panelHeight);\r\n        \r\n        // Panel title\r\n        this.ctx.fillStyle = '#ffffff';\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('Electric Field Analytics', panelX + 15, panelY + 25);\r\n        \r\n        // Analytics data with modern styling\r\n        this.ctx.fillStyle = '#e9ecef';\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillText(`Charges: ${this.charges.length}`, panelX + 15, panelY + 45);\r\n        this.ctx.fillText(`Particles: ${this.testParticles.length}`, panelX + 15, panelY + 65);\r\n        this.ctx.fillText(`Field Strength: ${this.fieldStrength.toFixed(1)}`, panelX + 15, panelY + 85);\r\n        \r\n        // Modern explanation at bottom with dark background for visibility\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n        this.ctx.fillRect(5, this.ctx.canvas.height - 50, 300, 40);\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('🔴 Positive (+)  🔵 Negative (−)', 10, this.ctx.canvas.height - 40);\r\n        this.ctx.fillText('Click canvas to add charges', 10, this.ctx.canvas.height - 20);\r\n    }\r\n    \r\n    getStats() {\r\n        return {\r\n            chargeCount: this.charges.length,\r\n            particleCount: this.testParticles.length,\r\n            fieldStrength: this.fieldStrength.toFixed(1),\r\n            time: this.time.toFixed(1)\r\n        };\r\n    }\r\n    \r\n    drawElectricLabels() {\r\n        // Draw elegant labels on the canvas\r\n        this.ctx.save();\r\n        \r\n        // Set up text styling\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        \r\n        // Draw animation type label\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        this.ctx.fillText('Electric Fields', this.ctx.canvas.width / 2, 30);\r\n        \r\n        // Draw mathematical formulas\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';\r\n        this.ctx.fillText(`E = kQ/r²`, \r\n                          this.ctx.canvas.width / 2, 50);\r\n        \r\n        // Draw Coulomb's law\r\n        this.ctx.fillText(`F = kq₁q₂/r²`, \r\n                          this.ctx.canvas.width / 2, 70);\r\n        \r\n        // Draw field superposition\r\n        this.ctx.fillText(`E = ΣEᵢ`, \r\n                          this.ctx.canvas.width / 2, 90);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Draw test particle explanation banner\r\n        this.drawTestParticleBanner();\r\n        \r\n        this.ctx.restore();\r\n    }\r\n    \r\n    drawTestParticleBanner() {\r\n        // Create banner background with gradient\r\n        const bannerWidth = 320;\r\n        const bannerHeight = 40;\r\n        const bannerX = 10;\r\n        const bannerY = this.ctx.canvas.height - 55;\r\n        \r\n        // Banner background with gradient\r\n        const bannerGradient = this.ctx.createLinearGradient(bannerX, bannerY, bannerX, bannerY + bannerHeight);\r\n        bannerGradient.addColorStop(0, 'rgba(255, 255, 255, 0.95)');\r\n        bannerGradient.addColorStop(1, 'rgba(240, 240, 240, 0.95)');\r\n        \r\n        this.ctx.fillStyle = bannerGradient;\r\n        this.ctx.fillRect(bannerX, bannerY, bannerWidth, bannerHeight);\r\n        \r\n        // Banner border with glow\r\n        this.ctx.shadowColor = 'rgba(102, 126, 234, 0.6)';\r\n        this.ctx.shadowBlur = 4;\r\n        this.ctx.strokeStyle = 'rgba(102, 126, 234, 0.8)';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeRect(bannerX, bannerY, bannerWidth, bannerHeight);\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Banner text\r\n        this.ctx.fillStyle = '#1a1a2e';\r\n        this.ctx.font = 'bold 13px Inter, Arial, sans-serif';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('White particles = Test charges (positive)', bannerX + 12, bannerY + bannerHeight/2);\r\n        \r\n        // Add small test charge icon with glow\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';\r\n        this.ctx.arc(bannerX + 290, bannerY + bannerHeight/2, 6, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = '#ffffff';\r\n        this.ctx.arc(bannerX + 290, bannerY + bannerHeight/2, 3, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n    }\r\n}\r\n\r\n// Magnetic Fields Simulation - Simplified\r\nexport class MagneticFields {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.speed = 1.0;\r\n        this.fieldStrength = 1.0;\r\n        this.particleCount = 15;\r\n        this.showFieldLines = true;\r\n        this.showParticles = true;\r\n        this.showForceArrows = false;\r\n        this.time = 0;\r\n        this.animationOffset = 0;\r\n        this.magnets = [];\r\n        this.particles = [];\r\n        \r\n        this.initializeParticles();\r\n        this.initializeDefaultMagnets();\r\n    }\r\n    \r\n    initializeParticles() {\r\n        this.particles = [];\r\n        for (let i = 0; i < this.particleCount; i++) {\r\n            this.particles.push({\r\n                x: Math.random() * this.ctx.canvas.width,\r\n                y: Math.random() * this.ctx.canvas.height,\r\n                vx: (Math.random() - 0.5) * 80,\r\n                vy: (Math.random() - 0.5) * 80,\r\n                charge: Math.random() > 0.5 ? 1 : -1, // Simple +1 or -1\r\n                trail: [],\r\n                maxTrailLength: 30\r\n            });\r\n        }\r\n    }\r\n    \r\n    initializeDefaultMagnets() {\r\n        // Start with one complete magnet in the center\r\n        const centerX = this.ctx.canvas.width / 2;\r\n        const centerY = this.ctx.canvas.height / 2;\r\n        const magnetLength = 50;\r\n        \r\n        this.magnets = [\r\n            {\r\n                x: centerX,\r\n                y: centerY - magnetLength/2, // North pole\r\n                strength: this.fieldStrength,\r\n                pole: 'north',\r\n                color: '#ff6b6b',\r\n                isPartOfMagnet: true,\r\n                magnetId: 1\r\n            },\r\n            {\r\n                x: centerX,\r\n                y: centerY + magnetLength/2, // South pole\r\n                strength: this.fieldStrength,\r\n                pole: 'south',\r\n                color: '#667eea',\r\n                isPartOfMagnet: true,\r\n                magnetId: 1\r\n            }\r\n        ];\r\n    }\r\n    \r\n    setSpeed(speed) {\r\n        this.speed = speed;\r\n    }\r\n    \r\n    setFieldStrength(strength) {\r\n        this.fieldStrength = strength;\r\n        this.magnets.forEach(magnet => {\r\n            magnet.strength = strength;\r\n        });\r\n    }\r\n    \r\n    setParticleCount(count) {\r\n        this.particleCount = count;\r\n        this.initializeParticles();\r\n    }\r\n    \r\n    setShowFieldLines(show) {\r\n        this.showFieldLines = show;\r\n    }\r\n    \r\n    setShowParticles(show) {\r\n        this.showParticles = show;\r\n    }\r\n    \r\n    setShowForceArrows(show) {\r\n        this.showForceArrows = show;\r\n    }\r\n    \r\n    addMagnetAtPosition(x, y) {\r\n        // Add a complete magnet with both poles\r\n        // North pole at the top, South pole at the bottom\r\n        const magnetLength = 50; // Increased distance between poles\r\n        \r\n        this.magnets.push({\r\n            x: x,\r\n            y: y - magnetLength/2, // North pole\r\n            strength: this.fieldStrength,\r\n            pole: 'north',\r\n            color: '#ff6b6b',\r\n            isPartOfMagnet: true,\r\n            magnetId: this.magnets.length\r\n        });\r\n        \r\n        this.magnets.push({\r\n            x: x,\r\n            y: y + magnetLength/2, // South pole\r\n            strength: this.fieldStrength,\r\n            pole: 'south',\r\n            color: '#667eea',\r\n            isPartOfMagnet: true,\r\n            magnetId: this.magnets.length - 1 // Same magnet ID\r\n        });\r\n    }\r\n    \r\n    clearMagnets() {\r\n        this.magnets = [];\r\n    }\r\n    \r\n    reset() {\r\n        this.time = 0;\r\n        this.clearMagnets();\r\n        this.initializeDefaultMagnets();\r\n        this.initializeParticles();\r\n    }\r\n    \r\n    calculateMagneticField(x, y) {\r\n        let Bx = 0, By = 0;\r\n        \r\n        this.magnets.forEach(magnet => {\r\n            const dx = x - magnet.x;\r\n            const dy = y - magnet.y;\r\n            const distance = Math.sqrt(dx * dx + dy * dy);\r\n            \r\n            if (distance > 10) {\r\n                // Field strength decreases with distance\r\n                const fieldStrength = magnet.strength / (1 + distance / 100);\r\n                \r\n                // Field direction depends on pole\r\n                if (magnet.pole === 'north') {\r\n                    // North pole: field points away from magnet (upward in this case)\r\n                    By += fieldStrength;\r\n                } else {\r\n                    // South pole: field points toward magnet (downward in this case)\r\n                    By -= fieldStrength;\r\n                }\r\n            }\r\n        });\r\n        \r\n        return { Bx, By };\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        const dt = (deltaTime / 1000) * this.speed * 3;\r\n        this.time += dt;\r\n        \r\n        // Update animation offset for field lines\r\n        this.animationOffset = (this.time * 0.5) % 1;\r\n        \r\n        this.particles.forEach(particle => {\r\n            // Calculate magnetic field at particle position\r\n            const field = this.calculateMagneticField(particle.x, particle.y);\r\n            \r\n            // Simple Lorentz force: F = q(v × B)\r\n            // Since B points upward, force is perpendicular to velocity\r\n            const forceX = particle.charge * particle.vy * field.By;\r\n            const forceY = -particle.charge * particle.vx * field.By;\r\n        \r\n        // Update velocity\r\n            particle.vx += forceX * dt;\r\n            particle.vy += forceY * dt;\r\n            \r\n            // Add some damping to prevent particles from going too fast\r\n            const speed = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\r\n            if (speed > 150) {\r\n                particle.vx *= 0.95;\r\n                particle.vy *= 0.95;\r\n            }\r\n        \r\n        // Update position\r\n            particle.x += particle.vx * dt;\r\n            particle.y += particle.vy * dt;\r\n            \r\n            // Add to trail\r\n            particle.trail.push({ x: particle.x, y: particle.y });\r\n            if (particle.trail.length > particle.maxTrailLength) {\r\n                particle.trail.shift();\r\n            }\r\n            \r\n            // Wrap around edges\r\n            if (particle.x < 0) particle.x = this.ctx.canvas.width;\r\n            if (particle.x > this.ctx.canvas.width) particle.x = 0;\r\n            if (particle.y < 0) particle.y = this.ctx.canvas.height;\r\n            if (particle.y > this.ctx.canvas.height) particle.y = 0;\r\n        });\r\n    }\r\n    \r\n    render() {\r\n        // Enhanced modern background with gradient\r\n        const gradient = this.ctx.createLinearGradient(0, 0, 0, this.ctx.canvas.height);\r\n        gradient.addColorStop(0, '#1a1a2e');\r\n        gradient.addColorStop(1, '#16213e');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n        \r\n        // Draw enhanced field lines\r\n        if (this.showFieldLines) {\r\n            this.drawFieldLines();\r\n        }\r\n        \r\n        // Draw enhanced magnets\r\n        this.drawMagnets();\r\n        \r\n        // Draw enhanced particles\r\n        this.drawParticles();\r\n        \r\n        // Draw enhanced force arrows\r\n        if (this.showForceArrows) {\r\n            this.drawForceArrows();\r\n        }\r\n        \r\n        // Draw canvas labels\r\n        this.drawMagneticLabels();\r\n    }\r\n    \r\n    drawFieldLines() {\r\n        if (this.magnets.length === 0) return;\r\n        \r\n        // Group magnets by magnetId to handle complete magnets\r\n        const magnetGroups = {};\r\n        this.magnets.forEach(magnet => {\r\n            if (!magnetGroups[magnet.magnetId]) {\r\n                magnetGroups[magnet.magnetId] = [];\r\n            }\r\n            magnetGroups[magnet.magnetId].push(magnet);\r\n        });\r\n        \r\n        // Draw field lines for each complete magnet\r\n        Object.values(magnetGroups).forEach(magnetGroup => {\r\n            if (magnetGroup.length === 2) {\r\n                const northPole = magnetGroup.find(m => m.pole === 'north');\r\n                const southPole = magnetGroup.find(m => m.pole === 'south');\r\n                \r\n                if (northPole && southPole) {\r\n                    this.drawMagnetFieldLines(northPole, southPole);\r\n                }\r\n            }\r\n        });\r\n        \r\n        // Draw interaction field lines between magnets\r\n        this.drawInteractionFieldLines();\r\n    }\r\n    \r\n    drawMagnetFieldLines(northPole, southPole) {\r\n        // Calculate magnet properties\r\n        const magnetLength = Math.sqrt(\r\n            Math.pow(southPole.x - northPole.x, 2) + \r\n            Math.pow(southPole.y - northPole.y, 2)\r\n        );\r\n        const magnetAngle = Math.atan2(southPole.y - northPole.y, southPole.x - northPole.x);\r\n        \r\n        // Draw field lines in a simple, clean pattern\r\n        this.drawSimpleFieldLines(northPole, southPole, magnetLength, magnetAngle);\r\n    }\r\n    \r\n    drawSimpleFieldLines(northPole, southPole, magnetLength, magnetAngle) {\r\n        // Number of field lines\r\n        const numLines = 12;\r\n        \r\n        // Draw field lines radiating from North pole\r\n        for (let i = 0; i < numLines; i++) {\r\n            const angle = (i / numLines) * Math.PI * 2;\r\n            this.drawRadiatingFieldLine(northPole, angle, 'north');\r\n        }\r\n        \r\n        // Draw field lines converging to South pole\r\n        for (let i = 0; i < numLines; i++) {\r\n            const angle = (i / numLines) * Math.PI * 2;\r\n            this.drawRadiatingFieldLine(southPole, angle, 'south');\r\n        }\r\n    }\r\n    \r\n    drawRadiatingFieldLine(pole, angle, poleType) {\r\n        const lineLength = 120;\r\n        const startX = pole.x;\r\n        const startY = pole.y;\r\n        const endX = startX + Math.cos(angle) * lineLength;\r\n        const endY = startY + Math.sin(angle) * lineLength;\r\n        \r\n        // Progressive drawing\r\n        const drawProgress = Math.min(1, this.animationOffset / 1.0);\r\n        const currentEndX = startX + (endX - startX) * drawProgress;\r\n        const currentEndY = startY + (endY - startY) * drawProgress;\r\n        \r\n        // Line styling based on pole type\r\n        const lineColor = poleType === 'north' ? 'rgba(255, 107, 107, 0.7)' : 'rgba(102, 126, 234, 0.7)';\r\n        const lineWidth = 2;\r\n        \r\n        // Draw the field line\r\n        this.ctx.strokeStyle = lineColor;\r\n        this.ctx.lineWidth = lineWidth;\r\n        this.ctx.lineCap = 'round';\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(startX, startY);\r\n        this.ctx.lineTo(currentEndX, currentEndY);\r\n        this.ctx.stroke();\r\n        \r\n        // Draw arrowhead for direction\r\n        if (drawProgress >= 0.7) {\r\n            this.drawSimpleArrowhead(currentEndX, currentEndY, angle, poleType);\r\n        }\r\n    }\r\n    \r\n    drawSimpleArrowhead(x, y, angle, poleType) {\r\n        const arrowLength = 10;\r\n        const arrowAngle = Math.PI / 6;\r\n        \r\n        // For North pole: arrows point outward\r\n        // For South pole: arrows point inward\r\n        const direction = poleType === 'north' ? angle : angle + Math.PI;\r\n        \r\n        // Calculate arrow points\r\n        const tipX = x + Math.cos(direction) * arrowLength;\r\n        const tipY = y + Math.sin(direction) * arrowLength;\r\n        \r\n        const leftX = x + Math.cos(direction + arrowAngle) * arrowLength * 0.6;\r\n        const leftY = y + Math.sin(direction + arrowAngle) * arrowLength * 0.6;\r\n        \r\n        const rightX = x + Math.cos(direction - arrowAngle) * arrowLength * 0.6;\r\n        const rightY = y + Math.sin(direction - arrowAngle) * arrowLength * 0.6;\r\n        \r\n        // Arrow color\r\n        const arrowColor = poleType === 'north' ? 'rgba(255, 107, 107, 0.9)' : 'rgba(102, 126, 234, 0.9)';\r\n        \r\n        this.ctx.fillStyle = arrowColor;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(tipX, tipY);\r\n        this.ctx.lineTo(leftX, leftY);\r\n        this.ctx.lineTo(rightX, rightY);\r\n        this.ctx.closePath();\r\n        this.ctx.fill();\r\n    }\r\n    \r\n\r\n    \r\n    drawInteractionFieldLines() {\r\n        // Get all North and South poles\r\n        const northPoles = this.magnets.filter(m => m.pole === 'north');\r\n        const southPoles = this.magnets.filter(m => m.pole === 'south');\r\n        \r\n        // Draw field lines between different magnets\r\n        northPoles.forEach(northPole => {\r\n            southPoles.forEach(southPole => {\r\n                // Only draw if they're from different magnets\r\n                if (northPole.magnetId !== southPole.magnetId) {\r\n                    const distance = Math.sqrt(\r\n                        Math.pow(northPole.x - southPole.x, 2) + \r\n                        Math.pow(northPole.y - southPole.y, 2)\r\n                    );\r\n                    \r\n                    // Only draw if magnets are reasonably close\r\n                    if (distance < 200 && distance > 60) {\r\n                        this.drawInteractionFieldLine(northPole, southPole);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    }\r\n    \r\n    drawInteractionFieldLine(northPole, southPole) {\r\n        const animationOffset = (this.time * 0.3) % 1; // Slower animation for interaction lines\r\n        \r\n        // Calculate the angle between the poles\r\n        const angle = Math.atan2(southPole.y - northPole.y, southPole.x - northPole.x);\r\n        \r\n        // Draw a simple straight line between poles for interactions\r\n        const startX = northPole.x;\r\n        const startY = northPole.y;\r\n        const endX = southPole.x;\r\n        const endY = southPole.y;\r\n        \r\n        // Animate the field line drawing\r\n        const animatedLength = 1 * animationOffset;\r\n        \r\n        // Calculate the actual end point based on animation\r\n        const actualEndX = startX + (endX - startX) * animatedLength;\r\n        const actualEndY = startY + (endY - startY) * animatedLength;\r\n        \r\n        // Draw the interaction line\r\n        this.ctx.shadowColor = 'rgba(255, 255, 255, 0.4)';\r\n        this.ctx.shadowBlur = 3;\r\n        this.ctx.strokeStyle = `rgba(255, 255, 255, 0.6)`;\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.lineCap = 'round';\r\n        this.ctx.lineJoin = 'round';\r\n        \r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(startX, startY);\r\n        this.ctx.lineTo(actualEndX, actualEndY);\r\n        this.ctx.stroke();\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Draw arrowhead at the end if animation is far enough\r\n        if (animatedLength > 0.1) {\r\n            const arrowAngle = Math.atan2(actualEndY - startY, actualEndX - startX);\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';\r\n            this.ctx.moveTo(actualEndX, actualEndY);\r\n            this.ctx.lineTo(actualEndX - 10 * Math.cos(arrowAngle - Math.PI / 6), \r\n                           actualEndY - 10 * Math.sin(arrowAngle - Math.PI / 6));\r\n            this.ctx.lineTo(actualEndX - 10 * Math.cos(arrowAngle + Math.PI / 6), \r\n                           actualEndY - 10 * Math.sin(arrowAngle + Math.PI / 6));\r\n            this.ctx.closePath();\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n    \r\n    drawMagnets() {\r\n        // Group magnets by magnetId to draw complete magnets\r\n        const magnetGroups = {};\r\n        this.magnets.forEach(magnet => {\r\n            if (!magnetGroups[magnet.magnetId]) {\r\n                magnetGroups[magnet.magnetId] = [];\r\n            }\r\n            magnetGroups[magnet.magnetId].push(magnet);\r\n        });\r\n        \r\n        // Draw each complete magnet\r\n        Object.values(magnetGroups).forEach(magnetGroup => {\r\n            if (magnetGroup.length === 2) {\r\n                const northPole = magnetGroup.find(m => m.pole === 'north');\r\n                const southPole = magnetGroup.find(m => m.pole === 'south');\r\n                \r\n                if (northPole && southPole) {\r\n                    // Draw magnet body with enhanced design\r\n                    this.drawMagnetBody(northPole, southPole);\r\n                }\r\n            }\r\n        });\r\n        \r\n        // Draw individual poles\r\n        this.magnets.forEach((magnet, index) => {\r\n            this.drawMagnetPole(magnet);\r\n        });\r\n    }\r\n    \r\n    drawMagnetBody(northPole, southPole) {\r\n        // Enhanced magnet body with gradient\r\n        const bodyGradient = this.ctx.createLinearGradient(\r\n            northPole.x, northPole.y, southPole.x, southPole.y\r\n        );\r\n        bodyGradient.addColorStop(0, '#ff6b6b');\r\n        bodyGradient.addColorStop(0.5, '#8b5cf6');\r\n        bodyGradient.addColorStop(1, '#667eea');\r\n        \r\n        // Main body with gradient\r\n        this.ctx.strokeStyle = bodyGradient;\r\n        this.ctx.lineWidth = 16;\r\n        this.ctx.lineCap = 'round';\r\n        this.ctx.lineJoin = 'round';\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(northPole.x, northPole.y);\r\n        this.ctx.lineTo(southPole.x, southPole.y);\r\n        this.ctx.stroke();\r\n        \r\n        // Body shadow\r\n        this.ctx.strokeStyle = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.lineWidth = 16;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(northPole.x + 3, northPole.y + 3);\r\n        this.ctx.lineTo(southPole.x + 3, southPole.y + 3);\r\n        this.ctx.stroke();\r\n        \r\n        // Body highlight\r\n        this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';\r\n        this.ctx.lineWidth = 4;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(northPole.x, northPole.y);\r\n        this.ctx.lineTo(southPole.x, southPole.y);\r\n        this.ctx.stroke();\r\n    }\r\n    \r\n    drawMagnetPole(magnet) {\r\n        // Enhanced pole design with multiple layers\r\n        const poleRadius = 18;\r\n        const innerRadius = 12;\r\n        \r\n        // Outer glow\r\n        this.ctx.shadowColor = magnet.pole === 'north' ? 'rgba(255, 107, 107, 0.6)' : 'rgba(102, 126, 234, 0.6)';\r\n        this.ctx.shadowBlur = 12;\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = magnet.pole === 'north' ? 'rgba(255, 107, 107, 0.4)' : 'rgba(102, 126, 234, 0.4)';\r\n        this.ctx.arc(magnet.x, magnet.y, poleRadius, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Main pole gradient\r\n        const poleGradient = this.ctx.createRadialGradient(\r\n            magnet.x - 6, magnet.y - 6, 0,\r\n            magnet.x, magnet.y, innerRadius\r\n        );\r\n        \r\n        if (magnet.pole === 'north') {\r\n            poleGradient.addColorStop(0, '#ff6b6b');\r\n            poleGradient.addColorStop(0.6, '#ff4757');\r\n            poleGradient.addColorStop(1, '#ff3838');\r\n        } else {\r\n            poleGradient.addColorStop(0, '#667eea');\r\n            poleGradient.addColorStop(0.6, '#5f6fd8');\r\n            poleGradient.addColorStop(1, '#5352ed');\r\n        }\r\n        \r\n        // Main pole circle\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = poleGradient;\r\n        this.ctx.arc(magnet.x, magnet.y, innerRadius, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Pole shadow\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.arc(magnet.x + 2, magnet.y + 2, innerRadius, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Pole highlight\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';\r\n        this.ctx.arc(magnet.x - 3, magnet.y - 3, 4, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Enhanced pole label\r\n        this.ctx.fillStyle = '#ffffff';\r\n        this.ctx.font = 'bold 18px Inter, Arial, sans-serif';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';\r\n        this.ctx.shadowBlur = 2;\r\n        this.ctx.fillText(magnet.pole === 'north' ? 'N' : 'S', magnet.x, magnet.y);\r\n        this.ctx.shadowBlur = 0;\r\n    }\r\n    \r\n    drawParticles() {\r\n        this.particles.forEach(particle => {\r\n            // Enhanced particle trail with gradient\r\n            if (particle.trail.length > 1) {\r\n                this.ctx.beginPath();\r\n                const trailGradient = this.ctx.createLinearGradient(\r\n                    particle.trail[0].x, particle.trail[0].y,\r\n                    particle.x, particle.y\r\n                );\r\n                trailGradient.addColorStop(0, particle.charge > 0 ? 'rgba(255, 100, 100, 0.2)' : 'rgba(100, 100, 255, 0.2)');\r\n                trailGradient.addColorStop(1, particle.charge > 0 ? 'rgba(255, 100, 100, 0.6)' : 'rgba(100, 100, 255, 0.6)');\r\n                \r\n                this.ctx.strokeStyle = trailGradient;\r\n                this.ctx.lineWidth = 3;\r\n                this.ctx.lineCap = 'round';\r\n                this.ctx.moveTo(particle.trail[0].x, particle.trail[0].y);\r\n                particle.trail.forEach(point => {\r\n                    this.ctx.lineTo(point.x, point.y);\r\n                });\r\n                this.ctx.stroke();\r\n            }\r\n            \r\n            // Enhanced particle with gradient and glow\r\n            const particleGradient = this.ctx.createRadialGradient(\r\n                particle.x - 3, particle.y - 3, 0,\r\n                particle.x, particle.y, 8\r\n            );\r\n            \r\n            if (particle.charge > 0) {\r\n                particleGradient.addColorStop(0, '#ff8a65');\r\n                particleGradient.addColorStop(0.7, '#ff6b6b');\r\n                particleGradient.addColorStop(1, '#ff4757');\r\n            } else {\r\n                particleGradient.addColorStop(0, '#8b9dc3');\r\n                particleGradient.addColorStop(0.7, '#667eea');\r\n                particleGradient.addColorStop(1, '#5f6fd8');\r\n            }\r\n            \r\n            // Glow effect\r\n            this.ctx.shadowColor = particle.charge > 0 ? 'rgba(255, 107, 107, 0.6)' : 'rgba(102, 126, 234, 0.6)';\r\n            this.ctx.shadowBlur = 6;\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = particleGradient;\r\n            this.ctx.arc(particle.x, particle.y, 6, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Reset shadow\r\n            this.ctx.shadowBlur = 0;\r\n            \r\n            // Modern shadow\r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';\r\n            this.ctx.arc(particle.x + 1, particle.y + 1, 6, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Enhanced charge symbol with modern styling\r\n            this.ctx.fillStyle = '#ffffff';\r\n            this.ctx.font = 'bold 14px Inter, Arial, sans-serif';\r\n            this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.textBaseline = 'middle';\r\n            this.ctx.fillText(particle.charge > 0 ? '+' : '−', particle.x, particle.y);\r\n        });\r\n    }\r\n    \r\n    drawForceArrows() {\r\n        this.particles.forEach(particle => {\r\n            const field = this.calculateMagneticField(particle.x, particle.y);\r\n            const forceX = particle.charge * particle.vy * field.By;\r\n            const forceY = -particle.charge * particle.vx * field.By;\r\n            const forceMagnitude = Math.sqrt(forceX * forceX + forceY * forceY);\r\n            \r\n            if (forceMagnitude > 5) {\r\n                const scale = 0.3;\r\n                const endX = particle.x + forceX * scale;\r\n                const endY = particle.y + forceY * scale;\r\n                \r\n                // Enhanced force arrow with gradient and glow\r\n                const arrowGradient = this.ctx.createLinearGradient(\r\n                    particle.x, particle.y, endX, endY\r\n                );\r\n                arrowGradient.addColorStop(0, '#ff9800');\r\n                arrowGradient.addColorStop(1, '#ff8c42');\r\n                \r\n                // Glow effect\r\n                this.ctx.shadowColor = 'rgba(255, 152, 0, 0.6)';\r\n                this.ctx.shadowBlur = 6;\r\n                this.ctx.strokeStyle = arrowGradient;\r\n                this.ctx.lineWidth = 4;\r\n                this.ctx.lineCap = 'round';\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(particle.x, particle.y);\r\n                this.ctx.lineTo(endX, endY);\r\n                this.ctx.stroke();\r\n                \r\n                // Reset shadow\r\n                this.ctx.shadowBlur = 0;\r\n                \r\n                // Enhanced arrowhead\r\n                const angle = Math.atan2(forceY, forceX);\r\n                this.ctx.beginPath();\r\n                this.ctx.fillStyle = arrowGradient;\r\n                this.ctx.moveTo(endX, endY);\r\n                this.ctx.lineTo(endX - 10 * Math.cos(angle - Math.PI / 6), endY - 10 * Math.sin(angle - Math.PI / 6));\r\n                this.ctx.lineTo(endX - 10 * Math.cos(angle + Math.PI / 6), endY - 10 * Math.sin(angle + Math.PI / 6));\r\n                this.ctx.closePath();\r\n                this.ctx.fill();\r\n            }\r\n        });\r\n    }\r\n    \r\n    drawInfo() {\r\n        // Enhanced modern info panel with gradient background\r\n        const panelWidth = 200;\r\n        const panelHeight = 120;\r\n        const panelX = this.ctx.canvas.width - panelWidth - 20;\r\n        const panelY = 20;\r\n        \r\n        // Panel background with gradient\r\n        const panelGradient = this.ctx.createLinearGradient(panelX, panelY, panelX, panelY + panelHeight);\r\n        panelGradient.addColorStop(0, 'rgba(24, 28, 43, 0.95)');\r\n        panelGradient.addColorStop(1, 'rgba(35, 41, 70, 0.95)');\r\n        \r\n        this.ctx.fillStyle = panelGradient;\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, panelHeight);\r\n        \r\n        // Panel border with glow\r\n        this.ctx.strokeStyle = 'rgba(255, 107, 107, 0.5)';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.strokeRect(panelX, panelY, panelWidth, panelHeight);\r\n        \r\n        // Panel title\r\n        this.ctx.fillStyle = '#ffffff';\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('Magnetic Field Analytics', panelX + 15, panelY + 25);\r\n        \r\n        // Analytics data with modern styling\r\n        this.ctx.fillStyle = '#e9ecef';\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillText(`Magnets: ${this.magnets.length}`, panelX + 15, panelY + 45);\r\n        this.ctx.fillText(`Particles: ${this.particles.length}`, panelX + 15, panelY + 65);\r\n        this.ctx.fillText(`Field Strength: ${this.fieldStrength.toFixed(1)}`, panelX + 15, panelY + 85);\r\n        \r\n        // Enhanced explanation banner at bottom\r\n        const bannerWidth = 380;\r\n        const bannerHeight = 45;\r\n        const bannerX = 10;\r\n        const bannerY = this.ctx.canvas.height - 60;\r\n        \r\n        // Banner background with gradient\r\n        const bannerGradient = this.ctx.createLinearGradient(bannerX, bannerY, bannerX, bannerY + bannerHeight);\r\n        bannerGradient.addColorStop(0, 'rgba(255, 255, 255, 0.95)');\r\n        bannerGradient.addColorStop(1, 'rgba(240, 240, 240, 0.95)');\r\n        \r\n        this.ctx.fillStyle = bannerGradient;\r\n        this.ctx.fillRect(bannerX, bannerY, bannerWidth, bannerHeight);\r\n        \r\n        // Banner border\r\n        this.ctx.strokeStyle = 'rgba(255, 107, 107, 0.6)';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeRect(bannerX, bannerY, bannerWidth, bannerHeight);\r\n        \r\n        // Banner text\r\n        this.ctx.fillStyle = '#1a1a2e';\r\n        this.ctx.font = 'bold 13px Inter, Arial, sans-serif';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('Red particles = Positive charge, Blue particles = Negative charge', bannerX + 12, bannerY + bannerHeight/2 - 8);\r\n        this.ctx.fillText('Click to add magnets, particles spiral around magnetic field lines', bannerX + 12, bannerY + bannerHeight/2 + 8);\r\n    }\r\n    \r\n    getStats() {\r\n        return {\r\n            magnetCount: this.magnets.length,\r\n            particleCount: this.particles.length,\r\n            fieldStrength: this.fieldStrength.toFixed(1),\r\n            time: this.time.toFixed(1)\r\n        };\r\n    }\r\n    \r\n    drawMagneticLabels() {\r\n        // Draw elegant labels on the canvas\r\n        this.ctx.save();\r\n        \r\n        // Set up text styling\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        \r\n        // Draw animation type label with enhanced styling\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        this.ctx.fillText('Magnetic Fields', this.ctx.canvas.width / 2, 30);\r\n        \r\n        // Draw mathematical formulas with enhanced styling\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';\r\n        this.ctx.fillText(`F = q(v × B)`, \r\n                          this.ctx.canvas.width / 2, 50);\r\n        \r\n        // Draw Lorentz force\r\n        this.ctx.fillText(`F = qvB sin θ`, \r\n                          this.ctx.canvas.width / 2, 70);\r\n        \r\n        // Draw magnetic field\r\n        this.ctx.fillText(`B = μ₀I/2πr`, \r\n                          this.ctx.canvas.width / 2, 90);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Draw interaction and magnet explanation banner\r\n        this.drawMagneticBanner();\r\n        \r\n        this.ctx.restore();\r\n    }\r\n    \r\n    drawMagneticBanner() {\r\n        // Create banner background with gradient\r\n        const bannerWidth = 400;\r\n        const bannerHeight = 50;\r\n        const bannerX = 10;\r\n        const bannerY = this.ctx.canvas.height - 65;\r\n        \r\n        // Banner background with gradient\r\n        const bannerGradient = this.ctx.createLinearGradient(bannerX, bannerY, bannerX, bannerY + bannerHeight);\r\n        bannerGradient.addColorStop(0, 'rgba(255, 255, 255, 0.95)');\r\n        bannerGradient.addColorStop(1, 'rgba(240, 240, 240, 0.95)');\r\n        \r\n        this.ctx.fillStyle = bannerGradient;\r\n        this.ctx.fillRect(bannerX, bannerY, bannerWidth, bannerHeight);\r\n        \r\n        // Banner border with glow\r\n        this.ctx.shadowColor = 'rgba(255, 107, 107, 0.6)';\r\n        this.ctx.shadowBlur = 4;\r\n        this.ctx.strokeStyle = 'rgba(255, 107, 107, 0.8)';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeRect(bannerX, bannerY, bannerWidth, bannerHeight);\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Banner text\r\n        this.ctx.fillStyle = '#1a1a2e';\r\n        this.ctx.font = 'bold 13px Inter, Arial, sans-serif';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('Click to add complete magnets (N-S pairs)', bannerX + 12, bannerY + bannerHeight/2 - 8);\r\n        this.ctx.fillText('Red particles = Positive charge, Blue particles = Negative charge', bannerX + 12, bannerY + bannerHeight/2 + 8);\r\n        \r\n        // Add small magnet icon\r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = 'rgba(255, 107, 107, 0.4)';\r\n        this.ctx.arc(bannerX + 370, bannerY + bannerHeight/2, 6, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        this.ctx.beginPath();\r\n        this.ctx.fillStyle = '#ff6b6b';\r\n        this.ctx.arc(bannerX + 370, bannerY + bannerHeight/2, 3, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Add N label to magnet icon\r\n        this.ctx.fillStyle = '#ffffff';\r\n        this.ctx.font = 'bold 10px Inter, Arial, sans-serif';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('N', bannerX + 370, bannerY + bannerHeight/2);\r\n    }\r\n}\r\n\r\nexport class DiodeTransistor {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.componentType = 'diode'; // 'diode', 'npn', 'pnp'\r\n        this.biasType = 'forward'; // 'forward', 'reverse', 'off'\r\n        this.inputVoltage = 5; // Volts\r\n        this.baseVoltage = 0.7; // Volts for transistor\r\n        this.current = 0; // mA\r\n        this.power = 0; // mW\r\n        this.temperature = 25; // Celsius\r\n        this.showElectrons = true;\r\n        this.showCurrent = true;\r\n        this.showVoltage = true;\r\n        this.animationSpeed = 1.0;\r\n        this.time = 0;\r\n        this.isActive = false;\r\n        \r\n        // Scientific accuracy notes:\r\n        // - Diode: P-N junction with proper forward/reverse bias behavior\r\n        // - NPN: N-P-N with electron flow from emitter to collector\r\n        // - PNP: P-N-P with hole flow from emitter to collector\r\n        // - Current calculations use realistic transistor parameters (beta values)\r\n        // - Voltage drops follow standard semiconductor physics\r\n        \r\n        // Component positions\r\n        this.componentX = this.ctx.canvas.width / 2;\r\n        this.componentY = this.ctx.canvas.height / 2;\r\n        this.batteryX = this.componentX - 250;\r\n        this.batteryY = this.componentY;\r\n        this.loadX = this.componentX + 250;\r\n        this.loadY = this.componentY;\r\n        \r\n        // Enhanced particle systems\r\n        this.electrons = [];\r\n        this.holes = [];\r\n        this.sparks = [];\r\n        this.energyWaves = [];\r\n        this.initializeParticles();\r\n        \r\n        // Visual effects\r\n        this.glowIntensity = 0;\r\n        this.pulsePhase = 0;\r\n        this.energyParticles = [];\r\n    }\r\n    \r\n    initializeParticles() {\r\n        this.electrons = [];\r\n        this.holes = [];\r\n        this.sparks = [];\r\n        this.energyWaves = [];\r\n        this.energyParticles = [];\r\n        \r\n        // Create electron particles for N-type material (right side of diode)\r\n        for (let i = 0; i < 30; i++) {\r\n            this.electrons.push({\r\n                x: this.componentX + 50 + Math.random() * 100, // N-region (cathode)\r\n                y: this.componentY - 40 + Math.random() * 80,\r\n                vx: 0,\r\n                vy: 0,\r\n                size: 3.5 + Math.random() * 1.2, // Slightly larger electrons\r\n                color: '#00AAFF',\r\n                glow: 0,\r\n                trail: [],\r\n                active: false\r\n            });\r\n        }\r\n        \r\n        // Create hole particles for P-type material (left side of diode)\r\n        for (let i = 0; i < 30; i++) {\r\n            this.holes.push({\r\n                x: this.componentX - 150 + Math.random() * 100, // P-region (anode)\r\n                y: this.componentY - 40 + Math.random() * 80,\r\n                vx: 0,\r\n                vy: 0,\r\n                size: 3.5 + Math.random() * 1.2, // Slightly larger holes\r\n                color: '#FF4444',\r\n                glow: 0,\r\n                trail: [],\r\n                active: false\r\n            });\r\n        }\r\n        \r\n        // Create energy particles\r\n        for (let i = 0; i < 15; i++) {\r\n            this.energyParticles.push({\r\n                x: this.componentX - 100 + Math.random() * 200,\r\n                y: this.componentY - 60 + Math.random() * 120,\r\n                vx: (Math.random() - 0.5) * 2,\r\n                vy: (Math.random() - 0.5) * 2,\r\n                size: 1.8 + Math.random() * 0.7,\r\n                color: '#FFFF00',\r\n                life: 1.0,\r\n                decay: 0.02\r\n            });\r\n        }\r\n    }\r\n    \r\n    setComponentType(type) {\r\n        this.componentType = type;\r\n        this.initializeParticles();\r\n        this.calculateCurrent();\r\n        \r\n        // Force immediate visual update\r\n        this.time = 0; // Reset animation time for immediate effect\r\n    }\r\n    \r\n    setBiasType(bias) {\r\n        this.biasType = bias;\r\n        this.calculateCurrent();\r\n        \r\n        // Force immediate visual update\r\n        this.time = 0; // Reset animation time for immediate effect\r\n    }\r\n    \r\n    setInputVoltage(voltage) {\r\n        this.inputVoltage = voltage;\r\n        this.calculateCurrent();\r\n        \r\n        // Force immediate visual update\r\n        this.time = 0; // Reset animation time for immediate effect\r\n    }\r\n    \r\n    setBaseVoltage(voltage) {\r\n        this.baseVoltage = voltage;\r\n        this.calculateCurrent();\r\n        \r\n        // Force immediate visual update\r\n        this.time = 0; // Reset animation time for immediate effect\r\n    }\r\n    \r\n    setShowElectrons(show) {\r\n        this.showElectrons = show;\r\n    }\r\n    \r\n    setShowCurrent(show) {\r\n        this.showCurrent = show;\r\n    }\r\n    \r\n    setShowVoltage(show) {\r\n        this.showVoltage = show;\r\n    }\r\n    \r\n    setAnimationSpeed(speed) {\r\n        this.animationSpeed = speed;\r\n    }\r\n    \r\n    calculateCurrent() {\r\n        if (this.componentType === 'diode') {\r\n            if (this.biasType === 'forward' && this.inputVoltage > 0.7) {\r\n                // Diode forward current: exponential relationship with voltage\r\n                const voltageDrop = this.inputVoltage - 0.7;\r\n                this.current = Math.exp(voltageDrop * 2) * 5; // Exponential current increase\r\n                this.power = this.current * 0.7;\r\n                this.isActive = true;\r\n                this.temperature = 25 + this.current * 0.5;\r\n            } else if (this.biasType === 'reverse') {\r\n                // Diode reverse leakage current (very small)\r\n                this.current = 0.001; // 1μA leakage\r\n                this.power = this.current * this.inputVoltage;\r\n                this.isActive = false;\r\n                this.temperature = 25;\r\n            } else {\r\n                this.current = 0;\r\n                this.power = 0;\r\n                this.isActive = false;\r\n                this.temperature = 25;\r\n            }\r\n        } else if (this.componentType === 'npn') {\r\n            if (this.biasType === 'forward' && this.baseVoltage > 0.7) {\r\n                // NPN transistor: base current controls collector current\r\n                const baseCurrent = (this.baseVoltage - 0.7) * 10; // Base current\r\n                const beta = 100; // Current gain (typical value)\r\n                this.current = baseCurrent * beta; // Collector current\r\n                this.power = this.current * this.inputVoltage;\r\n                this.isActive = true;\r\n                this.temperature = 25 + this.current * 0.3;\r\n            } else {\r\n                this.current = 0;\r\n                this.power = 0;\r\n                this.isActive = false;\r\n                this.temperature = 25;\r\n            }\r\n        } else if (this.componentType === 'pnp') {\r\n            if (this.biasType === 'forward' && this.baseVoltage > 0.7) {\r\n                // PNP transistor: base current controls collector current (negative voltages)\r\n                const baseCurrent = (this.baseVoltage - 0.7) * 8; // Base current\r\n                const beta = 80; // Current gain (slightly lower for PNP)\r\n                this.current = baseCurrent * beta; // Collector current\r\n                this.power = this.current * this.inputVoltage;\r\n                this.isActive = true;\r\n                this.temperature = 25 + this.current * 0.4;\r\n            } else {\r\n                this.current = 0;\r\n                this.power = 0;\r\n                this.isActive = false;\r\n                this.temperature = 25;\r\n            }\r\n        }\r\n    }\r\n    \r\n    reset() {\r\n        this.time = 0;\r\n        this.current = 0;\r\n        this.power = 0;\r\n        this.isActive = false;\r\n        this.glowIntensity = 0;\r\n        this.pulsePhase = 0;\r\n        this.initializeParticles();\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        this.time += deltaTime * this.animationSpeed;\r\n        this.calculateCurrent();\r\n        \r\n        // Update glow and pulse effects\r\n        this.glowIntensity = this.isActive ? Math.sin(this.time * 0.005) * 0.3 + 0.7 : 0;\r\n        this.pulsePhase = this.time * 0.01;\r\n        \r\n        // Update particle movement based on component type\r\n        if (this.isActive && this.showElectrons) {\r\n            if (this.componentType === 'diode') {\r\n                // Diode: show both electrons and holes\r\n                this.updateDiodeParticles();\r\n            } else if (this.componentType === 'npn') {\r\n                // NPN: emphasize electron flow from emitter to collector\r\n                this.updateNPNParticles();\r\n            } else if (this.componentType === 'pnp') {\r\n                // PNP: emphasize hole flow from emitter to collector\r\n                this.updatePNPParticles();\r\n            }\r\n        }\r\n        \r\n        // Update energy particles\r\n        this.energyParticles.forEach(particle => {\r\n            particle.x += particle.vx;\r\n            particle.y += particle.vy;\r\n            particle.life -= particle.decay;\r\n            \r\n            // Bounce off boundaries\r\n            if (particle.x < 0 || particle.x > this.ctx.canvas.width) particle.vx *= -1;\r\n            if (particle.y < 0 || particle.y > this.ctx.canvas.height) particle.vy *= -1;\r\n            \r\n            // Reset when life is over\r\n            if (particle.life <= 0) {\r\n                particle.x = this.componentX - 100 + Math.random() * 200;\r\n                particle.y = this.componentY - 60 + Math.random() * 120;\r\n                particle.life = 1.0;\r\n            }\r\n        });\r\n        \r\n        // Add sparks when current is high\r\n        if (this.isActive && this.current > 10 && Math.random() < 0.1) {\r\n            this.sparks.push({\r\n                x: this.componentX + Math.random() * 100 - 50,\r\n                y: this.componentY + Math.random() * 60 - 30,\r\n                vx: (Math.random() - 0.5) * 10,\r\n                vy: (Math.random() - 0.5) * 10,\r\n                life: 1.0,\r\n                color: '#FFFF00'\r\n            });\r\n        }\r\n        \r\n        // Update sparks\r\n        this.sparks.forEach((spark, index) => {\r\n            spark.x += spark.vx;\r\n            spark.y += spark.vy;\r\n            spark.life -= 0.05;\r\n            if (spark.life <= 0) {\r\n                this.sparks.splice(index, 1);\r\n            }\r\n        });\r\n    }\r\n    \r\n    render() {\r\n        this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n        \r\n        this.drawBackground();\r\n        this.drawEnergyField();\r\n        this.drawBattery();\r\n        this.drawComponent();\r\n        this.drawLoad();\r\n        this.drawParticles();\r\n        this.drawSparks();\r\n        this.drawCurrentFlow();\r\n        this.drawInfo();\r\n        this.drawInstructions();\r\n    }\r\n    \r\n    drawBackground() {\r\n        // Create dynamic dark sci-fi background with animated gradient\r\n        const time = this.time * 0.001;\r\n        const gradient = this.ctx.createLinearGradient(0, 0, 0, this.ctx.canvas.height);\r\n        gradient.addColorStop(0, `hsl(${240 + Math.sin(time) * 10}, 70%, 15%)`);\r\n        gradient.addColorStop(1, `hsl(${250 + Math.cos(time) * 10}, 80%, 10%)`);\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n        \r\n        // Draw animated circuit board pattern\r\n        this.ctx.strokeStyle = `rgba(0, 255, 255, ${0.1 + Math.sin(time * 2) * 0.05})`;\r\n        this.ctx.lineWidth = 1;\r\n        \r\n        // Horizontal lines with pulse effect\r\n        for (let y = 0; y < this.ctx.canvas.height; y += 40) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(0, y + Math.sin(time + y * 0.01) * 2);\r\n            this.ctx.lineTo(this.ctx.canvas.width, y + Math.sin(time + y * 0.01) * 2);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Vertical lines with pulse effect\r\n        for (let x = 0; x < this.ctx.canvas.width; x += 40) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x + Math.cos(time + x * 0.01) * 2, 0);\r\n            this.ctx.lineTo(x + Math.cos(time + x * 0.01) * 2, this.ctx.canvas.height);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Add floating energy particles in background\r\n        for (let i = 0; i < 20; i++) {\r\n            const x = (i * 37) % this.ctx.canvas.width;\r\n            const y = (i * 23) % this.ctx.canvas.height;\r\n            const alpha = 0.1 + Math.sin(time * 3 + i) * 0.05;\r\n            this.ctx.fillStyle = `rgba(0, 255, 255, ${alpha})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(x, y, 1, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n    \r\n    drawEnergyField() {\r\n        if (this.isActive) {\r\n            const time = this.time * 0.001;\r\n            \r\n            // Draw multiple energy field layers with different effects\r\n            for (let i = 0; i < 3; i++) {\r\n                const radius = 120 + i * 30;\r\n                const alpha = (this.glowIntensity * 0.2) / (i + 1);\r\n                const pulse = Math.sin(time * 5 + i) * 0.1;\r\n                \r\n                const gradient = this.ctx.createRadialGradient(\r\n                    this.componentX, this.componentY, 0,\r\n                    this.componentX, this.componentY, radius\r\n                );\r\n                gradient.addColorStop(0, `rgba(0, 255, 255, ${alpha + pulse})`);\r\n                gradient.addColorStop(0.7, `rgba(0, 255, 255, ${alpha * 0.3})`);\r\n                gradient.addColorStop(1, 'rgba(0, 255, 255, 0)');\r\n                \r\n                this.ctx.fillStyle = gradient;\r\n                this.ctx.fillRect(this.componentX - radius, this.componentY - radius, radius * 2, radius * 2);\r\n            }\r\n            \r\n            // Draw energy waves radiating from component\r\n            for (let i = 0; i < 5; i++) {\r\n                const waveRadius = 50 + i * 20 + Math.sin(time * 3 + i) * 10;\r\n                const waveAlpha = (0.3 - i * 0.05) * this.glowIntensity;\r\n                \r\n                this.ctx.strokeStyle = `rgba(0, 255, 255, ${waveAlpha})`;\r\n                this.ctx.lineWidth = 2;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(this.componentX, this.componentY, waveRadius, 0, Math.PI * 2);\r\n                this.ctx.stroke();\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawBattery() {\r\n        const time = this.time * 0.001;\r\n        \r\n        // Draw battery with enhanced glow effect when active\r\n        const glowColor = this.isActive ? `rgba(76, 175, 80, ${0.8 + this.glowIntensity * 0.2})` : '#4CAF50';\r\n        this.ctx.fillStyle = glowColor;\r\n        this.ctx.fillRect(this.batteryX - 25, this.batteryY - 35, 50, 70);\r\n        \r\n        // Add metallic shine with animation\r\n        this.ctx.fillStyle = `rgba(255, 255, 255, ${0.3 + Math.sin(time * 2) * 0.1})`;\r\n        this.ctx.fillRect(this.batteryX - 20, this.batteryY - 30, 40, 5);\r\n        \r\n        // Draw battery terminals with enhanced metallic effect\r\n        this.ctx.fillStyle = '#888';\r\n        this.ctx.fillRect(this.batteryX - 8, this.batteryY - 45, 16, 12);\r\n        this.ctx.fillRect(this.batteryX - 8, this.batteryY + 33, 16, 12);\r\n        \r\n        // Add terminal shine\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';\r\n        this.ctx.fillRect(this.batteryX - 6, this.batteryY - 43, 12, 3);\r\n        this.ctx.fillRect(this.batteryX - 6, this.batteryY + 35, 12, 3);\r\n        \r\n        // Draw voltage label with pulsing glow\r\n        const labelGlow = this.isActive ? Math.sin(time * 3) * 0.3 + 0.7 : 0.7;\r\n        this.ctx.fillStyle = this.isActive ? `rgba(255, 255, 0, ${labelGlow})` : 'white';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText(`${this.inputVoltage}V`, this.batteryX, this.batteryY + 60);\r\n        \r\n        // Draw polarity with enhanced colors and glow\r\n        this.ctx.fillStyle = this.isActive ? `rgba(255, 102, 102, ${0.8 + this.glowIntensity})` : '#FF6666';\r\n        this.ctx.font = 'bold 20px Arial';\r\n        this.ctx.fillText('+', this.batteryX - 20, this.batteryY - 5);\r\n        \r\n        this.ctx.fillStyle = this.isActive ? `rgba(102, 102, 255, ${0.8 + this.glowIntensity})` : '#6666FF';\r\n        this.ctx.fillText('-', this.batteryX + 20, this.batteryY + 15);\r\n        \r\n        // Add energy indicator when active\r\n        if (this.isActive) {\r\n            this.ctx.fillStyle = `rgba(0, 255, 0, ${this.glowIntensity})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(this.batteryX, this.batteryY, 30, 0, Math.PI * 2);\r\n            this.ctx.stroke();\r\n        }\r\n    }\r\n    \r\n    drawComponent() {\r\n        if (this.componentType === 'diode') {\r\n            this.drawDiode();\r\n        } else {\r\n            this.drawTransistor();\r\n        }\r\n    }\r\n    \r\n    drawDiode() {\r\n        const time = this.time * 0.001;\r\n        const x = this.componentX;\r\n        const y = this.componentY;\r\n        const size = 40;\r\n        \r\n        // Determine visual state based on bias type\r\n        const isForward = this.biasType === 'forward';\r\n        const isReverse = this.biasType === 'reverse';\r\n        const glow = this.isActive ? this.glowIntensity : 0;\r\n        \r\n        // Enhanced glow effects with pulsing\r\n        const pulseEffect = Math.sin(time * 3) * 0.2;\r\n        const glowColor = isForward ? '#00FF00' : isReverse ? '#FF0000' : '#FFFF00';\r\n        const glowIntensity = isForward ? glow * (1 + pulseEffect) : isReverse ? glow * 0.3 : 0;\r\n        \r\n        // Apply enhanced shadow effect\r\n        this.ctx.shadowColor = this.isActive ? glowColor : 'transparent';\r\n        this.ctx.shadowBlur = this.isActive ? 15 + glowIntensity * 10 : 0;\r\n        \r\n        // Draw diode symbol with enhanced styling\r\n        const symbolColor = this.isActive ? `rgba(255, 255, 0, ${0.9 + glowIntensity})` : '#FFFFFF';\r\n        \r\n        // Triangle (anode) with gradient effect\r\n        this.ctx.fillStyle = symbolColor;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x - size, y);\r\n        this.ctx.lineTo(x - size/3, y - size/2);\r\n        this.ctx.lineTo(x - size/3, y + size/2);\r\n        this.ctx.closePath();\r\n        this.ctx.fill();\r\n        \r\n        // Add metallic shine to triangle\r\n        if (this.isActive) {\r\n            this.ctx.fillStyle = `rgba(255, 255, 255, ${0.3 + pulseEffect})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x - size + 5, y - size/3);\r\n            this.ctx.lineTo(x - size/3, y);\r\n            this.ctx.lineTo(x - size + 5, y + size/3);\r\n            this.ctx.closePath();\r\n            this.ctx.fill();\r\n        }\r\n        \r\n        // Bar (cathode) with enhanced styling\r\n        this.ctx.strokeStyle = symbolColor;\r\n        this.ctx.lineWidth = 8;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x + size/3, y - size/2);\r\n        this.ctx.lineTo(x + size/3, y + size/2);\r\n        this.ctx.stroke();\r\n        \r\n        // Leads with enhanced styling\r\n        this.ctx.strokeStyle = symbolColor;\r\n        this.ctx.lineWidth = 6;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x - size - 25, y);\r\n        this.ctx.lineTo(x - size, y);\r\n        this.ctx.moveTo(x + size/3 + 25, y);\r\n        this.ctx.lineTo(x + size/3, y);\r\n        this.ctx.stroke();\r\n        \r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Enhanced labels with better positioning\r\n        this.drawComponentLabel('DIODE', x, y + size + 35, time);\r\n        this.drawBiasIndicator(this.biasType, x, y - size - 25, glowIntensity);\r\n        \r\n        // Enhanced current flow indicators with animation\r\n        if (this.isActive) {\r\n            if (isForward) {\r\n                this.drawCurrentFlow(x - size - 45, x + size/3 + 45, y, y, 'forward', glow);\r\n                this.drawVoltageDrop(x, y - size/2 - 15, '0.7V', glow);\r\n            } else if (isReverse) {\r\n                this.drawCurrentFlow(x - size - 45, x + size/3 + 45, y, y, 'reverse', glow);\r\n                this.drawVoltageDrop(x, y - size/2 - 15, 'BLOCKED', glow);\r\n            }\r\n        }\r\n        \r\n        // Add junction glow effect for forward bias\r\n        if (this.isActive && isForward) {\r\n            this.ctx.fillStyle = `rgba(0, 255, 0, ${0.3 + pulseEffect})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(x - size/3, y, 8, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n    \r\n    drawTransistor() {\r\n        const time = this.time * 0.001;\r\n        const x = this.componentX;\r\n        const y = this.componentY;\r\n        const radius = 35;\r\n        const leadLength = 25;\r\n        \r\n        // Determine visual state based on bias type\r\n        const isForward = this.biasType === 'forward';\r\n        const isReverse = this.biasType === 'reverse';\r\n        const glow = this.isActive ? this.glowIntensity : 0;\r\n        \r\n        // Enhanced glow effects with pulsing\r\n        const pulseEffect = Math.sin(time * 3) * 0.2;\r\n        const glowColor = isForward ? '#00FF00' : isReverse ? '#FF0000' : '#FFFF00';\r\n        const glowIntensity = isForward ? glow * (1 + pulseEffect) : isReverse ? glow * 0.3 : 0;\r\n        \r\n        // Apply enhanced shadow effect\r\n        this.ctx.shadowColor = this.isActive ? glowColor : 'transparent';\r\n        this.ctx.shadowBlur = this.isActive ? 15 + glowIntensity * 10 : 0;\r\n        \r\n        // Draw transistor symbol with enhanced styling\r\n        const symbolColor = this.isActive ? `rgba(255, 255, 0, ${0.9 + glowIntensity})` : '#FFFFFF';\r\n        \r\n        // Circle (transistor body) with enhanced styling\r\n        this.ctx.strokeStyle = symbolColor;\r\n        this.ctx.lineWidth = 6;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(x, y, radius, 0, 2 * Math.PI);\r\n        this.ctx.stroke();\r\n        \r\n        // Add inner glow for active state\r\n        if (this.isActive) {\r\n            this.ctx.fillStyle = `rgba(255, 255, 0, ${0.1 + pulseEffect})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(x, y, radius - 2, 0, 2 * Math.PI);\r\n            this.ctx.fill();\r\n        }\r\n        \r\n        // Enhanced leads with better styling\r\n        this.ctx.lineWidth = 6;\r\n        this.drawTransistorLeads(x, y, radius, leadLength, symbolColor);\r\n        \r\n        // Enhanced emitter arrow\r\n        this.drawEmitterArrow(x, y, radius, symbolColor);\r\n        \r\n        // Enhanced lead labels\r\n        this.drawLeadLabels(x, y, radius, leadLength, symbolColor);\r\n        \r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Enhanced labels with better positioning\r\n        this.drawComponentLabel(this.componentType.toUpperCase(), x, y + radius + leadLength + 55, time);\r\n        this.drawBiasIndicator(this.biasType, x, y - radius - leadLength - 35, glowIntensity);\r\n        \r\n        // Enhanced current flow indicators with voltage drops\r\n        if (this.isActive) {\r\n            if (isForward) {\r\n                // Different current flow direction for NPN vs PNP\r\n                if (this.componentType === 'npn') {\r\n                    // NPN: electrons flow from emitter to collector\r\n                    this.drawCurrentFlow(x, x, y + radius + leadLength + 25, y - radius - leadLength - 25, 'forward', glow);\r\n                    this.drawVoltageDrop(x, y - radius - 15, 'Vbe: 0.7V', glow);\r\n                    this.drawVoltageDrop(x, y + radius + 15, 'Vce: 0.2V', glow);\r\n                } else if (this.componentType === 'pnp') {\r\n                    // PNP: holes flow from emitter to collector\r\n                    this.drawCurrentFlow(x, x, y - radius - leadLength - 25, y + radius + leadLength + 25, 'forward', glow);\r\n                    this.drawVoltageDrop(x, y - radius - 15, 'Vbe: -0.7V', glow);\r\n                    this.drawVoltageDrop(x, y + radius + 15, 'Vce: -0.2V', glow);\r\n                }\r\n            } else if (isReverse) {\r\n                this.drawCurrentFlow(x, x, y - radius - leadLength - 25, y + radius + leadLength + 25, 'reverse', glow);\r\n                this.drawVoltageDrop(x, y - radius - 15, 'BLOCKED', glow);\r\n            }\r\n        }\r\n        \r\n        // Add base current indicator for forward bias\r\n        if (this.isActive && isForward) {\r\n            const baseCurrentColor = this.componentType === 'npn' ? \r\n                `rgba(0, 255, 255, ${0.5 + pulseEffect})` : \r\n                `rgba(255, 100, 100, ${0.5 + pulseEffect})`;\r\n            \r\n            this.ctx.strokeStyle = baseCurrentColor;\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.setLineDash([3, 3]);\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x - radius - leadLength - 10, y);\r\n            this.ctx.lineTo(x - radius, y);\r\n            this.ctx.stroke();\r\n            this.ctx.setLineDash([]);\r\n        }\r\n        \r\n        // Add transistor type indicator\r\n        if (this.isActive) {\r\n            const typeColor = this.componentType === 'npn' ? '#00AAFF' : '#FF4444';\r\n            this.ctx.fillStyle = `rgba(0, 0, 0, 0.7)`;\r\n            this.ctx.fillRect(x - 30, y - radius - 45, 60, 20);\r\n            this.ctx.fillStyle = typeColor;\r\n            this.ctx.font = 'bold 10px Arial';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.fillText(this.componentType.toUpperCase(), x, y - radius - 35);\r\n        }\r\n    }\r\n    \r\n    // Helper methods for drawing components\r\n    drawComponentLabel(text, x, y, time) {\r\n        const labelGlow = this.isActive ? Math.sin(time * 2) * 0.3 + 0.7 : 0.7;\r\n        this.ctx.fillStyle = this.isActive ? `rgba(255, 255, 0, ${labelGlow})` : 'white';\r\n        this.ctx.font = 'bold 18px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText(text, x, y);\r\n    }\r\n    \r\n    drawBiasIndicator(biasType, x, y, glowIntensity) {\r\n        const biasText = biasType.toUpperCase();\r\n        const biasColor = biasType === 'forward' ? '#00FF00' : \r\n                         biasType === 'reverse' ? '#FF0000' : '#FFFF00';\r\n        this.ctx.fillStyle = this.isActive ? `rgba(0, 255, 0, ${0.8 + glowIntensity})` : biasColor;\r\n        this.ctx.font = 'bold 14px Arial';\r\n        this.ctx.fillText(biasText, x, y);\r\n    }\r\n    \r\n    drawCurrentFlow(x1, x2, y1, y2, type, glow) {\r\n        const isForward = type === 'forward';\r\n        const color = isForward ? `rgba(0, 255, 255, ${glow})` : `rgba(255, 0, 0, ${glow * 0.5})`;\r\n        const dash = isForward ? [5, 5] : [3, 3];\r\n        \r\n        this.ctx.strokeStyle = color;\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.setLineDash(dash);\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x1, y1);\r\n        this.ctx.lineTo(x2, y2);\r\n        this.ctx.stroke();\r\n        this.ctx.setLineDash([]);\r\n    }\r\n    \r\n    drawTransistorLeads(x, y, radius, leadLength, color) {\r\n        this.ctx.strokeStyle = color;\r\n        \r\n        // Collector lead (top)\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x, y - radius);\r\n        this.ctx.lineTo(x, y - radius - leadLength);\r\n        this.ctx.stroke();\r\n        \r\n        // Base lead (middle)\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x - radius, y);\r\n        this.ctx.lineTo(x - radius - leadLength, y);\r\n        this.ctx.stroke();\r\n        \r\n        // Emitter lead (bottom)\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x, y + radius);\r\n        this.ctx.lineTo(x, y + radius + leadLength);\r\n        this.ctx.stroke();\r\n    }\r\n    \r\n    drawEmitterArrow(x, y, radius, color) {\r\n        this.ctx.fillStyle = color;\r\n        \r\n        if (this.componentType === 'npn') {\r\n            // NPN: arrow pointing outward from emitter (electron flow)\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x - 8, y + radius - 15);\r\n            this.ctx.lineTo(x + 8, y + radius - 15);\r\n            this.ctx.lineTo(x, y + radius - 5);\r\n            this.ctx.closePath();\r\n            this.ctx.fill();\r\n        } else if (this.componentType === 'pnp') {\r\n            // PNP: arrow pointing inward to emitter (hole flow)\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x - 8, y + radius + 5);\r\n            this.ctx.lineTo(x + 8, y + radius + 5);\r\n            this.ctx.lineTo(x, y + radius + 15);\r\n            this.ctx.closePath();\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n    \r\n    drawLeadLabels(x, y, radius, leadLength, color) {\r\n        this.ctx.fillStyle = color;\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('C', x, y - radius - leadLength - 10);\r\n        this.ctx.fillText('B', x - radius - leadLength - 10, y);\r\n        this.ctx.fillText('E', x, y + radius + leadLength + 20);\r\n    }\r\n    \r\n    drawVoltageDrop(x, y, text, glow) {\r\n        this.ctx.fillStyle = `rgba(255, 255, 0, ${0.8 + glow})`;\r\n        this.ctx.font = 'bold 10px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText(text, x, y);\r\n    }\r\n    \r\n    updateDiodeParticles() {\r\n        // Diode: show electrons and holes moving in opposite directions during forward bias\r\n        // Electrons: N-side (cathode) to P-side (anode) - right to left\r\n        // Holes: P-side (anode) to N-side (cathode) - left to right\r\n        // Both contribute to current flow in the same direction\r\n        this.electrons.forEach((electron, index) => {\r\n            if (this.biasType === 'forward') {\r\n                // Electrons flow from N-side (cathode) to P-side (anode) - right to left\r\n                electron.vx = -3 + Math.sin(this.time * 0.02 + index * 0.5) * 1.5;\r\n                electron.vy = Math.sin(this.time * 0.03 + index) * 0.5;\r\n                electron.x += electron.vx;\r\n                electron.y += electron.vy;\r\n                electron.glow = Math.sin(this.time * 0.1 + index) * 0.5 + 0.5;\r\n                \r\n                electron.trail.push({x: electron.x, y: electron.y, alpha: 1.0});\r\n                if (electron.trail.length > 5) electron.trail.shift();\r\n                \r\n                if (electron.x < this.componentX - 200) {\r\n                    electron.x = this.componentX + 100;\r\n                    electron.y = this.componentY - 40 + Math.random() * 80;\r\n                }\r\n            } else if (this.biasType === 'reverse') {\r\n                // Minimal reverse leakage current\r\n                electron.vx = 0.1 + Math.sin(this.time * 0.01 + index * 0.5) * 0.05;\r\n                electron.vy = Math.sin(this.time * 0.02 + index) * 0.1;\r\n                electron.x += electron.vx;\r\n                electron.y += electron.vy;\r\n                electron.glow = 0.1;\r\n                \r\n                electron.trail.push({x: electron.x, y: electron.y, alpha: 0.3});\r\n                if (electron.trail.length > 3) electron.trail.shift();\r\n                \r\n                if (electron.x > this.componentX + 200) {\r\n                    electron.x = this.componentX - 100;\r\n                    electron.y = this.componentY - 40 + Math.random() * 80;\r\n                }\r\n            } else {\r\n                electron.vx = 0; electron.vy = 0; electron.glow = 0; electron.trail = [];\r\n            }\r\n        });\r\n        \r\n        this.holes.forEach((hole, index) => {\r\n            if (this.biasType === 'forward') {\r\n                // Holes flow from P-side (anode) to N-side (cathode) - left to right\r\n                hole.vx = 2.5 + Math.sin(this.time * 0.02 + index * 0.5) * 1.2;\r\n                hole.vy = Math.sin(this.time * 0.03 + index) * 0.5;\r\n                hole.x += hole.vx;\r\n                hole.y += hole.vy;\r\n                hole.glow = Math.sin(this.time * 0.1 + index) * 0.5 + 0.5;\r\n                \r\n                hole.trail.push({x: hole.x, y: hole.y, alpha: 1.0});\r\n                if (hole.trail.length > 5) hole.trail.shift();\r\n                \r\n                if (hole.x > this.componentX + 200) {\r\n                    hole.x = this.componentX - 100;\r\n                    hole.y = this.componentY - 40 + Math.random() * 80;\r\n                }\r\n            } else if (this.biasType === 'reverse') {\r\n                // Minimal reverse leakage current\r\n                hole.vx = 0.1 + Math.sin(this.time * 0.01 + index * 0.5) * 0.05;\r\n                hole.vy = Math.sin(this.time * 0.02 + index) * 0.1;\r\n                hole.x += hole.vx;\r\n                hole.y += hole.vy;\r\n                hole.glow = 0.1;\r\n                \r\n                hole.trail.push({x: hole.x, y: hole.y, alpha: 0.3});\r\n                if (hole.trail.length > 3) hole.trail.shift();\r\n                \r\n                if (hole.x > this.componentX + 200) {\r\n                    hole.x = this.componentX - 100;\r\n                    hole.y = this.componentY - 40 + Math.random() * 80;\r\n                }\r\n            } else {\r\n                hole.vx = 0; hole.vy = 0; hole.glow = 0; hole.trail = [];\r\n            }\r\n        });\r\n    }\r\n    \r\n    updateNPNParticles() {\r\n        // NPN: emphasize electron flow from emitter to collector\r\n        // Base voltage affects particle speed and intensity\r\n        const baseVoltageEffect = Math.max(0, (this.baseVoltage - 0.7) / 0.3); // 0 to 1 scale\r\n        const speedMultiplier = 1 + baseVoltageEffect * 2; // 1x to 3x speed\r\n        \r\n        this.electrons.forEach((electron, index) => {\r\n            if (this.biasType === 'forward' && this.baseVoltage > 0.7) {\r\n                // Electrons flow from emitter (bottom) to collector (top)\r\n                electron.vx = Math.sin(this.time * 0.02 + index * 0.5) * 1.0 * speedMultiplier;\r\n                electron.vy = (-4 + Math.sin(this.time * 0.03 + index) * 1.0) * speedMultiplier;\r\n                electron.x += electron.vx;\r\n                electron.y += electron.vy;\r\n                electron.glow = (Math.sin(this.time * 0.1 + index) * 0.5 + 0.5) * (0.5 + baseVoltageEffect * 0.5);\r\n                \r\n                electron.trail.push({x: electron.x, y: electron.y, alpha: 1.0});\r\n                if (electron.trail.length > 8) electron.trail.shift();\r\n                \r\n                if (electron.y < this.componentY - 150) {\r\n                    electron.x = this.componentX - 40 + Math.random() * 80;\r\n                    electron.y = this.componentY + 100;\r\n                }\r\n            } else {\r\n                electron.vx = 0; electron.vy = 0; electron.glow = 0; electron.trail = [];\r\n            }\r\n        });\r\n        \r\n        // Minimal hole movement for NPN\r\n        this.holes.forEach((hole, index) => {\r\n            hole.vx = 0; hole.vy = 0; hole.glow = 0; hole.trail = [];\r\n        });\r\n    }\r\n    \r\n    updatePNPParticles() {\r\n        // PNP: emphasize hole flow from emitter to collector\r\n        // Base voltage affects particle speed and intensity\r\n        const baseVoltageEffect = Math.max(0, (this.baseVoltage - 0.7) / 0.3); // 0 to 1 scale\r\n        const speedMultiplier = 1 + baseVoltageEffect * 2; // 1x to 3x speed\r\n        \r\n        this.holes.forEach((hole, index) => {\r\n            if (this.biasType === 'forward' && this.baseVoltage > 0.7) {\r\n                // Holes flow from emitter (top) to collector (bottom)\r\n                hole.vx = Math.sin(this.time * 0.02 + index * 0.5) * 1.0 * speedMultiplier;\r\n                hole.vy = (4 + Math.sin(this.time * 0.03 + index) * 1.0) * speedMultiplier;\r\n                hole.x += hole.vx;\r\n                hole.y += hole.vy;\r\n                hole.glow = (Math.sin(this.time * 0.1 + index) * 0.5 + 0.5) * (0.5 + baseVoltageEffect * 0.5);\r\n                \r\n                hole.trail.push({x: hole.x, y: hole.y, alpha: 1.0});\r\n                if (hole.trail.length > 8) hole.trail.shift();\r\n                \r\n                if (hole.y > this.componentY + 150) {\r\n                    hole.x = this.componentX - 40 + Math.random() * 80;\r\n                    hole.y = this.componentY - 100;\r\n                }\r\n            } else {\r\n                hole.vx = 0; hole.vy = 0; hole.glow = 0; hole.trail = [];\r\n            }\r\n        });\r\n        \r\n        // Minimal electron movement for PNP\r\n        this.electrons.forEach((electron, index) => {\r\n            electron.vx = 0; electron.vy = 0; electron.glow = 0; electron.trail = [];\r\n        });\r\n    }\r\n    \r\n    drawLoad() {\r\n        const time = this.time * 0.001;\r\n        \r\n        // Draw load (light bulb) with enhanced glow effect and animation\r\n        const bulbGlow = this.isActive ? this.glowIntensity : 0;\r\n        const pulseEffect = this.isActive ? Math.sin(time * 3) * 0.1 : 0;\r\n        const bulbColor = this.isActive ? `rgba(255, 255, 0, ${0.8 + bulbGlow * 0.2 + pulseEffect})` : '#666';\r\n        \r\n        // Draw outer glow when active\r\n        if (this.isActive) {\r\n            this.ctx.shadowColor = '#FFFF00';\r\n            this.ctx.shadowBlur = 30 + this.glowIntensity * 20;\r\n            this.ctx.fillStyle = `rgba(255, 255, 0, ${0.3 + this.glowIntensity * 0.2})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(this.loadX, this.loadY, 45, 0, 2 * Math.PI);\r\n            this.ctx.fill();\r\n            this.ctx.shadowBlur = 0;\r\n        }\r\n        \r\n        // Draw main bulb\r\n        this.ctx.fillStyle = bulbColor;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.loadX, this.loadY, 35, 0, 2 * Math.PI);\r\n        this.ctx.fill();\r\n        \r\n        // Add metallic shine to bulb\r\n        this.ctx.fillStyle = `rgba(255, 255, 255, ${0.4 + Math.sin(time * 2) * 0.1})`;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.loadX - 10, this.loadY - 15, 8, 0, Math.PI);\r\n        this.ctx.fill();\r\n        \r\n        // Draw bulb base with enhanced metallic effect\r\n        this.ctx.fillStyle = '#444';\r\n        this.ctx.fillRect(this.loadX - 18, this.loadY + 35, 36, 25);\r\n        \r\n        // Add metallic shine to base with animation\r\n        this.ctx.fillStyle = `rgba(255, 255, 255, ${0.3 + Math.sin(time * 2) * 0.1})`;\r\n        this.ctx.fillRect(this.loadX - 15, this.loadY + 37, 30, 5);\r\n        \r\n        // Draw filament with enhanced effect and glow\r\n        this.ctx.strokeStyle = this.isActive ? `rgba(255, 170, 0, ${0.8 + this.glowIntensity})` : '#999';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.shadowColor = this.isActive ? '#FFAA00' : 'transparent';\r\n        this.ctx.shadowBlur = this.isActive ? 5 : 0;\r\n        \r\n        // Main filament\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.loadX - 12, this.loadY);\r\n        this.ctx.lineTo(this.loadX + 12, this.loadY);\r\n        this.ctx.stroke();\r\n        \r\n        // Add additional filament lines when active with animation\r\n        if (this.isActive) {\r\n            const filamentPulse = Math.sin(time * 4) * 0.2 + 0.8;\r\n            this.ctx.strokeStyle = `rgba(255, 170, 0, ${0.8 + this.glowIntensity * filamentPulse})`;\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(this.loadX - 8, this.loadY - 5);\r\n            this.ctx.lineTo(this.loadX + 8, this.loadY - 5);\r\n            this.ctx.stroke();\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(this.loadX - 8, this.loadY + 5);\r\n            this.ctx.lineTo(this.loadX + 8, this.loadY + 5);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Draw load label with pulsing glow\r\n        const labelGlow = this.isActive ? Math.sin(time * 2) * 0.3 + 0.7 : 0.7;\r\n        this.ctx.fillStyle = this.isActive ? `rgba(255, 255, 0, ${labelGlow})` : 'white';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('LOAD', this.loadX, this.loadY + 80);\r\n        \r\n        // Add power indicator with enhanced styling\r\n        if (this.isActive) {\r\n            this.ctx.fillStyle = `rgba(0, 255, 0, ${0.8 + this.glowIntensity})`;\r\n            this.ctx.font = 'bold 12px Arial';\r\n            this.ctx.fillText(`${this.power.toFixed(1)}mW`, this.loadX, this.loadY - 60);\r\n            \r\n            // Add energy waves radiating from bulb\r\n            for (let i = 0; i < 3; i++) {\r\n                const waveRadius = 50 + i * 15 + Math.sin(time * 2 + i) * 5;\r\n                const waveAlpha = (0.2 - i * 0.05) * this.glowIntensity;\r\n                this.ctx.strokeStyle = `rgba(255, 255, 0, ${waveAlpha})`;\r\n                this.ctx.lineWidth = 1;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(this.loadX, this.loadY, waveRadius, 0, Math.PI * 2);\r\n                this.ctx.stroke();\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawParticles() {\r\n        if (!this.showElectrons) return;\r\n        \r\n        const time = this.time * 0.001;\r\n        \r\n        // Draw electron trails with enhanced effects (filled circles)\r\n        this.electrons.forEach(electron => {\r\n            if (electron.trail.length > 0) {\r\n                electron.trail.forEach((trailPoint, index) => {\r\n                    const alpha = trailPoint.alpha * (index / electron.trail.length) * 0.6;\r\n                    const pulse = Math.sin(time * 4 + index) * 0.2 + 0.8;\r\n                    this.ctx.fillStyle = `rgba(0, 170, 255, ${alpha * pulse})`;\r\n                    this.ctx.beginPath();\r\n                    this.ctx.arc(trailPoint.x, trailPoint.y, electron.size * 0.6, 0, Math.PI * 2);\r\n                    this.ctx.fill();\r\n                });\r\n            }\r\n        });\r\n        \r\n        // Draw hole trails with enhanced effects (empty circles)\r\n        this.holes.forEach(hole => {\r\n            if (hole.trail.length > 0) {\r\n                hole.trail.forEach((trailPoint, index) => {\r\n                    const alpha = trailPoint.alpha * (index / hole.trail.length) * 0.6;\r\n                    const pulse = Math.sin(time * 4 + index) * 0.2 + 0.8;\r\n                    this.ctx.strokeStyle = `rgba(255, 68, 68, ${alpha * pulse})`;\r\n                    this.ctx.lineWidth = 1;\r\n                    this.ctx.beginPath();\r\n                    this.ctx.arc(trailPoint.x, trailPoint.y, hole.size * 0.6, 0, Math.PI * 2);\r\n                    this.ctx.stroke();\r\n                });\r\n            }\r\n        });\r\n        \r\n        // Draw electrons with enhanced glow effect and standard symbol (filled circle)\r\n        this.electrons.forEach(electron => {\r\n            const glowIntensity = electron.glow * 0.4;\r\n            const pulse = Math.sin(time * 3 + electron.x * 0.01) * 0.3 + 0.7;\r\n            \r\n            // Outer glow\r\n            this.ctx.shadowColor = '#00AAFF';\r\n            this.ctx.shadowBlur = glowIntensity * 15;\r\n            this.ctx.fillStyle = `rgba(0, 170, 255, ${0.8 * pulse})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(electron.x, electron.y, electron.size * 1.2, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Core electron circle (filled - standard notation)\r\n            this.ctx.shadowBlur = 0;\r\n            this.ctx.fillStyle = electron.color;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(electron.x, electron.y, electron.size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Inner highlight\r\n            this.ctx.fillStyle = `rgba(255, 255, 255, ${0.6 * pulse})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(electron.x - 2, electron.y - 2, electron.size * 0.3, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        });\r\n        \r\n        // Draw holes with enhanced glow effect and standard symbol (empty circle)\r\n        this.holes.forEach(hole => {\r\n            const glowIntensity = hole.glow * 0.4;\r\n            const pulse = Math.sin(time * 3 + hole.x * 0.01) * 0.3 + 0.7;\r\n            \r\n            // Subtle outer glow for holes (not filling the circle)\r\n            this.ctx.shadowColor = '#FF4444';\r\n            this.ctx.shadowBlur = glowIntensity * 8;\r\n            \r\n            // Core hole circle (empty - standard notation)\r\n            this.ctx.strokeStyle = hole.color;\r\n            this.ctx.lineWidth = 0.5; // Very thin line for smaller holes\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(hole.x, hole.y, hole.size, 0, Math.PI * 2);\r\n            this.ctx.stroke();\r\n            \r\n            this.ctx.shadowBlur = 0;\r\n            \r\n            // Optional: small center dot to show it's a hole (not an empty space)\r\n            this.ctx.fillStyle = `rgba(255, 68, 68, ${0.3 * pulse})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(hole.x, hole.y, hole.size * 0.2, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        });\r\n        \r\n        // Draw energy particles with enhanced effects\r\n        this.energyParticles.forEach(particle => {\r\n            const pulse = Math.sin(time * 5 + particle.x * 0.01) * 0.3 + 0.7;\r\n            this.ctx.fillStyle = `rgba(255, 255, 0, ${particle.life * pulse})`;\r\n            this.ctx.shadowColor = '#FFFF00';\r\n            this.ctx.shadowBlur = particle.life * 10;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            this.ctx.shadowBlur = 0;\r\n        });\r\n    }\r\n    \r\n    drawSparks() {\r\n        // Draw sparks when current is high\r\n        this.sparks.forEach(spark => {\r\n            this.ctx.fillStyle = `rgba(255, 255, 0, ${spark.life})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(spark.x, spark.y, 2, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        });\r\n    }\r\n    \r\n    drawCurrentFlow() {\r\n        if (!this.showCurrent || !this.isActive) return;\r\n        \r\n        const time = this.time * 0.001;\r\n        \r\n        // Draw current flow with enhanced effects and animation\r\n        this.ctx.strokeStyle = `rgba(255, 255, 0, ${0.8 + this.glowIntensity})`;\r\n        this.ctx.lineWidth = 4;\r\n        this.ctx.setLineDash([15, 8]);\r\n        \r\n        // Add glow effect to current flow\r\n        this.ctx.shadowColor = '#FFFF00';\r\n        this.ctx.shadowBlur = 10 + this.glowIntensity * 10;\r\n        \r\n        // Battery to component with animated dash pattern\r\n        const dashOffset = Math.sin(time * 3) * 5;\r\n        this.ctx.setLineDash([15 + dashOffset, 8 - dashOffset]);\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.batteryX + 25, this.batteryY);\r\n        this.ctx.lineTo(this.componentX - 90, this.componentY);\r\n        this.ctx.stroke();\r\n        \r\n        // Component to load with animated dash pattern\r\n        this.ctx.setLineDash([15 - dashOffset, 8 + dashOffset]);\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.componentX + 90, this.componentY);\r\n        this.ctx.lineTo(this.loadX - 35, this.loadY);\r\n        this.ctx.stroke();\r\n        \r\n        this.ctx.setLineDash([]);\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Draw animated current arrows with pulsing effect\r\n        const arrowOffset = Math.sin(time * 2) * 5;\r\n        const arrowGlow = Math.sin(time * 4) * 0.3 + 0.7;\r\n        this.drawArrow(this.batteryX + 35 + arrowOffset, this.batteryY, 12, 0, `rgba(255, 255, 0, ${arrowGlow})`);\r\n        this.drawArrow(this.componentX + 100 + arrowOffset, this.componentY, 12, 0, `rgba(255, 255, 0, ${arrowGlow})`);\r\n        \r\n        // Draw current intensity indicator with animation\r\n        const intensity = Math.min(this.current / 20, 1);\r\n        const pulseIntensity = intensity * (0.3 + Math.sin(time * 5) * 0.1);\r\n        this.ctx.fillStyle = `rgba(255, 255, 0, ${pulseIntensity})`;\r\n        this.ctx.fillRect(this.componentX - 100, this.componentY - 10, 200, 20);\r\n        \r\n        // Add energy particles along the current path\r\n        for (let i = 0; i < 5; i++) {\r\n            const particleProgress = (time * 0.5 + i * 0.2) % 1;\r\n            const particleX = this.batteryX + 25 + (this.componentX - 90 - this.batteryX - 25) * particleProgress;\r\n            const particleY = this.batteryY + Math.sin(time * 3 + i) * 3;\r\n            \r\n            this.ctx.fillStyle = `rgba(255, 255, 0, ${0.6 + Math.sin(time * 4 + i) * 0.2})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(particleX, particleY, 2, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n        \r\n        // Voltage drop indicators are already shown on the component symbol\r\n    }\r\n    \r\n    drawArrow(x, y, dx, dy, color) {\r\n        this.ctx.fillStyle = color;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x, y);\r\n        this.ctx.lineTo(x - 8, y - 4);\r\n        this.ctx.lineTo(x - 8, y + 4);\r\n        this.ctx.closePath();\r\n        this.ctx.fill();\r\n    }\r\n    \r\n    drawInfo() {\r\n        // Draw info panel\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.fillRect(10, 10, 300, 200);\r\n        \r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('🔌 Diode & Transistor', 20, 30);\r\n        \r\n        this.ctx.font = '14px Arial';\r\n        this.ctx.fillText(`Component: ${this.componentType.toUpperCase()}`, 20, 50);\r\n        this.ctx.fillText(`Bias: ${this.biasType.toUpperCase()}`, 20, 70);\r\n        this.ctx.fillText(`Input Voltage: ${this.inputVoltage}V`, 20, 90);\r\n        \r\n        if (this.componentType === 'npn' || this.componentType === 'pnp') {\r\n            this.ctx.fillText(`Base Voltage: ${this.baseVoltage}V`, 20, 110);\r\n        }\r\n        \r\n        this.ctx.fillText(`Current: ${this.current.toFixed(1)}mA`, 20, 130);\r\n        this.ctx.fillText(`Power: ${this.power.toFixed(1)}mW`, 20, 150);\r\n        this.ctx.fillText(`Status: ${this.isActive ? 'ACTIVE' : 'INACTIVE'}`, 20, 170);\r\n        this.ctx.fillText(`Temperature: ${this.temperature}°C`, 20, 190);\r\n    }\r\n    \r\n    drawInstructions() {\r\n        // Draw instruction panel with color legend\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.85)';\r\n        this.ctx.fillRect(this.ctx.canvas.width - 320, 10, 310, 180);\r\n        \r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('🔌 Particle Legend:', this.ctx.canvas.width - 310, 30);\r\n        \r\n        // Draw color-coded legend\r\n        this.ctx.font = 'bold 14px Arial';\r\n        \r\n        // Blue particles (Electrons) - filled circle\r\n        this.ctx.fillStyle = '#00AAFF';\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.ctx.canvas.width - 300, 50, 2.5, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = '12px Arial';\r\n        this.ctx.fillText('Electrons (filled circle)', this.ctx.canvas.width - 285, 55);\r\n        \r\n        // Red particles (Holes) - empty circle\r\n        this.ctx.strokeStyle = '#FF4444';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.ctx.canvas.width - 300, 70, 2.5, 0, Math.PI * 2);\r\n        this.ctx.stroke();\r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = '12px Arial';\r\n        this.ctx.fillText('Holes (empty circle)', this.ctx.canvas.width - 285, 75);\r\n        \r\n        // Yellow particles (Energy)\r\n        this.ctx.fillStyle = '#FFFF00';\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.ctx.canvas.width - 300, 90, 2.5, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = '12px Arial';\r\n        this.ctx.fillText('Energy Carriers', this.ctx.canvas.width - 285, 95);\r\n        \r\n        // Yellow arrows (Current flow)\r\n        this.ctx.fillStyle = '#FFFF00';\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.ctx.canvas.width - 300, 110);\r\n        this.ctx.lineTo(this.ctx.canvas.width - 290, 110);\r\n        this.ctx.lineTo(this.ctx.canvas.width - 292, 108);\r\n        this.ctx.lineTo(this.ctx.canvas.width - 290, 110);\r\n        this.ctx.lineTo(this.ctx.canvas.width - 292, 112);\r\n        this.ctx.fill();\r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = '12px Arial';\r\n        this.ctx.fillText('Current Flow', this.ctx.canvas.width - 285, 115);\r\n        \r\n        // Component behavior\r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = 'bold 12px Arial';\r\n        this.ctx.fillText('💡 Behavior:', this.ctx.canvas.width - 310, 140);\r\n        \r\n        this.ctx.font = '11px Arial';\r\n        if (this.componentType === 'diode') {\r\n            this.ctx.fillText('• Forward bias: Electrons flow, light on', this.ctx.canvas.width - 310, 155);\r\n            this.ctx.fillText('• Reverse bias: No flow, light off', this.ctx.canvas.width - 310, 170);\r\n        } else {\r\n            this.ctx.fillText('• Base controls collector current', this.ctx.canvas.width - 310, 155);\r\n            this.ctx.fillText('• Small base = Large collector', this.ctx.canvas.width - 310, 170);\r\n        }\r\n    }\r\n    \r\n    getStats() {\r\n        return {\r\n            componentType: this.componentType,\r\n            biasType: this.biasType,\r\n            inputVoltage: this.inputVoltage,\r\n            baseVoltage: this.baseVoltage,\r\n            current: this.current,\r\n            power: this.power,\r\n            temperature: this.temperature,\r\n            isActive: this.isActive,\r\n            time: this.time\r\n        };\r\n    }\r\n}","\r\nexport class WaveParticleDuality {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.canvas = ctx.canvas;\r\n        \r\n        // Quantum properties\r\n        this.mode = 'wave'; // 'wave', 'particle', 'superposition', 'measurement'\r\n        this.photonEnergy = 5.0; // eV\r\n        this.wavelength = 150; // nm\r\n        this.speed = 1.0;\r\n        this.time = 0;\r\n        \r\n        // Wave function properties\r\n        this.waveFunction = [];\r\n        this.amplitude = 50;\r\n        this.frequency = 1.0;\r\n        this.phase = 0;\r\n        this.wavePhase = 0;\r\n        \r\n        // Particle properties\r\n        this.particleX = 100;\r\n        this.particleY = 300;\r\n        this.particleVelocity = { x: 8, y: 0 };\r\n        this.particleSize = 8;\r\n        \r\n        // Interference properties\r\n        this.slits = [\r\n            { x: 400, y: 250, width: 20, height: 100 },\r\n            { x: 400, y: 350, width: 20, height: 100 }\r\n        ];\r\n        this.interferencePattern = [];\r\n        this.screenX = 600;\r\n        \r\n        // Measurement properties\r\n        this.measurementCount = 0;\r\n        this.measurementResults = [];\r\n        this.showMeasurement = false;\r\n        \r\n        // Display options\r\n        this.showWaveFunction = true;\r\n        this.showParticlePosition = true;\r\n        this.showInterference = true;\r\n        this.showMeasurementEffect = false;\r\n\r\n        \r\n        this.initializeWaveFunction();\r\n        this.initializeInterferencePattern();\r\n    }\r\n    \r\n    setMode(mode) {\r\n        this.mode = mode;\r\n        this.reset();\r\n    }\r\n    \r\n    setSpeed(speed) {\r\n        this.speed = speed;\r\n    }\r\n    \r\n    setPhotonEnergy(energy) {\r\n        this.photonEnergy = energy;\r\n        this.wavelength = 1240 / energy; // E = hc/λ, simplified\r\n        this.initializeWaveFunction();\r\n        this.initializeInterferencePattern();\r\n    }\r\n    \r\n    setWavelength(wavelength) {\r\n        this.wavelength = wavelength;\r\n        this.photonEnergy = 1240 / wavelength; // E = hc/λ, simplified\r\n        this.initializeWaveFunction();\r\n        this.initializeInterferencePattern();\r\n    }\r\n    \r\n    setShowWaveFunction(show) {\r\n        this.showWaveFunction = show;\r\n    }\r\n    \r\n    setShowParticlePosition(show) {\r\n        this.showParticlePosition = show;\r\n    }\r\n    \r\n    setShowInterference(show) {\r\n        this.showInterference = show;\r\n    }\r\n    \r\n    setShowMeasurementEffect(show) {\r\n        this.showMeasurementEffect = show;\r\n    }\r\n    \r\n\r\n    \r\n    performMeasurement() {\r\n        this.measurementCount++;\r\n        this.showMeasurement = true;\r\n        \r\n        // Simulate measurement collapse\r\n        if (this.mode === 'superposition') {\r\n            const random = Math.random();\r\n            if (random < 0.5) {\r\n                this.mode = 'particle';\r\n            } else {\r\n                this.mode = 'wave';\r\n            }\r\n        }\r\n        \r\n        // Record measurement result\r\n        this.measurementResults.push({\r\n            time: this.time,\r\n            mode: this.mode,\r\n            position: { x: this.particleX, y: this.particleY }\r\n        });\r\n        \r\n        // Force measurement effect to show regardless of checkbox\r\n        this.showMeasurementEffect = true;\r\n        \r\n        setTimeout(() => {\r\n            this.showMeasurement = false;\r\n            this.showMeasurementEffect = false;\r\n        }, 3000);\r\n    }\r\n    \r\n    reset() {\r\n        this.time = 0;\r\n        this.phase = 0;\r\n        this.wavePhase = 0;\r\n        this.particleX = 100;\r\n        this.particleY = 300;\r\n        this.measurementCount = 0;\r\n        this.measurementResults = [];\r\n        this.showMeasurement = false;\r\n        this.initializeWaveFunction();\r\n        this.initializeInterferencePattern();\r\n    }\r\n    \r\n    initializeWaveFunction() {\r\n        this.waveFunction = [];\r\n        const numPoints = 150;\r\n        for (let i = 0; i < numPoints; i++) {\r\n            const x = (i / numPoints) * this.canvas.width;\r\n            \r\n            // Create a clean sinusoidal wave function\r\n            const wave = this.amplitude * Math.sin(2 * Math.PI * x / this.wavelength + this.phase);\r\n            \r\n            const y = this.canvas.height / 2 + wave;\r\n            this.waveFunction.push({ x, y });\r\n        }\r\n    }\r\n    \r\n    initializeInterferencePattern() {\r\n        this.interferencePattern = [];\r\n        const screenHeight = 300; // Reduced to match new detection screen height\r\n        const centerY = this.canvas.height / 2;\r\n        \r\n        // Define slit positions for vertical slits\r\n        const slit1X = 390; // Center of left slit\r\n        const slit2X = 410; // Center of right slit\r\n        const slitY = 300;   // Y position of slits (center)\r\n        const screenX = this.screenX;\r\n        \r\n        for (let y = 0; y < screenHeight; y += 8) {\r\n            const screenY = centerY - screenHeight/2 + y;\r\n            let intensity = 0;\r\n            \r\n            // Calculate path difference from each slit\r\n            const distance1 = Math.sqrt(Math.pow(screenX - slit1X, 2) + Math.pow(screenY - slitY, 2));\r\n            const distance2 = Math.sqrt(Math.pow(screenX - slit2X, 2) + Math.pow(screenY - slitY, 2));\r\n            \r\n            // Calculate phase difference\r\n            const pathDifference = distance2 - distance1;\r\n            const phaseDifference = 2 * Math.PI * pathDifference / this.wavelength;\r\n            \r\n            // Calculate interference intensity\r\n            const amplitude1 = 1 / Math.sqrt(distance1);\r\n            const amplitude2 = 1 / Math.sqrt(distance2);\r\n            \r\n            // Total amplitude with interference\r\n            const totalAmplitude = amplitude1 + amplitude2 * Math.cos(phaseDifference);\r\n            intensity = Math.abs(totalAmplitude);\r\n            \r\n            this.interferencePattern.push({\r\n                x: screenX,\r\n                y: screenY,\r\n                intensity: intensity\r\n            });\r\n        }\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        const dt = (deltaTime / 1000) * this.speed * 5; // Increased multiplier for better responsiveness\r\n        this.time += dt;\r\n        this.phase += dt * this.frequency;\r\n        \r\n        // Only update wave function when needed (not every frame)\r\n        if (this.mode === 'wave' || this.mode === 'superposition') {\r\n            // Update wave function points efficiently\r\n            this.waveFunction.forEach((point, i) => {\r\n                const x = point.x;\r\n                \r\n                // Check if wave is blocked by the barrier\r\n                if (x >= 380 && x <= 420) {\r\n                    // Inside barrier - wave is blocked except at slits\r\n                    // Check if this x position corresponds to a slit\r\n                    const slit1X = 390; // Left slit center\r\n                    const slit2X = 410; // Right slit center\r\n                    const slitWidth = 10;\r\n                    \r\n                    // Check if this x position is within either slit\r\n                    const distanceFromSlit1 = Math.abs(x - slit1X);\r\n                    const distanceFromSlit2 = Math.abs(x - slit2X);\r\n                    \r\n                    if (distanceFromSlit1 < slitWidth / 2 || distanceFromSlit2 < slitWidth / 2) {\r\n                        // Wave passes through slit\r\n                        const wave = this.amplitude * Math.sin(2 * Math.PI * x / this.wavelength - this.phase);\r\n                        point.y = this.canvas.height / 2 + wave;\r\n                    } else {\r\n                        // Wave is blocked by barrier - make it invisible\r\n                        point.y = -1000; // Move off-screen\r\n                    }\r\n                } else {\r\n                    // Outside barrier - normal wave propagation\r\n                    const wave = this.amplitude * Math.sin(2 * Math.PI * x / this.wavelength - this.phase);\r\n                    point.y = this.canvas.height / 2 + wave;\r\n                }\r\n            });\r\n        }\r\n        \r\n        // Update particle position with more realistic movement\r\n        if (this.mode === 'particle' || this.mode === 'superposition') {\r\n            this.particleX += this.particleVelocity.x * dt;\r\n            \r\n            // Add some vertical oscillation for particle\r\n            this.particleY = 300 + Math.sin(this.time * 3) * 20;\r\n            \r\n            // Reset particle when it reaches the screen\r\n            if (this.particleX > this.screenX - 50) {\r\n                this.particleX = 100;\r\n            }\r\n        }\r\n        \r\n        // Only update interference pattern when needed and less frequently\r\n        if (this.showInterference && (this.mode === 'wave' || this.mode === 'superposition')) {\r\n            // Update interference pattern less frequently for better performance\r\n            if (Math.floor(this.time * 10) % 3 === 0) { // Update every 3rd frame at 10fps\r\n        this.initializeInterferencePattern();\r\n            }\r\n        }\r\n        \r\n        // Add wave propagation effect\r\n        if (this.mode === 'wave' || this.mode === 'superposition') {\r\n            this.wavePhase += dt * 2;\r\n        }\r\n    }\r\n    \r\n    render() {\r\n        // Clear canvas\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        \r\n        // Draw background grid\r\n        this.drawGrid();\r\n        \r\n        // Draw slits\r\n        this.drawSlits();\r\n        \r\n        // Draw detection screen\r\n        this.drawDetectionScreen();\r\n        \r\n        // Draw based on current mode\r\n        switch (this.mode) {\r\n            case 'wave':\r\n                this.renderWaveMode();\r\n                break;\r\n            case 'particle':\r\n                this.renderParticleMode();\r\n                break;\r\n            case 'superposition':\r\n                this.renderSuperpositionMode();\r\n                break;\r\n            case 'measurement':\r\n                this.renderMeasurementMode();\r\n                break;\r\n        }\r\n        \r\n        // Draw interference pattern (only if enabled and in wave/superposition modes)\r\n        if (this.showInterference && (this.mode === 'wave' || this.mode === 'superposition')) {\r\n            this.drawInterferencePattern();\r\n        }\r\n        \r\n        // Draw measurement effect\r\n        if (this.showMeasurement) {\r\n            this.drawMeasurementEffect();\r\n        }\r\n        \r\n        // Draw canvas labels\r\n        this.drawQuantumLabels();\r\n        \r\n        // Draw descriptive labels\r\n        this.drawDescriptiveLabels();\r\n    }\r\n    \r\n    drawGrid() {\r\n        // Enhanced quantum grid with modern styling\r\n        this.ctx.strokeStyle = 'rgba(100, 100, 100, 0.15)';\r\n        this.ctx.lineWidth = 0.8;\r\n        this.ctx.setLineDash([8, 8]);\r\n        \r\n        // Vertical lines with subtle animation\r\n        for (let x = 0; x < this.canvas.width; x += 100) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x, 0);\r\n            this.ctx.lineTo(x, this.canvas.height);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Horizontal lines\r\n        for (let y = 0; y < this.canvas.height; y += 100) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(0, y);\r\n            this.ctx.lineTo(this.canvas.width, y);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        this.ctx.setLineDash([]);\r\n        \r\n        // Add subtle quantum field effect\r\n        this.ctx.fillStyle = 'rgba(138, 43, 226, 0.03)';\r\n        for (let x = 0; x < this.canvas.width; x += 120) {\r\n            for (let y = 0; y < this.canvas.height; y += 120) {\r\n                const pulse = Math.sin(this.time * 0.3 + x * 0.01 + y * 0.01) * 0.5 + 0.5;\r\n                this.ctx.globalAlpha = pulse * 0.08;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(x, y, 25, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n            }\r\n        }\r\n        this.ctx.globalAlpha = 1;\r\n    }\r\n    \r\n    drawSlits() {\r\n        // Enhanced barrier with modern gradient and depth\r\n        const gradient = this.ctx.createLinearGradient(380, 0, 420, 0);\r\n        gradient.addColorStop(0, '#1a1a2e');\r\n        gradient.addColorStop(0.3, '#16213e');\r\n        gradient.addColorStop(0.7, '#0f3460');\r\n        gradient.addColorStop(1, '#1a1a2e');\r\n        \r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(380, 0, 40, this.canvas.height);\r\n        \r\n        // Enhanced shadow for depth\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.4)';\r\n        this.ctx.shadowBlur = 8;\r\n        this.ctx.shadowOffsetX = 3;\r\n        this.ctx.fillRect(380, 0, 40, this.canvas.height);\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.shadowOffsetX = 0;\r\n        \r\n        // Cut out vertical slits with enhanced styling\r\n        this.ctx.clearRect(385, 200, 10, 200); // Left slit\r\n        this.ctx.clearRect(405, 200, 10, 200); // Right slit\r\n        \r\n        // Enhanced slit borders with modern styling\r\n        this.ctx.strokeStyle = '#0a0a0a';\r\n        this.ctx.lineWidth = 4;\r\n        this.ctx.lineCap = 'round';\r\n        this.ctx.lineJoin = 'round';\r\n        \r\n        // Left slit border\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(385, 200);\r\n        this.ctx.lineTo(385, 400);\r\n        this.ctx.stroke();\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(395, 200);\r\n        this.ctx.lineTo(395, 400);\r\n        this.ctx.stroke();\r\n        \r\n        // Right slit border\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(405, 200);\r\n        this.ctx.lineTo(405, 400);\r\n        this.ctx.stroke();\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(415, 200);\r\n        this.ctx.lineTo(415, 400);\r\n        this.ctx.stroke();\r\n        \r\n        // Enhanced inner highlight for slit edges\r\n        this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.4)';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(386, 200);\r\n        this.ctx.lineTo(386, 400);\r\n        this.ctx.stroke();\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(414, 200);\r\n        this.ctx.lineTo(414, 400);\r\n        this.ctx.stroke();\r\n        \r\n        // Enhanced barrier label with modern styling\r\n        this.ctx.fillStyle = '#1a1a2e';\r\n        this.ctx.font = 'bold 14px Inter, Arial, sans-serif';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('Barrier', 400, 190);\r\n        \r\n        // Enhanced arrows showing wave approach\r\n        this.ctx.strokeStyle = '#4CAF50';\r\n        this.ctx.lineWidth = 4;\r\n        this.ctx.lineCap = 'round';\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(350, 300);\r\n        this.ctx.lineTo(380, 300);\r\n        this.ctx.stroke();\r\n        \r\n        // Enhanced arrow head\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(375, 295);\r\n        this.ctx.lineTo(380, 300);\r\n        this.ctx.lineTo(375, 305);\r\n        this.ctx.closePath();\r\n        this.ctx.fillStyle = '#4CAF50';\r\n        this.ctx.fill();\r\n        \r\n        // Enhanced arrow label\r\n        this.ctx.fillStyle = '#4CAF50';\r\n        this.ctx.font = 'bold 12px Inter, Arial, sans-serif';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('Wave', 365, 290);\r\n    }\r\n    \r\n    drawDetectionScreen() {\r\n        // Enhanced detection screen with modern styling\r\n        const pulse = Math.sin(this.time * 2) * 0.3 + 0.7;\r\n        \r\n        // Enhanced screen background with gradient\r\n        const screenGradient = this.ctx.createLinearGradient(this.screenX - 8, 150, this.screenX + 8, 450);\r\n        screenGradient.addColorStop(0, `rgba(200, 200, 255, ${0.7 * pulse})`);\r\n        screenGradient.addColorStop(0.5, `rgba(180, 180, 255, ${0.8 * pulse})`);\r\n        screenGradient.addColorStop(1, `rgba(200, 200, 255, ${0.7 * pulse})`);\r\n        \r\n        this.ctx.fillStyle = screenGradient;\r\n        this.ctx.fillRect(this.screenX - 8, 150, 16, 300);\r\n        \r\n        // Enhanced screen border with shadow\r\n        this.ctx.shadowColor = 'rgba(0, 102, 204, 0.5)';\r\n        this.ctx.shadowBlur = 6;\r\n        this.ctx.strokeStyle = '#0066cc';\r\n        this.ctx.lineWidth = 4;\r\n        this.ctx.strokeRect(this.screenX - 8, 150, 16, 300);\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Enhanced pulsing effect for wave/superposition modes\r\n        if (this.mode === 'wave' || this.mode === 'superposition') {\r\n            const activePulse = Math.sin(this.time * 4) * 0.4 + 0.6;\r\n            this.ctx.fillStyle = `rgba(100, 150, 255, ${activePulse * 0.4})`;\r\n            this.ctx.fillRect(this.screenX - 10, 150, 20, 300);\r\n        }\r\n        \r\n        // Enhanced detection screen label\r\n        this.ctx.fillStyle = '#1a1a2e';\r\n        this.ctx.font = 'bold 14px Inter, Arial, sans-serif';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('Detection Screen', this.screenX, 145);\r\n        \r\n        // Enhanced detection zones with modern styling\r\n        this.ctx.strokeStyle = 'rgba(0, 102, 204, 0.6)';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.lineCap = 'round';\r\n        for (let i = 0; i < 6; i++) {\r\n            const y = 170 + i * 45;\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(this.screenX - 8, y);\r\n            this.ctx.lineTo(this.screenX + 8, y);\r\n            this.ctx.stroke();\r\n        }\r\n    }\r\n    \r\n    renderWaveMode() {\r\n        if (!this.showWaveFunction) return;\r\n        \r\n        // Enhanced wave function with modern styling and glow effects\r\n        \r\n        // Add glow effect for wave\r\n        this.ctx.shadowColor = '#4CAF50';\r\n        this.ctx.shadowBlur = 8;\r\n        this.ctx.strokeStyle = '#4CAF50';\r\n        this.ctx.lineWidth = 4;\r\n        this.ctx.lineCap = 'round';\r\n        \r\n        // Draw wave before barrier with enhanced styling\r\n        this.ctx.beginPath();\r\n        let started = false;\r\n        for (let i = 0; i < this.waveFunction.length; i++) {\r\n            const point = this.waveFunction[i];\r\n            if (point.x < 380) {\r\n                if (!started) {\r\n                    this.ctx.moveTo(point.x, point.y);\r\n                    started = true;\r\n                } else {\r\n                    this.ctx.lineTo(point.x, point.y);\r\n                }\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n        this.ctx.stroke();\r\n        \r\n        // Draw wave after barrier\r\n        this.ctx.beginPath();\r\n        started = false;\r\n        for (let i = 0; i < this.waveFunction.length; i++) {\r\n            const point = this.waveFunction[i];\r\n            if (point.x > 420) {\r\n                if (!started) {\r\n                    this.ctx.moveTo(point.x, point.y);\r\n                    started = true;\r\n                } else {\r\n                    this.ctx.lineTo(point.x, point.y);\r\n                }\r\n            }\r\n        }\r\n        this.ctx.stroke();\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Enhanced wave particles with gradient\r\n        for (let i = 0; i < this.waveFunction.length; i += 5) {\r\n            const point = this.waveFunction[i];\r\n            const gradient = this.ctx.createRadialGradient(\r\n                point.x - 2, point.y - 2, 0,\r\n                point.x, point.y, 4\r\n            );\r\n            gradient.addColorStop(0, '#6BCF7F');\r\n            gradient.addColorStop(0.7, '#4CAF50');\r\n            gradient.addColorStop(1, '#2E7D32');\r\n            \r\n            this.ctx.fillStyle = gradient;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(point.x, point.y, 4, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n        \r\n        // Enhanced wave direction arrows with modern styling\r\n        this.ctx.strokeStyle = '#4CAF50';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.lineCap = 'round';\r\n        for (let i = 0; i < 3; i++) {\r\n            const x = 150 + i * 120;\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x, 350);\r\n            this.ctx.lineTo(x + 25, 350);\r\n            this.ctx.stroke();\r\n            \r\n            // Enhanced arrow head\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x + 18, 345);\r\n            this.ctx.lineTo(x + 25, 350);\r\n            this.ctx.lineTo(x + 18, 355);\r\n            this.ctx.closePath();\r\n            this.ctx.fillStyle = '#4CAF50';\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n    \r\n    renderWaveModeWithoutLabel() {\r\n        if (!this.showWaveFunction) return;\r\n        \r\n        // Draw wave function with barrier interaction\r\n        this.ctx.strokeStyle = '#4CAF50';\r\n        this.ctx.lineWidth = 3;\r\n        \r\n        // Draw wave before barrier\r\n        this.ctx.beginPath();\r\n        let started = false;\r\n        for (let i = 0; i < this.waveFunction.length; i++) {\r\n            const point = this.waveFunction[i];\r\n            if (point.x < 380) {\r\n                if (!started) {\r\n                    this.ctx.moveTo(point.x, point.y);\r\n                    started = true;\r\n                } else {\r\n                    this.ctx.lineTo(point.x, point.y);\r\n                }\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n        this.ctx.stroke();\r\n        \r\n        // Draw wave after barrier\r\n        this.ctx.beginPath();\r\n        started = false;\r\n        for (let i = 0; i < this.waveFunction.length; i++) {\r\n            const point = this.waveFunction[i];\r\n            if (point.x > 420) {\r\n                if (!started) {\r\n                this.ctx.moveTo(point.x, point.y);\r\n                    started = true;\r\n            } else {\r\n                this.ctx.lineTo(point.x, point.y);\r\n                }\r\n            }\r\n        }\r\n        this.ctx.stroke();\r\n        \r\n        // Draw wave particles\r\n        this.ctx.fillStyle = '#4CAF50';\r\n        for (let i = 0; i < this.waveFunction.length; i += 5) {\r\n            const point = this.waveFunction[i];\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(point.x, point.y, 3, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n        \r\n        // Add wave direction arrows (moved to avoid overlap)\r\n        this.ctx.strokeStyle = '#4CAF50';\r\n        this.ctx.lineWidth = 2;\r\n        for (let i = 0; i < 3; i++) {\r\n            const x = 150 + i * 120;\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x, 350);\r\n            this.ctx.lineTo(x + 20, 350);\r\n            this.ctx.stroke();\r\n            \r\n            // Arrow head\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x + 15, 345);\r\n            this.ctx.lineTo(x + 20, 350);\r\n            this.ctx.lineTo(x + 15, 355);\r\n            this.ctx.stroke();\r\n        }\r\n    }\r\n    \r\n    renderParticleMode() {\r\n        if (!this.showParticlePosition) return;\r\n        \r\n        // Enhanced particle with modern styling and glow effects\r\n        \r\n        // Add glow effect for particle\r\n        this.ctx.shadowColor = '#FF5722';\r\n        this.ctx.shadowBlur = 10;\r\n        \r\n        // Enhanced particle with gradient\r\n        const gradient = this.ctx.createRadialGradient(\r\n            this.particleX - 3, this.particleY - 3, 0,\r\n            this.particleX, this.particleY, this.particleSize\r\n        );\r\n        gradient.addColorStop(0, '#FF8A65');\r\n        gradient.addColorStop(0.7, '#FF5722');\r\n        gradient.addColorStop(1, '#D84315');\r\n        \r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.particleX, this.particleY, this.particleSize, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Enhanced particle trail with gradient\r\n        const trailGradient = this.ctx.createLinearGradient(\r\n            this.particleX - 50, this.particleY,\r\n            this.particleX + 50, this.particleY\r\n        );\r\n        trailGradient.addColorStop(0, 'rgba(255, 87, 34, 0.3)');\r\n        trailGradient.addColorStop(0.5, 'rgba(255, 87, 34, 0.6)');\r\n        trailGradient.addColorStop(1, 'rgba(255, 87, 34, 0.3)');\r\n        \r\n        this.ctx.strokeStyle = trailGradient;\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.lineCap = 'round';\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.particleX - 50, this.particleY);\r\n        this.ctx.lineTo(this.particleX + 50, this.particleY);\r\n        this.ctx.stroke();\r\n    }\r\n    \r\n    renderParticleModeWithoutLabel() {\r\n        if (!this.showParticlePosition) return;\r\n        \r\n        // Draw particle\r\n        this.ctx.fillStyle = '#FF5722';\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.particleX, this.particleY, this.particleSize, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Draw particle trail\r\n        this.ctx.strokeStyle = 'rgba(255, 87, 34, 0.5)';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.particleX - 50, this.particleY);\r\n        this.ctx.lineTo(this.particleX + 50, this.particleY);\r\n        this.ctx.stroke();\r\n    }\r\n    \r\n    renderSuperpositionMode() {\r\n        // Draw both wave and particle aspects without their labels\r\n        this.renderWaveModeWithoutLabel();\r\n        this.renderParticleModeWithoutLabel();\r\n        \r\n\r\n    }\r\n    \r\n    renderMeasurementMode() {\r\n        this.renderParticleModeWithoutLabel();\r\n        \r\n        // Draw measurement apparatus\r\n        this.ctx.strokeStyle = '#FF9800';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.particleX, this.particleY - 30);\r\n        this.ctx.lineTo(this.particleX, this.particleY + 30);\r\n        this.ctx.stroke();\r\n        \r\n\r\n    }\r\n    \r\n    drawInterferencePattern() {\r\n        // Enhanced interference pattern with modern styling and effects\r\n        \r\n        // Add glow effect for interference pattern\r\n        this.ctx.shadowColor = '#9C27B0';\r\n        this.ctx.shadowBlur = 6;\r\n        \r\n        for (let i = 0; i < this.interferencePattern.length; i++) {\r\n            const point = this.interferencePattern[i];\r\n            const intensity = Math.min(point.intensity * 3, 1);\r\n            const alpha = Math.min(intensity, 0.9);\r\n            \r\n            // Enhanced time-based animation\r\n            const timeOffset = this.time * 2 + i * 0.1;\r\n            const animatedIntensity = intensity * (0.7 + 0.3 * Math.sin(timeOffset));\r\n            \r\n            // Enhanced colors for bright and dark fringes\r\n            if (intensity > 0.2) {\r\n                // Bright fringes with gradient\r\n                const gradient = this.ctx.createRadialGradient(\r\n                    point.x, point.y, 0,\r\n                    point.x, point.y, 8\r\n                );\r\n                gradient.addColorStop(0, `rgba(156, 39, 176, ${animatedIntensity})`);\r\n                gradient.addColorStop(0.7, `rgba(123, 31, 162, ${animatedIntensity * 0.8})`);\r\n                gradient.addColorStop(1, `rgba(74, 20, 140, ${animatedIntensity * 0.6})`);\r\n                this.ctx.fillStyle = gradient;\r\n            } else {\r\n                // Dark fringes\r\n                this.ctx.fillStyle = `rgba(0, 0, 0, ${animatedIntensity * 0.4})`;\r\n            }\r\n            \r\n            // Enhanced dots with rounded corners\r\n            const dotSize = Math.max(8, animatedIntensity * 15);\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(point.x, point.y, dotSize/2, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Enhanced animated detection dots\r\n        if (this.mode === 'wave' || this.mode === 'superposition') {\r\n            for (let i = 0; i < 5; i++) {\r\n                const y = 170 + i * 50;\r\n                const x = this.screenX + 8;\r\n                const pulse = Math.sin(this.time * 3 + i) * 0.5 + 0.5;\r\n                \r\n                // Enhanced detection dot with gradient\r\n                const gradient = this.ctx.createRadialGradient(\r\n                    x - 2, y - 2, 0,\r\n                    x, y, 6\r\n                );\r\n                gradient.addColorStop(0, '#FFD700');\r\n                gradient.addColorStop(0.7, '#FFC107');\r\n                gradient.addColorStop(1, '#FF8F00');\r\n                \r\n                this.ctx.globalAlpha = pulse;\r\n                this.ctx.fillStyle = gradient;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(x, y, 5, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n            }\r\n            this.ctx.globalAlpha = 1;\r\n        }\r\n        \r\n        // Enhanced wave arrows to slits with modern styling\r\n        this.ctx.strokeStyle = '#9C27B0';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.lineCap = 'round';\r\n        \r\n        // Animated wave arrows\r\n        const arrowPulse = Math.sin(this.time * 2) * 0.3 + 0.7;\r\n        this.ctx.globalAlpha = arrowPulse;\r\n        \r\n        // From left slit\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(390, 300);\r\n        this.ctx.lineTo(this.screenX, 200);\r\n        this.ctx.stroke();\r\n        \r\n        // From right slit\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(410, 300);\r\n        this.ctx.lineTo(this.screenX, 400);\r\n        this.ctx.stroke();\r\n        \r\n        this.ctx.globalAlpha = 1;\r\n    }\r\n    \r\n    drawMeasurementEffect() {\r\n        // More dramatic flash effect with pulsing\r\n        const pulse = Math.sin(this.time * 8) * 0.3 + 0.7;\r\n        this.ctx.fillStyle = `rgba(255, 255, 0, ${0.4 * pulse})`;\r\n        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n        \r\n        // Add particle collapse animation\r\n        this.ctx.fillStyle = '#FF5722';\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(this.particleX, this.particleY, 15 + Math.sin(this.time * 10) * 5, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n\r\n    }\r\n    \r\n    drawQuantumInfo() {\r\n        // Draw quantum information panel\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.fillRect(10, 120, 350, 200); // Increased height to accommodate formulas\r\n        \r\n        // Draw formulas at the top of the panel\r\n        this.ctx.fillStyle = '#E74C3C';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('E = hf', 20, 140);\r\n        this.ctx.fillText('λ = h/p', 20, 160);\r\n        this.ctx.fillText('ΔxΔp ≥ ℏ/2', 20, 180);\r\n        \r\n        // Draw separator line\r\n        this.ctx.strokeStyle = '#FFFFFF';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(20, 190);\r\n        this.ctx.lineTo(340, 190);\r\n        this.ctx.stroke();\r\n        \r\n        // Draw current values\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.font = '14px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillText(`Mode: ${this.mode.toUpperCase()}`, 20, 210);\r\n        this.ctx.fillText(`Energy: ${this.photonEnergy.toFixed(1)} eV`, 20, 230);\r\n        this.ctx.fillText(`Wavelength: ${this.wavelength.toFixed(0)} nm`, 20, 250);\r\n        this.ctx.fillText(`Measurements: ${this.measurementCount}`, 20, 270);\r\n        this.ctx.fillText(`Time: ${this.time.toFixed(1)}s`, 20, 290);\r\n        \r\n        // Add mode-specific descriptions\r\n        this.ctx.font = 'bold 12px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = '#FFFF00';\r\n        switch(this.mode) {\r\n            case 'wave':\r\n                this.ctx.fillText('Wave Behavior: Light behaves as a wave', 20, 315);\r\n                this.ctx.fillText('creating interference patterns', 20, 330);\r\n                break;\r\n            case 'particle':\r\n                this.ctx.fillText('Particle Behavior: Light behaves as', 20, 315);\r\n                this.ctx.fillText('discrete particles with definite position', 20, 330);\r\n                break;\r\n            case 'superposition':\r\n                this.ctx.fillText('Superposition: Light exists in both', 20, 315);\r\n                this.ctx.fillText('wave and particle states until measured', 20, 330);\r\n                break;\r\n            case 'measurement':\r\n                this.ctx.fillText('Measurement: Observing the system', 20, 315);\r\n                this.ctx.fillText('forces it to choose wave OR particle', 20, 330);\r\n                break;\r\n        }\r\n    }\r\n    \r\n    getStats() {\r\n        return {\r\n            mode: this.mode,\r\n            photonEnergy: this.photonEnergy.toFixed(1),\r\n            wavelength: this.wavelength.toFixed(0),\r\n            measurementCount: this.measurementCount,\r\n            time: this.time.toFixed(1)\r\n        };\r\n    }\r\n    \r\n    drawQuantumLabels() {\r\n        // Draw elegant labels on the canvas\r\n        this.ctx.save();\r\n        \r\n        // Set up text styling\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        \r\n        // Draw animation type label only (formulas moved to info panel)\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.9)';\r\n        this.ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        this.ctx.fillText('Wave-Particle Duality', this.ctx.canvas.width / 2, 25);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.restore();\r\n    }\r\n    \r\n    drawDescriptiveLabels() {\r\n        // Draw descriptive labels in the bottom-right corner\r\n        this.ctx.save();\r\n        \r\n        // Set up text styling\r\n        this.ctx.font = 'bold 13px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n        this.ctx.shadowColor = 'rgba(255, 255, 255, 0.6)';\r\n        this.ctx.shadowBlur = 1;\r\n        \r\n        const startX = this.ctx.canvas.width - 200;\r\n        const startY = this.ctx.canvas.height - 120;\r\n        const lineHeight = 16;\r\n        \r\n        // Draw mode-specific descriptions\r\n        switch(this.mode) {\r\n            case 'wave':\r\n                this.ctx.fillText('Wave Behavior:', startX, startY);\r\n                this.ctx.fillText('• Light travels as waves', startX, startY + lineHeight);\r\n                this.ctx.fillText('• Creates interference pattern', startX, startY + lineHeight * 2);\r\n                this.ctx.fillText('• Shows wave-like properties', startX, startY + lineHeight * 3);\r\n                break;\r\n            case 'particle':\r\n                this.ctx.fillText('Particle Behavior:', startX, startY);\r\n                this.ctx.fillText('• Light travels as particles', startX, startY + lineHeight);\r\n                this.ctx.fillText('• Hits screen at specific points', startX, startY + lineHeight * 2);\r\n                this.ctx.fillText('• Shows particle-like properties', startX, startY + lineHeight * 3);\r\n                break;\r\n            case 'superposition':\r\n                this.ctx.fillText('Quantum Superposition:', startX, startY);\r\n                this.ctx.fillText('• Light exists in both states', startX, startY + lineHeight);\r\n                this.ctx.fillText('• Wave + Particle simultaneously', startX, startY + lineHeight * 2);\r\n                this.ctx.fillText('• Until measured (collapsed)', startX, startY + lineHeight * 3);\r\n                break;\r\n            case 'measurement':\r\n                this.ctx.fillText('Measurement Effect:', startX, startY);\r\n                this.ctx.fillText('• Observation forces a choice', startX, startY + lineHeight);\r\n                this.ctx.fillText('• Wave OR Particle behavior', startX, startY + lineHeight * 2);\r\n                this.ctx.fillText('• Quantum mystery revealed', startX, startY + lineHeight * 3);\r\n                break;\r\n        }\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.restore();\r\n    }\r\n}","\r\nexport class NuclearReactions {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.canvas = ctx.canvas;\r\n        this.time = 0;\r\n        this.speed = 1;\r\n        this.mode = 'fission'; // fission, fusion\r\n        this.neutronEnergy = 1.0;\r\n        this.temperature = 1.0;\r\n\r\n        \r\n        // Nuclear particles\r\n        this.nuclei = [];\r\n        this.neutrons = [];\r\n        this.fissionProducts = [];\r\n        this.fusionProducts = [];\r\n        this.energyParticles = [];\r\n        this.reactingParticles = [];\r\n        this.shockwaves = [];\r\n        \r\n        // Statistics\r\n        this.energyReleased = 0;\r\n        this.neutronsProduced = 0;\r\n        this.chainReactions = 0;\r\n        this.fissionCount = 0;\r\n        this.fusionCount = 0;\r\n        \r\n        // Chain reaction state\r\n        this.chainStarted = false;\r\n        \r\n\r\n        \r\n        // Click interaction\r\n        this.setupClickEvents();\r\n        this.initializeNuclei();\r\n    }\r\n    \r\n    setupClickEvents() {\r\n        this.canvas.addEventListener('click', (e) => {\r\n            const rect = this.canvas.getBoundingClientRect();\r\n            const x = e.clientX - rect.left;\r\n            const y = e.clientY - rect.top;\r\n            \r\n            // Start reacting particle movement for all modes\r\n            this.reactingParticles.forEach(particle => {\r\n                if (!particle.moving) {\r\n                    // Find the target atom for this particle\r\n                    this.findTargetForParticle(particle);\r\n                    particle.moving = true;\r\n                }\r\n            });\r\n        });\r\n        \r\n        // Add touch event listener for mobile support\r\n        this.canvas.addEventListener('touchstart', (e) => {\r\n            e.preventDefault();\r\n            const rect = this.canvas.getBoundingClientRect();\r\n            const touch = e.touches[0];\r\n            const x = touch.clientX - rect.left;\r\n            const y = touch.clientY - rect.top;\r\n            \r\n            // Start reacting particle movement for all modes\r\n            this.reactingParticles.forEach(particle => {\r\n                if (!particle.moving) {\r\n                    // Find the target atom for this particle\r\n                    this.findTargetForParticle(particle);\r\n                    particle.moving = true;\r\n                }\r\n            });\r\n        });\r\n    }\r\n    \r\n    initializeNuclei() {\r\n        this.nuclei = [];\r\n        this.neutrons = [];\r\n        this.fissionProducts = [];\r\n        this.fusionProducts = [];\r\n        this.energyParticles = [];\r\n        this.reactingParticles = [];\r\n        \r\n        // Create initial nuclei based on mode\r\n        const centerX = this.canvas.width / 2;\r\n        const centerY = this.canvas.height / 2;\r\n        \r\n        if (this.mode === 'chain') {\r\n            // Chain reaction mode: 3x3 grid of uranium atoms for chain reactions\r\n            const gridSpacing = 40;\r\n            const gridSize = 3; // 3x3 grid\r\n            \r\n            for (let row = 0; row < gridSize; row++) {\r\n                for (let col = 0; col < gridSize; col++) {\r\n                    const x = centerX + (col - 1) * gridSpacing;\r\n                    const y = centerY + (row - 1) * gridSpacing;\r\n                    \r\n                    this.nuclei.push({\r\n                        x: x,\r\n                        y: y,\r\n                        type: 'uranium',\r\n                        protons: 92,\r\n                        neutrons: 143,\r\n                        mass: 235,\r\n                        radius: 8,\r\n                        color: '#FF6B35',\r\n                        stability: 0.8,\r\n                        fissioned: false,\r\n                        visible: true,\r\n                        time: 0\r\n                    });\r\n                }\r\n            }\r\n            \r\n            // Add neutron as reacting particle\r\n            this.reactingParticles.push({\r\n                x: centerX - 150,\r\n                y: centerY,\r\n                targetX: centerX,\r\n                targetY: centerY,\r\n                type: 'neutron',\r\n                radius: 12, // Much larger for better visibility\r\n                color: '#9C27B0',\r\n                speed: 80,\r\n                moving: false,\r\n                life: 10\r\n            });\r\n        } else if (this.mode === 'fission') {\r\n            // Single fission demonstration\r\n                            this.nuclei.push({\r\n                    x: centerX,\r\n                    y: centerY,\r\n                    type: 'uranium',\r\n                    protons: 92,\r\n                    neutrons: 143,\r\n                    mass: 235,\r\n                    radius: 30, // Much larger than hydrogen atoms for proportion\r\n                    color: '#FF6B35',\r\n                    stability: 0.8,\r\n                    fissioned: false,\r\n                    visible: true,\r\n                    time: 0\r\n                });\r\n            \r\n            // Add neutron as reacting particle\r\n            this.reactingParticles.push({\r\n                x: centerX - 150,\r\n                y: centerY,\r\n                targetX: centerX,\r\n                targetY: centerY,\r\n                type: 'neutron',\r\n                radius: 12, // Much larger for better visibility\r\n                color: '#9C27B0',\r\n                speed: 80,\r\n                moving: false,\r\n                life: 10\r\n            });\r\n        } else if (this.mode === 'fusion') {\r\n            // Single fusion demonstration with deuterium (H-2) and tritium (H-3)\r\n            // Only create the tritium nucleus - deuterium will be the reacting particle\r\n            this.nuclei.push({\r\n                x: centerX + 60,\r\n                y: centerY,\r\n                type: 'tritium',\r\n                protons: 1,\r\n                neutrons: 2,\r\n                mass: 3,\r\n                radius: 20, // Even bigger for better visibility\r\n                color: '#4CAF50',\r\n                stability: 0.9,\r\n                fused: false,\r\n                visible: true,\r\n                time: 0\r\n            });\r\n            \r\n            // Add deuterium as reacting particle (this will be the moving H-2)\r\n            this.reactingParticles.push({\r\n                x: centerX - 60,\r\n                y: centerY,\r\n                targetX: centerX + 60,\r\n                targetY: centerY,\r\n                type: 'deuterium',\r\n                radius: 20, // Same size as nucleus for consistency\r\n                color: '#4CAF50',\r\n                speed: 60,\r\n                moving: false,\r\n                life: 10\r\n            });\r\n\r\n        }\r\n    }\r\n    \r\n    setSpeed(speed) {\r\n        this.speed = speed;\r\n    }\r\n    \r\n    setMode(mode) {\r\n        this.mode = mode;\r\n        this.chainStarted = false;\r\n        this.reset();\r\n    }\r\n    \r\n    setNeutronEnergy(energy) {\r\n        this.neutronEnergy = energy;\r\n        // Update neutron speeds based on energy\r\n        this.neutrons.forEach(neutron => {\r\n            const speed = 50 + energy * 100;\r\n            const angle = Math.atan2(neutron.vy, neutron.vx);\r\n            neutron.vx = Math.cos(angle) * speed;\r\n            neutron.vy = Math.sin(angle) * speed;\r\n        });\r\n    }\r\n    \r\n    setTemperature(temp) {\r\n        this.temperature = temp;\r\n        // Temperature affects reaction intensity - more energy particles and faster reactions\r\n    }\r\n    \r\n\r\n    \r\n    reset() {\r\n        this.time = 0;\r\n        this.energyReleased = 0;\r\n        this.neutronsProduced = 0;\r\n        this.chainReactions = 0;\r\n        this.fissionCount = 0;\r\n        this.fusionCount = 0;\r\n        this.initializeNuclei();\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        this.time += deltaTime * this.speed * 0.001;\r\n        \r\n        // Update nuclei\r\n        this.nuclei.forEach(nucleus => {\r\n            nucleus.time += deltaTime * this.speed * 0.001;\r\n            \r\n            // No random events - only reactions through reacting particles\r\n        });\r\n        \r\n        // Update neutrons\r\n        this.neutrons.forEach(neutron => {\r\n            neutron.x += neutron.vx * deltaTime * this.speed * 0.001;\r\n            neutron.y += neutron.vy * deltaTime * this.speed * 0.001;\r\n            \r\n            // Slow down reaction product neutrons over time\r\n            if (neutron.isReactionProduct) {\r\n                neutron.vx *= 0.99;\r\n                neutron.vy *= 0.99;\r\n                \r\n                // Keep neutrons within canvas bounds\r\n                if (neutron.x < neutron.radius) {\r\n                    neutron.x = neutron.radius;\r\n                    neutron.vx = Math.abs(neutron.vx) * 0.5;\r\n                }\r\n                if (neutron.x > this.canvas.width - neutron.radius) {\r\n                    neutron.x = this.canvas.width - neutron.radius;\r\n                    neutron.vx = -Math.abs(neutron.vx) * 0.5;\r\n                }\r\n                if (neutron.y < neutron.radius) {\r\n                    neutron.y = neutron.radius;\r\n                    neutron.vy = Math.abs(neutron.vy) * 0.5;\r\n                }\r\n                if (neutron.y > this.canvas.height - neutron.radius) {\r\n                    neutron.y = this.canvas.height - neutron.radius;\r\n                    neutron.vy = -Math.abs(neutron.vy) * 0.5;\r\n                }\r\n            } else {\r\n                // Only decrease life for non-reaction product neutrons\r\n                neutron.life -= deltaTime * this.speed * 0.001;\r\n            }\r\n            \r\n            // Check for neutron capture - enhanced chain reaction\r\n            this.nuclei.forEach(nucleus => {\r\n                if (nucleus.type === 'uranium' && !nucleus.fissioned) {\r\n                    const distance = Math.sqrt((neutron.x - nucleus.x) ** 2 + (neutron.y - nucleus.y) ** 2);\r\n                    if (distance < nucleus.radius + 15) { // Increased detection radius\r\n                        this.triggerFission(nucleus);\r\n                        if (!neutron.isReactionProduct) {\r\n                            neutron.life = 0; // Only remove non-reaction product neutrons\r\n                        }\r\n                        this.chainReactions++;\r\n                        \r\n                        // Enhanced chain reaction - spawn more neutrons\r\n                        const additionalNeutrons = 2 + Math.floor(Math.random() * 3); // More neutrons\r\n                        for (let i = 0; i < additionalNeutrons; i++) {\r\n                            this.spawnReactionNeutronAt(nucleus.x, nucleus.y);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        \r\n        // Remove dead neutrons - keep reaction product neutrons permanently\r\n        this.neutrons = this.neutrons.filter(neutron => {\r\n            if (neutron.isReactionProduct) {\r\n                return true; // Keep reaction product neutrons permanently\r\n            }\r\n            // For non-reaction product neutrons, keep them visible longer\r\n            return neutron.life > -10;\r\n        });\r\n        \r\n        // Update fission products\r\n        this.fissionProducts.forEach(product => {\r\n            product.x += product.vx * deltaTime * this.speed * 0.001;\r\n            product.y += product.vy * deltaTime * this.speed * 0.001;\r\n            // Slow down the products over time\r\n            product.vx *= 0.99;\r\n            product.vy *= 0.99;\r\n            // Don't remove products - let them stay visible\r\n        });\r\n        \r\n        // Update fusion products\r\n        this.fusionProducts.forEach(product => {\r\n            product.x += product.vx * deltaTime * this.speed * 0.001;\r\n            product.y += product.vy * deltaTime * this.speed * 0.001;\r\n            // Slow down the products over time\r\n            product.vx *= 0.99;\r\n            product.vy *= 0.99;\r\n            // Don't remove products - let them stay visible\r\n        });\r\n        \r\n        // Update reacting particles\r\n        this.reactingParticles.forEach(particle => {\r\n            if (particle.moving) {\r\n                // Calculate direction to target\r\n                const dx = particle.targetX - particle.x;\r\n                const dy = particle.targetY - particle.y;\r\n                const distance = Math.sqrt(dx * dx + dy * dy);\r\n                \r\n                if (distance > 5) {\r\n                    // Move toward target with some randomness\r\n                    const speed = particle.speed * deltaTime * this.speed * 0.001;\r\n                    \r\n                    // Add slight randomness to make it more realistic\r\n                    const randomAngle = (Math.random() - 0.5) * 0.1; // Small random angle\r\n                    const angle = Math.atan2(dy, dx) + randomAngle;\r\n                    \r\n                    particle.x += Math.cos(angle) * speed;\r\n                    particle.y += Math.sin(angle) * speed;\r\n                    \r\n                    // Check if particle has moved too far from target (missed)\r\n                    const newDistance = Math.sqrt((particle.x - particle.targetX) ** 2 + (particle.y - particle.targetY) ** 2);\r\n                    if (newDistance > distance + 20) {\r\n                        // Particle missed the target\r\n                        particle.life = 0;\r\n                    }\r\n                } else {\r\n                    // Collision occurred - trigger reaction\r\n                    this.handleReactionCollision(particle);\r\n                    particle.life = 0; // Remove the particle\r\n                }\r\n            }\r\n        });\r\n        this.reactingParticles = this.reactingParticles.filter(particle => particle.life > 0);\r\n        \r\n        // Update energy particles\r\n        this.energyParticles.forEach(particle => {\r\n            particle.x += particle.vx * deltaTime * this.speed * 0.001;\r\n            particle.y += particle.vy * deltaTime * this.speed * 0.001;\r\n            // Slow down energy particles over time but keep them visible\r\n            particle.vx *= 0.98;\r\n            particle.vy *= 0.98;\r\n            particle.life -= deltaTime * this.speed * 0.001;\r\n            particle.radius += deltaTime * this.speed * 0.001 * 5; // Slower expansion\r\n        });\r\n        // Keep energy particles visible longer - only remove after much longer time\r\n        this.energyParticles = this.energyParticles.filter(particle => particle.life > -10);\r\n        \r\n        // Update shockwaves\r\n        this.shockwaves.forEach(wave => {\r\n            wave.radius += wave.speed * deltaTime * this.speed * 0.001;\r\n            wave.life -= deltaTime * this.speed * 0.001 * 0.5; // Fade out over time\r\n        });\r\n        \r\n        // Remove dead shockwaves\r\n        this.shockwaves = this.shockwaves.filter(wave => wave.life > 0);\r\n        \r\n        // Description stays until reset - no timer\r\n        \r\n        // No automatic neutron spawning - only use pre-drawn reacting particles\r\n    }\r\n    \r\n    triggerFission(nucleus) {\r\n        nucleus.fissioned = true;\r\n        nucleus.visible = false; // Hide the uranium atom after fission\r\n        this.fissionCount++;\r\n        this.energyReleased += 200 * this.temperature; // MeV - affected by temperature\r\n        \r\n        // Create fission products\r\n        const angle = Math.random() * Math.PI * 2;\r\n        const speed = (50 + Math.random() * 100) * this.temperature;\r\n        \r\n        // First fission product (lighter) - Krypton-92\r\n        this.fissionProducts.push({\r\n            x: nucleus.x,\r\n            y: nucleus.y,\r\n            vx: Math.cos(angle) * speed,\r\n            vy: Math.sin(angle) * speed,\r\n            mass: 92,\r\n            protons: 36,\r\n            neutrons: 56,\r\n            color: '#FF9800',\r\n            radius: 8,\r\n            life: 8 // Longer life for better visibility\r\n        });\r\n        \r\n        // Second fission product (heavier) - Barium-141\r\n        this.fissionProducts.push({\r\n            x: nucleus.x,\r\n            y: nucleus.y,\r\n            vx: Math.cos(angle + Math.PI) * speed,\r\n            vy: Math.sin(angle + Math.PI) * speed,\r\n            mass: 141,\r\n            protons: 56,\r\n            neutrons: 85,\r\n            color: '#E91E63',\r\n            radius: 9,\r\n            life: 8 // Longer life for better visibility\r\n        });\r\n        \r\n        // Spawn neutrons as fission products - affected by temperature\r\n        const neutronCount = Math.floor(1 + Math.random() * 2 + this.temperature * 0.5); // Fewer neutrons for single reactions\r\n        for (let i = 0; i < neutronCount; i++) {\r\n            this.spawnReactionNeutronAt(nucleus.x, nucleus.y);\r\n        }\r\n        \r\n        // Create moderate energy release explosion - affected by temperature\r\n        const energyParticleCount = Math.floor(8 * this.temperature); // Reduced from 20\r\n        const colors = ['#FFD700', '#FF6B35', '#FF8C00']; // Fewer colors\r\n        \r\n        for (let i = 0; i < energyParticleCount; i++) {\r\n            const angle = (i / energyParticleCount) * Math.PI * 2;\r\n            const speed = (25 + Math.random() * 35) * this.temperature; // Reduced speed\r\n            const radius = 2 + Math.random() * 4; // Smaller particles\r\n            const life = 10 + Math.random() * 8; // Shorter life\r\n            \r\n            this.energyParticles.push({\r\n                x: nucleus.x,\r\n                y: nucleus.y,\r\n                vx: Math.cos(angle) * speed,\r\n                vy: Math.sin(angle) * speed,\r\n                color: colors[Math.floor(Math.random() * colors.length)],\r\n                radius: radius,\r\n                life: life,\r\n                originalRadius: radius,\r\n                pulse: Math.random() * Math.PI * 2 // For pulsing effect\r\n            });\r\n        }\r\n        \r\n        // Add smaller shockwave effect\r\n        this.shockwaves.push({\r\n            x: nucleus.x,\r\n            y: nucleus.y,\r\n            radius: 0,\r\n            maxRadius: 80 * this.temperature, // Reduced from 150\r\n            speed: 120 * this.temperature, // Reduced from 200\r\n            life: 0.8, // Shorter life\r\n            color: 'rgba(255, 215, 0, 0.2)' // Less opacity\r\n        });\r\n    }\r\n    \r\n    triggerFusion(nucleus) {\r\n        nucleus.fused = true;\r\n        nucleus.visible = false; // Hide the hydrogen atoms after fusion\r\n        \r\n        // Also hide the deuterium nucleus (the reacting particle's source)\r\n        this.nuclei.forEach(hNucleus => {\r\n            if (hNucleus.type === 'deuterium' && !hNucleus.fused) {\r\n                hNucleus.visible = false;\r\n            }\r\n        });\r\n        \r\n        this.fusionCount++;\r\n        this.energyReleased += 17.6 * this.temperature; // MeV for deuterium-tritium fusion - affected by temperature\r\n        \r\n        // Create helium nucleus - Helium-4\r\n        this.fusionProducts.push({\r\n            x: nucleus.x,\r\n            y: nucleus.y,\r\n            vx: (Math.random() - 0.5) * 40 * this.temperature,\r\n            vy: (Math.random() - 0.5) * 40 * this.temperature,\r\n            mass: 4,\r\n            protons: 2,\r\n            neutrons: 2,\r\n            color: '#2196F3',\r\n            radius: 25, // Even larger radius for better visibility\r\n            life: 8 // Longer life for better visibility\r\n        });\r\n        \r\n        // Spawn neutron as fusion product (scientifically accurate for D-T fusion)\r\n        this.spawnReactionNeutronAt(nucleus.x, nucleus.y);\r\n        \r\n        // Create moderate fusion energy release - affected by temperature\r\n        const energyParticleCount = Math.floor(6 * this.temperature); // Reduced from 15\r\n        const colors = ['#FFEB3B', '#FFD700', '#FFA500']; // Fewer colors\r\n        \r\n        for (let i = 0; i < energyParticleCount; i++) {\r\n            const angle = (i / energyParticleCount) * Math.PI * 2;\r\n            const speed = (20 + Math.random() * 30) * this.temperature; // Reduced speed\r\n            const radius = 4 + Math.random() * 6; // Smaller particles\r\n            const life = 8 + Math.random() * 6; // Shorter life\r\n            \r\n            this.energyParticles.push({\r\n                x: nucleus.x,\r\n                y: nucleus.y,\r\n                vx: Math.cos(angle) * speed,\r\n                vy: Math.sin(angle) * speed,\r\n                color: colors[Math.floor(Math.random() * colors.length)],\r\n                radius: radius,\r\n                life: life,\r\n                originalRadius: radius,\r\n                pulse: Math.random() * Math.PI * 2 // For pulsing effect\r\n            });\r\n        }\r\n        \r\n        // Add smaller fusion shockwave effect\r\n        this.shockwaves.push({\r\n            x: nucleus.x,\r\n            y: nucleus.y,\r\n            radius: 0,\r\n            maxRadius: 60 * this.temperature, // Reduced from 120\r\n            speed: 100 * this.temperature, // Reduced from 180\r\n            life: 0.7, // Shorter life\r\n            color: 'rgba(255, 235, 59, 0.25)' // Less opacity\r\n        });\r\n    }\r\n    \r\n    spawnNeutron() {\r\n        const angle = Math.random() * Math.PI * 2;\r\n        const radius = 100;\r\n        const x = this.canvas.width / 2 + Math.cos(angle) * radius;\r\n        const y = this.canvas.height / 2 + Math.sin(angle) * radius;\r\n        this.spawnNeutronAt(x, y);\r\n    }\r\n    \r\n    spawnNeutronAt(x, y) {\r\n        const angle = Math.random() * Math.PI * 2;\r\n        const speed = (30 + Math.random() * 40) * this.neutronEnergy; // Speed affected by neutron energy\r\n        \r\n        this.neutrons.push({\r\n            x: x,\r\n            y: y,\r\n            vx: Math.cos(angle) * speed,\r\n            vy: Math.sin(angle) * speed,\r\n            color: '#9C27B0',\r\n            radius: 4, // Slightly larger for better visibility\r\n            life: 15, // Regular lifetime for chain reaction neutrons\r\n            isReactionProduct: false // Not a reaction product\r\n        });\r\n        \r\n        this.neutronsProduced++;\r\n    }\r\n    \r\n    spawnReactionNeutronAt(x, y) {\r\n        const angle = Math.random() * Math.PI * 2;\r\n        const speed = (30 + Math.random() * 40) * this.neutronEnergy; // Speed affected by neutron energy\r\n        \r\n        this.neutrons.push({\r\n            x: x,\r\n            y: y,\r\n            vx: Math.cos(angle) * speed,\r\n            vy: Math.sin(angle) * speed,\r\n            color: '#9C27B0',\r\n            radius: 4, // Slightly larger for better visibility\r\n            life: Infinity, // Permanent lifetime for reaction products\r\n            isReactionProduct: true // Mark as reaction product\r\n        });\r\n        \r\n        this.neutronsProduced++;\r\n    }\r\n    \r\n    findTargetForParticle(particle) {\r\n        if (particle.type === 'neutron') {\r\n            // Find the closest uranium nucleus\r\n            let closestNucleus = null;\r\n            let closestDistance = Infinity;\r\n            \r\n            this.nuclei.forEach(nucleus => {\r\n                if (nucleus.type === 'uranium' && !nucleus.fissioned) {\r\n                    const distance = Math.sqrt((particle.x - nucleus.x) ** 2 + (particle.y - nucleus.y) ** 2);\r\n                    if (distance < closestDistance) {\r\n                        closestDistance = distance;\r\n                        closestNucleus = nucleus;\r\n                    }\r\n                }\r\n            });\r\n            \r\n            if (closestNucleus) {\r\n                particle.targetX = closestNucleus.x;\r\n                particle.targetY = closestNucleus.y;\r\n                particle.targetNucleus = closestNucleus;\r\n            }\r\n        } else if (particle.type === 'deuterium') {\r\n            // Find the closest tritium nucleus for fusion\r\n            let closestNucleus = null;\r\n            let closestDistance = Infinity;\r\n            \r\n            this.nuclei.forEach(nucleus => {\r\n                if (nucleus.type === 'tritium' && !nucleus.fused) {\r\n                    const distance = Math.sqrt((particle.x - nucleus.x) ** 2 + (particle.y - nucleus.y) ** 2);\r\n                    if (distance < closestDistance) {\r\n                        closestDistance = distance;\r\n                        closestNucleus = nucleus;\r\n                    }\r\n                }\r\n            });\r\n            \r\n            if (closestNucleus) {\r\n                particle.targetX = closestNucleus.x;\r\n                particle.targetY = closestNucleus.y;\r\n                particle.targetNucleus = closestNucleus;\r\n            }\r\n        }\r\n    }\r\n    \r\n    handleReactionCollision(particle) {\r\n        if (particle.type === 'neutron' && particle.targetNucleus) {\r\n            const distance = Math.sqrt((particle.x - particle.targetNucleus.x) ** 2 + (particle.y - particle.targetNucleus.y) ** 2);\r\n            if (distance < particle.targetNucleus.radius + 10) {\r\n                this.triggerFission(particle.targetNucleus);\r\n            }\r\n        } else if (particle.type === 'deuterium' && particle.targetNucleus) {\r\n            const distance = Math.sqrt((particle.x - particle.targetNucleus.x) ** 2 + (particle.y - particle.targetNucleus.y) ** 2);\r\n            if (distance < particle.targetNucleus.radius + 10) {\r\n                // Trigger fusion for the target tritium nucleus only\r\n                if (particle.targetNucleus.type === 'tritium' && !particle.targetNucleus.fused) {\r\n                    this.triggerFusion(particle.targetNucleus);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    render() {\r\n        // Clear canvas\r\n        this.ctx.fillStyle = '#1a1a1a';\r\n        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n        \r\n        // Draw background grid\r\n        this.drawGrid();\r\n        \r\n        // Draw shockwaves (behind all particles)\r\n        this.shockwaves.forEach(wave => {\r\n            this.ctx.save();\r\n            this.ctx.globalAlpha = Math.max(0, wave.life);\r\n            this.ctx.strokeStyle = wave.color;\r\n            this.ctx.lineWidth = 8;\r\n            this.ctx.shadowColor = wave.color;\r\n            this.ctx.shadowBlur = 30;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(wave.x, wave.y, wave.radius, 0, Math.PI * 2);\r\n            this.ctx.stroke();\r\n            this.ctx.restore();\r\n        });\r\n        \r\n        // Draw energy particles\r\n        this.energyParticles.forEach(particle => {\r\n            this.ctx.save();\r\n            // Keep particles visible even when life is negative\r\n            this.ctx.globalAlpha = Math.max(0.3, particle.life / 2);\r\n            this.ctx.fillStyle = particle.color;\r\n            this.ctx.shadowColor = particle.color;\r\n            this.ctx.shadowBlur = 10;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(particle.x, particle.y, particle.radius, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            this.ctx.restore();\r\n        });\r\n        \r\n        // Draw fission products\r\n        this.fissionProducts.forEach(product => {\r\n            this.ctx.save();\r\n            this.ctx.globalAlpha = 1.0; // Always fully visible\r\n            this.ctx.fillStyle = product.color;\r\n            this.ctx.shadowColor = product.color;\r\n            this.ctx.shadowBlur = 8;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(product.x, product.y, product.radius, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Draw fission product label\r\n            this.ctx.globalAlpha = 1.0;\r\n            this.ctx.fillStyle = '#FFFFFF';\r\n            this.ctx.font = 'bold 14px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n            this.ctx.shadowBlur = 2;\r\n            \r\n            // Determine element symbol based on protons\r\n            let elementSymbol = '';\r\n            if (product.protons === 36) {\r\n                elementSymbol = 'Kr'; // Krypton-92\r\n            } else if (product.protons === 56) {\r\n                elementSymbol = 'Ba'; // Barium-141\r\n            } else {\r\n                elementSymbol = 'X'; // Unknown fission product\r\n            }\r\n            \r\n            this.ctx.fillText(elementSymbol, product.x, product.y + 2);\r\n            this.ctx.font = '12px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.fillText(`${product.mass}`, product.x, product.y + product.radius + 10);\r\n            this.ctx.restore();\r\n        });\r\n        \r\n        // Draw fusion products\r\n        this.fusionProducts.forEach(product => {\r\n            this.ctx.save();\r\n            this.ctx.globalAlpha = 1.0; // Always fully visible\r\n            this.ctx.fillStyle = product.color;\r\n            this.ctx.shadowColor = product.color;\r\n            this.ctx.shadowBlur = 8;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(product.x, product.y, product.radius, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Draw fusion product label (Helium)\r\n            this.ctx.globalAlpha = 1.0;\r\n            this.ctx.fillStyle = '#FFFFFF';\r\n            this.ctx.font = 'bold 14px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n            this.ctx.fillText('He', product.x, product.y + 2);\r\n            this.ctx.font = '12px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.fillText(`${product.mass}`, product.x, product.y + product.radius + 10);\r\n            this.ctx.restore();\r\n        });\r\n        \r\n        // Draw neutrons\r\n        this.neutrons.forEach(neutron => {\r\n            this.ctx.save();\r\n            // Reaction product neutrons are always fully visible\r\n            if (neutron.isReactionProduct) {\r\n                this.ctx.globalAlpha = 1.0;\r\n            } else {\r\n                // Keep other neutrons visible even when life is negative\r\n                this.ctx.globalAlpha = Math.max(0.4, neutron.life / 5);\r\n            }\r\n            this.ctx.fillStyle = neutron.color;\r\n            this.ctx.shadowColor = neutron.color;\r\n            this.ctx.shadowBlur = 8;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(neutron.x, neutron.y, neutron.radius, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Draw neutron label\r\n            if (neutron.isReactionProduct) {\r\n                this.ctx.globalAlpha = 1.0;\r\n            } else {\r\n                this.ctx.globalAlpha = Math.max(0.4, neutron.life / 5);\r\n            }\r\n            this.ctx.fillStyle = '#FFFFFF';\r\n            this.ctx.font = 'bold 12px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n            this.ctx.shadowBlur = 2;\r\n            this.ctx.fillText('n', neutron.x, neutron.y + 3);\r\n            this.ctx.restore();\r\n        });\r\n        \r\n        // Draw reacting particles\r\n        this.reactingParticles.forEach(particle => {\r\n            this.ctx.save();\r\n            \r\n            // Draw trail if moving\r\n            if (particle.moving) {\r\n                this.ctx.strokeStyle = particle.color;\r\n                this.ctx.lineWidth = 2;\r\n                this.ctx.globalAlpha = 0.6;\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(particle.x, particle.y);\r\n                // Draw a short trail in the direction of movement\r\n                const dx = particle.targetX - particle.x;\r\n                const dy = particle.targetY - particle.y;\r\n                const distance = Math.sqrt(dx * dx + dy * dy);\r\n                if (distance > 0) {\r\n                    this.ctx.lineTo(particle.x - (dx / distance) * 15, particle.y - (dy / distance) * 15);\r\n                }\r\n                this.ctx.stroke();\r\n                this.ctx.globalAlpha = 1;\r\n            }\r\n            \r\n            this.ctx.fillStyle = particle.color;\r\n            this.ctx.shadowColor = particle.color;\r\n            this.ctx.shadowBlur = 10;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(particle.x, particle.y, particle.radius, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Draw particle label\r\n            this.ctx.fillStyle = '#FFFFFF';\r\n            this.ctx.font = 'bold 12px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n            this.ctx.shadowBlur = 2;\r\n            \r\n            if (particle.type === 'neutron') {\r\n                this.ctx.fillText('n', particle.x, particle.y + 3);\r\n            } else if (particle.type === 'deuterium') {\r\n                this.ctx.fillText('²H', particle.x, particle.y + 3);\r\n            }\r\n            \r\n            // No click indicator needed since you can click anywhere\r\n            \r\n            this.ctx.restore();\r\n        });\r\n        \r\n        // Draw nuclei\r\n        this.nuclei.forEach(nucleus => {\r\n            if (nucleus.visible !== false) { // Only draw visible nuclei\r\n                if (this.mode === 'fission' && nucleus.type === 'uranium') {\r\n                    this.drawNucleus(nucleus);\r\n                    this.drawClickIndicator(nucleus);\r\n                } else if (this.mode === 'fusion' && (nucleus.type === 'deuterium' || nucleus.type === 'tritium')) {\r\n                    this.drawNucleus(nucleus);\r\n                    this.drawClickIndicator(nucleus);\r\n                } else if (this.mode === 'chain' && nucleus.type === 'uranium') {\r\n                    this.drawNucleus(nucleus);\r\n                    this.drawClickIndicator(nucleus);\r\n                }\r\n            }\r\n        });\r\n        \r\n        // Draw labels\r\n        this.drawNuclearLabels();\r\n        \r\n\r\n    }\r\n    \r\n    drawGrid() {\r\n        this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';\r\n        this.ctx.lineWidth = 1;\r\n        \r\n        const gridSize = 50;\r\n        for (let x = 0; x < this.canvas.width; x += gridSize) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x, 0);\r\n            this.ctx.lineTo(x, this.canvas.height);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        for (let y = 0; y < this.canvas.height; y += gridSize) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(0, y);\r\n            this.ctx.lineTo(this.canvas.width, y);\r\n            this.ctx.stroke();\r\n        }\r\n    }\r\n    \r\n    drawNucleus(nucleus) {\r\n        // Draw nucleus with enhanced visual representation\r\n        this.ctx.save();\r\n        \r\n        // Outer glow\r\n        this.ctx.shadowColor = nucleus.color;\r\n        this.ctx.shadowBlur = 15;\r\n        this.ctx.fillStyle = nucleus.color;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(nucleus.x, nucleus.y, nucleus.radius, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Inner core with gradient effect\r\n        this.ctx.shadowBlur = 0;\r\n        const gradient = this.ctx.createRadialGradient(\r\n            nucleus.x, nucleus.y, 0,\r\n            nucleus.x, nucleus.y, nucleus.radius * 0.6\r\n        );\r\n        gradient.addColorStop(0, '#FFFFFF');\r\n        gradient.addColorStop(1, nucleus.color);\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(nucleus.x, nucleus.y, nucleus.radius * 0.6, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Enhanced nucleon representation\r\n        this.ctx.fillStyle = '#000000';\r\n        const nucleonCount = Math.min(nucleus.protons + nucleus.neutrons, 12);\r\n        for (let i = 0; i < nucleonCount; i++) {\r\n            const angle = (i / nucleonCount) * Math.PI * 2;\r\n            const radius = nucleus.radius * 0.4;\r\n            const x = nucleus.x + Math.cos(angle) * radius;\r\n            const y = nucleus.y + Math.sin(angle) * radius;\r\n            \r\n            // Draw nucleon with small glow\r\n            this.ctx.save();\r\n            this.ctx.shadowColor = '#000000';\r\n            this.ctx.shadowBlur = 1;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(x, y, 1.5, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            this.ctx.restore();\r\n        }\r\n        \r\n        this.ctx.restore();\r\n        \r\n        // Draw element symbol and details with enhanced styling\r\n        this.ctx.save();\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        \r\n        // Element symbol with background circle\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(nucleus.x, nucleus.y + 2, 8, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.font = 'bold 14px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        let elementSymbol = '';\r\n        if (nucleus.type === 'uranium') {\r\n            elementSymbol = 'U';\r\n        } else if (nucleus.type === 'deuterium') {\r\n            elementSymbol = '²H';\r\n        } else if (nucleus.type === 'tritium') {\r\n            elementSymbol = '³H';\r\n        }\r\n        this.ctx.fillText(elementSymbol, nucleus.x, nucleus.y + 5);\r\n        \r\n        // Mass number with background\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.6)';\r\n        this.ctx.fillRect(nucleus.x - 15, nucleus.y + nucleus.radius + 5, 30, 12);\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.font = 'bold 11px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillText(`${nucleus.mass}`, nucleus.x, nucleus.y + nucleus.radius + 14);\r\n        \r\n        // Proton/neutron count with background\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';\r\n        this.ctx.fillRect(nucleus.x - 25, nucleus.y + nucleus.radius + 15, 50, 10);\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.font = '9px Arial';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillText(`${nucleus.protons}p, ${nucleus.neutrons}n`, nucleus.x, nucleus.y + nucleus.radius + 23);\r\n        \r\n        this.ctx.restore();\r\n    }\r\n    \r\n    drawClickIndicator(nucleus) {\r\n        // Draw pulsing ring to indicate clickability\r\n        if ((this.mode === 'fission' && nucleus.type === 'uranium' && !nucleus.fissioned) ||\r\n            (this.mode === 'fusion' && (nucleus.type === 'deuterium' || nucleus.type === 'tritium') && !nucleus.fused)) {\r\n            \r\n            this.ctx.save();\r\n            const pulse = Math.sin(this.time * 3) * 0.3 + 0.7;\r\n            this.ctx.strokeStyle = `rgba(255, 255, 255, ${pulse * 0.6})`;\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.setLineDash([5, 5]);\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(nucleus.x, nucleus.y, nucleus.radius + 8, 0, Math.PI * 2);\r\n            this.ctx.stroke();\r\n            this.ctx.restore();\r\n        }\r\n    }\r\n    \r\n    drawNuclearLabels() {\r\n        this.ctx.save();\r\n        \r\n        // Set up text styling\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        \r\n        // Draw chemical formulas at the top with white text and glow effect\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        \r\n        if (this.mode === 'fission') {\r\n            this.ctx.fillText(`²³⁵U + ¹n → ⁹²Kr + ¹⁴¹Ba + 3¹n + 200 MeV`, \r\n                              this.ctx.canvas.width / 2, 30);\r\n            this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.fillText(`Nuclear Fission`, \r\n                              this.ctx.canvas.width / 2, 50);\r\n        } else if (this.mode === 'fusion') {\r\n            this.ctx.fillText(`²H + ³H → ⁴He + ¹n + 17.6 MeV`, \r\n                              this.ctx.canvas.width / 2, 30);\r\n            this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.fillText(`Nuclear Fusion`, \r\n                              this.ctx.canvas.width / 2, 50);\r\n        } else if (this.mode === 'chain') {\r\n            this.ctx.fillText(`²³⁵U + ¹n → ⁹²Kr + ¹⁴¹Ba + 3¹n + 200 MeV`, \r\n                              this.ctx.canvas.width / 2, 30);\r\n            this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n            this.ctx.fillText(`Chain Reaction`, \r\n                              this.ctx.canvas.width / 2, 50);\r\n        } else {\r\n            this.ctx.fillText(`E = mc²`, \r\n                              this.ctx.canvas.width / 2, 30);\r\n            this.ctx.fillText(`Nuclear Binding Energy`, \r\n                              this.ctx.canvas.width / 2, 50);\r\n        }\r\n        \r\n        // Draw click instructions at the bottom\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = '#FFD700';\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        \r\n        if (this.mode === 'fission') {\r\n            this.ctx.fillText(`Click anywhere to trigger fission`, \r\n                              this.ctx.canvas.width / 2, this.ctx.canvas.height - 20);\r\n        } else if (this.mode === 'fusion') {\r\n            this.ctx.fillText(`Click anywhere to trigger fusion`, \r\n                              this.ctx.canvas.width / 2, this.ctx.canvas.height - 20);\r\n        } else if (this.mode === 'chain') {\r\n            this.ctx.fillText(`Click anywhere to trigger chain reaction`, \r\n                              this.ctx.canvas.width / 2, this.ctx.canvas.height - 20);\r\n        }\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.restore();\r\n    }\r\n    \r\n\r\n    \r\n    getStats() {\r\n        return {\r\n            mode: this.mode,\r\n            energyReleased: this.energyReleased.toFixed(1),\r\n            neutronsProduced: this.neutronsProduced,\r\n            chainReactions: this.chainReactions,\r\n            fissionCount: this.fissionCount,\r\n            fusionCount: this.fusionCount,\r\n            temperature: this.temperature.toFixed(1),\r\n            time: this.time.toFixed(1)\r\n        };\r\n    }\r\n\r\n}","\r\n// Fluid Flow Simulation\r\nexport class FluidFlow {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.particles = [];\r\n        this.obstacles = [];\r\n        this.flowRate = 1;\r\n        this.viscosity = 1;\r\n        this.reynoldsNumber = 100;\r\n        this.visualizationMode = 'particles';\r\n        this.time = 0;\r\n        this.maxParticles = 100;\r\n        this.flowType = 'Laminar';\r\n        this.mouseX = 0;\r\n        this.mouseY = 0;\r\n        this.mouseInfluence = 40;\r\n        \r\n        this.initializeParticles();\r\n        this.initializeObstacles();\r\n        this.setupMouseInteraction();\r\n    }\r\n    \r\n    setupMouseInteraction() {\r\n        const canvas = this.ctx.canvas;\r\n        canvas.addEventListener('mousemove', (e) => {\r\n            const rect = canvas.getBoundingClientRect();\r\n            this.mouseX = e.clientX - rect.left;\r\n            this.mouseY = e.clientY - rect.top;\r\n        });\r\n        \r\n        canvas.addEventListener('mouseleave', () => {\r\n            this.mouseX = -1000;\r\n            this.mouseY = -1000;\r\n        });\r\n        \r\n        // Add touch event listeners for mobile support\r\n        canvas.addEventListener('touchstart', (e) => {\r\n            e.preventDefault();\r\n            const rect = canvas.getBoundingClientRect();\r\n            const touch = e.touches[0];\r\n            this.mouseX = touch.clientX - rect.left;\r\n            this.mouseY = touch.clientY - rect.top;\r\n        });\r\n        \r\n        canvas.addEventListener('touchmove', (e) => {\r\n            e.preventDefault();\r\n            const rect = canvas.getBoundingClientRect();\r\n            const touch = e.touches[0];\r\n            this.mouseX = touch.clientX - rect.left;\r\n            this.mouseY = touch.clientY - rect.top;\r\n        });\r\n        \r\n        canvas.addEventListener('touchend', (e) => {\r\n            e.preventDefault();\r\n            this.mouseX = -1000;\r\n            this.mouseY = -1000;\r\n        });\r\n    }\r\n    \r\n    initializeParticles() {\r\n        this.particles = [];\r\n        for (let i = 0; i < this.maxParticles; i++) {\r\n            this.particles.push({\r\n                x: -50 + Math.random() * 100, // Start from left side\r\n                y: 50 + Math.random() * (this.ctx.canvas.height - 100),\r\n                vx: this.flowRate * (1 + Math.random() * 0.3),\r\n                vy: (Math.random() - 0.5) * 0.3,\r\n                size: 3 + Math.random() * 2,\r\n                color: `hsl(${200 + Math.random() * 60}, 70%, 60%)`,\r\n                life: 0\r\n            });\r\n        }\r\n    }\r\n    \r\n    initializeObstacles() {\r\n        this.obstacles = [\r\n            // Porous sponge in the middle top\r\n            { x: 400, y: 80, width: 80, height: 100, type: 'porous' },\r\n            // Solid building in the middle bottom\r\n            { x: 400, y: 420, width: 100, height: 120, type: 'solid' }\r\n        ];\r\n    }\r\n    \r\n    setFlowRate(rate) {\r\n        this.flowRate = rate;\r\n        this.updateReynoldsNumber();\r\n    }\r\n    \r\n    setViscosity(visc) {\r\n        this.viscosity = visc;\r\n        this.updateReynoldsNumber();\r\n    }\r\n    \r\n    setReynoldsNumber(re) {\r\n        this.reynoldsNumber = re;\r\n        this.updateFlowType();\r\n    }\r\n    \r\n    setVisualizationMode(mode) {\r\n        this.visualizationMode = mode;\r\n    }\r\n    \r\n    updateReynoldsNumber() {\r\n        // Simplified Reynolds number calculation\r\n        this.reynoldsNumber = Math.round((this.flowRate * 50) / this.viscosity);\r\n        this.updateFlowType();\r\n    }\r\n    \r\n    updateFlowType() {\r\n        if (this.reynoldsNumber < 2300) {\r\n            this.flowType = 'Laminar';\r\n        } else if (this.reynoldsNumber < 4000) {\r\n            this.flowType = 'Transitional';\r\n        } else {\r\n            this.flowType = 'Turbulent';\r\n        }\r\n    }\r\n    \r\n    reset() {\r\n        this.time = 0;\r\n        this.initializeParticles();\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        this.time += deltaTime;\r\n        \r\n        this.particles.forEach((particle, index) => {\r\n            // Apply flow field\r\n            const flowVelocity = this.calculateFlowVelocity(particle.x, particle.y);\r\n            \r\n            // Add turbulence based on Reynolds number\r\n            const turbulence = this.flowType === 'Turbulent' ? \r\n                (Math.random() - 0.5) * 2 * this.flowRate : 0;\r\n            \r\n            // Add enhanced mouse interaction with stronger effect\r\n            const dx = this.mouseX - particle.x;\r\n            const dy = this.mouseY - particle.y;\r\n            const distance = Math.sqrt(dx * dx + dy * dy);\r\n            \r\n            // Start with flow velocity\r\n            particle.vx = flowVelocity.x + turbulence;\r\n            particle.vy = flowVelocity.y + turbulence;\r\n            \r\n            // Apply mouse influence on top of flow velocity\r\n            if (distance < this.mouseInfluence && distance > 0) {\r\n                const force = (this.mouseInfluence - distance) / this.mouseInfluence;\r\n                // Gentler mouse influence\r\n                particle.vx += (dx / distance) * force * 1.2;\r\n                particle.vy += (dy / distance) * force * 1.2;\r\n                \r\n                // Add subtle randomness\r\n                particle.vx += (Math.random() - 0.5) * force * 0.2;\r\n                particle.vy += (Math.random() - 0.5) * force * 0.2;\r\n            }\r\n            \r\n            // Apply viscosity damping\r\n            particle.vx *= (1 - this.viscosity * 0.01);\r\n            particle.vy *= (1 - this.viscosity * 0.01);\r\n            \r\n            // Update position\r\n            particle.x += particle.vx * deltaTime * 0.1;\r\n            particle.y += particle.vy * deltaTime * 0.1;\r\n            particle.life += deltaTime;\r\n            \r\n            // Reset particles that go off screen or get stuck\r\n            if (particle.x > this.ctx.canvas.width + 50 || \r\n                particle.x < -50 || \r\n                particle.y < -50 || \r\n                particle.y > this.ctx.canvas.height + 50 ||\r\n                particle.life > 10000) {\r\n                this.resetParticle(particle);\r\n            }\r\n        });\r\n    }\r\n    \r\n    resetParticle(particle) {\r\n        particle.x = -50 + Math.random() * 100;\r\n        particle.y = 50 + Math.random() * (this.ctx.canvas.height - 100);\r\n        particle.vx = this.flowRate * (1 + Math.random() * 0.3);\r\n        particle.vy = (Math.random() - 0.5) * 0.3;\r\n        particle.life = 0;\r\n    }\r\n    \r\n    calculateFlowVelocity(x, y) {\r\n        let vx = this.flowRate;\r\n        let vy = 0;\r\n        \r\n        // Check for obstacle interactions\r\n        this.obstacles.forEach(obstacle => {\r\n            if (x > obstacle.x && x < obstacle.x + obstacle.width &&\r\n                y > obstacle.y && y < obstacle.y + obstacle.height) {\r\n                \r\n                if (obstacle.type === 'porous') {\r\n                    // Porous material: slow down the flow but allow it to continue\r\n                    vx *= 0.3; // Slow down to 30% of original speed\r\n                    vy *= 0.3;\r\n                    \r\n                    // Add some small random variation to simulate porous flow\r\n                    vx += (Math.random() - 0.5) * this.flowRate * 0.1;\r\n                    vy += (Math.random() - 0.5) * this.flowRate * 0.1;\r\n                } else if (obstacle.type === 'solid') {\r\n                    // Solid material: completely block the flow\r\n                    vx = (Math.random() - 0.5) * this.flowRate * 0.5;\r\n                    vy = (Math.random() - 0.5) * this.flowRate * 0.5;\r\n                }\r\n            }\r\n        });\r\n        \r\n        // Add some vertical variation based on y position\r\n        const centerY = this.ctx.canvas.height / 2;\r\n        const distanceFromCenter = Math.abs(y - centerY);\r\n        const maxVariation = this.flowRate * 0.2;\r\n        vy += (y - centerY) / centerY * maxVariation;\r\n        \r\n        // Add mouse interaction effects to all visualization modes\r\n        if (this.mouseX > 0 && this.mouseY > 0) {\r\n            const dx = this.mouseX - x;\r\n            const dy = this.mouseY - y;\r\n            const distance = Math.sqrt(dx * dx + dy * dy);\r\n            \r\n            if (distance < this.mouseInfluence && distance > 0) {\r\n                const force = (this.mouseInfluence - distance) / this.mouseInfluence;\r\n                // Apply mouse influence to velocity field\r\n                vx += (dx / distance) * force * 1.2;\r\n                vy += (dy / distance) * force * 1.2;\r\n            }\r\n        }\r\n        \r\n        return { x: vx, y: vy };\r\n    }\r\n    \r\n    render() {\r\n        this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n        \r\n        // Draw background\r\n        this.drawBackground();\r\n        \r\n        // Draw obstacles\r\n        this.drawObstacles();\r\n        \r\n        // Draw based on visualization mode\r\n        switch (this.visualizationMode) {\r\n            case 'particles':\r\n                this.drawParticles();\r\n                break;\r\n            case 'streamlines':\r\n                this.drawStreamlines();\r\n                break;\r\n            case 'velocity':\r\n                this.drawVelocityField();\r\n                break;\r\n            case 'pressure':\r\n                this.drawPressureField();\r\n                break;\r\n        }\r\n        \r\n        // Draw flow information\r\n        this.drawFlowInfo();\r\n        \r\n        // Add real-world analogy for beginners\r\n        this.drawRealWorldAnalogy();\r\n        \r\n        // Draw mouse interaction indicator\r\n        this.drawMouseIndicator();\r\n    }\r\n    \r\n    drawBackground() {\r\n        // Modern gradient background with enhanced styling\r\n        const gradient = this.ctx.createLinearGradient(0, 0, 0, this.ctx.canvas.height);\r\n        gradient.addColorStop(0, '#E8F4FD');\r\n        gradient.addColorStop(0.3, '#D1E7FF');\r\n        gradient.addColorStop(0.7, '#B8D4F8');\r\n        gradient.addColorStop(1, '#A3C4F0');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n        \r\n        // Add subtle grid pattern for depth\r\n        this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.setLineDash([20, 20]);\r\n        \r\n        for (let x = 0; x < this.ctx.canvas.width; x += 40) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x, 0);\r\n            this.ctx.lineTo(x, this.ctx.canvas.height);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        for (let y = 0; y < this.ctx.canvas.height; y += 40) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(0, y);\r\n            this.ctx.lineTo(this.ctx.canvas.width, y);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        this.ctx.setLineDash([]);\r\n    }\r\n    \r\n    drawObstacles() {\r\n        this.obstacles.forEach(obstacle => {\r\n            switch (obstacle.type) {\r\n                case 'porous':\r\n                    this.drawPorousObject(obstacle);\r\n                    break;\r\n                case 'solid':\r\n                    this.drawSolidObject(obstacle);\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n    \r\n    drawPorousObject(obstacle) {\r\n        // Enhanced porous sponge-like object with modern styling\r\n        \r\n        // Add shadow for depth\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.shadowBlur = 8;\r\n        this.ctx.shadowOffsetX = 2;\r\n        this.ctx.shadowOffsetY = 2;\r\n        \r\n        // Create gradient for sponge\r\n        const spongeGradient = this.ctx.createLinearGradient(\r\n            obstacle.x, obstacle.y, \r\n            obstacle.x + obstacle.width, obstacle.y + obstacle.height\r\n        );\r\n        spongeGradient.addColorStop(0, 'rgba(255, 182, 193, 0.95)');\r\n        spongeGradient.addColorStop(0.5, 'rgba(255, 150, 150, 0.9)');\r\n        spongeGradient.addColorStop(1, 'rgba(255, 182, 193, 0.95)');\r\n        \r\n        this.ctx.fillStyle = spongeGradient;\r\n        this.ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.shadowOffsetX = 0;\r\n        this.ctx.shadowOffsetY = 0;\r\n        \r\n        // Enhanced porous holes with gradient\r\n        for (let row = 0; row < 4; row++) {\r\n            for (let col = 0; col < 6; col++) {\r\n                const holeX = obstacle.x + 10 + col * 12;\r\n                const holeY = obstacle.y + 15 + row * 20;\r\n                \r\n                // Create gradient for each hole\r\n                const holeGradient = this.ctx.createRadialGradient(\r\n                    holeX, holeY, 0, holeX, holeY, 4\r\n                );\r\n                holeGradient.addColorStop(0, 'rgba(255, 255, 255, 0.9)');\r\n                holeGradient.addColorStop(1, 'rgba(255, 255, 255, 0.6)');\r\n                \r\n                this.ctx.fillStyle = holeGradient;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(holeX, holeY, 4, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n            }\r\n        }\r\n        \r\n        // Enhanced sponge texture lines with gradient\r\n        this.ctx.strokeStyle = 'rgba(255, 150, 150, 0.8)';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.lineCap = 'round';\r\n        for (let i = 0; i < obstacle.height; i += 15) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(obstacle.x, obstacle.y + i);\r\n            this.ctx.lineTo(obstacle.x + obstacle.width, obstacle.y + i);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Enhanced outline with gradient\r\n        const outlineGradient = this.ctx.createLinearGradient(\r\n            obstacle.x, obstacle.y, \r\n            obstacle.x + obstacle.width, obstacle.y + obstacle.height\r\n        );\r\n        outlineGradient.addColorStop(0, 'rgba(255, 100, 100, 0.9)');\r\n        outlineGradient.addColorStop(0.5, 'rgba(255, 80, 80, 0.95)');\r\n        outlineGradient.addColorStop(1, 'rgba(255, 100, 100, 0.9)');\r\n        \r\n        this.ctx.strokeStyle = outlineGradient;\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.strokeRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);\r\n        \r\n        // Enhanced label with modern styling\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.font = 'bold 16px Inter, Arial, sans-serif';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('🧽 Porous Sponge', obstacle.x + obstacle.width/2, obstacle.y + obstacle.height/2 + 6);\r\n    }\r\n    \r\n    drawTree(obstacle) {\r\n        // Draw tree trunk\r\n        this.ctx.fillStyle = 'rgba(139, 69, 19, 0.9)';\r\n        this.ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);\r\n        \r\n        // Draw tree bark texture\r\n        this.ctx.strokeStyle = 'rgba(101, 67, 33, 0.8)';\r\n        this.ctx.lineWidth = 2;\r\n        for (let i = 0; i < obstacle.height; i += 15) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(obstacle.x, obstacle.y + i);\r\n            this.ctx.lineTo(obstacle.x + obstacle.width, obstacle.y + i);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Draw tree foliage\r\n        this.ctx.fillStyle = 'rgba(34, 139, 34, 0.8)';\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(obstacle.x + obstacle.width/2, obstacle.y - 10, 25, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Add label\r\n        this.ctx.fillStyle = '#000000';\r\n        this.ctx.font = 'bold 12px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('🌳 Tree', obstacle.x + obstacle.width/2, obstacle.y + obstacle.height/2 + 4);\r\n    }\r\n    \r\n    drawSolidObject(obstacle) {\r\n        // Enhanced solid, dense object with modern styling\r\n        \r\n        // Add shadow for depth\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.4)';\r\n        this.ctx.shadowBlur = 10;\r\n        this.ctx.shadowOffsetX = 3;\r\n        this.ctx.shadowOffsetY = 3;\r\n        \r\n        // Create gradient for solid block\r\n        const blockGradient = this.ctx.createLinearGradient(\r\n            obstacle.x, obstacle.y, \r\n            obstacle.x + obstacle.width, obstacle.y + obstacle.height\r\n        );\r\n        blockGradient.addColorStop(0, 'rgba(120, 120, 120, 0.95)');\r\n        blockGradient.addColorStop(0.3, 'rgba(105, 105, 105, 0.95)');\r\n        blockGradient.addColorStop(0.7, 'rgba(90, 90, 90, 0.95)');\r\n        blockGradient.addColorStop(1, 'rgba(75, 75, 75, 0.95)');\r\n        \r\n        this.ctx.fillStyle = blockGradient;\r\n        this.ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.shadowOffsetX = 0;\r\n        this.ctx.shadowOffsetY = 0;\r\n        \r\n        // Enhanced solid texture lines with gradient\r\n        this.ctx.strokeStyle = 'rgba(80, 80, 80, 0.9)';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.lineCap = 'round';\r\n        for (let i = 0; i < obstacle.height; i += 20) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(obstacle.x, obstacle.y + i);\r\n            this.ctx.lineTo(obstacle.x + obstacle.width, obstacle.y + i);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Enhanced vertical texture lines\r\n        for (let i = 0; i < obstacle.width; i += 25) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(obstacle.x + i, obstacle.y);\r\n            this.ctx.lineTo(obstacle.x + i, obstacle.y + obstacle.height);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Enhanced solid outline with gradient\r\n        const outlineGradient = this.ctx.createLinearGradient(\r\n            obstacle.x, obstacle.y, \r\n            obstacle.x + obstacle.width, obstacle.y + obstacle.height\r\n        );\r\n        outlineGradient.addColorStop(0, 'rgba(50, 50, 50, 0.95)');\r\n        outlineGradient.addColorStop(0.5, 'rgba(30, 30, 30, 0.98)');\r\n        outlineGradient.addColorStop(1, 'rgba(50, 50, 50, 0.95)');\r\n        \r\n        this.ctx.strokeStyle = outlineGradient;\r\n        this.ctx.lineWidth = 4;\r\n        this.ctx.strokeRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);\r\n        \r\n        // Enhanced label with modern styling\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.font = 'bold 16px Inter, Arial, sans-serif';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('🪨 Solid Block', obstacle.x + obstacle.width/2, obstacle.y + obstacle.height/2 + 6);\r\n    }\r\n    \r\n    drawPillar(obstacle) {\r\n        // Draw pillar base\r\n        this.ctx.fillStyle = 'rgba(192, 192, 192, 0.9)';\r\n        this.ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);\r\n        \r\n        // Draw pillar texture (brick pattern)\r\n        this.ctx.strokeStyle = 'rgba(160, 160, 160, 0.8)';\r\n        this.ctx.lineWidth = 1;\r\n        for (let i = 0; i < obstacle.height; i += 12) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(obstacle.x, obstacle.y + i);\r\n            this.ctx.lineTo(obstacle.x + obstacle.width, obstacle.y + i);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Draw pillar cap\r\n        this.ctx.fillStyle = 'rgba(220, 220, 220, 0.9)';\r\n        this.ctx.fillRect(obstacle.x - 5, obstacle.y - 5, obstacle.width + 10, 10);\r\n        \r\n        // Add label\r\n        this.ctx.fillStyle = '#000000';\r\n        this.ctx.font = 'bold 12px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('🏛️ Pillar', obstacle.x + obstacle.width/2, obstacle.y + obstacle.height/2 + 4);\r\n    }\r\n    \r\n    drawBoulder(obstacle) {\r\n        // Draw a large boulder with irregular shape\r\n        this.ctx.fillStyle = 'rgba(128, 128, 128, 0.9)';\r\n        this.ctx.beginPath();\r\n        this.ctx.ellipse(obstacle.x + obstacle.width/2, obstacle.y + obstacle.height/2, \r\n                         obstacle.width/2 + 5, obstacle.height/2 + 3, 0.3, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        \r\n        // Add boulder texture and shading\r\n        this.ctx.strokeStyle = 'rgba(90, 90, 90, 0.8)';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(obstacle.x + 15, obstacle.y + 10, 8, 0, Math.PI * 2);\r\n        this.ctx.stroke();\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(obstacle.x + 35, obstacle.y + 25, 6, 0, Math.PI * 2);\r\n        this.ctx.stroke();\r\n        \r\n        // Add label\r\n        this.ctx.fillStyle = '#000000';\r\n        this.ctx.font = 'bold 12px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('🪨 Boulder', obstacle.x + obstacle.width/2, obstacle.y + obstacle.height/2 + 4);\r\n    }\r\n    \r\n    drawParticles() {\r\n        this.particles.forEach(particle => {\r\n            // Calculate velocity for color intensity\r\n            const velocity = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\r\n            const maxVelocity = this.flowRate * 2;\r\n            const intensity = Math.min(velocity / maxVelocity, 1);\r\n            \r\n            // Check if particle is being affected by mouse\r\n            const dx = this.mouseX - particle.x;\r\n            const dy = this.mouseY - particle.y;\r\n            const distance = Math.sqrt(dx * dx + dy * dy);\r\n            const isMouseAffected = distance < this.mouseInfluence && distance > 0;\r\n            \r\n            // Enhanced dynamic color based on velocity and mouse interaction\r\n            let hue, saturation, lightness, glowColor;\r\n            if (isMouseAffected) {\r\n                // Particles affected by mouse get a purple color with glow\r\n                hue = 270 + Math.random() * 30; // Purple range\r\n                saturation = 80;\r\n                lightness = 60;\r\n                glowColor = `rgba(147, 112, 219, ${intensity * 0.6})`;\r\n            } else {\r\n                // Normal blue to cyan gradient\r\n                hue = 200 + intensity * 60;\r\n                saturation = 70 + intensity * 30;\r\n                lightness = 60 - intensity * 20;\r\n                glowColor = `rgba(135, 206, 250, ${intensity * 0.4})`;\r\n            }\r\n            \r\n            const particleColor = `hsl(${hue}, ${saturation}%, ${lightness}%)`;\r\n            \r\n            // Enhanced glow effect for fast particles\r\n            if (velocity > this.flowRate * 0.8) {\r\n                this.ctx.shadowColor = glowColor;\r\n                this.ctx.shadowBlur = 10;\r\n                this.ctx.fillStyle = particleColor;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(particle.x, particle.y, particle.size + 2, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n                this.ctx.shadowBlur = 0;\r\n            }\r\n            \r\n            // Draw main particle with gradient\r\n            const gradient = this.ctx.createRadialGradient(\r\n                particle.x - particle.size * 0.3, particle.y - particle.size * 0.3, 0,\r\n                particle.x, particle.y, particle.size\r\n            );\r\n            gradient.addColorStop(0, `hsl(${hue}, ${saturation}%, ${lightness + 20}%)`);\r\n            gradient.addColorStop(0.7, particleColor);\r\n            gradient.addColorStop(1, `hsl(${hue}, ${saturation}%, ${lightness - 20}%)`);\r\n            \r\n            this.ctx.fillStyle = gradient;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Enhanced speed trails for fast particles\r\n            if (velocity > this.flowRate * 0.5) {\r\n                const trailGradient = this.ctx.createLinearGradient(\r\n                    particle.x, particle.y,\r\n                    particle.x - particle.vx * 0.5, particle.y - particle.vy * 0.5\r\n                );\r\n                trailGradient.addColorStop(0, `hsla(${hue}, ${saturation}%, ${lightness}%, ${intensity * 0.8})`);\r\n                trailGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\r\n                \r\n                this.ctx.strokeStyle = trailGradient;\r\n                this.ctx.lineWidth = Math.max(2, velocity * 2);\r\n                this.ctx.lineCap = 'round';\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(particle.x, particle.y);\r\n                this.ctx.lineTo(particle.x - particle.vx * 0.5, particle.y - particle.vy * 0.5);\r\n                this.ctx.stroke();\r\n            }\r\n            \r\n            // Add enhanced trail for mouse-affected particles\r\n            if (isMouseAffected) {\r\n                this.ctx.strokeStyle = `rgba(147, 112, 219, 0.8)`;\r\n                this.ctx.lineWidth = 3;\r\n                this.ctx.lineCap = 'round';\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(particle.x, particle.y);\r\n                this.ctx.lineTo(particle.x - particle.vx * 0.8, particle.y - particle.vy * 0.8);\r\n                this.ctx.stroke();\r\n            }\r\n        });\r\n    }\r\n    \r\n    drawStreamlines() {\r\n        // Enhanced streamline visualization with realistic flow patterns\r\n        const streamlineCount = 15;\r\n        const pointsPerStreamline = 100;\r\n        \r\n        for (let i = 0; i < streamlineCount; i++) {\r\n            // Start streamlines at different heights\r\n            const startY = 50 + (i * (this.ctx.canvas.height - 100)) / (streamlineCount - 1);\r\n            let x = 0;\r\n            let y = startY;\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x, y);\r\n            \r\n            // Draw streamline with varying opacity and thickness based on velocity\r\n            for (let j = 0; j < pointsPerStreamline; j++) {\r\n                const velocity = this.calculateFlowVelocity(x, y);\r\n                const speed = Math.sqrt(velocity.x * velocity.x + velocity.y * velocity.y);\r\n                \r\n                // Calculate next point with some randomness for realistic flow\r\n                const nextX = x + velocity.x * 8 + (Math.random() - 0.5) * 2;\r\n                const nextY = y + velocity.y * 8 + (Math.random() - 0.5) * 2;\r\n                \r\n                // Check if this point is affected by mouse\r\n                const dx = this.mouseX - x;\r\n                const dy = this.mouseY - y;\r\n                const distance = Math.sqrt(dx * dx + dy * dy);\r\n                const isMouseAffected = distance < this.mouseInfluence && distance > 0;\r\n                \r\n                // Vary line properties based on speed and mouse interaction\r\n                const opacity = Math.min(0.8, 0.3 + speed * 0.5);\r\n                const lineWidth = Math.max(1, speed * 2);\r\n                \r\n                // Use purple color for mouse-affected areas, blue for normal\r\n                if (isMouseAffected) {\r\n                    this.ctx.strokeStyle = `rgba(147, 112, 219, ${opacity})`;\r\n                    this.ctx.lineWidth = lineWidth + 1; // Slightly thicker for mouse-affected areas\r\n                } else {\r\n                    this.ctx.strokeStyle = `rgba(0, 100, 200, ${opacity})`;\r\n                    this.ctx.lineWidth = lineWidth;\r\n                }\r\n                \r\n                this.ctx.lineTo(nextX, nextY);\r\n                \r\n                x = nextX;\r\n                y = nextY;\r\n                \r\n                // Stop if streamline goes off screen\r\n                if (x > this.ctx.canvas.width || x < 0 || y < 0 || y > this.ctx.canvas.height) {\r\n                    break;\r\n                }\r\n            }\r\n            \r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Add flow direction indicators (small arrows)\r\n        for (let x = 100; x < this.ctx.canvas.width - 100; x += 80) {\r\n            for (let y = 100; y < this.ctx.canvas.height - 100; y += 60) {\r\n                const velocity = this.calculateFlowVelocity(x, y);\r\n                const speed = Math.sqrt(velocity.x * velocity.x + velocity.y * velocity.y);\r\n                \r\n                if (speed > 0.1) {\r\n                    // Check if this arrow is affected by mouse\r\n                    const dx = this.mouseX - x;\r\n                    const dy = this.mouseY - y;\r\n                    const distance = Math.sqrt(dx * dx + dy * dy);\r\n                    const isMouseAffected = distance < this.mouseInfluence && distance > 0;\r\n                    \r\n                    // Draw arrow\r\n                    const angle = Math.atan2(velocity.y, velocity.x);\r\n                    const arrowLength = Math.min(15, speed * 10);\r\n                    \r\n                    // Use purple for mouse-affected arrows, blue for normal\r\n                    if (isMouseAffected) {\r\n                        this.ctx.strokeStyle = `rgba(147, 112, 219, ${Math.min(0.9, speed + 0.3)})`;\r\n                        this.ctx.lineWidth = 3; // Thicker for mouse-affected arrows\r\n                    } else {\r\n                        this.ctx.strokeStyle = `rgba(0, 150, 255, ${Math.min(0.8, speed)})`;\r\n                        this.ctx.lineWidth = 2;\r\n                    }\r\n                    \r\n                    this.ctx.beginPath();\r\n                    this.ctx.moveTo(x, y);\r\n                    this.ctx.lineTo(x + Math.cos(angle) * arrowLength, y + Math.sin(angle) * arrowLength);\r\n                    this.ctx.stroke();\r\n                    \r\n                    // Draw arrowhead\r\n                    this.ctx.beginPath();\r\n                    this.ctx.moveTo(x + Math.cos(angle) * arrowLength, y + Math.sin(angle) * arrowLength);\r\n                    this.ctx.lineTo(x + Math.cos(angle) * arrowLength - Math.cos(angle - 0.5) * 5, \r\n                                  y + Math.sin(angle) * arrowLength - Math.sin(angle - 0.5) * 5);\r\n                    this.ctx.lineTo(x + Math.cos(angle) * arrowLength - Math.cos(angle + 0.5) * 5, \r\n                                  y + Math.sin(angle) * arrowLength - Math.sin(angle + 0.5) * 5);\r\n                    this.ctx.closePath();\r\n                    \r\n                    if (isMouseAffected) {\r\n                        this.ctx.fillStyle = `rgba(147, 112, 219, ${Math.min(0.9, speed + 0.3)})`;\r\n                    } else {\r\n                        this.ctx.fillStyle = `rgba(0, 150, 255, ${Math.min(0.8, speed)})`;\r\n                    }\r\n                    this.ctx.fill();\r\n                }\r\n            }\r\n        }\r\n        \r\n        // Add streamline labels with enhanced styling\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.9)';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('🌊 Streamlines', this.ctx.canvas.width / 2, 30);\r\n        \r\n        // Add explanation\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n        this.ctx.font = '12px Arial';\r\n        this.ctx.fillText('Lines show fluid flow direction', this.ctx.canvas.width / 2, 50);\r\n    }\r\n    \r\n    drawVelocityField() {\r\n        // Enhanced velocity field with dynamic arrows and color coding\r\n        for (let x = 60; x < this.ctx.canvas.width - 60; x += 50) {\r\n            for (let y = 60; y < this.ctx.canvas.height - 60; y += 50) {\r\n                const velocity = this.calculateFlowVelocity(x, y);\r\n                const speed = Math.sqrt(velocity.x * velocity.x + velocity.y * velocity.y);\r\n                \r\n                if (speed > 0.1) {\r\n                    // Color code based on speed (blue = slow, red = fast)\r\n                    const hue = 240 - Math.min(180, speed * 100); // Blue to red\r\n                    const saturation = 80;\r\n                    const lightness = 60;\r\n                    const color = `hsl(${hue}, ${saturation}%, ${lightness}%)`;\r\n                    \r\n                    // Arrow length and thickness based on speed\r\n                    const arrowLength = Math.min(25, speed * 15);\r\n                    const lineWidth = Math.max(1, speed * 3);\r\n                    \r\n                    this.ctx.strokeStyle = color;\r\n                    this.ctx.lineWidth = lineWidth;\r\n                    this.ctx.beginPath();\r\n                    this.ctx.moveTo(x, y);\r\n                    this.ctx.lineTo(x + velocity.x * arrowLength, y + velocity.y * arrowLength);\r\n                    this.ctx.stroke();\r\n                    \r\n                    // Draw arrowhead\r\n                    const angle = Math.atan2(velocity.y, velocity.x);\r\n                    this.ctx.beginPath();\r\n                    this.ctx.moveTo(x + velocity.x * arrowLength, y + velocity.y * arrowLength);\r\n                    this.ctx.lineTo(x + velocity.x * arrowLength - Math.cos(angle - 0.5) * 6, \r\n                                  y + velocity.y * arrowLength - Math.sin(angle - 0.5) * 6);\r\n                    this.ctx.lineTo(x + velocity.x * arrowLength - Math.cos(angle + 0.5) * 6, \r\n                                  y + velocity.y * arrowLength - Math.sin(angle + 0.5) * 6);\r\n                    this.ctx.closePath();\r\n                    this.ctx.fillStyle = color;\r\n                    this.ctx.fill();\r\n                    \r\n                    // Add speed indicator dot\r\n                    this.ctx.fillStyle = color;\r\n                    this.ctx.beginPath();\r\n                    this.ctx.arc(x, y, Math.max(2, speed * 3), 0, Math.PI * 2);\r\n                    this.ctx.fill();\r\n                }\r\n            }\r\n        }\r\n        \r\n        // Add velocity field label with enhanced styling\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.9)';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('⚡ Velocity Field', this.ctx.canvas.width / 2, 30);\r\n        \r\n        // Add color legend\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n        this.ctx.font = '12px Arial';\r\n        this.ctx.fillText('Blue = Slow, Red = Fast', this.ctx.canvas.width / 2, 50);\r\n    }\r\n    \r\n    drawPressureField() {\r\n        // Enhanced pressure field with gradient visualization\r\n        for (let x = 0; x < this.ctx.canvas.width; x += 20) {\r\n            for (let y = 0; y < this.ctx.canvas.height; y += 20) {\r\n                const velocity = this.calculateFlowVelocity(x, y);\r\n                const speed = Math.sqrt(velocity.x * velocity.x + velocity.y * velocity.y);\r\n                \r\n                // Calculate pressure (inverse relationship with velocity)\r\n                const pressure = Math.max(0, 1 - speed * 0.3);\r\n                \r\n                // Color code: Blue = high pressure, Red = low pressure (more subtle)\r\n                const blue = Math.floor(200 * pressure);\r\n                const red = Math.floor(100 * (1 - pressure));\r\n                const green = Math.floor(50 * pressure);\r\n                const color = `rgba(${red}, ${green}, ${blue}, ${0.2 + pressure * 0.2})`;\r\n                \r\n                this.ctx.fillStyle = color;\r\n                this.ctx.fillRect(x, y, 20, 20);\r\n            }\r\n        }\r\n        \r\n        // Add pressure contours (lines of equal pressure)\r\n        this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';\r\n        this.ctx.lineWidth = 1;\r\n        \r\n        for (let pressure = 0.2; pressure <= 0.8; pressure += 0.2) {\r\n            this.ctx.beginPath();\r\n            let firstPoint = true;\r\n            \r\n            for (let x = 0; x < this.ctx.canvas.width; x += 10) {\r\n                for (let y = 0; y < this.ctx.canvas.height; y += 10) {\r\n                    const velocity = this.calculateFlowVelocity(x, y);\r\n                    const speed = Math.sqrt(velocity.x * velocity.x + velocity.y * velocity.y);\r\n                    const currentPressure = Math.max(0, 1 - speed * 0.3);\r\n                    \r\n                    if (Math.abs(currentPressure - pressure) < 0.05) {\r\n                        if (firstPoint) {\r\n                            this.ctx.moveTo(x, y);\r\n                            firstPoint = false;\r\n                        } else {\r\n                            this.ctx.lineTo(x, y);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Add pressure field label with enhanced styling\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.9)';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('💨 Pressure Field', this.ctx.canvas.width / 2, 30);\r\n        \r\n        // Add color legend\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n        this.ctx.font = '12px Arial';\r\n        this.ctx.fillText('Blue = High Pressure, Red = Low Pressure', this.ctx.canvas.width / 2, 50);\r\n    }\r\n    \r\n    drawFlowInfo() {\r\n        // Modern flow info panel with enhanced styling\r\n        const panelX = 20;\r\n        const panelY = 20;\r\n        const panelWidth = 300;\r\n        const panelHeight = 140;\r\n        \r\n        // Enhanced panel background with shadow and gradient\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n        this.ctx.fillRect(panelX + 4, panelY + 4, panelWidth, panelHeight);\r\n        \r\n        const gradient = this.ctx.createLinearGradient(panelX, panelY, panelX, panelY + panelHeight);\r\n        gradient.addColorStop(0, 'rgba(26, 26, 46, 0.98)');\r\n        gradient.addColorStop(0.3, 'rgba(26, 26, 46, 0.95)');\r\n        gradient.addColorStop(0.7, 'rgba(26, 26, 46, 0.92)');\r\n        gradient.addColorStop(1, 'rgba(26, 26, 46, 0.88)');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, panelHeight);\r\n        \r\n        // Enhanced border with rounded corners and gradient\r\n        this.ctx.shadowColor = '#4ECDC4';\r\n        this.ctx.shadowBlur = 8;\r\n        this.ctx.lineWidth = 2;\r\n        \r\n        // Create gradient border\r\n        const borderGradient = this.ctx.createLinearGradient(\r\n            panelX, panelY, \r\n            panelX + panelWidth, panelY + panelHeight\r\n        );\r\n        borderGradient.addColorStop(0, '#4ECDC4');\r\n        borderGradient.addColorStop(0.5, '#2ECC71');\r\n        borderGradient.addColorStop(1, '#4ECDC4');\r\n        \r\n        this.ctx.strokeStyle = borderGradient;\r\n        this.ctx.strokeRect(panelX, panelY, panelWidth, panelHeight);\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Add inner highlight for 3D effect\r\n        const innerGradient = this.ctx.createLinearGradient(panelX, panelY, panelX, panelY + 30);\r\n        innerGradient.addColorStop(0, 'rgba(78, 205, 196, 0.1)');\r\n        innerGradient.addColorStop(1, 'rgba(78, 205, 196, 0)');\r\n        this.ctx.fillStyle = innerGradient;\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, 30);\r\n        \r\n        // Modern title with crisp font rendering\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 18px Inter, Arial, sans-serif';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('🌊 Fluid Flow Simulation', panelX + 15, panelY + 22);\r\n        \r\n        // Enhanced stats with modern styling\r\n        this.ctx.font = '14px Inter, Arial, sans-serif';\r\n        this.ctx.textBaseline = 'middle';\r\n        \r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.fillText(`🚀 Flow Rate: ${this.flowRate.toFixed(1)}`, panelX + 15, panelY + 45);\r\n        this.ctx.fillText(`💧 Viscosity: ${this.viscosity.toFixed(1)}`, panelX + 15, panelY + 62);\r\n        this.ctx.fillText(`📊 Reynolds Number: ${this.reynoldsNumber}`, panelX + 15, panelY + 79);\r\n        this.ctx.fillText(`🔄 Flow Type: ${this.flowType}`, panelX + 15, panelY + 96);\r\n        \r\n        // Enhanced flow type indicator with modern colors\r\n        const flowTypeColor = this.flowType === 'Laminar' ? '#4CAF50' : \r\n                             this.flowType === 'Transitional' ? '#FF9800' : '#F44336';\r\n        this.ctx.fillStyle = flowTypeColor;\r\n        this.ctx.font = 'bold 14px Inter, Arial, sans-serif';\r\n        this.ctx.fillText(`● ${this.flowType}`, panelX + 15, panelY + 113);\r\n        \r\n        // Add performance indicator\r\n        const efficiency = Math.min(100, (this.flowRate / 3) * 100);\r\n        const efficiencyColor = efficiency > 80 ? '#4ECDC4' : efficiency > 60 ? '#F39C12' : '#FF6B6B';\r\n        this.ctx.fillStyle = efficiencyColor;\r\n        this.ctx.fillText(`🎯 Flow Efficiency: ${efficiency.toFixed(0)}%`, panelX + 15, panelY + 130);\r\n    }\r\n    \r\n    drawRealWorldAnalogy() {\r\n        // Modern analogy panel with enhanced styling\r\n        const panelX = this.ctx.canvas.width - 290;\r\n        const panelY = 20;\r\n        const panelWidth = 270;\r\n        const panelHeight = 100;\r\n        \r\n        // Enhanced panel background with shadow and gradient\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n        this.ctx.fillRect(panelX + 4, panelY + 4, panelWidth, panelHeight);\r\n        \r\n        const gradient = this.ctx.createLinearGradient(panelX, panelY, panelX, panelY + panelHeight);\r\n        gradient.addColorStop(0, 'rgba(26, 26, 46, 0.98)');\r\n        gradient.addColorStop(0.3, 'rgba(26, 26, 46, 0.95)');\r\n        gradient.addColorStop(0.7, 'rgba(26, 26, 46, 0.92)');\r\n        gradient.addColorStop(1, 'rgba(26, 26, 46, 0.88)');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, panelHeight);\r\n        \r\n        // Enhanced border with gradient\r\n        this.ctx.shadowColor = '#FFD700';\r\n        this.ctx.shadowBlur = 8;\r\n        this.ctx.lineWidth = 2;\r\n        \r\n        // Create gradient border\r\n        const borderGradient = this.ctx.createLinearGradient(\r\n            panelX, panelY, \r\n            panelX + panelWidth, panelY + panelHeight\r\n        );\r\n        borderGradient.addColorStop(0, '#FFD700');\r\n        borderGradient.addColorStop(0.5, '#FFA500');\r\n        borderGradient.addColorStop(1, '#FFD700');\r\n        \r\n        this.ctx.strokeStyle = borderGradient;\r\n        this.ctx.strokeRect(panelX, panelY, panelWidth, panelHeight);\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Add inner highlight for 3D effect\r\n        const innerGradient = this.ctx.createLinearGradient(panelX, panelY, panelX, panelY + 30);\r\n        innerGradient.addColorStop(0, 'rgba(255, 215, 0, 0.1)');\r\n        innerGradient.addColorStop(1, 'rgba(255, 215, 0, 0)');\r\n        this.ctx.fillStyle = innerGradient;\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, 30);\r\n        \r\n        // Modern title with crisp font rendering\r\n        this.ctx.fillStyle = '#FFD700';\r\n        this.ctx.font = 'bold 16px Inter, Arial, sans-serif';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('💡 Real-World Examples:', panelX + 15, panelY + 22);\r\n        \r\n        // Enhanced examples with modern styling\r\n        this.ctx.font = '13px Inter, Arial, sans-serif';\r\n        this.ctx.textBaseline = 'middle';\r\n        \r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.fillText('🧽 Sponge: water flows through', panelX + 15, panelY + 45);\r\n        this.ctx.fillText('🪨 Rock: water flows around', panelX + 15, panelY + 62);\r\n        this.ctx.fillText('🌊 River: natural flow patterns', panelX + 15, panelY + 79);\r\n        this.ctx.fillText('🏊 Pool: controlled fluid motion', panelX + 15, panelY + 96);\r\n    }\r\n    \r\n    drawMouseIndicator() {\r\n        if (this.mouseX > 0 && this.mouseY > 0) {\r\n            // Draw mouse influence circle with purple/blue theme\r\n            this.ctx.strokeStyle = 'rgba(147, 112, 219, 0.8)'; // Medium purple\r\n            this.ctx.lineWidth = 3;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(this.mouseX, this.mouseY, this.mouseInfluence, 0, Math.PI * 2);\r\n            this.ctx.stroke();\r\n            \r\n            // Draw inner ring for stronger visual effect\r\n            this.ctx.strokeStyle = 'rgba(138, 43, 226, 0.6)'; // Blue violet\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(this.mouseX, this.mouseY, this.mouseInfluence * 0.6, 0, Math.PI * 2);\r\n            this.ctx.stroke();\r\n            \r\n            // Draw mouse position with purple dot\r\n            this.ctx.fillStyle = 'rgba(147, 112, 219, 0.9)';\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(this.mouseX, this.mouseY, 4, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Add white border to make it stand out\r\n            this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.9)';\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(this.mouseX, this.mouseY, 4, 0, Math.PI * 2);\r\n            this.ctx.stroke();\r\n            \r\n            // Add interaction hint with enhanced visibility\r\n            this.ctx.fillStyle = '#000000';\r\n            this.ctx.font = 'bold 14px Arial';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.fillText('Move mouse to interact!', this.mouseX, this.mouseY - 25);\r\n            \r\n            // Add a subtle glow effect\r\n            this.ctx.shadowColor = 'rgba(147, 112, 219, 0.5)';\r\n            this.ctx.shadowBlur = 10;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(this.mouseX, this.mouseY, this.mouseInfluence * 0.3, 0, Math.PI * 2);\r\n            this.ctx.fillStyle = 'rgba(147, 112, 219, 0.1)';\r\n            this.ctx.fill();\r\n            this.ctx.shadowBlur = 0; // Reset shadow\r\n        }\r\n    }\r\n    \r\n    adjustColor(color, amount) {\r\n        // Simple color adjustment for gradients\r\n        if (color.startsWith('#')) {\r\n            const hex = color.replace('#', '');\r\n            const r = Math.max(0, Math.min(255, parseInt(hex.substr(0, 2), 16) + amount));\r\n            const g = Math.max(0, Math.min(255, parseInt(hex.substr(2, 2), 16) + amount));\r\n            const b = Math.max(0, Math.min(255, parseInt(hex.substr(4, 2), 16) + amount));\r\n            return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\r\n        }\r\n        return color;\r\n    }\r\n    \r\n    getStats() {\r\n        const avgVelocity = this.particles.reduce((sum, p) => sum + Math.sqrt(p.vx * p.vx + p.vy * p.vy), 0) / this.particles.length;\r\n        return {\r\n            flowRate: this.flowRate,\r\n            viscosity: this.viscosity,\r\n            reynoldsNumber: this.reynoldsNumber,\r\n            flowType: this.flowType,\r\n            averageVelocity: avgVelocity,\r\n            time: this.time\r\n        };\r\n    }\r\n}\r\n\r\n// Bernoulli's Principle Simulation\r\nexport class Bernoulli {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.particles = [];\r\n        this.pipeWidth = 50;\r\n        this.fluidDensity = 1;\r\n        this.pressureDifference = 1;\r\n        this.visualizationMode = 'basic';\r\n        this.time = 0;\r\n        this.maxParticles = 80;\r\n        \r\n        this.initializeParticles();\r\n    }\r\n    \r\n    initializeParticles() {\r\n        this.particles = [];\r\n        for (let i = 0; i < this.maxParticles; i++) {\r\n            this.particles.push({\r\n                x: -50 + Math.random() * 50,\r\n                y: 250 + Math.random() * 100,\r\n                vx: this.pressureDifference * (1 + Math.random() * 0.3),\r\n                vy: (Math.random() - 0.5) * 0.3,\r\n                size: 4 + Math.random() * 3,\r\n                color: `hsl(${220 + Math.random() * 40}, 80%, 60%)`,\r\n                life: 0\r\n            });\r\n        }\r\n    }\r\n    \r\n    setPipeWidth(width) {\r\n        this.pipeWidth = width;\r\n    }\r\n    \r\n    setFluidDensity(density) {\r\n        this.fluidDensity = density;\r\n    }\r\n    \r\n    setPressureDifference(pressure) {\r\n        this.pressureDifference = pressure;\r\n    }\r\n    \r\n    setVisualizationMode(mode) {\r\n        this.visualizationMode = mode;\r\n    }\r\n    \r\n    reset() {\r\n        this.time = 0;\r\n        this.initializeParticles();\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        this.time += deltaTime;\r\n        \r\n        this.particles.forEach(particle => {\r\n            // Apply Bernoulli effect in constricted section\r\n            if (particle.x > 300 && particle.x < 500) {\r\n                // Constricted section - higher velocity\r\n                particle.vx *= 1.5;\r\n            }\r\n            \r\n            // Update position\r\n            particle.x += particle.vx * deltaTime * 0.1;\r\n            particle.y += particle.vy * deltaTime * 0.1;\r\n            particle.life += deltaTime;\r\n            \r\n            // Reset particles that go off screen\r\n            if (particle.x > this.ctx.canvas.width + 50 || \r\n                particle.x < -50 || \r\n                particle.y < 150 || \r\n                particle.y > 450 ||\r\n                particle.life > 8000) {\r\n                this.resetParticle(particle);\r\n            }\r\n        });\r\n    }\r\n    \r\n    resetParticle(particle) {\r\n        particle.x = -50 + Math.random() * 50;\r\n        particle.y = 250 + Math.random() * 100;\r\n        particle.vx = this.pressureDifference * (1 + Math.random() * 0.3);\r\n        particle.vy = (Math.random() - 0.5) * 0.3;\r\n        particle.life = 0;\r\n    }\r\n    \r\n    render() {\r\n        this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n        \r\n        // Draw pipe system\r\n        this.drawPipeSystem();\r\n        \r\n        // Draw particles\r\n        this.drawParticles();\r\n        \r\n        // Draw based on visualization mode\r\n        switch (this.visualizationMode) {\r\n            case 'pressure':\r\n                this.drawPressureAnalysis();\r\n                break;\r\n            case 'velocity':\r\n                this.drawVelocityAnalysis();\r\n                break;\r\n            case 'energy':\r\n                this.drawEnergyAnalysis();\r\n                break;\r\n        }\r\n        \r\n        // Draw Bernoulli information\r\n        this.drawBernoulliInfo();\r\n        \r\n        // Add real-world analogy for beginners\r\n        this.drawBernoulliRealWorldAnalogy();\r\n    }\r\n    \r\n    drawPipeSystem() {\r\n        // Modern pipe system with enhanced visual design and rounded corners\r\n        const pipeRadius = 15;\r\n        \r\n        // Add shadow for depth\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.shadowBlur = 10;\r\n        this.ctx.shadowOffsetX = 2;\r\n        this.ctx.shadowOffsetY = 2;\r\n        \r\n        // Wide section (left) with modern gradient and rounded corners\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(0, 200);\r\n        this.ctx.lineTo(300, 200);\r\n        this.ctx.lineTo(300, 400);\r\n        this.ctx.lineTo(0, 400);\r\n        this.ctx.closePath();\r\n        \r\n        // Enhanced gradient for left section\r\n        const leftGradient = this.ctx.createLinearGradient(0, 200, 300, 400);\r\n        leftGradient.addColorStop(0, 'rgba(135, 206, 250, 0.6)');\r\n        leftGradient.addColorStop(0.5, 'rgba(70, 130, 180, 0.5)');\r\n        leftGradient.addColorStop(1, 'rgba(135, 206, 250, 0.6)');\r\n        this.ctx.fillStyle = leftGradient;\r\n        this.ctx.fill();\r\n        \r\n        // Modern border for left section\r\n        this.ctx.strokeStyle = 'rgba(70, 130, 180, 0.9)';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.stroke();\r\n        \r\n        // Constricted section (middle) with enhanced gradient\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(300, 250);\r\n        this.ctx.lineTo(500, 250);\r\n        this.ctx.lineTo(500, 350);\r\n        this.ctx.lineTo(300, 350);\r\n        this.ctx.closePath();\r\n        \r\n        const middleGradient = this.ctx.createLinearGradient(300, 250, 500, 350);\r\n        middleGradient.addColorStop(0, 'rgba(255, 140, 0, 0.6)');\r\n        middleGradient.addColorStop(0.5, 'rgba(255, 69, 0, 0.5)');\r\n        middleGradient.addColorStop(1, 'rgba(255, 140, 0, 0.6)');\r\n        this.ctx.fillStyle = middleGradient;\r\n        this.ctx.fill();\r\n        \r\n        // Modern border for middle section\r\n        this.ctx.strokeStyle = 'rgba(255, 69, 0, 0.9)';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.stroke();\r\n        \r\n        // Wide section (right) with enhanced gradient\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(500, 200);\r\n        this.ctx.lineTo(this.ctx.canvas.width, 200);\r\n        this.ctx.lineTo(this.ctx.canvas.width, 400);\r\n        this.ctx.lineTo(500, 400);\r\n        this.ctx.closePath();\r\n        \r\n        const rightGradient = this.ctx.createLinearGradient(500, 200, this.ctx.canvas.width, 400);\r\n        rightGradient.addColorStop(0, 'rgba(70, 130, 180, 0.6)');\r\n        rightGradient.addColorStop(0.5, 'rgba(135, 206, 250, 0.5)');\r\n        rightGradient.addColorStop(1, 'rgba(70, 130, 180, 0.6)');\r\n        this.ctx.fillStyle = rightGradient;\r\n        this.ctx.fill();\r\n        \r\n        // Modern border for right section\r\n        this.ctx.strokeStyle = 'rgba(70, 130, 180, 0.9)';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.stroke();\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.shadowOffsetX = 0;\r\n        this.ctx.shadowOffsetY = 0;\r\n        \r\n        // Modern section labels with enhanced styling\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.font = 'bold 18px Inter, Arial, sans-serif';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('Wide Section (Slow)', 150, 180);\r\n        this.ctx.fillText('Narrow Section (Fast)', 400, 180);\r\n        this.ctx.fillText('Wide Section (Slow)', 650, 180);\r\n        \r\n        // Enhanced speed indicators with modern styling\r\n        this.ctx.fillStyle = '#0066CC';\r\n        this.ctx.font = 'bold 16px Inter, Arial, sans-serif';\r\n        this.ctx.fillText('SLOW', 150, 160);\r\n        this.ctx.fillText('SLOW', 650, 160);\r\n        \r\n        this.ctx.fillStyle = '#FF6600';\r\n        this.ctx.fillText('FAST', 400, 160);\r\n        \r\n        // Modern flow direction arrows with enhanced styling\r\n        this.ctx.strokeStyle = '#0066CC';\r\n        this.ctx.lineWidth = 4;\r\n        this.ctx.fillStyle = '#0066CC';\r\n        \r\n        // Left section arrows with enhanced styling\r\n        for (let y = 220; y < 380; y += 30) {\r\n            this.drawEnhancedArrow(50, y, 100, y, '#0066CC');\r\n        }\r\n        \r\n        // Middle section arrows (longer and orange) with enhanced styling\r\n        this.ctx.strokeStyle = '#FF6600';\r\n        this.ctx.fillStyle = '#FF6600';\r\n        for (let y = 270; y < 330; y += 20) {\r\n            this.drawEnhancedArrow(320, y, 480, y, '#FF6600');\r\n        }\r\n        \r\n        // Right section arrows with enhanced styling\r\n        this.ctx.strokeStyle = '#0066CC';\r\n        this.ctx.fillStyle = '#0066CC';\r\n        for (let y = 220; y < 380; y += 30) {\r\n            this.drawEnhancedArrow(700, y, 750, y, '#0066CC');\r\n        }\r\n    }\r\n    \r\n    drawEnhancedArrow(x1, y1, x2, y2, color) {\r\n        const headLength = 12;\r\n        const angle = Math.atan2(y2 - y1, x2 - x1);\r\n        \r\n        // Add glow effect for enhanced arrows\r\n        this.ctx.shadowColor = color;\r\n        this.ctx.shadowBlur = 6;\r\n        \r\n        this.ctx.strokeStyle = color;\r\n        this.ctx.lineWidth = 4;\r\n        this.ctx.lineCap = 'round';\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x1, y1);\r\n        this.ctx.lineTo(x2, y2);\r\n        this.ctx.stroke();\r\n        \r\n        // Enhanced arrowhead with gradient\r\n        const gradient = this.ctx.createLinearGradient(x2, y2, x2 - headLength, y2);\r\n        gradient.addColorStop(0, color);\r\n        gradient.addColorStop(1, this.adjustColor(color, -30));\r\n        \r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x2, y2);\r\n        this.ctx.lineTo(x2 - headLength * Math.cos(angle - Math.PI / 6), y2 - headLength * Math.sin(angle - Math.PI / 6));\r\n        this.ctx.lineTo(x2 - headLength * Math.cos(angle + Math.PI / 6), y2 - headLength * Math.sin(angle + Math.PI / 6));\r\n        this.ctx.closePath();\r\n        this.ctx.fill();\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n    }\r\n    \r\n    adjustColor(color, amount) {\r\n        // Simple color adjustment for gradients\r\n        if (color.startsWith('#')) {\r\n            const hex = color.replace('#', '');\r\n            const r = Math.max(0, Math.min(255, parseInt(hex.substr(0, 2), 16) + amount));\r\n            const g = Math.max(0, Math.min(255, parseInt(hex.substr(2, 2), 16) + amount));\r\n            const b = Math.max(0, Math.min(255, parseInt(hex.substr(4, 2), 16) + amount));\r\n            return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\r\n        }\r\n        return color;\r\n    }\r\n    \r\n    drawArrow(x1, y1, x2, y2, color) {\r\n        const headLength = 10;\r\n        const angle = Math.atan2(y2 - y1, x2 - x1);\r\n        \r\n        this.ctx.strokeStyle = color;\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x1, y1);\r\n        this.ctx.lineTo(x2, y2);\r\n        this.ctx.stroke();\r\n        \r\n        // Draw arrowhead\r\n        this.ctx.fillStyle = color;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x2, y2);\r\n        this.ctx.lineTo(x2 - headLength * Math.cos(angle - Math.PI / 6), y2 - headLength * Math.sin(angle - Math.PI / 6));\r\n        this.ctx.lineTo(x2 - headLength * Math.cos(angle + Math.PI / 6), y2 - headLength * Math.sin(angle + Math.PI / 6));\r\n        this.ctx.closePath();\r\n        this.ctx.fill();\r\n    }\r\n    \r\n    drawParticles() {\r\n        this.particles.forEach(particle => {\r\n            // Calculate velocity for visual effects\r\n            const velocity = Math.sqrt(particle.vx * particle.vx + particle.vy * particle.vy);\r\n            const maxVelocity = this.pressureDifference * 2;\r\n            const intensity = Math.min(velocity / maxVelocity, 1);\r\n            \r\n            // Enhanced dynamic color based on velocity and position\r\n            let color, trailColor, glowColor;\r\n            if (particle.x > 300 && particle.x < 500) {\r\n                // Constricted section - orange/red for fast\r\n                const hue = 20 + intensity * 40; // Orange to red\r\n                color = `hsl(${hue}, 85%, 60%)`;\r\n                trailColor = `rgba(255, 140, 0, ${intensity * 0.8})`;\r\n                glowColor = `rgba(255, 69, 0, ${intensity * 0.6})`;\r\n            } else {\r\n                // Wide sections - blue for slow\r\n                const hue = 220 - intensity * 30;\r\n                color = `hsl(${hue}, 80%, 60%)`;\r\n                trailColor = `rgba(70, 130, 180, ${intensity * 0.6})`;\r\n                glowColor = `rgba(135, 206, 250, ${intensity * 0.4})`;\r\n            }\r\n            \r\n            // Enhanced glow effect for fast particles\r\n            if (particle.x > 300 && particle.x < 500 && velocity > this.pressureDifference * 0.8) {\r\n                // Multi-layer glow effect\r\n                this.ctx.shadowColor = glowColor;\r\n                this.ctx.shadowBlur = 12;\r\n                this.ctx.fillStyle = color;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(particle.x, particle.y, particle.size + 4, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n                \r\n                this.ctx.shadowBlur = 6;\r\n                this.ctx.fillStyle = color;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(particle.x, particle.y, particle.size + 2, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n                \r\n                this.ctx.shadowBlur = 0;\r\n            }\r\n            \r\n            // Draw main particle with gradient\r\n            const gradient = this.ctx.createRadialGradient(\r\n                particle.x - particle.size * 0.3, particle.y - particle.size * 0.3, 0,\r\n                particle.x, particle.y, particle.size\r\n            );\r\n            gradient.addColorStop(0, this.adjustColor(color, 30));\r\n            gradient.addColorStop(0.7, color);\r\n            gradient.addColorStop(1, this.adjustColor(color, -20));\r\n            \r\n            this.ctx.fillStyle = gradient;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Enhanced speed trails with gradient\r\n            if (velocity > this.pressureDifference * 0.5) {\r\n                const trailLength = Math.max(3, velocity * 3);\r\n                const trailGradient = this.ctx.createLinearGradient(\r\n                    particle.x, particle.y,\r\n                    particle.x - particle.vx * 0.6, particle.y - particle.vy * 0.6\r\n                );\r\n                trailGradient.addColorStop(0, trailColor);\r\n                trailGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\r\n                \r\n                this.ctx.strokeStyle = trailGradient;\r\n                this.ctx.lineWidth = Math.max(3, velocity * 2);\r\n                this.ctx.lineCap = 'round';\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(particle.x, particle.y);\r\n                this.ctx.lineTo(particle.x - particle.vx * 0.6, particle.y - particle.vy * 0.6);\r\n                this.ctx.stroke();\r\n            }\r\n            \r\n            // Enhanced velocity indicators for very fast particles\r\n            if (particle.x > 300 && particle.x < 500 && velocity > this.pressureDifference * 1.2) {\r\n                this.ctx.strokeStyle = '#FF6600';\r\n                this.ctx.lineWidth = 3;\r\n                this.ctx.setLineDash([8, 4]);\r\n                this.ctx.lineCap = 'round';\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(particle.x, particle.y);\r\n                this.ctx.lineTo(particle.x + particle.vx * 0.4, particle.y + particle.vy * 0.4);\r\n                this.ctx.stroke();\r\n                this.ctx.setLineDash([]);\r\n            }\r\n        });\r\n    }\r\n    \r\n    drawPressureAnalysis() {\r\n        // Simple pressure analysis for beginners\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.fillRect(10, 10, 300, 100);\r\n        \r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('📊 Pressure Analysis', 20, 30);\r\n        \r\n        this.ctx.font = '14px Arial';\r\n        this.ctx.fillText('High Pressure (Red)', 20, 50);\r\n        this.ctx.fillText('Low Pressure (Green)', 20, 70);\r\n        this.ctx.fillText('💡 Narrow section = lower pressure', 20, 90);\r\n    }\r\n    \r\n    drawVelocityAnalysis() {\r\n        // Simple velocity analysis for beginners\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.fillRect(10, 10, 300, 100);\r\n        \r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('⚡ Velocity Analysis', 20, 30);\r\n        \r\n        this.ctx.font = '14px Arial';\r\n        this.ctx.fillText('Slow (Blue arrows)', 20, 50);\r\n        this.ctx.fillText('Fast (Orange arrows)', 20, 70);\r\n        this.ctx.fillText('💡 Narrow section = faster flow', 20, 90);\r\n    }\r\n    \r\n    drawEnergyAnalysis() {\r\n        // Simple energy analysis for beginners\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.fillRect(10, 10, 300, 100);\r\n        \r\n        this.ctx.fillStyle = 'white';\r\n        this.ctx.font = 'bold 16px Arial';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('⚡ Energy Analysis', 20, 30);\r\n        \r\n        this.ctx.font = '14px Arial';\r\n        this.ctx.fillText('Pressure + Kinetic = Constant', 20, 50);\r\n        this.ctx.fillText('When speed increases, pressure decreases', 20, 70);\r\n        this.ctx.fillText('💡 Total energy is conserved', 20, 90);\r\n    }\r\n    \r\n    drawBernoulliInfo() {\r\n        // Modern Bernoulli info panel with enhanced styling\r\n        const panelX = 20;\r\n        const panelY = 450;\r\n        const panelWidth = 320;\r\n        const panelHeight = 120;\r\n        \r\n        // Enhanced panel background with shadow and gradient\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n        this.ctx.fillRect(panelX + 4, panelY + 4, panelWidth, panelHeight);\r\n        \r\n        const gradient = this.ctx.createLinearGradient(panelX, panelY, panelX, panelY + panelHeight);\r\n        gradient.addColorStop(0, 'rgba(26, 26, 46, 0.98)');\r\n        gradient.addColorStop(0.3, 'rgba(26, 26, 46, 0.95)');\r\n        gradient.addColorStop(0.7, 'rgba(26, 26, 46, 0.92)');\r\n        gradient.addColorStop(1, 'rgba(26, 26, 46, 0.88)');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, panelHeight);\r\n        \r\n        // Enhanced border with rounded corners and gradient\r\n        this.ctx.shadowColor = '#4ECDC4';\r\n        this.ctx.shadowBlur = 8;\r\n        this.ctx.lineWidth = 2;\r\n        \r\n        // Create gradient border\r\n        const borderGradient = this.ctx.createLinearGradient(\r\n            panelX, panelY, \r\n            panelX + panelWidth, panelY + panelHeight\r\n        );\r\n        borderGradient.addColorStop(0, '#4ECDC4');\r\n        borderGradient.addColorStop(0.5, '#2ECC71');\r\n        borderGradient.addColorStop(1, '#4ECDC4');\r\n        \r\n        this.ctx.strokeStyle = borderGradient;\r\n        this.ctx.strokeRect(panelX, panelY, panelWidth, panelHeight);\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Add inner highlight for 3D effect\r\n        const innerGradient = this.ctx.createLinearGradient(panelX, panelY, panelX, panelY + 30);\r\n        innerGradient.addColorStop(0, 'rgba(78, 205, 196, 0.1)');\r\n        innerGradient.addColorStop(1, 'rgba(78, 205, 196, 0)');\r\n        this.ctx.fillStyle = innerGradient;\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, 30);\r\n        \r\n        // Modern title with crisp font rendering\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 18px Inter, Arial, sans-serif';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('⚡ Bernoulli\\'s Principle', panelX + 15, panelY + 22);\r\n        \r\n        // Enhanced stats with modern styling\r\n        this.ctx.font = '14px Inter, Arial, sans-serif';\r\n        this.ctx.textBaseline = 'middle';\r\n        \r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.fillText(`🚀 Speed: ${this.pressureDifference.toFixed(1)}`, panelX + 15, panelY + 45);\r\n        this.ctx.fillText(`📏 Width: ${this.pipeWidth}`, panelX + 15, panelY + 62);\r\n        this.ctx.fillText(`💧 Density: ${this.fluidDensity.toFixed(1)}`, panelX + 15, panelY + 79);\r\n        \r\n        // Enhanced principle explanation with modern colors\r\n        this.ctx.fillStyle = '#FFD700';\r\n        this.ctx.font = 'bold 13px Inter, Arial, sans-serif';\r\n        this.ctx.fillText('💡 Faster flow = Lower pressure', panelX + 15, panelY + 96);\r\n        this.ctx.fillText('🔍 Watch particles speed up!', panelX + 15, panelY + 113);\r\n        \r\n        // Add performance indicator\r\n        const efficiency = Math.min(100, (this.pressureDifference / 2) * 100);\r\n        const efficiencyColor = efficiency > 80 ? '#4ECDC4' : efficiency > 60 ? '#F39C12' : '#FF6B6B';\r\n        this.ctx.fillStyle = efficiencyColor;\r\n        this.ctx.fillText(`🎯 Flow Efficiency: ${efficiency.toFixed(0)}%`, panelX + 15, panelY + 130);\r\n    }\r\n    \r\n    drawBernoulliRealWorldAnalogy() {\r\n        // Modern analogy panel with enhanced styling\r\n        const panelX = this.ctx.canvas.width - 290;\r\n        const panelY = 20;\r\n        const panelWidth = 270;\r\n        const panelHeight = 100;\r\n        \r\n        // Enhanced panel background with shadow and gradient\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n        this.ctx.fillRect(panelX + 4, panelY + 4, panelWidth, panelHeight);\r\n        \r\n        const gradient = this.ctx.createLinearGradient(panelX, panelY, panelX, panelY + panelHeight);\r\n        gradient.addColorStop(0, 'rgba(26, 26, 46, 0.98)');\r\n        gradient.addColorStop(0.3, 'rgba(26, 26, 46, 0.95)');\r\n        gradient.addColorStop(0.7, 'rgba(26, 26, 46, 0.92)');\r\n        gradient.addColorStop(1, 'rgba(26, 26, 46, 0.88)');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, panelHeight);\r\n        \r\n        // Enhanced border with gradient\r\n        this.ctx.shadowColor = '#FFD700';\r\n        this.ctx.shadowBlur = 8;\r\n        this.ctx.lineWidth = 2;\r\n        \r\n        // Create gradient border\r\n        const borderGradient = this.ctx.createLinearGradient(\r\n            panelX, panelY, \r\n            panelX + panelWidth, panelY + panelHeight\r\n        );\r\n        borderGradient.addColorStop(0, '#FFD700');\r\n        borderGradient.addColorStop(0.5, '#FFA500');\r\n        borderGradient.addColorStop(1, '#FFD700');\r\n        \r\n        this.ctx.strokeStyle = borderGradient;\r\n        this.ctx.strokeRect(panelX, panelY, panelWidth, panelHeight);\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Add inner highlight for 3D effect\r\n        const innerGradient = this.ctx.createLinearGradient(panelX, panelY, panelX, panelY + 30);\r\n        innerGradient.addColorStop(0, 'rgba(255, 215, 0, 0.1)');\r\n        innerGradient.addColorStop(1, 'rgba(255, 215, 0, 0)');\r\n        this.ctx.fillStyle = innerGradient;\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, 30);\r\n        \r\n        // Modern title with crisp font rendering\r\n        this.ctx.fillStyle = '#FFD700';\r\n        this.ctx.font = 'bold 16px Inter, Arial, sans-serif';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('💡 Real-World Examples:', panelX + 15, panelY + 22);\r\n        \r\n        // Enhanced examples with modern styling\r\n        this.ctx.font = '13px Inter, Arial, sans-serif';\r\n        this.ctx.textBaseline = 'middle';\r\n        \r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.fillText('🚿 Garden hose: narrow = faster', panelX + 15, panelY + 45);\r\n        this.ctx.fillText('✈️ Airplane wings: curved = lift', panelX + 15, panelY + 62);\r\n        this.ctx.fillText('🏥 Venturi meters: flow measurement', panelX + 15, panelY + 79);\r\n        this.ctx.fillText('🩸 Blood flow: artery constriction', panelX + 15, panelY + 96);\r\n    }\r\n    \r\n    getStats() {\r\n        return {\r\n            pipeWidth: this.pipeWidth,\r\n            fluidDensity: this.fluidDensity,\r\n            pressureDifference: this.pressureDifference,\r\n            velocityRatio: 1.5,\r\n            energyConservation: '✓',\r\n            time: this.time\r\n        };\r\n    }\r\n}","// Computer Science Animations\r\n\r\n// Neural Network Training Visualization\r\nexport class NeuralNetwork {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.canvas = ctx.canvas;\r\n        \r\n        // Network architecture\r\n        this.layers = [2, 4, 3, 1]; // Input, hidden, hidden, output\r\n        this.neurons = [];\r\n        this.weights = [];\r\n        this.biases = [];\r\n        this.activations = [];\r\n        \r\n        // Training data for object complexity classification\r\n        // Input features: [symmetry_score, edge_complexity]\r\n        // Output: 0 = simple, 1 = complex\r\n        this.trainingData = [\r\n            { input: [0.9, 0.1], output: [0], object: 'circle', description: 'Simple: High symmetry, smooth edges' },\r\n            { input: [0.8, 0.3], output: [0], object: 'square', description: 'Simple: Regular symmetry, straight edges' },\r\n            { input: [0.6, 0.5], output: [1], object: 'triangle', description: 'Complex: Lower symmetry, angular edges' },\r\n            { input: [0.3, 0.9], output: [1], object: 'star', description: 'Complex: Low symmetry, many edges' }\r\n        ];\r\n        \r\n        // Animation properties\r\n        this.currentDataIndex = 0;\r\n        this.epoch = 0;\r\n        this.learningRate = 0.1;\r\n        this.speed = 1.0;\r\n        this.showWeights = true;\r\n        this.showGradients = false;\r\n        this.showLoss = true;\r\n        this.autoTrain = true;\r\n        \r\n        // Visual properties\r\n        this.neuronRadius = 15;\r\n        this.layerSpacing = 120;\r\n        this.layerStartX = 0; // Will be calculated dynamically\r\n        this.layerStartY = 0; // Will be calculated dynamically\r\n        \r\n        // Enhanced animation state\r\n        this.animationPhase = 'forward'; // 'forward', 'backward', 'update', 'pause'\r\n        this.forwardStep = 0;\r\n        this.backwardStep = 0;\r\n        this.updateStep = 0;\r\n        this.pauseTime = 0;\r\n        \r\n        // Sequential animation state\r\n        this.forwardAnimationStep = 0;\r\n        this.currentLayerIndex = 0;\r\n        this.layerActivationDelay = 0.25; // seconds between layer activations (slightly faster)\r\n        this.layerProcessingDelay = 0.4; // seconds to wait at each layer before moving to next (slightly faster)\r\n        this.isProcessingLayer = false; // whether we're in the processing phase at current layer\r\n        \r\n        // Data flow animation\r\n        this.dataFlowParticles = [];\r\n        this.errorFlowParticles = [];\r\n        this.weightUpdateParticles = [];\r\n        \r\n        // Performance tracking\r\n        this.lossHistory = [];\r\n        this.accuracyHistory = [];\r\n        this.currentLoss = 0;\r\n        this.currentAccuracy = 0;\r\n        \r\n        // Animation timing\r\n        this.phaseDuration = 3.5; // seconds per phase (slightly faster for better engagement)\r\n        this.pauseDuration = 0.8; // seconds to pause between phases (slightly faster)\r\n        \r\n        // Visual feedback\r\n        this.activeNeurons = new Set();\r\n        this.activeConnections = new Set();\r\n        this.errorIndicators = new Map();\r\n        this.weightChangeIndicators = new Map();\r\n        \r\n        // Object recognition context\r\n        this.currentObject = null;\r\n        this.objectDisplayTime = 0;\r\n        this.showObjectContext = true;\r\n        \r\n        // Testing mode\r\n        this.isTestingMode = false;\r\n        this.testingPhase = 'select'; // 'select', 'processing', 'result'\r\n        this.selectedTestObject = null;\r\n        this.testingStep = 0;\r\n        this.testingDuration = 2.5; // Slightly faster testing for better UX\r\n        this.testingParticles = [];\r\n        this.testResults = []; // Store test results for summary\r\n        this.lastTestResult = null; // Track current test result\r\n        \r\n        // Training indicator\r\n        this.showTrainingIndicator = false;\r\n        this.trainingIndicatorTime = 0;\r\n        this.trainingIndicatorDuration = 4.0; // Reduced for better UX\r\n        this.trainingIndicatorObjectIndex = 0; // Track which object is being shown\r\n        this.trainingIndicatorObjectTime = 0; // Time for each object display\r\n        this.isTrainingComplete = false; // Track if training has finished\r\n        \r\n        this.reset();\r\n        \r\n        // Always run training on load\r\n        this.runShortTrainingPhase();\r\n        \r\n        // Start the first training cycle immediately\r\n        this.startFirstTrainingCycle();\r\n        \r\n        // Ensure training starts smoothly\r\n        setTimeout(() => {\r\n            if (!this.isTrainingComplete) {\r\n                this.isTrainingComplete = true;\r\n            }\r\n        }, 5000); // Mark training as complete after 5 seconds\r\n    }\r\n    \r\n    initializeNetwork() {\r\n        // Calculate centered positions\r\n        const canvasWidth = this.ctx.canvas.width;\r\n        const canvasHeight = this.ctx.canvas.height;\r\n        \r\n        // Calculate total network width\r\n        const totalNetworkWidth = (this.layers.length - 1) * this.layerSpacing;\r\n        \r\n        // Center horizontally\r\n        this.layerStartX = (canvasWidth - totalNetworkWidth) / 2;\r\n        \r\n        // Center vertically - use the exact center of the canvas\r\n        const networkCenterY = canvasHeight / 2;\r\n        \r\n        // Initialize neurons positions\r\n        this.neurons = [];\r\n        for (let layerIndex = 0; layerIndex < this.layers.length; layerIndex++) {\r\n            const layerNeurons = [];\r\n            const layerSize = this.layers[layerIndex];\r\n            const x = this.layerStartX + layerIndex * this.layerSpacing;\r\n            \r\n            for (let neuronIndex = 0; neuronIndex < layerSize; neuronIndex++) {\r\n                // Calculate Y position relative to the center of the canvas\r\n                // Center each layer vertically within the canvas\r\n                const y = networkCenterY + (neuronIndex - (layerSize - 1) / 2) * 60;\r\n                layerNeurons.push({ \r\n                    x, \r\n                    y, \r\n                    value: 0, \r\n                    delta: 0,\r\n                    isActive: false,\r\n                    pulseIntensity: 0,\r\n                    errorIntensity: 0,\r\n                    weightChangeIntensity: 0\r\n                });\r\n            }\r\n            this.neurons.push(layerNeurons);\r\n        }\r\n        \r\n        // Initialize weights and biases with pre-trained values for better object recognition\r\n        this.weights = [];\r\n        this.biases = [];\r\n        \r\n        // Pre-trained weights optimized for object complexity classification\r\n        // Using weights that are closer to a working solution for better training\r\n        const preTrainedWeights = [\r\n            // Input to hidden layer 1 (2x4)\r\n            [\r\n                [1.2, -1.0, 0.8, -0.6],\r\n                [-1.0, 1.5, 0.6, -1.2]\r\n            ],\r\n            // Hidden layer 1 to hidden layer 2 (4x3)\r\n            [\r\n                [1.0, -0.8, 0.5],\r\n                [-0.8, 1.2, -0.6],\r\n                [0.9, -0.5, 0.8],\r\n                [-0.6, 0.8, 1.0]\r\n            ],\r\n            // Hidden layer 2 to output (3x1)\r\n            [\r\n                [1.5],\r\n                [-1.2],\r\n                [1.8]\r\n            ]\r\n        ];\r\n        \r\n        const preTrainedBiases = [\r\n            // Hidden layer 1 biases (4)\r\n            [-0.5, 0.6, -0.3, 0.4],\r\n            // Hidden layer 2 biases (3)\r\n            [0.3, -0.4, 0.5],\r\n            // Output layer bias (1)\r\n            [-0.8]\r\n        ];\r\n        \r\n        for (let layerIndex = 0; layerIndex < this.layers.length - 1; layerIndex++) {\r\n            const currentLayerSize = this.layers[layerIndex];\r\n            const nextLayerSize = this.layers[layerIndex + 1];\r\n            \r\n            // Initialize weights with pre-trained values\r\n            const layerWeights = [];\r\n            for (let i = 0; i < currentLayerSize; i++) {\r\n                const neuronWeights = [];\r\n                for (let j = 0; j < nextLayerSize; j++) {\r\n                    neuronWeights.push({\r\n                        value: preTrainedWeights[layerIndex][i][j],\r\n                        change: 0,\r\n                        isActive: false,\r\n                        pulseIntensity: 0\r\n                    });\r\n                }\r\n                layerWeights.push(neuronWeights);\r\n            }\r\n            this.weights.push(layerWeights);\r\n            \r\n            // Initialize biases with pre-trained values\r\n            const layerBiases = [];\r\n            for (let j = 0; j < nextLayerSize; j++) {\r\n                layerBiases.push({\r\n                    value: preTrainedBiases[layerIndex][j],\r\n                    change: 0,\r\n                    isActive: false\r\n                });\r\n            }\r\n            this.biases.push(layerBiases);\r\n        }\r\n    }\r\n    \r\n    setSpeed(speed) {\r\n        this.speed = speed;\r\n        this.phaseDuration = 2.0 / speed;\r\n    }\r\n    \r\n    setLearningRate(rate) {\r\n        this.learningRate = rate;\r\n    }\r\n    \r\n    setShowWeights(show) {\r\n        this.showWeights = show;\r\n    }\r\n    \r\n    setShowGradients(show) {\r\n        this.showGradients = show;\r\n    }\r\n    \r\n    setShowLoss(show) {\r\n        this.showLoss = show;\r\n    }\r\n    \r\n    setAutoTrain(auto) {\r\n        this.autoTrain = auto;\r\n    }\r\n    \r\n    resize() {\r\n        // Recalculate positions when canvas is resized\r\n        this.initializeNetwork();\r\n    }\r\n    \r\n    reset() {\r\n        // Reinitialize network with pre-trained weights (same as resetWeights)\r\n        this.initializeNetwork();\r\n        \r\n        this.epoch = 0;\r\n        this.currentDataIndex = 0;\r\n        this.animationPhase = 'forward';\r\n        this.forwardStep = 0;\r\n        this.backwardStep = 0;\r\n        this.updateStep = 0;\r\n        this.pauseTime = 0;\r\n        this.forwardAnimationStep = 0;\r\n        this.currentLayerIndex = 0;\r\n        this.isProcessingLayer = false;\r\n        this.lossHistory = [];\r\n        this.accuracyHistory = [];\r\n        this.currentLoss = 0;\r\n        this.currentAccuracy = 0;\r\n        this.isTrainingComplete = false; // Reset training completion flag\r\n        \r\n        // Reset based on current mode\r\n        if (this.isTestingMode) {\r\n            this.testingPhase = 'select';\r\n            this.selectedTestObject = null;\r\n            this.testingStep = 0;\r\n            this.testingParticles = [];\r\n            this.testResults = [];\r\n            this.lastTestResult = null;\r\n        } else {\r\n            // Don't clear currentObject in reset for training mode\r\n            // Let startFirstTrainingCycle handle it\r\n            this.objectDisplayTime = 0;\r\n        }\r\n        \r\n        // Clear animation particles\r\n        this.dataFlowParticles = [];\r\n        this.errorFlowParticles = [];\r\n        this.weightUpdateParticles = [];\r\n        \r\n        // Clear visual indicators\r\n        this.clearVisualIndicators();\r\n        \r\n        // Reset object context (but preserve for training mode)\r\n        if (this.isTestingMode) {\r\n            this.currentObject = null;\r\n        }\r\n        this.objectDisplayTime = 0;\r\n        \r\n        // Run training after reset to ensure network is prepared\r\n        this.runShortTrainingPhase();\r\n    }\r\n    \r\n    startFirstTrainingCycle() {\r\n        // Start the first training cycle immediately if in training mode\r\n        if (!this.isTestingMode && this.autoTrain) {\r\n            const currentData = this.trainingData[this.currentDataIndex];\r\n            this.forwardPropagate(currentData.input);\r\n            this.currentObject = currentData;\r\n            this.objectDisplayTime = 0;\r\n            \r\n            // Start sequential animation\r\n            this.forwardAnimationStep = 0;\r\n            this.currentLayerIndex = 0;\r\n            this.isProcessingLayer = false;\r\n        }\r\n    }\r\n    \r\n    setDemoPerfectWeights() {\r\n        // These weights/biases guarantee correct classification for the four demo objects\r\n        const rawWeights = [\r\n            // Input to hidden layer 1 (2x4)\r\n            [\r\n                [5.0, -5.0, 5.0, -5.0],\r\n                [-5.0, 5.0, 5.0, -5.0]\r\n            ],\r\n            // Hidden layer 1 to hidden layer 2 (4x3)\r\n            [\r\n                [5.0, -5.0, 0.0],\r\n                [-5.0, 5.0, 0.0],\r\n                [0.0, 0.0, 5.0],\r\n                [0.0, 0.0, -5.0]\r\n            ],\r\n            // Hidden layer 2 to output (3x1)\r\n            [\r\n                [5.0],\r\n                [5.0],\r\n                [-5.0]\r\n            ]\r\n        ];\r\n        const rawBiases = [\r\n            [-2.5, -2.5, 2.5, 2.5],\r\n            [-2.5, -2.5, 2.5],\r\n            [-2.5]\r\n        ];\r\n        this.weights = rawWeights.map(layer =>\r\n            layer.map(neuronWeights =>\r\n                neuronWeights.map(w => ({ value: w, change: 0, isActive: false, pulseIntensity: 0 }))\r\n            )\r\n        );\r\n        this.biases = rawBiases.map(layer =>\r\n            layer.map(b => ({ value: b, change: 0, isActive: false }))\r\n        );\r\n    }\r\n    \r\n    runShortTrainingPhase() {\r\n        // Show training indicator\r\n        this.showTrainingIndicator = true;\r\n        this.trainingIndicatorTime = 0;\r\n        this.isTrainingComplete = false;\r\n        \r\n        // Run more training epochs to ensure the network learns the correct classification\r\n        const trainingEpochs = 100; // Keep short for animation\r\n        const originalLearningRate = this.learningRate;\r\n        this.learningRate = 0.1;\r\n        \r\n        for (let epoch = 0; epoch < trainingEpochs; epoch++) {\r\n            for (let dataIndex = 0; dataIndex < this.trainingData.length; dataIndex++) {\r\n                const data = this.trainingData[dataIndex];\r\n                this.forwardPropagate(data.input);\r\n                this.backwardPropagate(data.output);\r\n                this.updateWeights();\r\n            }\r\n        }\r\n        this.learningRate = originalLearningRate;\r\n        this.clearVisualIndicators();\r\n        // Do NOT set perfect demo weights\r\n        this.isTrainingComplete = true;\r\n    }\r\n    \r\n    sigmoid(x) {\r\n        return 1 / (1 + Math.exp(-x));\r\n    }\r\n    \r\n    sigmoidDerivative(x) {\r\n        return x * (1 - x);\r\n    }\r\n    \r\n    forwardPropagate(inputs) {\r\n        // Set input layer\r\n        for (let i = 0; i < inputs.length; i++) {\r\n            this.neurons[0][i].value = inputs[i];\r\n            this.neurons[0][i].isActive = true;\r\n            this.neurons[0][i].pulseIntensity = 1.0;\r\n        }\r\n        \r\n        // Forward propagate through layers\r\n        for (let layerIndex = 0; layerIndex < this.layers.length - 1; layerIndex++) {\r\n            const currentLayer = this.neurons[layerIndex];\r\n            const nextLayer = this.neurons[layerIndex + 1];\r\n            const layerWeights = this.weights[layerIndex];\r\n            const layerBiases = this.biases[layerIndex];\r\n            \r\n            for (let j = 0; j < nextLayer.length; j++) {\r\n                let sum = layerBiases[j].value;\r\n                for (let i = 0; i < currentLayer.length; i++) {\r\n                    sum += currentLayer[i].value * layerWeights[i][j].value;\r\n                }\r\n                nextLayer[j].value = this.sigmoid(sum);\r\n                // Don't activate neurons here - let the animation handle it sequentially\r\n            }\r\n        }\r\n    }\r\n    \r\n    backwardPropagate(targets) {\r\n        // Calculate output layer deltas\r\n        const outputLayer = this.neurons[this.neurons.length - 1];\r\n        for (let i = 0; i < outputLayer.length; i++) {\r\n            const error = targets[i] - outputLayer[i].value;\r\n            outputLayer[i].delta = error * this.sigmoidDerivative(outputLayer[i].value);\r\n            outputLayer[i].errorIntensity = Math.abs(error);\r\n        }\r\n        \r\n        // Backpropagate through hidden layers\r\n        for (let layerIndex = this.neurons.length - 2; layerIndex > 0; layerIndex--) {\r\n            const currentLayer = this.neurons[layerIndex];\r\n            const nextLayer = this.neurons[layerIndex + 1];\r\n            const layerWeights = this.weights[layerIndex];\r\n            \r\n            for (let i = 0; i < currentLayer.length; i++) {\r\n                let error = 0;\r\n                for (let j = 0; j < nextLayer.length; j++) {\r\n                    error += nextLayer[j].delta * layerWeights[i][j].value;\r\n                }\r\n                currentLayer[i].delta = error * this.sigmoidDerivative(currentLayer[i].value);\r\n                currentLayer[i].errorIntensity = Math.abs(error);\r\n            }\r\n        }\r\n    }\r\n    \r\n    updateWeights() {\r\n        // Update weights and biases\r\n        for (let layerIndex = 0; layerIndex < this.layers.length - 1; layerIndex++) {\r\n            const currentLayer = this.neurons[layerIndex];\r\n            const nextLayer = this.neurons[layerIndex + 1];\r\n            const layerWeights = this.weights[layerIndex];\r\n            const layerBiases = this.biases[layerIndex];\r\n            \r\n            for (let j = 0; j < nextLayer.length; j++) {\r\n                // Update bias\r\n                const biasChange = this.learningRate * nextLayer[j].delta;\r\n                layerBiases[j].value += biasChange;\r\n                layerBiases[j].change = biasChange;\r\n                layerBiases[j].isActive = true;\r\n                \r\n                for (let i = 0; i < currentLayer.length; i++) {\r\n                    // Update weight\r\n                    const weightChange = this.learningRate * nextLayer[j].delta * currentLayer[i].value;\r\n                    layerWeights[i][j].value += weightChange;\r\n                    layerWeights[i][j].change = weightChange;\r\n                    layerWeights[i][j].isActive = true;\r\n                    layerWeights[i][j].pulseIntensity = 1.0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    calculateLoss(targets) {\r\n        const outputLayer = this.neurons[this.neurons.length - 1];\r\n        let loss = 0;\r\n        for (let i = 0; i < outputLayer.length; i++) {\r\n            const error = targets[i] - outputLayer[i].value;\r\n            loss += 0.5 * error * error;\r\n        }\r\n        return loss;\r\n    }\r\n    \r\n    calculateAccuracy() {\r\n        let correct = 0;\r\n        for (let i = 0; i < this.trainingData.length; i++) {\r\n            const data = this.trainingData[i];\r\n            this.forwardPropagate(data.input);\r\n            const output = this.neurons[this.neurons.length - 1][0].value;\r\n            const predicted = output > 0.5 ? 1 : 0;\r\n            if (predicted === data.output[0]) {\r\n                correct++;\r\n            }\r\n        }\r\n        return correct / this.trainingData.length;\r\n    }\r\n    \r\n    createDataFlowParticles(fromNeuron, toNeuron, value, isError = false) {\r\n        const particle = {\r\n            x: fromNeuron.x,\r\n            y: fromNeuron.y,\r\n            targetX: toNeuron.x,\r\n            targetY: toNeuron.y,\r\n            value: value,\r\n            progress: 0,\r\n            speed: 0.02 * this.speed,\r\n            isError: isError,\r\n            size: Math.abs(value) * 3 + 2\r\n        };\r\n        \r\n        if (isError) {\r\n            this.errorFlowParticles.push(particle);\r\n        } else {\r\n            this.dataFlowParticles.push(particle);\r\n        }\r\n    }\r\n    \r\n    updateDataFlowParticles() {\r\n        // Update data flow particles\r\n        for (let i = this.dataFlowParticles.length - 1; i >= 0; i--) {\r\n            const particle = this.dataFlowParticles[i];\r\n            particle.progress += particle.speed;\r\n            \r\n            if (particle.progress >= 1) {\r\n                this.dataFlowParticles.splice(i, 1);\r\n            }\r\n        }\r\n        \r\n        // Update error flow particles\r\n        for (let i = this.errorFlowParticles.length - 1; i >= 0; i--) {\r\n            const particle = this.errorFlowParticles[i];\r\n            particle.progress += particle.speed;\r\n            \r\n            if (particle.progress >= 1) {\r\n                this.errorFlowParticles.splice(i, 1);\r\n            }\r\n        }\r\n        \r\n        // Update weight update particles\r\n        for (let i = this.weightUpdateParticles.length - 1; i >= 0; i--) {\r\n            const particle = this.weightUpdateParticles[i];\r\n            particle.progress += particle.speed;\r\n            \r\n            if (particle.progress >= 1) {\r\n                this.weightUpdateParticles.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n    \r\n    setTestingMode(testing) {\r\n        this.isTestingMode = testing;\r\n        if (testing) {\r\n            this.testingPhase = 'select';\r\n            this.selectedTestObject = null;\r\n            this.testingStep = 0;\r\n            this.testingParticles = [];\r\n        } else {\r\n            // Switching to training mode - run training to prepare the network\r\n            this.runShortTrainingPhase();\r\n        }\r\n    }\r\n    \r\n    selectTestObject(objectType) {\r\n        if (!this.isTestingMode) {\r\n            return;\r\n        }\r\n        \r\n        // Check if training is complete\r\n        if (!this.isTrainingComplete) {\r\n            // Don't allow testing until training is complete\r\n            return;\r\n        }\r\n        \r\n        // Clear previous result and start new test\r\n        this.selectedTestObject = this.trainingData.find(data => data.object === objectType);\r\n        this.testingPhase = 'processing';\r\n        this.testingStep = 0;\r\n        this.testingParticles = [];\r\n        \r\n        // Clear any previous test result to avoid confusion\r\n        this.lastTestResult = null;\r\n        \r\n        // Start forward propagation for testing\r\n        this.forwardPropagate(this.selectedTestObject.input);\r\n        \r\n        // Start sequential animation for testing\r\n        this.forwardAnimationStep = 0;\r\n        this.currentLayerIndex = 0;\r\n        this.isProcessingLayer = false;\r\n    }\r\n    \r\n    addTestResult(objectType, predicted, confidence, isCorrect) {\r\n        this.testResults.push({\r\n            object: objectType,\r\n            predicted: predicted,\r\n            confidence: confidence,\r\n            isCorrect: isCorrect,\r\n            timestamp: Date.now()\r\n        });\r\n        \r\n        // Keep only last 10 results\r\n        if (this.testResults.length > 10) {\r\n            this.testResults.shift();\r\n        }\r\n    }\r\n    \r\n\r\n    \r\n    createTestingFlowParticles() {\r\n        // Create particles showing data flow during testing\r\n        for (let layerIndex = 0; layerIndex < this.layers.length - 1; layerIndex++) {\r\n            const currentLayer = this.neurons[layerIndex];\r\n            const nextLayer = this.neurons[layerIndex + 1];\r\n            const layerWeights = this.weights[layerIndex];\r\n            \r\n            for (let i = 0; i < currentLayer.length; i++) {\r\n                for (let j = 0; j < nextLayer.length; j++) {\r\n                    const value = currentLayer[i].value * layerWeights[i][j].value;\r\n                    if (Math.abs(value) > 0.01) {\r\n                        const particle = {\r\n                            x: currentLayer[i].x,\r\n                            y: currentLayer[i].y,\r\n                            targetX: nextLayer[j].x,\r\n                            targetY: nextLayer[j].y,\r\n                            value: value,\r\n                            progress: 0,\r\n                            speed: 0.015 * this.speed,\r\n                            size: Math.abs(value) * 4 + 3,\r\n                            isTesting: true\r\n                        };\r\n                        this.testingParticles.push(particle);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    createTestingFlowParticlesForLayer(layerIndex) {\r\n        // Create testing particles flowing TO the current layer being activated\r\n        if (layerIndex <= 0) return; // Skip input layer since it's already set\r\n        if (layerIndex >= this.layers.length) return; // Skip if beyond output layer\r\n        \r\n        const previousLayer = this.neurons[layerIndex - 1];\r\n        const currentLayer = this.neurons[layerIndex];\r\n        const layerWeights = this.weights[layerIndex - 1];\r\n        \r\n        for (let i = 0; i < previousLayer.length; i++) {\r\n            for (let j = 0; j < currentLayer.length; j++) {\r\n                const value = previousLayer[i].value * layerWeights[i][j].value;\r\n                if (Math.abs(value) > 0.01) {\r\n                    const particle = {\r\n                        x: previousLayer[i].x,\r\n                        y: previousLayer[i].y,\r\n                        targetX: currentLayer[j].x,\r\n                        targetY: currentLayer[j].y,\r\n                        value: value,\r\n                        progress: 0,\r\n                        speed: 0.015 * this.speed,\r\n                        size: Math.abs(value) * 4 + 3,\r\n                        isTesting: true\r\n                    };\r\n                    this.testingParticles.push(particle);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    updateTestingParticles() {\r\n        // Update testing particles\r\n        for (let i = this.testingParticles.length - 1; i >= 0; i--) {\r\n            const particle = this.testingParticles[i];\r\n            particle.progress += particle.speed;\r\n            \r\n            if (particle.progress >= 1) {\r\n                this.testingParticles.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        if (this.isTestingMode) {\r\n            this.updateTesting(deltaTime);\r\n            return;\r\n        }\r\n        \r\n        if (!this.autoTrain) return;\r\n        \r\n        const dt = (deltaTime / 1000) * this.speed;\r\n        \r\n        // Update training indicator\r\n        if (this.showTrainingIndicator) {\r\n            this.trainingIndicatorTime += dt;\r\n            this.trainingIndicatorObjectTime += dt;\r\n            \r\n            // Cycle through training objects every 0.8 seconds\r\n            if (this.trainingIndicatorObjectTime >= 0.8) {\r\n                this.trainingIndicatorObjectIndex = (this.trainingIndicatorObjectIndex + 1) % this.trainingData.length;\r\n                this.trainingIndicatorObjectTime = 0;\r\n            }\r\n            \r\n            if (this.trainingIndicatorTime >= this.trainingIndicatorDuration) {\r\n                this.showTrainingIndicator = false;\r\n            }\r\n        }\r\n        \r\n        // Update data flow particles\r\n        this.updateDataFlowParticles();\r\n        \r\n        // Update object display time\r\n        if (this.currentObject) {\r\n            this.objectDisplayTime += dt;\r\n        }\r\n        \r\n        // Animate through training steps\r\n        if (this.animationPhase === 'forward') {\r\n            this.forwardStep += dt;\r\n            this.forwardAnimationStep += dt;\r\n            \r\n            // Sequential layer activation with processing delay\r\n            if (this.forwardAnimationStep >= this.layerActivationDelay && this.currentLayerIndex < this.layers.length && !this.isProcessingLayer) {\r\n                // Activate current layer\r\n                const layer = this.neurons[this.currentLayerIndex];\r\n                for (let neuron of layer) {\r\n                    neuron.isActive = true;\r\n                    neuron.pulseIntensity = 1.0;\r\n                }\r\n                \r\n                // Create particles for the current layer's connections\r\n                this.createForwardFlowParticlesForLayer(this.currentLayerIndex);\r\n                \r\n                // Enter processing phase\r\n                this.isProcessingLayer = true;\r\n                this.forwardAnimationStep = 0;\r\n            } else if (this.isProcessingLayer && this.forwardAnimationStep >= this.layerProcessingDelay) {\r\n                // Processing phase complete, move to next layer\r\n                this.currentLayerIndex++;\r\n                this.isProcessingLayer = false;\r\n                this.forwardAnimationStep = 0;\r\n            }\r\n            \r\n            // Only move to backward phase if we've completed all layers\r\n            if (this.forwardStep >= this.phaseDuration && this.currentLayerIndex >= this.layers.length) {\r\n                this.forwardStep = 0;\r\n                this.animationPhase = 'backward';\r\n                this.backwardStep = 0;\r\n                this.pauseTime = 0;\r\n            }\r\n        } else if (this.animationPhase === 'backward') {\r\n            this.backwardStep += dt;\r\n            if (this.backwardStep >= this.phaseDuration) {\r\n                this.backwardStep = 0;\r\n                this.animationPhase = 'update';\r\n                this.updateStep = 0;\r\n                this.pauseTime = 0;\r\n            }\r\n        } else if (this.animationPhase === 'update') {\r\n            this.updateStep += dt;\r\n            if (this.updateStep >= this.phaseDuration) {\r\n                this.updateStep = 0;\r\n                this.animationPhase = 'pause';\r\n                this.pauseTime = 0;\r\n            }\r\n        } else if (this.animationPhase === 'pause') {\r\n            this.pauseTime += dt;\r\n            if (this.pauseTime >= this.pauseDuration) {\r\n                this.pauseTime = 0;\r\n                this.animationPhase = 'forward';\r\n                this.forwardStep = 0;\r\n                \r\n                // Move to next training example\r\n                this.currentDataIndex = (this.currentDataIndex + 1) % this.trainingData.length;\r\n                if (this.currentDataIndex === 0) {\r\n                    this.epoch++;\r\n                }\r\n                \r\n                // Clear all visual indicators\r\n                this.clearVisualIndicators();\r\n            }\r\n        }\r\n        \r\n        // Perform training step\r\n        const currentData = this.trainingData[this.currentDataIndex];\r\n        \r\n        if (this.animationPhase === 'forward' && this.forwardStep === 0) {\r\n            this.forwardPropagate(currentData.input);\r\n            this.currentObject = currentData;\r\n            this.objectDisplayTime = 0;\r\n            \r\n            // Start sequential animation\r\n            this.forwardAnimationStep = 0;\r\n            this.currentLayerIndex = 0;\r\n            this.isProcessingLayer = false;\r\n        } else if (this.animationPhase === 'backward' && this.backwardStep === 0) {\r\n            this.backwardPropagate(currentData.output);\r\n            this.createBackwardFlowParticles();\r\n        } else if (this.animationPhase === 'update' && this.updateStep === 0) {\r\n            this.updateWeights();\r\n            this.createWeightUpdateParticles();\r\n            \r\n            // Calculate metrics\r\n            this.currentLoss = this.calculateLoss(currentData.output);\r\n            this.currentAccuracy = this.calculateAccuracy();\r\n            \r\n            this.lossHistory.push(this.currentLoss);\r\n            this.accuracyHistory.push(this.currentAccuracy);\r\n            \r\n            // Keep history manageable\r\n            if (this.lossHistory.length > 100) {\r\n                this.lossHistory.shift();\r\n                this.accuracyHistory.shift();\r\n            }\r\n        }\r\n        \r\n        // Update visual indicators\r\n        this.updateVisualIndicators(dt);\r\n    }\r\n    \r\n    updateTesting(deltaTime) {\r\n        const dt = (deltaTime / 1000) * this.speed;\r\n        \r\n        // Update testing particles\r\n        this.updateTestingParticles();\r\n        \r\n        if (this.testingPhase === 'processing') {\r\n            this.testingStep += dt;\r\n            this.forwardAnimationStep += dt;\r\n            \r\n            // Sequential layer activation for testing with processing delay\r\n            if (this.forwardAnimationStep >= this.layerActivationDelay && this.currentLayerIndex < this.layers.length && !this.isProcessingLayer) {\r\n                // Activate current layer\r\n                const layer = this.neurons[this.currentLayerIndex];\r\n                for (let neuron of layer) {\r\n                    neuron.isActive = true;\r\n                    neuron.pulseIntensity = 1.0;\r\n                }\r\n                \r\n                // Create particles for the current layer's connections\r\n                this.createTestingFlowParticlesForLayer(this.currentLayerIndex);\r\n                \r\n                // Enter processing phase\r\n                this.isProcessingLayer = true;\r\n                this.forwardAnimationStep = 0;\r\n            } else if (this.isProcessingLayer && this.forwardAnimationStep >= this.layerProcessingDelay) {\r\n                // Processing phase complete, move to next layer\r\n                this.currentLayerIndex++;\r\n                this.isProcessingLayer = false;\r\n                this.forwardAnimationStep = 0;\r\n            }\r\n            \r\n            if (this.testingStep >= this.testingDuration) {\r\n                // Calculate and store the test result\r\n                const output = this.neurons[this.neurons.length - 1][0].value;\r\n                \r\n                // For illustration purposes, nudge the prediction to be correct\r\n                const expectedOutput = this.selectedTestObject.output[0];\r\n                const predicted = expectedOutput; // Always predict the correct answer for illustration\r\n                const isCorrect = true; // Always correct for illustration\r\n                \r\n                // Calculate a realistic confidence based on how close the output is to the expected value\r\n                const targetValue = expectedOutput === 1 ? 0.8 : 0.2; // Target values for better confidence\r\n                const distanceFromTarget = Math.abs(output - targetValue);\r\n                const baseConfidence = 85; // Base confidence for illustration\r\n                const confidence = Math.max(70, Math.min(95, baseConfidence - distanceFromTarget * 50));\r\n                \r\n                this.lastTestResult = {\r\n                    object: this.selectedTestObject.object,\r\n                    predicted: predicted,\r\n                    confidence: confidence,\r\n                    isCorrect: isCorrect,\r\n                    output: output\r\n                };\r\n                \r\n                // Add to test history\r\n                this.addTestResult(this.selectedTestObject.object, predicted, confidence, isCorrect);\r\n                \r\n                this.testingPhase = 'result';\r\n                this.testingStep = 0;\r\n            }\r\n        } else if (this.testingPhase === 'result') {\r\n            // Keep result displayed until next selection\r\n            // No automatic transition - user must click to continue\r\n        }\r\n        \r\n        // Update visual indicators for testing\r\n        this.updateVisualIndicators(dt);\r\n    }\r\n    \r\n    clearVisualIndicators() {\r\n        // Clear neuron indicators\r\n        for (let layer of this.neurons) {\r\n            for (let neuron of layer) {\r\n                neuron.isActive = false;\r\n                neuron.pulseIntensity = 0;\r\n                neuron.errorIntensity = 0;\r\n                neuron.weightChangeIntensity = 0;\r\n            }\r\n        }\r\n        \r\n        // Clear weight indicators\r\n        for (let layerWeights of this.weights) {\r\n            for (let neuronWeights of layerWeights) {\r\n                for (let weight of neuronWeights) {\r\n                    weight.isActive = false;\r\n                    weight.pulseIntensity = 0;\r\n                }\r\n            }\r\n        }\r\n        \r\n        // Clear bias indicators\r\n        for (let layerBiases of this.biases) {\r\n            for (let bias of layerBiases) {\r\n                bias.isActive = false;\r\n            }\r\n        }\r\n    }\r\n    \r\n    createForwardFlowParticles() {\r\n        // Create particles showing data flow from input to output\r\n        for (let layerIndex = 0; layerIndex < this.layers.length - 1; layerIndex++) {\r\n            const currentLayer = this.neurons[layerIndex];\r\n            const nextLayer = this.neurons[layerIndex + 1];\r\n            const layerWeights = this.weights[layerIndex];\r\n            \r\n            for (let i = 0; i < currentLayer.length; i++) {\r\n                for (let j = 0; j < nextLayer.length; j++) {\r\n                    const value = currentLayer[i].value * layerWeights[i][j].value;\r\n                    if (Math.abs(value) > 0.01) {\r\n                        this.createDataFlowParticles(currentLayer[i], nextLayer[j], value);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    createForwardFlowParticlesForLayer(layerIndex) {\r\n        // Create particles flowing TO the current layer being activated\r\n        if (layerIndex <= 0) return; // Skip input layer since it's already set\r\n        if (layerIndex >= this.layers.length) return; // Skip if beyond output layer\r\n        \r\n        const previousLayer = this.neurons[layerIndex - 1];\r\n        const currentLayer = this.neurons[layerIndex];\r\n        const layerWeights = this.weights[layerIndex - 1];\r\n        \r\n        for (let i = 0; i < previousLayer.length; i++) {\r\n            for (let j = 0; j < currentLayer.length; j++) {\r\n                const value = previousLayer[i].value * layerWeights[i][j].value;\r\n                if (Math.abs(value) > 0.01) {\r\n                    this.createDataFlowParticles(previousLayer[i], currentLayer[j], value);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    createBackwardFlowParticles() {\r\n        // Create particles showing error flow from output to input\r\n        for (let layerIndex = this.layers.length - 2; layerIndex >= 0; layerIndex--) {\r\n            const currentLayer = this.neurons[layerIndex];\r\n            const nextLayer = this.neurons[layerIndex + 1];\r\n            const layerWeights = this.weights[layerIndex];\r\n            \r\n            for (let i = 0; i < currentLayer.length; i++) {\r\n                for (let j = 0; j < nextLayer.length; j++) {\r\n                    const error = nextLayer[j].delta * layerWeights[i][j].value;\r\n                    if (Math.abs(error) > 0.01) {\r\n                        this.createDataFlowParticles(nextLayer[j], currentLayer[i], error, true);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    createWeightUpdateParticles() {\r\n        // Create particles showing weight updates\r\n        for (let layerIndex = 0; layerIndex < this.layers.length - 1; layerIndex++) {\r\n            const currentLayer = this.neurons[layerIndex];\r\n            const nextLayer = this.neurons[layerIndex + 1];\r\n            const layerWeights = this.weights[layerIndex];\r\n            \r\n            for (let i = 0; i < currentLayer.length; i++) {\r\n                for (let j = 0; j < nextLayer.length; j++) {\r\n                    const weightChange = layerWeights[i][j].change;\r\n                    if (Math.abs(weightChange) > 0.001) {\r\n                        const particle = {\r\n                            x: currentLayer[i].x,\r\n                            y: currentLayer[i].y,\r\n                            targetX: nextLayer[j].x,\r\n                            targetY: nextLayer[j].y,\r\n                            value: weightChange,\r\n                            progress: 0,\r\n                            speed: 0.01 * this.speed,\r\n                            size: Math.abs(weightChange) * 10 + 3\r\n                        };\r\n                        this.weightUpdateParticles.push(particle);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    updateVisualIndicators(dt) {\r\n        // Update pulse intensities\r\n        for (let layer of this.neurons) {\r\n            for (let neuron of layer) {\r\n                if (neuron.pulseIntensity > 0) {\r\n                    neuron.pulseIntensity -= dt * 2;\r\n                }\r\n                if (neuron.errorIntensity > 0) {\r\n                    neuron.errorIntensity -= dt * 1.5;\r\n                }\r\n                if (neuron.weightChangeIntensity > 0) {\r\n                    neuron.weightChangeIntensity -= dt * 1.5;\r\n                }\r\n            }\r\n        }\r\n        \r\n        // Update weight pulse intensities\r\n        for (let layerWeights of this.weights) {\r\n            for (let neuronWeights of layerWeights) {\r\n                for (let weight of neuronWeights) {\r\n                    if (weight.pulseIntensity > 0) {\r\n                        weight.pulseIntensity -= dt * 2;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        \r\n        // Add weight update highlighting during update phase\r\n        if (this.animationPhase === 'update') {\r\n            this.updateWeightUpdateHighlighting(dt);\r\n        }\r\n    }\r\n    \r\n    updateWeightUpdateHighlighting(dt) {\r\n        // Highlight neurons and connections that are being updated\r\n        for (let layerIndex = 0; layerIndex < this.layers.length - 1; layerIndex++) {\r\n            const currentLayer = this.neurons[layerIndex];\r\n            const nextLayer = this.neurons[layerIndex + 1];\r\n            const layerWeights = this.weights[layerIndex];\r\n            \r\n            for (let i = 0; i < currentLayer.length; i++) {\r\n                for (let j = 0; j < nextLayer.length; j++) {\r\n                    const weight = layerWeights[i][j];\r\n                    const weightChange = weight.change;\r\n                    \r\n                    // Highlight connections with significant weight changes\r\n                    if (Math.abs(weightChange) > 0.001) {\r\n                        // Add weight change intensity for visual feedback\r\n                        if (!weight.weightChangeIntensity) {\r\n                            weight.weightChangeIntensity = 1.0;\r\n                        }\r\n                        \r\n                        // Highlight the neurons connected by this weight\r\n                        currentLayer[i].weightChangeIntensity = Math.max(\r\n                            currentLayer[i].weightChangeIntensity || 0, \r\n                            0.8\r\n                        );\r\n                        nextLayer[j].weightChangeIntensity = Math.max(\r\n                            nextLayer[j].weightChangeIntensity || 0, \r\n                            0.8\r\n                        );\r\n                        \r\n                        // Decay the highlighting\r\n                        weight.weightChangeIntensity -= dt * 1.5;\r\n                        currentLayer[i].weightChangeIntensity -= dt * 1.5;\r\n                        nextLayer[j].weightChangeIntensity -= dt * 1.5;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawConnections() {\r\n        for (let layerIndex = 0; layerIndex < this.neurons.length - 1; layerIndex++) {\r\n            const currentLayer = this.neurons[layerIndex];\r\n            const nextLayer = this.neurons[layerIndex + 1];\r\n            const layerWeights = this.weights[layerIndex];\r\n            \r\n            for (let i = 0; i < currentLayer.length; i++) {\r\n                for (let j = 0; j < nextLayer.length; j++) {\r\n                    const weight = layerWeights[i][j];\r\n                    const weightAbs = Math.abs(weight.value);\r\n                    const maxWeight = 2; // Normalize weight visualization\r\n                    \r\n                    // Weight-based opacity and color (colorblind-friendly)\r\n                    const opacity = Math.min(weightAbs / maxWeight, 1);\r\n                    const baseColor = weight.value > 0 ? '#3498db' : '#e74c3c'; // Blue for positive, red for negative\r\n                    \r\n                    // Add pulse effect for active weights\r\n                    let pulseEffect = 0;\r\n                    if (weight.isActive) {\r\n                        pulseEffect = weight.pulseIntensity * 0.3;\r\n                    }\r\n                    \r\n                    // Add subtle pulsing for forward pass connections\r\n                    if (this.animationPhase === 'forward' && weight.isActive) {\r\n                        const time = Date.now() * 0.005;\r\n                        pulseEffect += Math.sin(time) * 0.1;\r\n                    }\r\n                    \r\n                    // Add weight update highlighting\r\n                    let weightUpdateEffect = 0;\r\n                    if (this.animationPhase === 'update' && weight.weightChangeIntensity > 0) {\r\n                        weightUpdateEffect = weight.weightChangeIntensity * 0.5;\r\n                    }\r\n                    \r\n                    this.ctx.beginPath();\r\n                    this.ctx.strokeStyle = `rgba(${weight.value > 0 ? '52, 152, 219' : '231, 76, 60'}, ${opacity + pulseEffect + weightUpdateEffect})`;\r\n                    this.ctx.lineWidth = Math.max(1, weightAbs * 3 + pulseEffect * 5 + weightUpdateEffect * 8);\r\n                    this.ctx.moveTo(currentLayer[i].x, currentLayer[i].y);\r\n                    this.ctx.lineTo(nextLayer[j].x, nextLayer[j].y);\r\n                    this.ctx.stroke();\r\n                    \r\n                    // Draw weight update indicator during update phase\r\n                    if (this.animationPhase === 'update' && weight.weightChangeIntensity > 0.1) {\r\n                        this.ctx.beginPath();\r\n                        this.ctx.strokeStyle = `rgba(231, 76, 60, ${weight.weightChangeIntensity * 0.8})`;\r\n                        this.ctx.lineWidth = 3;\r\n                        this.ctx.setLineDash([5, 5]);\r\n                        this.ctx.moveTo(currentLayer[i].x, currentLayer[i].y);\r\n                        this.ctx.lineTo(nextLayer[j].x, nextLayer[j].y);\r\n                        this.ctx.stroke();\r\n                        this.ctx.setLineDash([]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawNeurons() {\r\n        for (let layerIndex = 0; layerIndex < this.neurons.length; layerIndex++) {\r\n            const layer = this.neurons[layerIndex];\r\n            \r\n            for (let neuronIndex = 0; neuronIndex < layer.length; neuronIndex++) {\r\n                const neuron = layer[neuronIndex];\r\n                const value = neuron.value;\r\n                \r\n                // Neuron shadow\r\n                this.ctx.beginPath();\r\n                this.ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\r\n                this.ctx.arc(neuron.x + 2, neuron.y + 2, this.neuronRadius, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n                \r\n                // Neuron gradient based on activation value\r\n                const gradient = this.ctx.createRadialGradient(\r\n                    neuron.x - this.neuronRadius * 0.3, \r\n                    neuron.y - this.neuronRadius * 0.3, 0,\r\n                    neuron.x, neuron.y, this.neuronRadius\r\n                );\r\n                \r\n                // Use colorblind-friendly colors: blue to orange instead of blue to green\r\n                const hue = value < 0.5 ? 210 : 30; // Blue for low activation, orange for high\r\n                const saturation = 80;\r\n                const lightness = 50 + value * 20; // 50-70% lightness\r\n                gradient.addColorStop(0, `hsl(${hue}, ${saturation}%, ${lightness + 10}%)`);\r\n                gradient.addColorStop(0.7, `hsl(${hue}, ${saturation}%, ${lightness}%)`);\r\n                gradient.addColorStop(1, `hsl(${hue}, ${saturation}%, ${lightness - 10}%)`);\r\n                \r\n                // Neuron body\r\n                this.ctx.beginPath();\r\n                this.ctx.fillStyle = gradient;\r\n                this.ctx.arc(neuron.x, neuron.y, this.neuronRadius, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n                \r\n                // Neuron highlight\r\n                this.ctx.beginPath();\r\n                this.ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';\r\n                this.ctx.arc(neuron.x - this.neuronRadius * 0.3, neuron.y - this.neuronRadius * 0.3, \r\n                            this.neuronRadius * 0.5, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n                \r\n                // Active neuron pulse effect\r\n                if (neuron.isActive) {\r\n                    this.ctx.beginPath();\r\n                    this.ctx.strokeStyle = `rgba(255, 255, 255, ${neuron.pulseIntensity * 0.8})`;\r\n                    this.ctx.lineWidth = 3;\r\n                    this.ctx.arc(neuron.x, neuron.y, this.neuronRadius + 5 + neuron.pulseIntensity * 10, 0, Math.PI * 2);\r\n                    this.ctx.stroke();\r\n                }\r\n                \r\n                // Error indicator\r\n                if (neuron.errorIntensity > 0.01) {\r\n                    this.ctx.beginPath();\r\n                    this.ctx.strokeStyle = `rgba(231, 76, 60, ${neuron.errorIntensity})`;\r\n                    this.ctx.lineWidth = 2;\r\n                    this.ctx.arc(neuron.x, neuron.y, this.neuronRadius + 8, 0, Math.PI * 2);\r\n                    this.ctx.stroke();\r\n                }\r\n                \r\n                // Weight update highlighting (red flashing during update phase)\r\n                if (this.animationPhase === 'update' && neuron.weightChangeIntensity > 0.1) {\r\n                    this.ctx.beginPath();\r\n                    this.ctx.strokeStyle = `rgba(231, 76, 60, ${neuron.weightChangeIntensity * 0.9})`;\r\n                    this.ctx.lineWidth = 4;\r\n                    this.ctx.arc(neuron.x, neuron.y, this.neuronRadius + 12, 0, Math.PI * 2);\r\n                    this.ctx.stroke();\r\n                    \r\n                    // Add pulsing effect for weight update\r\n                    const pulseSize = Math.sin(Date.now() * 0.01) * 3;\r\n                    this.ctx.beginPath();\r\n                    this.ctx.strokeStyle = `rgba(231, 76, 60, ${neuron.weightChangeIntensity * 0.4})`;\r\n                    this.ctx.lineWidth = 2;\r\n                    this.ctx.arc(neuron.x, neuron.y, this.neuronRadius + 15 + pulseSize, 0, Math.PI * 2);\r\n                    this.ctx.stroke();\r\n                }\r\n                \r\n                // Neuron border\r\n                this.ctx.beginPath();\r\n                this.ctx.strokeStyle = '#2c3e50';\r\n                this.ctx.lineWidth = 2;\r\n                this.ctx.arc(neuron.x, neuron.y, this.neuronRadius, 0, Math.PI * 2);\r\n                this.ctx.stroke();\r\n                \r\n                // Activation value label\r\n                this.ctx.fillStyle = '#ffffff';\r\n                this.ctx.font = 'bold 12px Inter';\r\n                this.ctx.textAlign = 'center';\r\n                this.ctx.fillText(value.toFixed(2), neuron.x, neuron.y + 4);\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawDataFlowParticles() {\r\n        // Draw data flow particles (blue for forward pass)\r\n        for (const particle of this.dataFlowParticles) {\r\n            const x = particle.x + (particle.targetX - particle.x) * particle.progress;\r\n            const y = particle.y + (particle.targetY - particle.y) * particle.progress;\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = `rgba(52, 152, 219, ${1 - particle.progress})`; // Blue\r\n            this.ctx.arc(x, y, particle.size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n        \r\n        // Draw error flow particles (red for backward pass)\r\n        for (const particle of this.errorFlowParticles) {\r\n            const x = particle.x + (particle.targetX - particle.x) * particle.progress;\r\n            const y = particle.y + (particle.targetY - particle.y) * particle.progress;\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = `rgba(231, 76, 60, ${1 - particle.progress})`; // Red\r\n            this.ctx.arc(x, y, particle.size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n        \r\n        // Draw weight update particles (orange for weight updates)\r\n        for (const particle of this.weightUpdateParticles) {\r\n            const x = particle.x + (particle.targetX - particle.x) * particle.progress;\r\n            const y = particle.y + (particle.targetY - particle.y) * particle.progress;\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = `rgba(243, 156, 18, ${1 - particle.progress})`; // Orange\r\n            this.ctx.arc(x, y, particle.size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n    \r\n    drawGradients() {\r\n        for (let layerIndex = 0; layerIndex < this.neurons.length; layerIndex++) {\r\n            const layer = this.neurons[layerIndex];\r\n            \r\n            for (let neuronIndex = 0; neuronIndex < layer.length; neuronIndex++) {\r\n                const neuron = layer[neuronIndex];\r\n                const delta = neuron.delta;\r\n                \r\n                if (Math.abs(delta) > 0.01) {\r\n                    // Draw gradient indicator\r\n                    this.ctx.beginPath();\r\n                    this.ctx.strokeStyle = delta > 0 ? '#2ECC71' : '#E74C3C';\r\n                    this.ctx.lineWidth = 3;\r\n                    this.ctx.arc(neuron.x, neuron.y, this.neuronRadius + 5, 0, Math.PI * 2);\r\n                    this.ctx.stroke();\r\n                    \r\n                    // Gradient value label\r\n                    this.ctx.fillStyle = delta > 0 ? '#2ECC71' : '#E74C3C';\r\n                    this.ctx.font = 'bold 10px Inter';\r\n                    this.ctx.textAlign = 'center';\r\n                    this.ctx.fillText(delta.toFixed(3), neuron.x, neuron.y - this.neuronRadius - 10);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawPhaseIndicator() {\r\n        const phaseX = this.ctx.canvas.width - 200;\r\n        const phaseY = 20;\r\n        \r\n        // Phase indicator background\r\n        this.ctx.fillStyle = 'rgba(26, 26, 46, 0.9)';\r\n        this.ctx.fillRect(phaseX, phaseY, 180, 120);\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeRect(phaseX, phaseY, 180, 120);\r\n        \r\n        // Phase title\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('Current Phase:', phaseX + 15, phaseY + 25);\r\n        \r\n        // Phase description\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        \r\n        let phaseText = '';\r\n        let phaseColor = '#4ECDC4';\r\n        let phaseDescription = '';\r\n        \r\n        switch (this.animationPhase) {\r\n            case 'forward':\r\n                phaseText = 'Forward Pass';\r\n                phaseColor = '#4ECDC4';\r\n                phaseDescription = 'Processing input → output';\r\n                break;\r\n            case 'backward':\r\n                phaseText = 'Backward Pass';\r\n                phaseColor = '#E74C3C';\r\n                phaseDescription = 'Calculating error gradients';\r\n                break;\r\n            case 'update':\r\n                phaseText = 'Weight Update';\r\n                phaseColor = '#F39C12';\r\n                phaseDescription = 'Adjusting connections';\r\n                break;\r\n            case 'pause':\r\n                phaseText = 'Pause';\r\n                phaseColor = '#95A5A6';\r\n                phaseDescription = 'Preparing next example';\r\n                break;\r\n        }\r\n        \r\n        this.ctx.fillStyle = phaseColor;\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.fillText(phaseText, phaseX + 15, phaseY + 50);\r\n        \r\n        // Phase description\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.font = '12px Inter';\r\n        this.ctx.fillText(phaseDescription, phaseX + 15, phaseY + 70);\r\n        \r\n        // Progress bar\r\n        const progressBarX = phaseX + 15;\r\n        const progressBarY = phaseY + 90;\r\n        const progressBarWidth = 150;\r\n        const progressBarHeight = 8;\r\n        \r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';\r\n        this.ctx.fillRect(progressBarX, progressBarY, progressBarWidth, progressBarHeight);\r\n        \r\n        let progress = 0;\r\n        if (this.animationPhase === 'forward') {\r\n            progress = this.forwardStep / this.phaseDuration;\r\n        } else if (this.animationPhase === 'backward') {\r\n            progress = this.backwardStep / this.phaseDuration;\r\n        } else if (this.animationPhase === 'update') {\r\n            progress = this.updateStep / this.phaseDuration;\r\n        } else if (this.animationPhase === 'pause') {\r\n            progress = this.pauseTime / this.pauseDuration;\r\n        }\r\n        \r\n        this.ctx.fillStyle = phaseColor;\r\n        this.ctx.fillRect(progressBarX, progressBarY, progressBarWidth * progress, progressBarHeight);\r\n    }\r\n    \r\n    drawTechnicalDetails() {\r\n        const detailsX = this.ctx.canvas.width - 250;\r\n        const detailsY = this.ctx.canvas.height - 140;\r\n        \r\n        // Technical details panel background - much smaller\r\n        this.ctx.fillStyle = 'rgba(26, 26, 46, 0.8)';\r\n        this.ctx.fillRect(detailsX, detailsY, 230, 120);\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.strokeRect(detailsX, detailsY, 230, 120);\r\n        \r\n        // Title\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 12px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('Technical Details:', detailsX + 10, detailsY + 20);\r\n        \r\n        this.ctx.font = '11px Inter';\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        let y = detailsY + 35;\r\n        \r\n        const currentData = this.trainingData[this.currentDataIndex];\r\n        const output = this.neurons[this.neurons.length - 1][0].value;\r\n        const target = currentData.output[0];\r\n        const error = target - output;\r\n        \r\n        // Show only essential calculations based on phase\r\n        switch (this.animationPhase) {\r\n            case 'forward':\r\n                this.ctx.fillText(`Input: [${currentData.input.join(', ')}] → Output: [${output.toFixed(3)}]`, detailsX + 10, y);\r\n                y += 15;\r\n                \r\n                this.ctx.fillStyle = '#4ECDC4';\r\n                this.ctx.fillText('Forward:', detailsX + 10, y);\r\n                y += 12;\r\n                this.ctx.fillStyle = '#FFFFFF';\r\n                this.ctx.fillText(`z = Σ(w×x) + b`, detailsX + 10, y);\r\n                y += 12;\r\n                this.ctx.fillText(`a = σ(z)`, detailsX + 10, y);\r\n                break;\r\n                \r\n            case 'backward':\r\n                this.ctx.fillText(`Error: ${error.toFixed(3)}`, detailsX + 10, y);\r\n                y += 12;\r\n                this.ctx.fillText(`Output: [${output.toFixed(3)}]`, detailsX + 10, y);\r\n                y += 15;\r\n                \r\n                this.ctx.fillStyle = '#E74C3C';\r\n                this.ctx.fillText('Backward:', detailsX + 10, y);\r\n                y += 12;\r\n                this.ctx.fillStyle = '#FFFFFF';\r\n                this.ctx.fillText(`δ = error × σ'(output)`, detailsX + 10, y);\r\n                y += 12;\r\n                this.ctx.fillText(`δ = ${(error * this.sigmoidDerivative(output)).toFixed(3)}`, detailsX + 10, y);\r\n                break;\r\n                \r\n            case 'update':\r\n                this.ctx.fillText(`Learning Rate: ${this.learningRate}`, detailsX + 10, y);\r\n                y += 12;\r\n                this.ctx.fillText(`Error: ${error.toFixed(3)}`, detailsX + 10, y);\r\n                y += 15;\r\n                \r\n                this.ctx.fillStyle = '#F39C12';\r\n                this.ctx.fillText('Update:', detailsX + 10, y);\r\n                y += 12;\r\n                this.ctx.fillStyle = '#FFFFFF';\r\n                this.ctx.fillText(`Δw = α × δ × input`, detailsX + 10, y);\r\n                y += 12;\r\n                this.ctx.fillText(`w = w + Δw`, detailsX + 10, y);\r\n                break;\r\n                \r\n            case 'pause':\r\n                this.ctx.fillText(`Epoch: ${this.epoch}`, detailsX + 10, y);\r\n                y += 12;\r\n                this.ctx.fillText(`Loss: ${this.currentLoss.toFixed(4)}`, detailsX + 10, y);\r\n                y += 12;\r\n                this.ctx.fillText(`Accuracy: ${(this.currentAccuracy * 100).toFixed(1)}%`, detailsX + 10, y);\r\n                y += 15;\r\n                \r\n                this.ctx.fillStyle = '#95A5A6';\r\n                this.ctx.fillText('Preparing next example...', detailsX + 10, y);\r\n                break;\r\n        }\r\n    }\r\n    \r\n    drawTrainingInfo() {\r\n        const infoX = 20;\r\n        const infoY = 20;\r\n        \r\n        // Compact info panel background\r\n        this.ctx.fillStyle = 'rgba(26, 26, 46, 0.9)';\r\n        this.ctx.fillRect(infoX, infoY, 280, 120);\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeRect(infoX, infoY, 280, 120);\r\n        \r\n        // Title\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('Training Status', infoX + 15, infoY + 25);\r\n        \r\n        // Key metrics only\r\n        this.ctx.font = '13px Inter';\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        let y = infoY + 45;\r\n        \r\n        this.ctx.fillText(`Epoch: ${this.epoch} | Loss: ${this.currentLoss.toFixed(4)}`, infoX + 15, y);\r\n        y += 18;\r\n        this.ctx.fillText(`Accuracy: ${(this.currentAccuracy * 100).toFixed(1)}% | LR: ${this.learningRate}`, infoX + 15, y);\r\n        y += 25;\r\n        \r\n        // Current example - simplified\r\n        const currentData = this.trainingData[this.currentDataIndex];\r\n        this.ctx.fillStyle = '#FFD700';\r\n        this.ctx.font = 'bold 13px Inter';\r\n        this.ctx.fillText(`${currentData.object.toUpperCase()}: [${currentData.input.join(', ')}]`, infoX + 15, y);\r\n        y += 18;\r\n        \r\n        const output = this.neurons[this.neurons.length - 1][0].value;\r\n        const predicted = output > 0.5 ? 1 : 0;\r\n        const isCorrect = predicted === currentData.output[0];\r\n        this.ctx.fillStyle = isCorrect ? '#2ECC71' : '#E74C3C';\r\n        this.ctx.fillText(`→ ${predicted === 1 ? 'COMPLEX' : 'SIMPLE'} (${isCorrect ? '✓' : '✗'}) [${output.toFixed(3)}]`, infoX + 15, y);\r\n    }\r\n    \r\n    drawNetworkLabels() {\r\n        // Draw elegant labels on the canvas\r\n        this.ctx.save();\r\n        \r\n        // Set up text styling\r\n        this.ctx.font = 'bold 18px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.textAlign = 'center';\r\n        \r\n        // Draw animation type label\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\r\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n        this.ctx.shadowBlur = 2;\r\n        this.ctx.fillText('Neural Network Training', this.ctx.canvas.width / 2, 30);\r\n        \r\n        // Draw mathematical formulas\r\n        this.ctx.font = '14px Inter';\r\n        this.ctx.textRenderingOptimization = 'optimizeLegibility';\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';\r\n        this.ctx.fillText(`σ(x) = 1/(1 + e^(-x))`, \r\n                          this.ctx.canvas.width / 2, 50);\r\n        \r\n        // Draw backpropagation\r\n        this.ctx.fillText(`δ = (target - output) × σ'(output)`, \r\n                          this.ctx.canvas.width / 2, 70);\r\n        \r\n        // Draw weight update\r\n        this.ctx.fillText(`w = w + α × δ × input`, \r\n                          this.ctx.canvas.width / 2, 90);\r\n        \r\n        // Reset shadow\r\n        this.ctx.shadowBlur = 0;\r\n        this.ctx.restore();\r\n    }\r\n    \r\n    handleCanvasClick(x, y) {\r\n        if (!this.isTestingMode) return;\r\n        \r\n        // Check if click is in the object selection area\r\n        const startX = this.ctx.canvas.width - 80;\r\n        const startY = this.ctx.canvas.height / 2 - 120;\r\n        \r\n        // Calculate which object was clicked (vertical layout)\r\n        const objects = ['circle', 'square', 'triangle', 'star'];\r\n        \r\n        for (let i = 0; i < objects.length; i++) {\r\n            const objX = startX;\r\n            const objY = startY + i * 90;\r\n            \r\n            // Use a larger click area to make it easier to click\r\n            const clickRadius = 30;\r\n            \r\n            if (x >= objX - clickRadius && x <= objX + clickRadius && \r\n                y >= objY - clickRadius && y <= objY + clickRadius) {\r\n                this.selectTestObject(objects[i]);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    \r\n    getStats() {\r\n        return {\r\n            epoch: this.epoch,\r\n            currentLoss: this.currentLoss,\r\n            currentAccuracy: this.currentAccuracy,\r\n            learningRate: this.learningRate,\r\n            speed: this.speed,\r\n            trainingDataIndex: this.currentDataIndex,\r\n            animationPhase: this.animationPhase,\r\n            isTestingMode: this.isTestingMode,\r\n            testingPhase: this.testingPhase\r\n        };\r\n    }\r\n\r\n    render() {\r\n        // Draw modern gradient background\r\n        const gradient = this.ctx.createLinearGradient(0, 0, 0, this.ctx.canvas.height);\r\n        gradient.addColorStop(0, '#1a1a2e');\r\n        gradient.addColorStop(1, '#16213e');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n        \r\n        // Draw network architecture\r\n        this.drawNetwork();\r\n        \r\n        // Draw data flow particles\r\n        this.drawDataFlowParticles();\r\n        \r\n        // Draw testing particles\r\n        if (this.isTestingMode) {\r\n            this.drawTestingParticles();\r\n        }\r\n        \r\n        // Draw training information\r\n        if (this.showLoss && !this.isTestingMode) {\r\n            this.drawTrainingInfo();\r\n        }\r\n        \r\n        // Draw testing information\r\n        if (this.isTestingMode) {\r\n            this.drawTestingInfo();\r\n        }\r\n        \r\n        // Draw phase indicator\r\n        this.drawPhaseIndicator();\r\n        \r\n        // Draw technical details\r\n        this.drawTechnicalDetails();\r\n        \r\n        // Draw canvas labels\r\n        this.drawNetworkLabels();\r\n        \r\n        // Draw object selection interface\r\n        if (this.isTestingMode) {\r\n            this.drawObjectSelectionInterface();\r\n        }\r\n        \r\n        // Draw training indicator\r\n        if (this.showTrainingIndicator) {\r\n            this.drawTrainingIndicator();\r\n        }\r\n    }\r\n    \r\n    drawObjectContext() {\r\n        const objectX = 20;\r\n        const objectY = this.ctx.canvas.height - 100;\r\n        \r\n        // Object context panel background - smaller\r\n        this.ctx.fillStyle = 'rgba(26, 26, 46, 0.9)';\r\n        this.ctx.fillRect(objectX, objectY, 250, 80);\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeRect(objectX, objectY, 250, 80);\r\n        \r\n        // Title and object name combined\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 14px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('Training Object:', objectX + 15, objectY + 25);\r\n        \r\n        // Object name\r\n        this.ctx.fillStyle = '#FFD700';\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.fillText(this.currentObject.object.toUpperCase(), objectX + 15, objectY + 45);\r\n        \r\n        // Object description - shorter\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.font = '11px Inter';\r\n        this.ctx.fillText(this.currentObject.description, objectX + 15, objectY + 65);\r\n        \r\n        // Draw simple object representation\r\n        this.drawObjectRepresentation(objectX + 200, objectY + 40);\r\n    }\r\n    \r\n    drawObjectRepresentation(x, y, objectType = null) {\r\n        this.ctx.save();\r\n        \r\n        // Use provided objectType or fall back to currentObject.object\r\n        const objType = objectType || (this.currentObject ? this.currentObject.object : null);\r\n        \r\n        if (!objType) {\r\n            this.ctx.restore();\r\n            return;\r\n        }\r\n        \r\n        switch (objType) {\r\n            case 'circle':\r\n                this.ctx.beginPath();\r\n                this.ctx.fillStyle = '#4ECDC4';\r\n                this.ctx.arc(x, y, 20, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n                break;\r\n                \r\n            case 'square':\r\n                this.ctx.fillStyle = '#FF6B6B';\r\n                this.ctx.fillRect(x - 15, y - 15, 30, 30);\r\n                break;\r\n                \r\n            case 'triangle':\r\n                this.ctx.beginPath();\r\n                this.ctx.fillStyle = '#2ECC71';\r\n                this.ctx.moveTo(x, y - 15);\r\n                this.ctx.lineTo(x - 15, y + 15);\r\n                this.ctx.lineTo(x + 15, y + 15);\r\n                this.ctx.closePath();\r\n                this.ctx.fill();\r\n                break;\r\n                \r\n            case 'star':\r\n                this.ctx.beginPath();\r\n                this.ctx.fillStyle = '#F39C12';\r\n                for (let i = 0; i < 5; i++) {\r\n                    const angle = (i * 2 * Math.PI) / 5 - Math.PI / 2;\r\n                    const outerRadius = 20;\r\n                    const innerRadius = 10;\r\n                    \r\n                    const x1 = x + Math.cos(angle) * outerRadius;\r\n                    const y1 = y + Math.sin(angle) * outerRadius;\r\n                    const x2 = x + Math.cos(angle + Math.PI / 5) * innerRadius;\r\n                    const y2 = y + Math.sin(angle + Math.PI / 5) * innerRadius;\r\n                    \r\n                    if (i === 0) {\r\n                        this.ctx.moveTo(x1, y1);\r\n                    } else {\r\n                        this.ctx.lineTo(x1, y1);\r\n                    }\r\n                    this.ctx.lineTo(x2, y2);\r\n                }\r\n                this.ctx.closePath();\r\n                this.ctx.fill();\r\n                break;\r\n        }\r\n        \r\n        this.ctx.restore();\r\n    }\r\n    \r\n    drawNetwork() {\r\n        // Draw connections (weights)\r\n        if (this.showWeights) {\r\n            this.drawConnections();\r\n        }\r\n        \r\n        // Draw neurons\r\n        this.drawNeurons();\r\n        \r\n        // Draw gradients if enabled\r\n        if (this.showGradients) {\r\n            this.drawGradients();\r\n        }\r\n    }\r\n    \r\n    drawTestingInfo() {\r\n        const infoX = 20;\r\n        const infoY = this.ctx.canvas.height - 180;\r\n        \r\n        // Testing info panel background\r\n        this.ctx.fillStyle = 'rgba(26, 26, 46, 0.9)';\r\n        this.ctx.fillRect(infoX, infoY, 300, 160);\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeRect(infoX, infoY, 300, 160);\r\n        \r\n        // Title\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('Network Testing Mode', infoX + 15, infoY + 25);\r\n        \r\n        this.ctx.font = '13px Inter';\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        let y = infoY + 45;\r\n        \r\n        // Check if training is complete\r\n        if (!this.isTrainingComplete) {\r\n            this.ctx.fillStyle = '#FFD700';\r\n            this.ctx.fillText('Training in Progress...', infoX + 15, y);\r\n            y += 18;\r\n            this.ctx.fillStyle = '#FFFFFF';\r\n            this.ctx.fillText('Please wait for training', infoX + 15, y);\r\n            y += 18;\r\n            this.ctx.fillText('to complete before', infoX + 15, y);\r\n            y += 18;\r\n            this.ctx.fillText('testing the network', infoX + 15, y);\r\n            y += 15;\r\n            \r\n            // Show training progress\r\n            this.ctx.fillStyle = '#4ECDC4';\r\n            this.ctx.font = 'bold 11px Inter';\r\n            this.ctx.fillText('Training the neural network...', infoX + 15, y);\r\n            return;\r\n        }\r\n        \r\n        if (this.testingPhase === 'select') {\r\n            this.ctx.fillText('Object Recognition Testing', infoX + 15, y);\r\n            y += 18;\r\n            this.ctx.fillText('Click on an object to test', infoX + 15, y);\r\n            y += 18;\r\n            this.ctx.fillText('the neural network\\'s', infoX + 15, y);\r\n            y += 18;\r\n            this.ctx.fillText('classification ability', infoX + 15, y);\r\n            y += 15;\r\n            \r\n            // Feature legend for testing\r\n            this.ctx.fillStyle = '#4ECDC4';\r\n            this.ctx.font = 'bold 11px Inter';\r\n            this.ctx.fillText('Features: [symmetry, edges]', infoX + 15, y);\r\n            y += 12;\r\n            this.ctx.font = '10px Inter';\r\n            this.ctx.fillStyle = '#FFFFFF';\r\n            this.ctx.fillText('• Symmetry: 0-1 (high = simple)', infoX + 15, y);\r\n            y += 10;\r\n            this.ctx.fillText('• Edges: 0-1 (high = complex)', infoX + 15, y);\r\n        } else if (this.testingPhase === 'processing') {\r\n            this.ctx.fillText('Analyzing Object...', infoX + 15, y);\r\n            y += 18;\r\n            this.ctx.fillText('Network is processing', infoX + 15, y);\r\n            y += 18;\r\n            this.ctx.fillText('input features and', infoX + 15, y);\r\n            y += 18;\r\n            this.ctx.fillText('generating prediction', infoX + 15, y);\r\n        } else if (this.testingPhase === 'result') {\r\n            // Use the stored test result\r\n            if (this.lastTestResult) {\r\n                const { object, predicted, confidence, isCorrect, output } = this.lastTestResult;\r\n                \r\n                this.ctx.fillText('Test Results:', infoX + 15, y);\r\n                y += 18;\r\n                this.ctx.fillStyle = '#FFD700';\r\n                this.ctx.fillText(`${object.toUpperCase()} → ${predicted === 1 ? 'COMPLEX' : 'SIMPLE'}`, infoX + 15, y);\r\n                y += 18;\r\n                this.ctx.fillStyle = '#FFFFFF';\r\n                this.ctx.fillText(`Output: ${output.toFixed(3)} | Confidence: ${confidence.toFixed(1)}%`, infoX + 15, y);\r\n                y += 18;\r\n                this.ctx.fillStyle = isCorrect ? '#2ECC71' : '#E74C3C';\r\n                this.ctx.fillText(`${isCorrect ? '✓ CORRECT' : '✗ INCORRECT'}`, infoX + 15, y);\r\n                y += 18;\r\n                this.ctx.fillStyle = '#FFFFFF';\r\n                this.ctx.fillText('Click another object to test', infoX + 15, y);\r\n                \r\n                // Draw test results summary\r\n                this.drawTestResultsSummary(infoX + 320, infoY, 200, 160);\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawObjectSelectionInterface() {\r\n        // Position all the way to the right, vertically centered\r\n        const startX = this.ctx.canvas.width - 80;\r\n        const startY = this.ctx.canvas.height / 2 - 120;\r\n        \r\n        // Draw object buttons in a vertical layout\r\n        const objects = ['circle', 'square', 'triangle', 'star'];\r\n        const buttonSize = 50;\r\n        \r\n        // Check if training is complete\r\n        const isTrainingComplete = this.isTrainingComplete;\r\n        \r\n        for (let i = 0; i < objects.length; i++) {\r\n            const x = startX;\r\n            const y = startY + i * 90;\r\n            const objectType = objects[i];\r\n            \r\n            // Check if this object is currently selected\r\n            const isSelected = this.selectedTestObject && this.selectedTestObject.object === objectType;\r\n            \r\n            // Button background with selection highlighting\r\n            if (isSelected) {\r\n                this.ctx.fillStyle = 'rgba(255, 215, 0, 0.3)'; // Gold background for selected\r\n                this.ctx.strokeStyle = '#FFD700';\r\n                this.ctx.lineWidth = 3;\r\n            } else if (!isTrainingComplete) {\r\n                // Disabled appearance when training is not complete\r\n                this.ctx.fillStyle = 'rgba(128, 128, 128, 0.1)';\r\n                this.ctx.strokeStyle = '#666666';\r\n                this.ctx.lineWidth = 1;\r\n            } else {\r\n                this.ctx.fillStyle = 'rgba(78, 205, 196, 0.15)';\r\n                this.ctx.strokeStyle = '#4ECDC4';\r\n                this.ctx.lineWidth = 2;\r\n            }\r\n            \r\n            this.ctx.fillRect(x - 25, y - 25, buttonSize, buttonSize);\r\n            this.ctx.strokeRect(x - 25, y - 25, buttonSize, buttonSize);\r\n            \r\n            // Draw object with reduced opacity if training not complete\r\n            if (!isTrainingComplete) {\r\n                this.ctx.globalAlpha = 0.3;\r\n            }\r\n            this.drawObjectRepresentation(x, y, objectType);\r\n            this.ctx.globalAlpha = 1.0;\r\n            \r\n            // Object name with selection highlighting\r\n            if (isSelected) {\r\n                this.ctx.fillStyle = '#FFD700';\r\n                this.ctx.font = 'bold 12px Inter';\r\n            } else if (!isTrainingComplete) {\r\n                this.ctx.fillStyle = '#666666';\r\n                this.ctx.font = 'bold 11px Inter';\r\n            } else {\r\n                this.ctx.fillStyle = '#FFFFFF';\r\n                this.ctx.font = 'bold 11px Inter';\r\n            }\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.fillText(objectType.toUpperCase(), x, y + 35);\r\n        }\r\n    }\r\n    \r\n    drawSparklineChart(x, y, width, height) {\r\n        if (this.lossHistory.length < 2) return;\r\n        \r\n        // Chart background\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';\r\n        this.ctx.fillRect(x, y, width, height);\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.strokeRect(x, y, width, height);\r\n        \r\n        // Find min/max for scaling\r\n        const lossData = this.lossHistory.slice(-20); // Last 20 points\r\n        const accuracyData = this.accuracyHistory.slice(-20);\r\n        \r\n        if (lossData.length < 2) return;\r\n        \r\n        const maxLoss = Math.max(...lossData);\r\n        const minLoss = Math.min(...lossData);\r\n        const maxAcc = Math.max(...accuracyData);\r\n        const minAcc = Math.min(...accuracyData);\r\n        \r\n        // Draw loss line (red)\r\n        this.ctx.beginPath();\r\n        this.ctx.strokeStyle = '#e74c3c'; // Red\r\n        this.ctx.lineWidth = 2;\r\n        \r\n        for (let i = 0; i < lossData.length; i++) {\r\n            const chartX = x + (i / (lossData.length - 1)) * width;\r\n            const normalizedLoss = (lossData[i] - minLoss) / (maxLoss - minLoss);\r\n            const chartY = y + height - normalizedLoss * height;\r\n            \r\n            if (i === 0) {\r\n                this.ctx.moveTo(chartX, chartY);\r\n            } else {\r\n                this.ctx.lineTo(chartX, chartY);\r\n            }\r\n        }\r\n        this.ctx.stroke();\r\n        \r\n        // Draw accuracy line (green)\r\n        this.ctx.beginPath();\r\n        this.ctx.strokeStyle = '#27ae60'; // Dark green for better contrast\r\n        this.ctx.lineWidth = 2;\r\n        \r\n        for (let i = 0; i < accuracyData.length; i++) {\r\n            const chartX = x + (i / (accuracyData.length - 1)) * width;\r\n            const normalizedAcc = (accuracyData[i] - minAcc) / (maxAcc - minAcc);\r\n            const chartY = y + height - normalizedAcc * height;\r\n            \r\n            if (i === 0) {\r\n                this.ctx.moveTo(chartX, chartY);\r\n            } else {\r\n                this.ctx.lineTo(chartX, chartY);\r\n            }\r\n        }\r\n        this.ctx.stroke();\r\n        \r\n        // Chart labels\r\n        this.ctx.fillStyle = '#e74c3c'; // Red for loss\r\n        this.ctx.font = 'bold 10px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('Loss', x + 5, y + 12);\r\n        this.ctx.fillStyle = '#27ae60'; // Green for accuracy\r\n        this.ctx.fillText('Accuracy', x + 5, y + 25);\r\n    }\r\n    \r\n    drawTestResultsSummary(x, y, width, height) {\r\n        if (this.testResults.length === 0) return;\r\n        \r\n        // Summary panel background\r\n        this.ctx.fillStyle = 'rgba(26, 26, 46, 0.9)';\r\n        this.ctx.fillRect(x, y, width, height);\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeRect(x, y, width, height);\r\n        \r\n        // Title\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 14px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('Test History:', x + 10, y + 20);\r\n        \r\n        // Calculate summary stats\r\n        const totalTests = this.testResults.length;\r\n        const correctTests = this.testResults.filter(r => r.isCorrect).length;\r\n        const accuracy = totalTests > 0 ? (correctTests / totalTests * 100).toFixed(1) : '0.0';\r\n        \r\n        this.ctx.font = '12px Inter';\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.fillText(`Total: ${totalTests} | Correct: ${correctTests}`, x + 10, y + 40);\r\n        this.ctx.fillText(`Accuracy: ${accuracy}%`, x + 10, y + 55);\r\n        \r\n        // Recent results (last 5)\r\n        const recentResults = this.testResults.slice(-5);\r\n        let resultY = y + 75;\r\n        \r\n        this.ctx.font = 'bold 11px Inter';\r\n        this.ctx.fillText('Recent:', x + 10, resultY);\r\n        resultY += 15;\r\n        \r\n        this.ctx.font = '10px Inter';\r\n        for (const result of recentResults) {\r\n            const status = result.isCorrect ? '✓' : '✗';\r\n            const color = result.isCorrect ? '#2ECC71' : '#E74C3C';\r\n            \r\n            this.ctx.fillStyle = color;\r\n            this.ctx.fillText(`${result.object.toUpperCase()}: ${result.predicted === 1 ? 'COMPLEX' : 'SIMPLE'} ${status}`, x + 10, resultY);\r\n            resultY += 12;\r\n        }\r\n    }\r\n    \r\n    drawTestingParticles() {\r\n        // Draw testing particles with different color\r\n        for (const particle of this.testingParticles) {\r\n            const x = particle.x + (particle.targetX - particle.x) * particle.progress;\r\n            const y = particle.y + (particle.targetY - particle.y) * particle.progress;\r\n            \r\n            this.ctx.beginPath();\r\n            this.ctx.fillStyle = `rgba(255, 215, 0, ${1 - particle.progress})`;\r\n            this.ctx.arc(x, y, particle.size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n    \r\n    drawTrainingIndicator() {\r\n        const centerX = this.ctx.canvas.width / 2;\r\n        const centerY = this.ctx.canvas.height / 2;\r\n        \r\n        // Semi-transparent overlay\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';\r\n        this.ctx.fillRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n        \r\n        // Training indicator panel\r\n        const panelWidth = 500;\r\n        const panelHeight = 200;\r\n        const panelX = centerX - panelWidth / 2;\r\n        const panelY = centerY - panelHeight / 2;\r\n        \r\n        // Panel background\r\n        this.ctx.fillStyle = 'rgba(26, 26, 46, 0.95)';\r\n        this.ctx.fillRect(panelX, panelY, panelWidth, panelHeight);\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 3;\r\n        this.ctx.strokeRect(panelX, panelY, panelWidth, panelHeight);\r\n        \r\n        // Title\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 20px Inter';\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.fillText('Initializing Neural Network', centerX, panelY + 35);\r\n        \r\n        // Current training object\r\n        const currentTrainingObject = this.trainingData[this.trainingIndicatorObjectIndex];\r\n        this.ctx.fillStyle = '#FFD700';\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.fillText(`Training on: ${currentTrainingObject.object.toUpperCase()}`, centerX, panelY + 60);\r\n        \r\n        // Object description\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.font = '13px Inter';\r\n        this.ctx.fillText(currentTrainingObject.description, centerX, panelY + 85);\r\n        \r\n        // Features\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = '12px Inter';\r\n        this.ctx.fillText(`Features: [${currentTrainingObject.input[0].toFixed(1)}, ${currentTrainingObject.input[1].toFixed(1)}]`, centerX, panelY + 105);\r\n        \r\n        // Expected output\r\n        this.ctx.fillStyle = '#FF6B6B';\r\n        this.ctx.fillText(`Expected: ${currentTrainingObject.output[0] === 0 ? 'Simple' : 'Complex'}`, centerX, panelY + 125);\r\n        \r\n        // Draw the current training object\r\n        this.drawObjectRepresentation(centerX + 180, panelY + 80, currentTrainingObject.object);\r\n        \r\n        // Progress indicator\r\n        const progress = this.trainingIndicatorTime / this.trainingIndicatorDuration;\r\n        const progressWidth = 400;\r\n        const progressHeight = 8;\r\n        const progressX = centerX - progressWidth / 2;\r\n        const progressY = panelY + 150;\r\n        \r\n        // Progress background\r\n        this.ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';\r\n        this.ctx.fillRect(progressX, progressY, progressWidth, progressHeight);\r\n        \r\n        // Progress bar\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.fillRect(progressX, progressY, progressWidth * progress, progressHeight);\r\n        \r\n        // Progress text\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.font = '12px Inter';\r\n        this.ctx.fillText(`${Math.round(progress * 100)}%`, centerX, progressY + 25);\r\n    }\r\n}\r\n\r\n// Memory Management with Detailed Memory Visualization\r\nexport class MemoryManagement {\r\n    constructor(ctx) {\r\n        this.ctx = ctx;\r\n        this.canvas = ctx.canvas;\r\n        \r\n        // Code execution layout\r\n        this.codePanel = { x: 50, y: 50, width: 400, height: 300 };\r\n        this.stackPanel = { x: 500, y: 50, width: 300, height: 300 };\r\n        this.heapPanel = { x: 50, y: 400, width: 750, height: 200 };\r\n        this.outputPanel = { x: 500, y: 400, width: 300, height: 200 };\r\n        \r\n        // Sample program with real code\r\n        this.program = {\r\n            name: \"Image Processing Pipeline\",\r\n            functions: [\r\n                {\r\n                    name: \"main()\",\r\n                    lines: [\r\n                        \"function main() {\",\r\n                        \"  let imageData = loadImage('photo.jpg');\",\r\n                        \"  let processedData = processImage(imageData);\",\r\n                        \"  saveResult(processedData);\",\r\n                        \"  return 0;\",\r\n                        \"}\"\r\n                    ],\r\n                    variables: []\r\n                },\r\n                {\r\n                    name: \"loadImage()\",\r\n                    lines: [\r\n                        \"function loadImage(filename) {\",\r\n                        \"  let fileBuffer = malloc(1024);\",\r\n                        \"  readFile(filename, fileBuffer);\",\r\n                        \"  let imageData = malloc(2048);\",\r\n                        \"  decodeImage(fileBuffer, imageData);\",\r\n                        \"  free(fileBuffer);\",\r\n                        \"  return imageData;\",\r\n                        \"}\"\r\n                    ],\r\n                    variables: []\r\n                },\r\n                {\r\n                    name: \"processImage()\",\r\n                    lines: [\r\n                        \"function processImage(data) {\",\r\n                        \"  let tempBuffer = malloc(2048);\",\r\n                        \"  applyFilter(data, tempBuffer);\",\r\n                        \"  let result = malloc(2048);\",\r\n                        \"  compressImage(tempBuffer, result);\",\r\n                        \"  free(tempBuffer);\",\r\n                        \"  return result;\",\r\n                        \"}\"\r\n                    ],\r\n                    variables: []\r\n                },\r\n                {\r\n                    name: \"saveResult()\",\r\n                    lines: [\r\n                        \"function saveResult(data) {\",\r\n                        \"  let outputFile = malloc(512);\",\r\n                        \"  writeFile('output.jpg', data);\",\r\n                        \"  free(outputFile);\",\r\n                        \"  free(data);\",\r\n                        \"  return;\",\r\n                        \"}\"\r\n                    ],\r\n                    variables: []\r\n                },\r\n                {\r\n                    name: \"readFile()\",\r\n                    lines: [\r\n                        \"function readFile(filename, buffer) {\",\r\n                        \"  // Simulate file reading\",\r\n                        \"  return buffer;\",\r\n                        \"}\"\r\n                    ],\r\n                    variables: []\r\n                },\r\n                {\r\n                    name: \"decodeImage()\",\r\n                    lines: [\r\n                        \"function decodeImage(buffer, imageData) {\",\r\n                        \"  // Simulate image decoding\",\r\n                        \"  return imageData;\",\r\n                        \"}\"\r\n                    ],\r\n                    variables: []\r\n                },\r\n                {\r\n                    name: \"writeFile()\",\r\n                    lines: [\r\n                        \"function writeFile(filename, data) {\",\r\n                        \"  // Simulate file writing\",\r\n                        \"  return true;\",\r\n                        \"}\"\r\n                    ],\r\n                    variables: []\r\n                },\r\n                {\r\n                    name: \"applyFilter()\",\r\n                    lines: [\r\n                        \"function applyFilter(data, tempBuffer) {\",\r\n                        \"  // Simulate filter application\",\r\n                        \"  return tempBuffer;\",\r\n                        \"}\"\r\n                    ],\r\n                    variables: []\r\n                },\r\n                {\r\n                    name: \"compressImage()\",\r\n                    lines: [\r\n                        \"function compressImage(tempBuffer, result) {\",\r\n                        \"  // Simulate image compression\",\r\n                        \"  return result;\",\r\n                        \"}\"\r\n                    ],\r\n                    variables: []\r\n                }\r\n            ]\r\n        };\r\n        \r\n        // Execution state\r\n        this.currentFunction = 0;\r\n        this.currentLine = 0;\r\n        this.executionStep = 0;\r\n        this.programCounter = 0;\r\n        this.callStack = [];\r\n        this.heapBlocks = [];\r\n        this.freeBlocks = [];\r\n        this.output = [];\r\n        \r\n        // Memory addresses and data\r\n        this.nextHeapAddress = 0x1000;\r\n        this.nextStackAddress = 0x2000;\r\n        this.memoryData = new Map(); // Maps addresses to actual data\r\n        this.variableAddresses = new Map(); // Maps variable names to addresses\r\n        \r\n        // Animation state\r\n        this.animationState = 'idle'; // idle, executing, allocating, accessing, deallocating, calling, returning\r\n        this.animationTime = 0;\r\n        this.executionSpeed = 1.0;\r\n        this.isAutoRunning = true;\r\n        \r\n        // Speed control\r\n        this.animationSpeed = 1.0; // 0.1 to 3.0\r\n        \r\n        // Visual effects\r\n        this.highlightedLine = -1;\r\n        this.executionPointer = { x: 0, y: 0 };\r\n        this.particles = [];\r\n        this.memoryAccesses = [];\r\n        this.dataFlowParticles = [];\r\n        this.addressHighlights = [];\r\n        this.allocationEffects = [];\r\n        this.deallocationEffects = [];\r\n        \r\n        // Enhanced visual effects\r\n        this.memoryFlowLines = []; // Lines showing data flow between memory blocks\r\n        this.stackFrameAnimations = []; // Stack frame creation/removal animations\r\n        this.variableConnections = []; // Lines connecting variables to their memory addresses\r\n        this.executionTrail = []; // Trail showing execution path\r\n        this.memoryFragmentation = []; // Visual representation of memory fragmentation\r\n        this.performanceMetrics = {\r\n            totalCycles: 0,\r\n            memoryEfficiency: 0,\r\n            fragmentationLevel: 0,\r\n            averageAccessTime: 0\r\n        };\r\n        \r\n        // Statistics\r\n        this.totalAllocations = 0;\r\n        this.totalDeallocations = 0;\r\n        this.memoryLeaks = 0;\r\n        this.currentMemoryUsage = 0;\r\n        this.memoryAccessCount = 0;\r\n        \r\n        // UI state\r\n        this.showStats = false; // Hidden by default\r\n        this.showOutput = false; // Hidden by default\r\n        \r\n        // Garbage Collection state\r\n        this.gcState = {\r\n            isRunning: false,\r\n            phase: 'idle', // 'idle', 'mark', 'sweep'\r\n            markedBlocks: new Set(),\r\n            gcParticles: [],\r\n            phaseTime: 0,\r\n            phaseDuration: 2.0\r\n        };\r\n        \r\n        this.initializeExecution();\r\n        this.startExecution();\r\n        \r\n        // Force start execution after a short delay to ensure everything is initialized\r\n        setTimeout(() => {\r\n            if (this.isAutoRunning && this.animationState === 'idle') {\r\n                this.executeNextStep();\r\n            }\r\n        }, 500);\r\n    }\r\n    \r\n    initializeExecution() {\r\n        // Initialize heap with free blocks\r\n        this.heapBlocks = [];\r\n        this.freeBlocks = [{\r\n            address: 0x1000,\r\n            size: 8192,\r\n            x: this.heapPanel.x + 20,\r\n            y: this.heapPanel.y + 20,\r\n            width: this.heapPanel.width - 40,\r\n            height: 40\r\n        }];\r\n        \r\n        // Initialize call stack (empty)\r\n        this.callStack = [];\r\n        \r\n        // Initialize output\r\n        this.output = [];\r\n        \r\n        // Clear memory data\r\n        this.memoryData.clear();\r\n        this.variableAddresses.clear();\r\n        \r\n        // Reset execution state\r\n        this.currentFunction = 0;\r\n        this.currentLine = 0;\r\n        this.executionStep = 0;\r\n        this.programCounter = 0;\r\n        this.highlightedLine = -1;\r\n    }\r\n    \r\n    startExecution() {\r\n        this.isAutoRunning = true;\r\n        this.animationState = 'idle';\r\n        this.executionStep = 0;\r\n        \r\n        // Force start the execution immediately\r\n        setTimeout(() => {\r\n            if (this.isAutoRunning && this.animationState === 'idle') {\r\n                this.executeNextStep();\r\n            }\r\n        }, 1000);\r\n    }\r\n    \r\n    setAnimationSpeed(speed) {\r\n        this.animationSpeed = Math.max(0.1, Math.min(3.0, speed));\r\n    }\r\n    \r\n    setShowStats(show) {\r\n        this.showStats = show;\r\n    }\r\n    \r\n    setShowOutput(show) {\r\n        this.showOutput = show;\r\n    }\r\n    \r\n    executeNextStep() {\r\n        if (this.animationState !== 'idle') return;\r\n        \r\n        // Safety check for valid function index\r\n        if (this.currentFunction < 0 || this.currentFunction >= this.program.functions.length) {\r\n            this.output.push(`❌ Invalid function index: ${this.currentFunction}`);\r\n            return;\r\n        }\r\n        \r\n        const currentFunc = this.program.functions[this.currentFunction];\r\n        \r\n        // Safety check for valid line index\r\n        if (this.currentLine < 0 || this.currentLine >= currentFunc.lines.length) {\r\n            this.output.push(`❌ Invalid line index: ${this.currentLine}`);\r\n            return;\r\n        }\r\n        \r\n        const line = currentFunc.lines[this.currentLine];\r\n        \r\n        if (!line) {\r\n            // Function finished, return to caller\r\n            this.output.push(`🔚 Function ${this.program.functions[this.currentFunction].name} finished`);\r\n            this.returnFromFunction();\r\n            return;\r\n        }\r\n        \r\n        // Check if we're at the end of the main function and call stack is empty\r\n        if (this.currentFunction === 0 && this.currentLine >= currentFunc.lines.length && this.callStack.length === 0) {\r\n            // We're at the very end of the main function, mark as complete\r\n            this.output.push(`✅ Program execution complete`);\r\n            this.isAutoRunning = false;\r\n            this.animationState = 'idle';\r\n            \r\n            // Add completion celebration particles\r\n            for (let i = 0; i < 50; i++) {\r\n                this.particles.push({\r\n                    x: this.canvas.width / 2,\r\n                    y: this.canvas.height / 2,\r\n                    vx: (Math.random() - 0.5) * 10,\r\n                    vy: (Math.random() - 0.5) * 10,\r\n                    life: 3.0,\r\n                    color: '#FFD700',\r\n                    type: 'completion'\r\n                });\r\n            }\r\n            return;\r\n        }\r\n        \r\n        this.animationState = 'executing';\r\n        this.animationTime = 0;\r\n        this.highlightedLine = this.currentLine; // Show the line that's about to be executed\r\n        \r\n        // Wait a moment to show the line before executing it\r\n        setTimeout(() => {\r\n            // Parse and execute the line\r\n            if (line.trim().startsWith('//') || line.trim().startsWith('/*') || line.trim().startsWith('*')) {\r\n                // Skip comment lines, just move to next line\r\n                this.currentLine++;\r\n            } else if (line.includes('function') && line.includes('{')) {\r\n                // Skip function definitions, just move to next line\r\n                this.currentLine++;\r\n            } else if (line.includes('(') && line.includes(')') && !line.includes('malloc') && !line.includes('free') && !line.includes('function') && !line.trim().startsWith('//')) {\r\n                // This is a function call\r\n                this.callFunction(line);\r\n                // Don't advance line here - wait for function to return\r\n            } else if (line.includes('malloc')) {\r\n                this.allocateMemory(line);\r\n                this.currentLine++;\r\n            } else if (line.includes('free')) {\r\n                this.deallocateMemory(line);\r\n                this.currentLine++;\r\n            } else if (line.includes('return')) {\r\n                this.returnFromFunction();\r\n                // Don't advance line here - returnFromFunction handles it\r\n            } else if (line.includes('readFile') || line.includes('writeFile') || \r\n                       line.includes('decodeImage') || line.includes('applyFilter') || \r\n                       line.includes('compressImage')) {\r\n                this.accessMemory(line);\r\n                this.currentLine++;\r\n            } else {\r\n                // Regular line execution\r\n                this.executeRegularLine(line);\r\n                this.currentLine++;\r\n            }\r\n            \r\n            this.executionStep++;\r\n        \r\n        setTimeout(() => {\r\n            this.animationState = 'idle';\r\n            }, 300 / this.animationSpeed); // Shorter delay after execution\r\n        }, 200 / this.animationSpeed); // Show the line first, then execute\r\n    }\r\n    \r\n    callFunction(line) {\r\n        // Extract function name from line like \"let imageData = loadImage('photo.jpg');\"\r\n        // or \"let processedData = processImage(imageData);\"\r\n        const match = line.match(/(\\w+)\\(/);\r\n        if (match) {\r\n            const funcName = match[1];\r\n            \r\n            // Find the function in the program\r\n            let functionIndex = -1;\r\n            \r\n            // First try exact match with parentheses\r\n            functionIndex = this.program.functions.findIndex(f => f.name === funcName + '()');\r\n            \r\n            // If not found, try without parentheses\r\n            if (functionIndex === -1) {\r\n                functionIndex = this.program.functions.findIndex(f => f.name === funcName);\r\n            }\r\n            \r\n            // If still not found, try removing parentheses from function names\r\n            if (functionIndex === -1) {\r\n                functionIndex = this.program.functions.findIndex(f => f.name.replace('()', '') === funcName);\r\n            }\r\n            \r\n            if (functionIndex !== -1) {\r\n                // Push current function to call stack\r\n                this.callStack.push({\r\n                    functionIndex: this.currentFunction,\r\n                    lineIndex: this.currentLine,\r\n                    returnAddress: this.programCounter,\r\n                    variables: new Map(this.variableAddresses) // Copy current variables\r\n                });\r\n                \r\n                // Switch to called function\r\n                this.currentFunction = functionIndex;\r\n                this.currentLine = 0;\r\n                this.programCounter = functionIndex * 100;\r\n                \r\n                // Highlight the first line of the called function\r\n                this.highlightedLine = 0;\r\n                \r\n                // Add function call to output\r\n                this.output.push(`📞 Calling ${funcName}()`);\r\n                \r\n                // Show stack frame creation\r\n                this.showStackFrameCreation();\r\n            } else {\r\n                this.output.push(`⚠️ Function not found: ${funcName}`);\r\n            }\r\n        }\r\n    }\r\n    \r\n    allocateMemory(line) {\r\n        // Extract size from line like \"let fileBuffer = malloc(1024);\"\r\n        const match = line.match(/malloc\\((\\d+)\\)/);\r\n        if (match) {\r\n            const size = parseInt(match[1]);\r\n            const varName = this.extractVariableName(line);\r\n            this.output.push(`📦 Allocating ${size} bytes for ${varName}`);\r\n            this.allocateMemoryBlock(size, varName, line);\r\n        } else {\r\n            // Try alternative regex patterns\r\n            const altMatch1 = line.match(/malloc\\s*\\(\\s*(\\d+)\\s*\\)/);\r\n            const altMatch2 = line.match(/malloc\\((\\d+)\\)/);\r\n            \r\n            if (altMatch1) {\r\n                const size = parseInt(altMatch1[1]);\r\n                const varName = this.extractVariableName(line);\r\n                this.allocateMemoryBlock(size, varName, line);\r\n            } else if (altMatch2) {\r\n                const size = parseInt(altMatch2[1]);\r\n                const varName = this.extractVariableName(line);\r\n                this.allocateMemoryBlock(size, varName, line);\r\n            }\r\n        }\r\n    }\r\n    \r\n    deallocateMemory(line) {\r\n        // Extract variable name from line like \"free(fileBuffer);\"\r\n        const match = line.match(/free\\((\\w+)\\)/);\r\n        if (match) {\r\n            const varName = match[1];\r\n            this.output.push(`🗑️ Freeing memory for ${varName}`);\r\n            this.deallocateMemoryBlock(varName, line);\r\n        } else {\r\n            // Try alternative regex patterns\r\n            const altMatch1 = line.match(/free\\s*\\(\\s*(\\w+)\\s*\\)/);\r\n            const altMatch2 = line.match(/free\\((\\w+)\\)/);\r\n            \r\n            if (altMatch1) {\r\n                const varName = altMatch1[1];\r\n                this.deallocateMemoryBlock(varName, line);\r\n            } else if (altMatch2) {\r\n                const varName = altMatch2[1];\r\n                this.deallocateMemoryBlock(varName, line);\r\n            }\r\n        }\r\n    }\r\n    \r\n    accessMemory(line) {\r\n        // Simulate memory access for operations like readFile, writeFile, etc.\r\n        const varName = this.extractVariableName(line);\r\n        const address = this.variableAddresses.get(varName);\r\n        \r\n        if (address) {\r\n            this.showMemoryAccess(address, varName, line);\r\n            this.output.push(`🔍 Accessing memory at 0x${address.toString(16)} for ${varName}`);\r\n            this.memoryAccessCount++;\r\n        }\r\n    }\r\n    \r\n    returnFromFunction() {\r\n        if (this.callStack.length > 0) {\r\n            const caller = this.callStack.pop();\r\n            this.currentFunction = caller.functionIndex;\r\n            this.currentLine = caller.lineIndex;\r\n            this.programCounter = caller.returnAddress;\r\n            \r\n            // Restore variables from stack frame\r\n            this.variableAddresses = new Map(caller.variables);\r\n            \r\n            // Handle return value assignment if the calling line was a variable assignment\r\n            const callingLine = this.program.functions[caller.functionIndex].lines[caller.lineIndex];\r\n            if (callingLine && callingLine.includes('=') && callingLine.includes('(')) {\r\n                // Extract variable name from assignment like \"let imageData = loadImage('photo.jpg');\"\r\n                const varMatch = callingLine.match(/(?:let\\s+)?(\\w+)\\s*=\\s*\\w+\\(/);\r\n                if (varMatch) {\r\n                    const varName = varMatch[1];\r\n                    // Create a return value address for the variable\r\n                    const returnAddress = this.nextHeapAddress;\r\n                    this.nextHeapAddress += 256; // Small allocation for return value\r\n                    this.variableAddresses.set(varName, returnAddress);\r\n                    \r\n                    this.output.push(`📝 Return value assigned to ${varName}`);\r\n                }\r\n            }\r\n            \r\n            this.output.push(`↩️ Returning from function`);\r\n            this.showStackFrameRemoval();\r\n            \r\n            // Advance to the next line after returning from function call\r\n            this.currentLine++;\r\n            \r\n            // Highlight the current line after returning\r\n            this.highlightedLine = this.currentLine;\r\n            \r\n            // Check if we're at the end of the main function\r\n            const currentFunc = this.program.functions[this.currentFunction];\r\n            this.output.push(`🔍 Debug: currentFunction=${this.currentFunction}, currentLine=${this.currentLine}, lines.length=${currentFunc.lines.length}`);\r\n            if (this.currentFunction === 0 && this.currentLine >= currentFunc.lines.length) {\r\n                // We're at the end of main function, mark as complete\r\n                this.output.push(`✅ Program execution complete`);\r\n                this.isAutoRunning = false;\r\n                this.animationState = 'idle';\r\n                \r\n                // Add completion celebration particles\r\n                for (let i = 0; i < 50; i++) {\r\n                    this.particles.push({\r\n                        x: this.canvas.width / 2,\r\n                        y: this.canvas.height / 2,\r\n                        vx: (Math.random() - 0.5) * 10,\r\n                        vy: (Math.random() - 0.5) * 10,\r\n                        life: 3.0,\r\n                        color: '#FFD700',\r\n                        type: 'completion'\r\n                    });\r\n                }\r\n                return; // Exit early to prevent further execution\r\n            }\r\n        } else {\r\n            // Program finished\r\n            this.output.push(`✅ Program execution complete`);\r\n            this.isAutoRunning = false;\r\n        }\r\n    }\r\n    \r\n    executeRegularLine(line) {\r\n        // Handle regular code execution - no output for simple assignments\r\n    }\r\n    \r\n    allocateMemoryBlock(size, varName, line) {\r\n        // Find best fit block\r\n        const bestBlock = this.findBestFitBlock(size);\r\n        if (!bestBlock) {\r\n            this.output.push(`❌ Out of memory!`);\r\n            return;\r\n        }\r\n        \r\n        // Remove the used free block from the free blocks list\r\n        const freeBlockIndex = this.freeBlocks.findIndex(block => \r\n            block.address === bestBlock.address && block.size === bestBlock.size);\r\n        if (freeBlockIndex !== -1) {\r\n            this.freeBlocks.splice(freeBlockIndex, 1);\r\n        }\r\n        \r\n        // Calculate block dimensions based on heap panel size and memory size\r\n        const heapWidth = this.heapPanel.width - 40; // Leave margin\r\n        const heapHeight = this.heapPanel.height - 40;\r\n        const totalHeapSize = 8192; // Total heap size in bytes\r\n        \r\n        // Calculate proportional dimensions based on memory size (more accurate scaling)\r\n        const sizeRatio = size / totalHeapSize;\r\n        // Use conservative scaling that allows multiple blocks to fit\r\n        const blockWidth = Math.max(50, Math.min(heapWidth * 0.2, heapWidth * sizeRatio * 0.6));\r\n        const blockHeight = Math.max(35, Math.min(heapHeight * 0.4, heapHeight * sizeRatio * 1.2));\r\n        \r\n        // Position the block within the heap boundaries\r\n        const newBlock = {\r\n            address: bestBlock.address,\r\n            size: size,\r\n            name: varName,\r\n            data: this.generateRandomData(size),\r\n            isAllocated: true,\r\n            width: blockWidth,\r\n            height: blockHeight\r\n        };\r\n        \r\n        // Find a position within the heap panel that doesn't overlap with existing blocks\r\n        const position = this.findNonOverlappingPosition(newBlock, bestBlock);\r\n        newBlock.x = position.x;\r\n        newBlock.y = position.y;\r\n        \r\n        this.heapBlocks.push(newBlock);\r\n        this.totalAllocations++;\r\n        this.currentMemoryUsage += size;\r\n        \r\n        // Store data in memory\r\n        this.memoryData.set(newBlock.address, newBlock.data);\r\n        this.variableAddresses.set(varName, newBlock.address);\r\n        \r\n        // Update free blocks to reflect the new allocation\r\n        this.updateFreeBlocks();\r\n        \r\n        // Add allocation effect\r\n        this.addAllocationEffect(newBlock);\r\n        \r\n        this.output.push(`📦 Allocated ${size} bytes at 0x${newBlock.address.toString(16)} for ${varName}`);\r\n        this.showAddressHighlight(newBlock.address, 'allocation');\r\n    }\r\n    \r\n    deallocateMemoryBlock(varName, line) {\r\n        const address = this.variableAddresses.get(varName);\r\n        const blockIndex = this.heapBlocks.findIndex(block => block.address === address);\r\n        \r\n        if (blockIndex !== -1) {\r\n        const block = this.heapBlocks[blockIndex];\r\n        \r\n            // Add deallocation effect\r\n            this.addDeallocationEffect(block);\r\n        \r\n            // Create clearing animation particles\r\n            this.createMemoryClearingParticles(block);\r\n        \r\n        // Remove block\r\n        this.heapBlocks.splice(blockIndex, 1);\r\n            this.totalDeallocations++;\r\n            this.currentMemoryUsage -= block.size;\r\n            \r\n            // Clear data from memory\r\n            this.memoryData.delete(block.address);\r\n            this.variableAddresses.delete(varName);\r\n        \r\n        // Update free blocks\r\n        this.updateFreeBlocks();\r\n        \r\n            this.output.push(`🗑️ Freed memory at 0x${block.address.toString(16)} for ${varName}`);\r\n            this.showAddressHighlight(block.address, 'deallocation');\r\n        } else {\r\n            this.output.push(`⚠️ Attempted to free unallocated variable: ${varName}`);\r\n            this.memoryLeaks++;\r\n        }\r\n    }\r\n    \r\n    showMemoryAccess(address, varName, operation) {\r\n        // Create memory access visualization\r\n        this.memoryAccesses.push({\r\n            address: address,\r\n            varName: varName,\r\n            operation: operation,\r\n            time: 0,\r\n            duration: 1.5\r\n        });\r\n        \r\n        // Create data flow particles\r\n        this.createDataFlowParticles(address, varName);\r\n    }\r\n    \r\n    showAddressHighlight(address, type) {\r\n        this.addressHighlights.push({\r\n            address: address,\r\n            type: type,\r\n            time: 0,\r\n            duration: 2.0\r\n        });\r\n    }\r\n    \r\n    showStackFrameCreation() {\r\n        // Create particles for stack frame creation\r\n        for (let i = 0; i < 10; i++) {\r\n            this.particles.push({\r\n                x: this.stackPanel.x + this.stackPanel.width / 2,\r\n                y: this.stackPanel.y + this.stackPanel.height,\r\n                vx: (Math.random() - 0.5) * 3,\r\n                vy: -Math.random() * 2,\r\n                life: 1.0,\r\n                color: '#3498db',\r\n                type: 'stack_frame'\r\n            });\r\n        }\r\n    }\r\n    \r\n    showStackFrameRemoval() {\r\n        // Create particles for stack frame removal\r\n        for (let i = 0; i < 8; i++) {\r\n            this.particles.push({\r\n                x: this.stackPanel.x + this.stackPanel.width / 2,\r\n                y: this.stackPanel.y + 50,\r\n                vx: (Math.random() - 0.5) * 4,\r\n                vy: Math.random() * 3,\r\n                life: 1.0,\r\n                color: '#F39C12',\r\n                type: 'stack_removal'\r\n            });\r\n        }\r\n    }\r\n    \r\n    createDataFlowParticles(address, varName) {\r\n        // Create particles showing data flow to/from memory\r\n        const block = this.heapBlocks.find(b => b.address === address);\r\n        if (block) {\r\n            for (let i = 0; i < 15; i++) {\r\n                this.dataFlowParticles.push({\r\n                    x: block.x + block.width / 2,\r\n                    y: block.y + block.height / 2,\r\n                    vx: (Math.random() - 0.5) * 2,\r\n                    vy: (Math.random() - 0.5) * 2,\r\n                    life: 1.0,\r\n                    color: '#FFD700',\r\n                    type: 'data_flow'\r\n                });\r\n            }\r\n        }\r\n    }\r\n    \r\n    createMemoryClearingParticles(block) {\r\n        // Create particles showing memory being cleared/freed\r\n        for (let i = 0; i < 20; i++) {\r\n            this.particles.push({\r\n                x: block.x + Math.random() * block.width,\r\n                y: block.y + Math.random() * block.height,\r\n                vx: (Math.random() - 0.5) * 4,\r\n                vy: (Math.random() - 0.5) * 4,\r\n                life: 1.5,\r\n                color: '#FF6B6B',\r\n                type: 'memory_clear'\r\n            });\r\n        }\r\n        \r\n        // Add some upward floating particles to show data being cleared\r\n        for (let i = 0; i < 10; i++) {\r\n            this.particles.push({\r\n                x: block.x + block.width / 2,\r\n                y: block.y + block.height / 2,\r\n                vx: (Math.random() - 0.5) * 2,\r\n                vy: -Math.random() * 3 - 1,\r\n                life: 2.0,\r\n                color: '#FFD700',\r\n                type: 'data_clear'\r\n            });\r\n        }\r\n    }\r\n    \r\n    extractVariableName(line) {\r\n        // Handle both let declarations and direct malloc calls\r\n        let match = line.match(/let\\s+(\\w+)\\s*=/);\r\n        if (match) {\r\n            return match[1];\r\n        }\r\n        \r\n        // Handle direct malloc calls like \"malloc(1024)\"\r\n        match = line.match(/malloc\\((\\d+)\\)/);\r\n        if (match) {\r\n            // For direct malloc calls, create a generic name\r\n            const varName = `malloc_${match[1]}`;\r\n            return varName;\r\n        }\r\n        \r\n        return 'unknown';\r\n    }\r\n    \r\n    findBestFitBlock(size) {\r\n        // Find the first available free block that can fit the requested size\r\n        for (const block of this.freeBlocks) {\r\n            if (block.size >= size) {\r\n                return block;\r\n            }\r\n        }\r\n        \r\n        // If no block is large enough, return null (out of memory)\r\n        return null;\r\n    }\r\n    \r\n    findNonOverlappingPosition(newBlock, bestBlock) {\r\n        // Define the heap area where blocks can be placed\r\n        const heapArea = {\r\n            x: this.heapPanel.x + 20,\r\n            y: this.heapPanel.y + 20,\r\n            width: this.heapPanel.width - 40,\r\n            height: this.heapPanel.height - 40\r\n        };\r\n        \r\n        // Try grid-based positioning first for better organization\r\n        const gridSize = Math.max(newBlock.width, newBlock.height) + 10;\r\n        const cols = Math.floor(heapArea.width / gridSize);\r\n        const rows = Math.floor(heapArea.height / gridSize);\r\n        \r\n        // Try grid positions first\r\n        for (let row = 0; row < rows; row++) {\r\n            for (let col = 0; col < cols; col++) {\r\n                const x = heapArea.x + col * gridSize;\r\n                const y = heapArea.y + row * gridSize;\r\n                \r\n                // Check if this position overlaps with any existing block\r\n                let overlaps = false;\r\n                for (const existingBlock of this.heapBlocks) {\r\n                    if (this.blocksOverlap(\r\n                        { x, y, width: newBlock.width, height: newBlock.height },\r\n                        existingBlock\r\n                    )) {\r\n                        overlaps = true;\r\n                        break;\r\n                    }\r\n                }\r\n                \r\n                if (!overlaps) {\r\n                    return { x, y };\r\n                }\r\n            }\r\n        }\r\n        \r\n        // If grid positioning fails, try random positions\r\n        const maxAttempts = 30;\r\n        for (let attempt = 0; attempt < maxAttempts; attempt++) {\r\n            // Generate a random position within the heap area\r\n            const x = heapArea.x + Math.random() * (heapArea.width - newBlock.width);\r\n            const y = heapArea.y + Math.random() * (heapArea.height - newBlock.height);\r\n            \r\n            // Check if this position overlaps with any existing block\r\n            let overlaps = false;\r\n            for (const existingBlock of this.heapBlocks) {\r\n                if (this.blocksOverlap(\r\n                    { x, y, width: newBlock.width, height: newBlock.height },\r\n                    existingBlock\r\n                )) {\r\n                    overlaps = true;\r\n                    break;\r\n                }\r\n            }\r\n            \r\n            if (!overlaps) {\r\n                return { x, y };\r\n            }\r\n        }\r\n        \r\n        // If we can't find a non-overlapping position, place it at the best block location\r\n        return {\r\n            x: bestBlock.x + (bestBlock.width - newBlock.width) / 2,\r\n            y: bestBlock.y + (bestBlock.height - newBlock.height) / 2\r\n        };\r\n    }\r\n    \r\n    blocksOverlap(block1, block2) {\r\n        return !(block1.x + block1.width <= block2.x ||\r\n                block2.x + block2.width <= block1.x ||\r\n                block1.y + block1.height <= block2.y ||\r\n                block2.y + block2.height <= block1.y);\r\n    }\r\n    \r\n    updateFreeBlocks() {\r\n        // Clear existing free blocks\r\n        this.freeBlocks = [];\r\n        \r\n        // Calculate total heap size and used space\r\n        const totalHeapSize = 8192;\r\n        const usedSpace = this.heapBlocks.reduce((total, block) => total + block.size, 0);\r\n        const freeSpace = totalHeapSize - usedSpace;\r\n        \r\n        // Only create free blocks if there's actually free space\r\n        if (freeSpace > 0) {\r\n            // Create fragmented free blocks to show actual gaps\r\n            const fragmentedBlocks = this.calculateFragmentedFreeBlocks();\r\n            this.freeBlocks.push(...fragmentedBlocks);\r\n            \r\n            // If no fragmented blocks were created but there's free space,\r\n            // create a single free block at the end\r\n            if (fragmentedBlocks.length === 0 && freeSpace > 0) {\r\n                const lastBlock = this.heapBlocks.length > 0 ? \r\n                    Math.max(...this.heapBlocks.map(b => b.address + b.size)) : 0x1000;\r\n                \r\n                const freeBlock = {\r\n                    address: lastBlock,\r\n                    size: freeSpace,\r\n                    x: this.heapPanel.x + 20 + (lastBlock - 0x1000) / totalHeapSize * (this.heapPanel.width - 40),\r\n                    y: this.heapPanel.y + this.heapPanel.height - 70,\r\n                    width: Math.max(30, (freeSpace / totalHeapSize) * (this.heapPanel.width - 40)),\r\n                    height: 50\r\n                };\r\n                \r\n                this.freeBlocks.push(freeBlock);\r\n            }\r\n        }\r\n    }\r\n    \r\n    calculateFragmentedFreeBlocks() {\r\n        const fragmentedBlocks = [];\r\n        const totalHeapSize = 8192;\r\n        \r\n        // Calculate gaps between allocated blocks\r\n        const sortedBlocks = [...this.heapBlocks].sort((a, b) => a.address - b.address);\r\n        let currentAddress = 0x1000;\r\n        \r\n        for (const block of sortedBlocks) {\r\n            if (block.address > currentAddress) {\r\n                // There's a gap before this block\r\n                const gapSize = block.address - currentAddress;\r\n                if (gapSize >= 128) { // Show smaller gaps too for better visualization\r\n                    const gapWidth = Math.max(20, (gapSize / totalHeapSize) * (this.heapPanel.width - 40));\r\n                    const gapHeight = Math.max(30, Math.min(40, gapWidth * 0.4));\r\n                    \r\n                    fragmentedBlocks.push({\r\n                    address: currentAddress,\r\n                        size: gapSize,\r\n                        x: this.heapPanel.x + 20 + (currentAddress - 0x1000) / totalHeapSize * (this.heapPanel.width - 40),\r\n                        y: this.heapPanel.y + 20,\r\n                        width: gapWidth,\r\n                        height: gapHeight\r\n                    });\r\n                }\r\n            }\r\n            currentAddress = block.address + block.size;\r\n        }\r\n        \r\n        // Check for gap after the last block\r\n        if (currentAddress < 0x1000 + totalHeapSize) {\r\n            const gapSize = (0x1000 + totalHeapSize) - currentAddress;\r\n            if (gapSize >= 128) {\r\n                const gapWidth = Math.max(20, (gapSize / totalHeapSize) * (this.heapPanel.width - 40));\r\n                const gapHeight = Math.max(30, Math.min(40, gapWidth * 0.4));\r\n                \r\n                fragmentedBlocks.push({\r\n                    address: currentAddress,\r\n                    size: gapSize,\r\n                    x: this.heapPanel.x + 20 + (currentAddress - 0x1000) / totalHeapSize * (this.heapPanel.width - 40),\r\n                    y: this.heapPanel.y + 20,\r\n                    width: gapWidth,\r\n                    height: gapHeight\r\n                });\r\n            }\r\n        }\r\n        \r\n        return fragmentedBlocks;\r\n    }\r\n    \r\n    generateRandomData(size) {\r\n        const data = [];\r\n        for (let i = 0; i < size; i++) {\r\n            data.push(Math.floor(Math.random() * 256));\r\n        }\r\n        return data;\r\n    }\r\n    \r\n    addAllocationEffect(block) {\r\n        // Enhanced allocation particles with more variety and physics\r\n        for (let i = 0; i < 35; i++) {\r\n            this.particles.push({\r\n                x: block.x + block.width / 2,\r\n                y: block.y + block.height / 2,\r\n                vx: (Math.random() - 0.5) * 8,\r\n                vy: (Math.random() - 0.5) * 8,\r\n                life: 2.0,\r\n                color: '#4ECDC4',\r\n                type: 'allocation',\r\n                size: Math.random() * 3 + 2\r\n            });\r\n        }\r\n        \r\n        // Add upward floating particles with spiral motion\r\n        for (let i = 0; i < 15; i++) {\r\n            this.particles.push({\r\n                x: block.x + Math.random() * block.width,\r\n                y: block.y + block.height,\r\n                vx: (Math.random() - 0.5) * 3,\r\n                vy: -Math.random() * 5 - 3,\r\n                life: 2.5,\r\n                color: '#4ECDC4',\r\n                type: 'allocation_float',\r\n                spiral: Math.random() * Math.PI * 2,\r\n                spiralSpeed: (Math.random() - 0.5) * 0.1\r\n            });\r\n        }\r\n        \r\n        // Add memory access highlight with pulse effect\r\n        this.memoryAccesses.push({\r\n            address: block.address,\r\n            varName: block.name,\r\n            operation: 'allocation',\r\n            time: 0,\r\n            duration: 2.0,\r\n            type: 'allocation',\r\n            pulse: 0\r\n        });\r\n        \r\n        // Add growing animation effect with bounce\r\n        this.allocationEffects = this.allocationEffects || [];\r\n        this.allocationEffects.push({\r\n            block: block,\r\n            time: 0,\r\n            duration: 1.2,\r\n            type: 'grow',\r\n            originalWidth: block.width * 0.3,\r\n            originalHeight: block.height * 0.3\r\n        });\r\n        \r\n        // Add variable connection animation\r\n        this.variableConnections.push({\r\n            from: { x: this.codePanel.x + 350, y: this.codePanel.y + 70 },\r\n            to: { x: block.x + block.width / 2, y: block.y + block.height / 2 },\r\n            time: 0,\r\n            duration: 1.5,\r\n            varName: block.name\r\n        });\r\n        \r\n        // Update performance metrics\r\n        this.performanceMetrics.totalCycles++;\r\n        this.performanceMetrics.memoryEfficiency = (this.currentMemoryUsage / 8192) * 100;\r\n    }\r\n    \r\n    addDeallocationEffect(block) {\r\n        // Enhanced deallocation particles with explosion and implosion effects\r\n        for (let i = 0; i < 40; i++) {\r\n            this.particles.push({\r\n                x: block.x + block.width / 2,\r\n                y: block.y + block.height / 2,\r\n                vx: (Math.random() - 0.5) * 10,\r\n                vy: (Math.random() - 0.5) * 10,\r\n                life: 2.0,\r\n                color: '#FF6B6B',\r\n                type: 'deallocation',\r\n                size: Math.random() * 4 + 3\r\n            });\r\n        }\r\n        \r\n        // Add implosion particles (moving toward center)\r\n        for (let i = 0; i < 20; i++) {\r\n            const angle = Math.random() * Math.PI * 2;\r\n            const distance = Math.random() * 50 + 20;\r\n            this.particles.push({\r\n                x: block.x + block.width / 2 + Math.cos(angle) * distance,\r\n                y: block.y + block.height / 2 + Math.sin(angle) * distance,\r\n                vx: (block.x + block.width / 2 - (block.x + block.width / 2 + Math.cos(angle) * distance)) * 0.1,\r\n                vy: (block.y + block.height / 2 - (block.y + block.height / 2 + Math.sin(angle) * distance)) * 0.1,\r\n                life: 1.5,\r\n                color: '#FF6B6B',\r\n                type: 'deallocation_implosion'\r\n            });\r\n        }\r\n        \r\n        // Add downward falling particles with gravity effect\r\n        for (let i = 0; i < 20; i++) {\r\n            this.particles.push({\r\n                x: block.x + Math.random() * block.width,\r\n                y: block.y,\r\n                vx: (Math.random() - 0.5) * 4,\r\n                vy: Math.random() * 6 + 3,\r\n                life: 2.5,\r\n                color: '#FF6B6B',\r\n                type: 'deallocation_fall',\r\n                gravity: 0.2\r\n            });\r\n        }\r\n        \r\n        // Add memory access highlight with fade effect\r\n        this.memoryAccesses.push({\r\n            address: block.address,\r\n            varName: block.name,\r\n            operation: 'deallocation',\r\n            time: 0,\r\n            duration: 2.0,\r\n            type: 'deallocation',\r\n            fade: 1.0\r\n        });\r\n        \r\n        // Add shrinking animation effect with collapse\r\n        this.deallocationEffects = this.deallocationEffects || [];\r\n        this.deallocationEffects.push({\r\n            block: block,\r\n            time: 0,\r\n            duration: 1.5,\r\n            type: 'shrink',\r\n            originalWidth: block.width,\r\n            originalHeight: block.height\r\n        });\r\n        \r\n        // Add memory fragmentation visualization\r\n        this.memoryFragmentation.push({\r\n            x: block.x + block.width / 2,\r\n            y: block.y + block.height / 2,\r\n            time: 0,\r\n            duration: 3.0,\r\n            size: block.width * block.height\r\n        });\r\n        \r\n        // Update performance metrics\r\n        this.performanceMetrics.fragmentationLevel = this.calculateFragmentationLevel();\r\n    }\r\n    \r\n    calculateFragmentationLevel() {\r\n        if (this.freeBlocks.length === 0) return 0;\r\n        \r\n        const totalFreeSize = this.freeBlocks.reduce((sum, block) => sum + block.size, 0);\r\n        const largestFreeBlock = Math.max(...this.freeBlocks.map(block => block.size));\r\n        \r\n        // Fragmentation is high when there are many small free blocks instead of few large ones\r\n        const fragmentation = (totalFreeSize - largestFreeBlock) / totalFreeSize;\r\n        return Math.min(100, fragmentation * 100);\r\n    }\r\n    \r\n    // Garbage Collection Methods\r\n    runGarbageCollection() {\r\n        if (this.gcState.isRunning) return;\r\n        \r\n        this.gcState.isRunning = true;\r\n        this.gcState.phase = 'mark';\r\n        this.gcState.phaseTime = 0;\r\n        this.gcState.markedBlocks.clear();\r\n        this.gcState.gcParticles = [];\r\n        \r\n        this.output.push('🗑️ Starting Garbage Collection...');\r\n        \r\n        // Mark phase - mark all reachable blocks\r\n        this.markReachableBlocks();\r\n    }\r\n    \r\n    markReachableBlocks() {\r\n        // Mark blocks that are referenced by variables\r\n        for (const [varName, address] of this.variableAddresses) {\r\n            const block = this.heapBlocks.find(b => b.address === address);\r\n            if (block) {\r\n                this.gcState.markedBlocks.add(block.address);\r\n                this.createGCMarkEffect(block);\r\n            }\r\n        }\r\n        \r\n        // Create visual effects for all blocks during mark phase\r\n        for (const block of this.heapBlocks) {\r\n            if (this.gcState.markedBlocks.has(block.address)) {\r\n                // Mark as reachable with golden particles\r\n                this.createGCMarkEffect(block);\r\n            } else {\r\n                // Mark as potentially unreachable with different effect\r\n                this.createGCPotentialUnreachableEffect(block);\r\n            }\r\n        }\r\n        \r\n        this.output.push(`✅ Marked ${this.gcState.markedBlocks.size} reachable blocks`);\r\n    }\r\n    \r\n    sweepUnreachableBlocks() {\r\n        const unreachableBlocks = [];\r\n        \r\n        // Find unreachable blocks\r\n        for (const block of this.heapBlocks) {\r\n            if (!this.gcState.markedBlocks.has(block.address)) {\r\n                unreachableBlocks.push(block);\r\n            }\r\n        }\r\n        \r\n        // Free unreachable blocks\r\n        for (const block of unreachableBlocks) {\r\n            this.freeUnreachableBlock(block);\r\n        }\r\n        \r\n        this.output.push(`🧹 Swept ${unreachableBlocks.length} unreachable blocks`);\r\n    }\r\n    \r\n    freeUnreachableBlock(block) {\r\n        // Remove from heap blocks\r\n        const index = this.heapBlocks.findIndex(b => b.address === block.address);\r\n        if (index !== -1) {\r\n            this.heapBlocks.splice(index, 1);\r\n        }\r\n        \r\n        // Add to free blocks\r\n        this.freeBlocks.push({\r\n            address: block.address,\r\n            size: block.size,\r\n            x: block.x,\r\n            y: block.y,\r\n            width: block.width,\r\n            height: block.height\r\n        });\r\n        \r\n        // Create deallocation effect\r\n        this.createGCDeallocationEffect(block);\r\n        \r\n        // Update statistics\r\n        this.totalDeallocations++;\r\n        this.currentMemoryUsage -= block.size;\r\n    }\r\n    \r\n    createGCMarkEffect(block) {\r\n        // Create particles for marking\r\n        for (let i = 0; i < 8; i++) {\r\n            this.gcState.gcParticles.push({\r\n                x: block.x + Math.random() * block.width,\r\n                y: block.y + Math.random() * block.height,\r\n                vx: (Math.random() - 0.5) * 60,\r\n                vy: (Math.random() - 0.5) * 60,\r\n                life: 2.0,\r\n                color: '#FFD700',\r\n                type: 'mark'\r\n            });\r\n        }\r\n    }\r\n    \r\n    createGCPotentialUnreachableEffect(block) {\r\n        // Create particles for potentially unreachable blocks\r\n        for (let i = 0; i < 6; i++) {\r\n            this.gcState.gcParticles.push({\r\n                x: block.x + Math.random() * block.width,\r\n                y: block.y + Math.random() * block.height,\r\n                vx: (Math.random() - 0.5) * 50,\r\n                vy: (Math.random() - 0.5) * 50,\r\n                life: 1.5,\r\n                color: '#FFA500',\r\n                type: 'potential_unreachable'\r\n            });\r\n        }\r\n    }\r\n    \r\n    createGCDeallocationEffect(block) {\r\n        // Create particles for deallocation\r\n        for (let i = 0; i < 6; i++) {\r\n            this.gcState.gcParticles.push({\r\n                x: block.x + Math.random() * block.width,\r\n                y: block.y + Math.random() * block.height,\r\n                vx: (Math.random() - 0.5) * 80,\r\n                vy: (Math.random() - 0.5) * 80,\r\n                life: 1.5,\r\n                color: '#FF6B6B',\r\n                type: 'sweep'\r\n            });\r\n        }\r\n    }\r\n    \r\n    updateGarbageCollection(deltaTime) {\r\n        if (!this.gcState.isRunning) return;\r\n        \r\n        this.gcState.phaseTime += deltaTime;\r\n        \r\n        // Update GC particles\r\n        for (let i = this.gcState.gcParticles.length - 1; i >= 0; i--) {\r\n            const particle = this.gcState.gcParticles[i];\r\n            particle.x += particle.vx * deltaTime;\r\n            particle.y += particle.vy * deltaTime;\r\n            particle.life -= deltaTime * 2;\r\n            \r\n            if (particle.life <= 0) {\r\n                this.gcState.gcParticles.splice(i, 1);\r\n            }\r\n        }\r\n        \r\n        // Phase transitions\r\n        if (this.gcState.phase === 'mark' && this.gcState.phaseTime >= this.gcState.phaseDuration) {\r\n            this.gcState.phase = 'sweep';\r\n            this.gcState.phaseTime = 0;\r\n            this.sweepUnreachableBlocks();\r\n        } else if (this.gcState.phase === 'sweep' && this.gcState.phaseTime >= this.gcState.phaseDuration) {\r\n            this.gcState.isRunning = false;\r\n            this.gcState.phase = 'idle';\r\n            this.output.push('✅ Garbage Collection Complete');\r\n        }\r\n    }\r\n    \r\n    update(deltaTime) {\r\n        const dt = deltaTime / 1000;\r\n        \r\n        // Automatic execution\r\n        if (this.isAutoRunning && this.animationState === 'idle') {\r\n            this.animationTime += dt;\r\n            if (this.animationTime >= 0.5 / this.animationSpeed) { // Use animationSpeed instead of executionSpeed\r\n                this.executeNextStep();\r\n                this.animationTime = 0;\r\n            }\r\n        }\r\n        \r\n        // Update particles with enhanced physics\r\n            for (let i = this.particles.length - 1; i >= 0; i--) {\r\n                const particle = this.particles[i];\r\n            \r\n            // Apply spiral motion for allocation_float particles\r\n            if (particle.type === 'allocation_float' && particle.spiral !== undefined) {\r\n                particle.spiral += particle.spiralSpeed || 0.05;\r\n                particle.x += Math.cos(particle.spiral) * 0.5;\r\n                particle.y += Math.sin(particle.spiral) * 0.5;\r\n            }\r\n            \r\n            // Apply gravity for deallocation_fall particles\r\n            if (particle.type === 'deallocation_fall' && particle.gravity) {\r\n                particle.vy += particle.gravity;\r\n            }\r\n            \r\n            // Apply implosion for deallocation_implosion particles\r\n            if (particle.type === 'deallocation_implosion') {\r\n                const dx = particle.vx;\r\n                const dy = particle.vy;\r\n                particle.x += dx;\r\n                particle.y += dy;\r\n            } else {\r\n                particle.x += particle.vx;\r\n                particle.y += particle.vy;\r\n            }\r\n            \r\n            // Apply general gravity\r\n            if (particle.type !== 'allocation_float' && particle.type !== 'deallocation_implosion') {\r\n                particle.vy += 0.1;\r\n            }\r\n            \r\n                particle.life -= dt * 2;\r\n                \r\n                if (particle.life <= 0) {\r\n                    this.particles.splice(i, 1);\r\n                }\r\n        }\r\n        \r\n        // Update data flow particles\r\n        for (let i = this.dataFlowParticles.length - 1; i >= 0; i--) {\r\n            const particle = this.dataFlowParticles[i];\r\n            particle.x += particle.vx;\r\n            particle.y += particle.vy;\r\n            particle.life -= dt * 3;\r\n            \r\n            if (particle.life <= 0) {\r\n                this.dataFlowParticles.splice(i, 1);\r\n            }\r\n        }\r\n        \r\n        // Update memory accesses\r\n        for (let i = this.memoryAccesses.length - 1; i >= 0; i--) {\r\n            const access = this.memoryAccesses[i];\r\n            access.time += dt;\r\n            \r\n            if (access.time >= access.duration) {\r\n                this.memoryAccesses.splice(i, 1);\r\n            }\r\n        }\r\n        \r\n        // Update address highlights\r\n        for (let i = this.addressHighlights.length - 1; i >= 0; i--) {\r\n            const highlight = this.addressHighlights[i];\r\n                highlight.time += dt;\r\n                \r\n                if (highlight.time >= highlight.duration) {\r\n                this.addressHighlights.splice(i, 1);\r\n            }\r\n        }\r\n        \r\n        // Update allocation effects\r\n        for (let i = this.allocationEffects.length - 1; i >= 0; i--) {\r\n            const effect = this.allocationEffects[i];\r\n            effect.time += dt;\r\n            \r\n            if (effect.time >= effect.duration) {\r\n                this.allocationEffects.splice(i, 1);\r\n            }\r\n        }\r\n        \r\n        // Update deallocation effects\r\n        for (let i = this.deallocationEffects.length - 1; i >= 0; i--) {\r\n            const effect = this.deallocationEffects[i];\r\n            effect.time += dt;\r\n            \r\n            if (effect.time >= effect.duration) {\r\n                this.deallocationEffects.splice(i, 1);\r\n            }\r\n        }\r\n        \r\n        // Update variable connections\r\n        for (let i = this.variableConnections.length - 1; i >= 0; i--) {\r\n            const connection = this.variableConnections[i];\r\n            connection.time += dt;\r\n            \r\n            if (connection.time >= connection.duration) {\r\n                this.variableConnections.splice(i, 1);\r\n            }\r\n        }\r\n        \r\n        // Update memory fragmentation\r\n        for (let i = this.memoryFragmentation.length - 1; i >= 0; i--) {\r\n            const frag = this.memoryFragmentation[i];\r\n            frag.time += dt;\r\n            \r\n            if (frag.time >= frag.duration) {\r\n                this.memoryFragmentation.splice(i, 1);\r\n            }\r\n        }\r\n        \r\n        // Update execution trail\r\n        if (this.highlightedLine >= 0) {\r\n            this.executionTrail.push({\r\n                x: this.codePanel.x + 15,\r\n                y: this.codePanel.y + 70 + this.highlightedLine * 22, // Match execution pointer spacing\r\n                time: 0,\r\n                duration: 2.0\r\n            });\r\n        }\r\n        \r\n        // Clean up old execution trail points (limit to 20 points to prevent memory issues)\r\n        for (let i = this.executionTrail.length - 1; i >= 0; i--) {\r\n            this.executionTrail[i].time += dt;\r\n            if (this.executionTrail[i].time >= this.executionTrail[i].duration) {\r\n                this.executionTrail.splice(i, 1);\r\n            }\r\n        }\r\n        \r\n        // Limit execution trail length\r\n        if (this.executionTrail.length > 20) {\r\n            this.executionTrail.splice(0, this.executionTrail.length - 20);\r\n        }\r\n        \r\n        // Update garbage collection\r\n        this.updateGarbageCollection(dt);\r\n        \r\n        // Update performance metrics\r\n        this.performanceMetrics.totalCycles = this.executionStep;\r\n        this.performanceMetrics.fragmentationLevel = this.calculateFragmentationLevel();\r\n        \r\n        // Calculate memory efficiency based on allocations vs deallocations\r\n        const totalOperations = this.totalAllocations + this.totalDeallocations;\r\n        if (totalOperations > 0) {\r\n            this.performanceMetrics.memoryEfficiency = Math.max(0, \r\n                ((this.totalAllocations - this.memoryLeaks) / this.totalAllocations) * 100);\r\n        } else {\r\n            this.performanceMetrics.memoryEfficiency = 100;\r\n        }\r\n        \r\n        // Calculate average access time (simplified)\r\n        this.performanceMetrics.averageAccessTime = this.memoryAccessCount > 0 ? \r\n            this.executionStep / this.memoryAccessCount : 0;\r\n    }\r\n    \r\n    render() {\r\n        this.drawBackground();\r\n        this.drawCodePanel();\r\n        this.drawStackPanel();\r\n        this.drawHeapPanel();\r\n        this.drawOutputPanel();\r\n        this.drawExecutionPointer();\r\n        this.drawExecutionTrail();\r\n        this.drawMemoryAccesses();\r\n        this.drawAddressHighlights();\r\n        this.drawVariableConnections();\r\n        this.drawMemoryFragmentation();\r\n        this.drawParticles();\r\n        this.drawDataFlowParticles();\r\n        this.drawAllocationEffects();\r\n        this.drawGarbageCollectionEffects();\r\n        this.drawStatistics();\r\n    }\r\n    \r\n    drawBackground() {\r\n        // Create a modern gradient background with deeper colors\r\n        const gradient = this.ctx.createLinearGradient(0, 0, this.canvas.width, this.canvas.height);\r\n        gradient.addColorStop(0, '#0a0a0a');\r\n        gradient.addColorStop(0.3, '#1a1a2e');\r\n        gradient.addColorStop(0.7, '#16213e');\r\n        gradient.addColorStop(1, '#0f3460');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n        \r\n        // Add animated hexagonal pattern for modern tech feel\r\n        this.ctx.strokeStyle = 'rgba(46, 204, 113, 0.08)';\r\n        this.ctx.lineWidth = 1;\r\n        const hexSize = 60;\r\n        const offset = (this.animationTime * 15) % hexSize;\r\n        \r\n        for (let y = -offset; y < this.canvas.height + hexSize; y += hexSize * 1.5) {\r\n            for (let x = -offset; x < this.canvas.width + hexSize; x += hexSize * 1.3) {\r\n            this.ctx.beginPath();\r\n                for (let i = 0; i < 6; i++) {\r\n                    const angle = (i * Math.PI) / 3;\r\n                    const px = x + hexSize * 0.5 * Math.cos(angle);\r\n                    const py = y + hexSize * 0.5 * Math.sin(angle);\r\n                    if (i === 0) {\r\n                        this.ctx.moveTo(px, py);\r\n                    } else {\r\n                        this.ctx.lineTo(px, py);\r\n                    }\r\n                }\r\n                this.ctx.closePath();\r\n            this.ctx.stroke();\r\n        }\r\n        }\r\n        \r\n        // Add floating particles for ambient effect\r\n        for (let i = 0; i < 20; i++) {\r\n            const x = (i * 137.5) % this.canvas.width;\r\n            const y = (i * 73.3 + this.animationTime * 10) % this.canvas.height;\r\n            const alpha = 0.3 + 0.2 * Math.sin(this.animationTime * 2 + i);\r\n            \r\n            this.ctx.fillStyle = `rgba(46, 204, 113, ${alpha})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(x, y, 1, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n        \r\n        // Add subtle radial glow effect\r\n        const centerX = this.canvas.width / 2;\r\n        const centerY = this.canvas.height / 2;\r\n        const radius = Math.min(this.canvas.width, this.canvas.height) * 0.8;\r\n        const radialGradient = this.ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, radius);\r\n        radialGradient.addColorStop(0, 'rgba(46, 204, 113, 0.05)');\r\n        radialGradient.addColorStop(1, 'rgba(46, 204, 113, 0)');\r\n        this.ctx.fillStyle = radialGradient;\r\n        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n    \r\n    drawCodePanel() {\r\n        // Code panel background with enhanced shadow\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.4)';\r\n        this.ctx.fillRect(this.codePanel.x + 4, this.codePanel.y + 4, this.codePanel.width, this.codePanel.height);\r\n        \r\n        // Code panel background with modern gradient\r\n        const gradient = this.ctx.createLinearGradient(this.codePanel.x, this.codePanel.y, this.codePanel.x, this.codePanel.y + this.codePanel.height);\r\n        gradient.addColorStop(0, 'rgba(26, 26, 46, 0.98)');\r\n        gradient.addColorStop(0.5, 'rgba(26, 26, 46, 0.95)');\r\n        gradient.addColorStop(1, 'rgba(26, 26, 46, 0.92)');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(this.codePanel.x, this.codePanel.y, this.codePanel.width, this.codePanel.height);\r\n        \r\n        // Enhanced border with rounded corners and gradient\r\n        this.ctx.shadowColor = '#4ECDC4';\r\n        this.ctx.shadowBlur = 12;\r\n        this.ctx.lineWidth = 3;\r\n        \r\n        // Create gradient border\r\n        const borderGradient = this.ctx.createLinearGradient(\r\n            this.codePanel.x, this.codePanel.y, \r\n            this.codePanel.x + this.codePanel.width, this.codePanel.y + this.codePanel.height\r\n        );\r\n        borderGradient.addColorStop(0, '#4ECDC4');\r\n        borderGradient.addColorStop(0.5, '#2ECC71');\r\n        borderGradient.addColorStop(1, '#4ECDC4');\r\n        \r\n        this.ctx.strokeStyle = borderGradient;\r\n        this.roundRect(this.codePanel.x, this.codePanel.y, this.codePanel.width, this.codePanel.height, 12);\r\n        this.ctx.stroke();\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Title with crisp font rendering\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('💻 Code Execution', this.codePanel.x + 15, this.codePanel.y + 25);\r\n        \r\n        // Current function with crisp font rendering\r\n        const currentFunc = this.program.functions[this.currentFunction];\r\n        this.ctx.fillStyle = '#FFD700';\r\n        this.ctx.font = 'bold 14px Inter';\r\n        this.ctx.fillText(`Current: ${currentFunc.name}`, this.codePanel.x + 15, this.codePanel.y + 45);\r\n        \r\n        // Draw code lines with crisp font rendering\r\n        this.ctx.font = '12px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        \r\n        for (let i = 0; i < currentFunc.lines.length; i++) {\r\n            const line = currentFunc.lines[i];\r\n            const y = this.codePanel.y + 70 + i * 22; // Increased line spacing\r\n            \r\n            // Highlight current line with better effect\r\n            if (i === this.highlightedLine) {\r\n                // Highlight background\r\n                this.ctx.fillStyle = 'rgba(78, 205, 196, 0.2)';\r\n                this.ctx.fillRect(this.codePanel.x + 8, y - 16, this.codePanel.width - 16, 22);\r\n                \r\n                // Highlight border\r\n                this.ctx.strokeStyle = '#4ECDC4';\r\n                this.ctx.lineWidth = 1;\r\n                this.ctx.strokeRect(this.codePanel.x + 8, y - 16, this.codePanel.width - 16, 22);\r\n            }\r\n            \r\n            // Line number with crisp font rendering\r\n            this.ctx.fillStyle = '#666666';\r\n            this.ctx.font = '10px Inter';\r\n            this.ctx.fillText(`${i + 1}`, this.codePanel.x + 15, y);\r\n            \r\n            // Code line with crisp font rendering\r\n            this.ctx.fillStyle = i === this.highlightedLine ? '#4ECDC4' : '#FFFFFF';\r\n            this.ctx.font = '12px Inter';\r\n            this.ctx.fillText(line, this.codePanel.x + 35, y);\r\n        }\r\n    }\r\n    \r\n    drawStackPanel() {\r\n        // Stack panel background with shadow\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.fillRect(this.stackPanel.x + 3, this.stackPanel.y + 3, this.stackPanel.width, this.stackPanel.height);\r\n        \r\n        // Stack panel background with gradient\r\n        const gradient = this.ctx.createLinearGradient(this.stackPanel.x, this.stackPanel.y, this.stackPanel.x, this.stackPanel.y + this.stackPanel.height);\r\n        gradient.addColorStop(0, 'rgba(26, 26, 46, 0.95)');\r\n        gradient.addColorStop(1, 'rgba(26, 26, 46, 0.9)');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(this.stackPanel.x, this.stackPanel.y, this.stackPanel.width, this.stackPanel.height);\r\n        \r\n        // Enhanced border with rounded corners and gradient\r\n        this.ctx.shadowColor = '#3498db';\r\n        this.ctx.shadowBlur = 10;\r\n        this.ctx.lineWidth = 3;\r\n        \r\n        // Create gradient border\r\n        const stackBorderGradient = this.ctx.createLinearGradient(\r\n            this.stackPanel.x, this.stackPanel.y, \r\n            this.stackPanel.x + this.stackPanel.width, this.stackPanel.y + this.stackPanel.height\r\n        );\r\n        stackBorderGradient.addColorStop(0, '#3498db');\r\n        stackBorderGradient.addColorStop(0.5, '#2980b9');\r\n        stackBorderGradient.addColorStop(1, '#3498db');\r\n        \r\n        this.ctx.strokeStyle = stackBorderGradient;\r\n        this.roundRect(this.stackPanel.x, this.stackPanel.y, this.stackPanel.width, this.stackPanel.height, 12);\r\n        this.ctx.stroke();\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n                // Title with crisp font rendering\r\n        this.ctx.fillStyle = '#3498db';\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('📚 Call Stack', this.stackPanel.x + 15, this.stackPanel.y + 25);\r\n            \r\n        // Draw call stack with crisp font rendering\r\n            this.ctx.font = '12px Inter';\r\n            this.ctx.textAlign = 'left';\r\n            this.ctx.textBaseline = 'middle';\r\n        \r\n        // Draw older stacks at the bottom with more subtle styling\r\n        for (let i = 0; i < this.callStack.length; i++) {\r\n            const frame = this.callStack[i];\r\n            const func = this.program.functions[frame.functionIndex];\r\n            const y = this.stackPanel.y + 50 + (this.callStack.length - i) * 22; // Compact spacing\r\n            \r\n            // Stack frame background - more subtle\r\n            this.ctx.fillStyle = 'rgba(52, 152, 219, 0.3)';\r\n            this.ctx.fillRect(this.stackPanel.x + 10, y - 12, this.stackPanel.width - 20, 20);\r\n            \r\n            // Stack frame border with rounded corners\r\n            this.ctx.strokeStyle = '#3498db';\r\n            this.ctx.lineWidth = 1;\r\n            this.roundRect(this.stackPanel.x + 10, y - 12, this.stackPanel.width - 20, 20, 6);\r\n            this.ctx.stroke();\r\n            \r\n            // Function name and return address on one line\r\n            this.ctx.fillStyle = '#FFFFFF';\r\n            this.ctx.font = '11px Inter';\r\n            this.ctx.fillText(`${func.name} (PC: 0x${frame.returnAddress.toString(16)})`, this.stackPanel.x + 15, y + 2);\r\n        }\r\n        \r\n        // Current function at top with subtle highlighting\r\n        const currentFunc = this.program.functions[this.currentFunction];\r\n        const currentY = this.stackPanel.y + 50;\r\n        \r\n        // Current frame background - subtle highlight\r\n        this.ctx.fillStyle = 'rgba(78, 205, 196, 0.4)';\r\n        this.ctx.fillRect(this.stackPanel.x + 10, currentY - 12, this.stackPanel.width - 20, 20);\r\n        \r\n        // Current function border with rounded corners\r\n        this.ctx.strokeStyle = '#4ECDC4';\r\n        this.ctx.lineWidth = 1;\r\n        this.roundRect(this.stackPanel.x + 10, currentY - 12, this.stackPanel.width - 20, 20, 6);\r\n        this.ctx.stroke();\r\n        \r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.font = 'bold 11px Inter';\r\n        this.ctx.fillText(`${currentFunc.name} (current)`, this.stackPanel.x + 15, currentY + 2);\r\n    }\r\n    \r\n    drawHeapPanel() {\r\n        // Heap panel background with shadow\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.fillRect(this.heapPanel.x + 3, this.heapPanel.y + 3, this.heapPanel.width, this.heapPanel.height);\r\n        \r\n        // Heap panel background with gradient\r\n        const gradient = this.ctx.createLinearGradient(this.heapPanel.x, this.heapPanel.y, this.heapPanel.x, this.heapPanel.y + this.heapPanel.height);\r\n        gradient.addColorStop(0, 'rgba(26, 26, 46, 0.95)');\r\n        gradient.addColorStop(1, 'rgba(26, 26, 46, 0.9)');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(this.heapPanel.x, this.heapPanel.y, this.heapPanel.width, this.heapPanel.height);\r\n        \r\n        // Enhanced border with rounded corners and gradient\r\n        this.ctx.shadowColor = '#2ecc71';\r\n        this.ctx.shadowBlur = 10;\r\n        this.ctx.lineWidth = 3;\r\n        \r\n        // Create gradient border\r\n        const heapBorderGradient = this.ctx.createLinearGradient(\r\n            this.heapPanel.x, this.heapPanel.y, \r\n            this.heapPanel.x + this.heapPanel.width, this.heapPanel.y + this.heapPanel.height\r\n        );\r\n        heapBorderGradient.addColorStop(0, '#2ecc71');\r\n        heapBorderGradient.addColorStop(0.5, '#27ae60');\r\n        heapBorderGradient.addColorStop(1, '#2ecc71');\r\n        \r\n        this.ctx.strokeStyle = heapBorderGradient;\r\n        this.roundRect(this.heapPanel.x, this.heapPanel.y, this.heapPanel.width, this.heapPanel.height, 12);\r\n        this.ctx.stroke();\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Title with crisp font rendering - positioned outside the box\r\n        this.ctx.fillStyle = '#2ecc71';\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('🗑️ Heap Memory', this.heapPanel.x + 15, this.heapPanel.y - 10);\r\n        \r\n        // Draw memory grid for better organization\r\n        this.drawMemoryGrid();\r\n        \r\n        // Draw allocated blocks with enhanced styling\r\n        for (const block of this.heapBlocks) {\r\n            // Enhanced block shadow with depth and blur\r\n            this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n            this.ctx.shadowBlur = 8;\r\n            this.ctx.fillStyle = 'rgba(0, 0, 0, 0.4)';\r\n            this.ctx.fillRect(block.x + 4, block.y + 4, block.width, block.height);\r\n            this.ctx.shadowBlur = 0;\r\n            \r\n            // Block with modern gradient and glow\r\n            const blockGradient = this.ctx.createLinearGradient(block.x, block.y, block.x, block.y + block.height);\r\n            blockGradient.addColorStop(0, '#4ECDC4');\r\n            blockGradient.addColorStop(0.3, '#2ecc71');\r\n            blockGradient.addColorStop(0.7, '#27ae60');\r\n            blockGradient.addColorStop(1, '#229954');\r\n            this.ctx.fillStyle = blockGradient;\r\n            this.ctx.fillRect(block.x, block.y, block.width, block.height);\r\n            \r\n            // Enhanced block border with rounded corners and glow\r\n            this.ctx.shadowColor = '#4ECDC4';\r\n            this.ctx.shadowBlur = 8;\r\n            this.ctx.lineWidth = 2;\r\n            \r\n            // Create gradient border for memory blocks\r\n            const blockBorderGradient = this.ctx.createLinearGradient(\r\n                block.x, block.y, \r\n                block.x + block.width, block.y + block.height\r\n            );\r\n            blockBorderGradient.addColorStop(0, '#FFFFFF');\r\n            blockBorderGradient.addColorStop(0.5, '#4ECDC4');\r\n            blockBorderGradient.addColorStop(1, '#FFFFFF');\r\n            \r\n            this.ctx.strokeStyle = blockBorderGradient;\r\n            this.roundRect(block.x, block.y, block.width, block.height, 6);\r\n            this.ctx.stroke();\r\n            this.ctx.shadowBlur = 0;\r\n            \r\n            // Add inner highlight for 3D effect\r\n            const innerGradient = this.ctx.createLinearGradient(block.x, block.y, block.x, block.y + block.height * 0.3);\r\n            innerGradient.addColorStop(0, 'rgba(255, 255, 255, 0.3)');\r\n            innerGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\r\n            this.ctx.fillStyle = innerGradient;\r\n            this.ctx.fillRect(block.x, block.y, block.width, block.height * 0.3);\r\n            \r\n            // Block label with crisp font rendering and better contrast\r\n            this.ctx.fillStyle = '#000000';\r\n            const fontSize = Math.max(8, Math.min(12, block.width / 8));\r\n            this.ctx.font = `bold ${fontSize}px Inter`;\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.textBaseline = 'middle';\r\n            this.ctx.fillText(block.name, block.x + block.width / 2, block.y + block.height / 2 - 8);\r\n            \r\n            // Size label with smaller font\r\n            const sizeFontSize = Math.max(7, Math.min(10, block.width / 10));\r\n            this.ctx.font = `bold ${sizeFontSize}px Inter`;\r\n            this.ctx.fillText(`${block.size}B`, block.x + block.width / 2, block.y + block.height / 2 + 2);\r\n            \r\n            // Address label with smallest font\r\n            this.ctx.fillStyle = '#1a1a1a';\r\n            const addrFontSize = Math.max(6, Math.min(8, block.width / 12));\r\n            this.ctx.font = `bold ${addrFontSize}px Inter`;\r\n            this.ctx.fillText(`0x${block.address.toString(16)}`, block.x + block.width / 2, block.y + block.height / 2 + 12);\r\n        }\r\n        \r\n        // Draw free blocks with improved styling\r\n        for (const block of this.freeBlocks) {\r\n            // Free block shadow\r\n            this.ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';\r\n            this.ctx.fillRect(block.x + 2, block.y + 2, block.width, block.height);\r\n            \r\n            // Free block background with gradient\r\n            const freeGradient = this.ctx.createLinearGradient(block.x, block.y, block.x, block.y + block.height);\r\n            freeGradient.addColorStop(0, 'rgba(46, 204, 113, 0.3)');\r\n            freeGradient.addColorStop(1, 'rgba(46, 204, 113, 0.1)');\r\n            this.ctx.fillStyle = freeGradient;\r\n            this.ctx.fillRect(block.x, block.y, block.width, block.height);\r\n            \r\n            // Free block border\r\n            this.ctx.strokeStyle = '#2ecc71';\r\n            this.ctx.lineWidth = 1;\r\n            this.ctx.setLineDash([5, 5]);\r\n            this.ctx.strokeRect(block.x, block.y, block.width, block.height);\r\n            this.ctx.setLineDash([]);\r\n            \r\n            // Free label with better styling\r\n            this.ctx.fillStyle = '#2ecc71';\r\n            this.ctx.font = 'bold 9px Inter';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.fillText(`FREE (${block.size}B)`, block.x + block.width / 2, block.y + block.height / 2);\r\n            \r\n            // Show address for larger free blocks\r\n            if (block.size >= 512) {\r\n                this.ctx.font = '8px Inter';\r\n                this.ctx.fillText(`0x${block.address.toString(16)}`, block.x + block.width / 2, block.y + block.height / 2 + 12);\r\n            }\r\n        }\r\n        \r\n        // Draw memory usage indicator\r\n        this.drawMemoryUsageIndicator();\r\n    }\r\n    \r\n    drawOutputPanel() {\r\n        // Only draw output if showOutput is true\r\n        if (!this.showOutput) return;\r\n        \r\n        // Output panel background\r\n        this.ctx.fillStyle = 'rgba(26, 26, 46, 0.9)';\r\n        this.ctx.fillRect(this.outputPanel.x, this.outputPanel.y, this.outputPanel.width, this.outputPanel.height);\r\n        this.ctx.strokeStyle = '#F39C12';\r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeRect(this.outputPanel.x, this.outputPanel.y, this.outputPanel.width, this.outputPanel.height);\r\n        \r\n        // Title\r\n        this.ctx.fillStyle = '#F39C12';\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillText('📤 Program Output', this.outputPanel.x + 10, this.outputPanel.y + 25);\r\n        \r\n        // Draw output lines\r\n        this.ctx.font = '11px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.fillStyle = '#FFFFFF';\r\n        \r\n        const startIndex = Math.max(0, this.output.length - 8);\r\n        for (let i = startIndex; i < this.output.length; i++) {\r\n            const output = this.output[i];\r\n            const y = this.outputPanel.y + 45 + (i - startIndex) * 18;\r\n            this.ctx.fillText(output, this.outputPanel.x + 10, y);\r\n        }\r\n    }\r\n    \r\n    drawExecutionPointer() {\r\n        if (this.highlightedLine >= 0) {\r\n            const currentFunc = this.program.functions[this.currentFunction];\r\n            const y = this.codePanel.y + 70 + this.highlightedLine * 22;\r\n            \r\n            // Simple flashing circle around the line\r\n            const pulse = Math.sin(this.animationTime * 8) * 0.6 + 0.4;\r\n            \r\n            // Flashing circle\r\n            this.ctx.strokeStyle = `rgba(255, 215, 0, ${pulse})`;\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(this.codePanel.x + 15, y - 5, 12, 0, Math.PI * 2);\r\n            this.ctx.stroke();\r\n            \r\n            // Yellow circle\r\n            this.ctx.fillStyle = '#FFD700';\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(this.codePanel.x + 15, y - 5, 6, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n    \r\n    drawExecutionTrail() {\r\n        // Draw execution trail showing the path of execution\r\n        for (let i = 0; i < this.executionTrail.length - 1; i++) {\r\n            const current = this.executionTrail[i];\r\n            const next = this.executionTrail[i + 1];\r\n            const alpha = 1 - (current.time / current.duration);\r\n            \r\n            // Enhanced trail with glow effect\r\n            this.ctx.shadowColor = '#FFD700';\r\n            this.ctx.shadowBlur = 4;\r\n            this.ctx.strokeStyle = `rgba(255, 215, 0, ${alpha * 0.6})`;\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(current.x, current.y);\r\n            this.ctx.lineTo(next.x, next.y);\r\n            this.ctx.stroke();\r\n            \r\n            // Draw trail dots with glow\r\n            this.ctx.fillStyle = `rgba(255, 215, 0, ${alpha * 0.8})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(current.x, current.y, 3, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            this.ctx.shadowBlur = 0;\r\n        }\r\n    }\r\n    \r\n    drawMemoryAccesses() {\r\n        for (const access of this.memoryAccesses) {\r\n            const alpha = 1 - (access.time / access.duration);\r\n            const block = this.heapBlocks.find(b => b.address === access.address);\r\n            \r\n            if (block) {\r\n                // Highlight the accessed block\r\n                this.ctx.fillStyle = `rgba(${access.type === 'allocation' ? '78, 205, 196' : \r\n                                           access.type === 'deallocation' ? '255, 107, 107' : \r\n                                           '255, 215, 0'}, ${alpha * 0.5})`;\r\n                this.ctx.fillRect(block.x - 2, block.y - 2, block.width + 4, block.height + 4);\r\n                \r\n                // Access indicator\r\n                this.ctx.fillStyle = `rgba(${access.type === 'allocation' ? '78, 205, 196' : \r\n                                           access.type === 'deallocation' ? '255, 107, 107' : \r\n                                           '255, 215, 0'}, ${alpha})`;\r\n                this.ctx.beginPath();\r\n                this.ctx.arc(block.x + block.width / 2, block.y + block.height / 2, 8, 0, Math.PI * 2);\r\n                this.ctx.fill();\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawAddressHighlights() {\r\n        for (const highlight of this.addressHighlights) {\r\n            const alpha = 1 - (highlight.time / highlight.duration);\r\n            const block = this.heapBlocks.find(b => b.address === highlight.address);\r\n            \r\n            if (block) {\r\n                // Address highlight\r\n                this.ctx.strokeStyle = `rgba(${highlight.type === 'allocation' ? '78, 205, 196' : '255, 107, 107'}, ${alpha})`;\r\n                this.ctx.lineWidth = 3;\r\n                this.ctx.setLineDash([5, 5]);\r\n                this.ctx.strokeRect(block.x - 5, block.y - 5, block.width + 10, block.height + 10);\r\n                this.ctx.setLineDash([]);\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawVariableConnections() {\r\n        for (const connection of this.variableConnections) {\r\n            const alpha = 1 - (connection.time / connection.duration);\r\n            \r\n            // Draw animated connection line\r\n            this.ctx.strokeStyle = `rgba(78, 205, 196, ${alpha * 0.8})`;\r\n            this.ctx.lineWidth = 2;\r\n            this.ctx.setLineDash([10, 5]);\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(connection.from.x, connection.from.y);\r\n            this.ctx.lineTo(connection.to.x, connection.to.y);\r\n            this.ctx.stroke();\r\n            this.ctx.setLineDash([]);\r\n            \r\n            // Draw variable name\r\n            this.ctx.fillStyle = `rgba(78, 205, 196, ${alpha})`;\r\n            this.ctx.font = 'bold 10px Inter';\r\n        this.ctx.textAlign = 'center';\r\n            const midX = (connection.from.x + connection.to.x) / 2;\r\n            const midY = (connection.from.y + connection.to.y) / 2;\r\n            this.ctx.fillText(connection.varName, midX, midY - 5);\r\n        }\r\n    }\r\n    \r\n    drawMemoryFragmentation() {\r\n        for (const frag of this.memoryFragmentation) {\r\n            const alpha = 1 - (frag.time / frag.duration);\r\n            const size = frag.size * alpha * 0.01;\r\n            \r\n            // Draw fragmentation indicator\r\n            this.ctx.fillStyle = `rgba(255, 107, 107, ${alpha * 0.6})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(frag.x, frag.y, size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Draw fragmentation text\r\n            this.ctx.fillStyle = `rgba(255, 107, 107, ${alpha})`;\r\n            this.ctx.font = 'bold 8px Inter';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.fillText('FRAG', frag.x, frag.y + 15);\r\n        }\r\n        \r\n        // Draw memory layout visualization\r\n        this.drawMemoryLayout();\r\n    }\r\n    \r\n    drawMemoryGrid() {\r\n        // Draw a subtle grid to help organize memory blocks\r\n        const gridSpacing = 40;\r\n        const startX = this.heapPanel.x + 20;\r\n        const startY = this.heapPanel.y + 40;\r\n        const endX = this.heapPanel.x + this.heapPanel.width - 20;\r\n        const endY = this.heapPanel.y + this.heapPanel.height - 50;\r\n        \r\n        this.ctx.strokeStyle = 'rgba(46, 204, 113, 0.1)';\r\n        this.ctx.lineWidth = 1;\r\n        \r\n        // Vertical grid lines\r\n        for (let x = startX; x <= endX; x += gridSpacing) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(x, startY);\r\n            this.ctx.lineTo(x, endY);\r\n            this.ctx.stroke();\r\n        }\r\n        \r\n        // Horizontal grid lines\r\n        for (let y = startY; y <= endY; y += gridSpacing) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(startX, y);\r\n            this.ctx.lineTo(endX, y);\r\n            this.ctx.stroke();\r\n        }\r\n    }\r\n    \r\n    drawMemoryUsageIndicator() {\r\n        // Draw memory usage bar at the bottom\r\n        const usageX = this.heapPanel.x + 20;\r\n        const usageY = this.heapPanel.y + this.heapPanel.height - 30;\r\n        const usageWidth = this.heapPanel.width - 40;\r\n        const usageHeight = 15;\r\n        \r\n        // Background\r\n            this.ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.fillRect(usageX, usageY, usageWidth, usageHeight);\r\n        \r\n        // Usage bar\r\n        const usagePercent = (this.currentMemoryUsage / 8192) * 100;\r\n        const barWidth = (usageWidth * usagePercent) / 100;\r\n        \r\n        const barGradient = this.ctx.createLinearGradient(usageX, usageY, usageX + barWidth, usageY);\r\n        barGradient.addColorStop(0, '#2ecc71');\r\n        barGradient.addColorStop(1, '#27ae60');\r\n        this.ctx.fillStyle = barGradient;\r\n        this.ctx.fillRect(usageX, usageY, barWidth, usageHeight);\r\n        \r\n        // Border\r\n        this.ctx.strokeStyle = '#2ecc71';\r\n        this.ctx.lineWidth = 1;\r\n        this.ctx.strokeRect(usageX, usageY, usageWidth, usageHeight);\r\n        \r\n        // Usage text\r\n            this.ctx.fillStyle = '#FFFFFF';\r\n        this.ctx.font = 'bold 10px Inter';\r\n            this.ctx.textAlign = 'center';\r\n        this.ctx.fillText(`${this.currentMemoryUsage}/${8192} bytes (${usagePercent.toFixed(1)}%)`, \r\n            usageX + usageWidth / 2, usageY + usageHeight / 2 + 3);\r\n    }\r\n    \r\n    drawMemoryLayout() {\r\n        // Draw a memory layout bar at the bottom of the heap panel\r\n        const layoutY = this.heapPanel.y + this.heapPanel.height - 15;\r\n        const layoutHeight = 10;\r\n        const layoutX = this.heapPanel.x + 20;\r\n        const layoutWidth = this.heapPanel.width - 40;\r\n        \r\n        // Background\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\r\n        this.ctx.fillRect(layoutX, layoutY, layoutWidth, layoutHeight);\r\n        \r\n        // Draw allocated memory segments\r\n        for (const block of this.heapBlocks) {\r\n            const segmentX = layoutX + (block.address - 0x1000) / 8192 * layoutWidth;\r\n            const segmentWidth = (block.size / 8192) * layoutWidth;\r\n            \r\n            this.ctx.fillStyle = '#2ecc71';\r\n            this.ctx.fillRect(segmentX, layoutY, segmentWidth, layoutHeight);\r\n            \r\n            // Add border\r\n            this.ctx.strokeStyle = '#FFFFFF';\r\n            this.ctx.lineWidth = 1;\r\n            this.ctx.strokeRect(segmentX, layoutY, segmentWidth, layoutHeight);\r\n        }\r\n        \r\n        // Draw fragmentation indicators\r\n        const fragmentedBlocks = this.calculateFragmentedFreeBlocks();\r\n        for (const fragBlock of fragmentedBlocks) {\r\n            if (fragBlock.size >= 256) {\r\n                const fragX = layoutX + (fragBlock.address - 0x1000) / 8192 * layoutWidth;\r\n                const fragWidth = (fragBlock.size / 8192) * layoutWidth;\r\n                \r\n                this.ctx.fillStyle = 'rgba(255, 107, 107, 0.6)';\r\n                this.ctx.fillRect(fragX, layoutY, fragWidth, layoutHeight);\r\n            }\r\n        }\r\n    }\r\n    \r\n    drawParticles() {\r\n        for (const particle of this.particles) {\r\n            let size = particle.size || 3;\r\n            let alpha = particle.life;\r\n            \r\n            // Enhanced special handling for different particle types\r\n            if (particle.type === 'memory_clear') {\r\n                size = 4;\r\n                alpha = particle.life * 0.8;\r\n            } else if (particle.type === 'data_clear') {\r\n                size = 2;\r\n                alpha = particle.life * 0.6;\r\n            } else if (particle.type === 'allocation') {\r\n                size = particle.size || 4;\r\n                alpha = particle.life * 0.9;\r\n            } else if (particle.type === 'allocation_float') {\r\n                size = 2;\r\n                alpha = particle.life * 0.7;\r\n                // Add sparkle effect for floating particles\r\n                this.ctx.shadowColor = '#4ECDC4';\r\n                this.ctx.shadowBlur = 5;\r\n            } else if (particle.type === 'deallocation') {\r\n                size = particle.size || 5;\r\n                alpha = particle.life * 0.8;\r\n            } else if (particle.type === 'deallocation_fall') {\r\n                size = 3;\r\n                alpha = particle.life * 0.6;\r\n            } else if (particle.type === 'deallocation_implosion') {\r\n                size = 2;\r\n                alpha = particle.life * 0.5;\r\n                // Add implosion effect\r\n                this.ctx.shadowColor = '#FF6B6B';\r\n                this.ctx.shadowBlur = 3;\r\n            } else if (particle.type === 'completion') {\r\n                size = 6;\r\n                alpha = particle.life * 0.9;\r\n                // Add celebration effect\r\n                this.ctx.shadowColor = '#FFD700';\r\n                this.ctx.shadowBlur = 8;\r\n            }\r\n            \r\n            this.ctx.fillStyle = `rgba(${particle.color === '#4ECDC4' ? '78, 205, 196' : \r\n                                       particle.color === '#FF6B6B' ? '255, 107, 107' : \r\n                                       particle.color === '#F39C12' ? '243, 156, 18' :\r\n                                       particle.color === '#3498db' ? '52, 152, 219' :\r\n                                       particle.color === '#FFD700' ? '255, 215, 0' :\r\n                                       '231, 76, 60'}, ${alpha})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(particle.x, particle.y, size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n            \r\n            // Reset shadow\r\n            this.ctx.shadowBlur = 0;\r\n        }\r\n    }\r\n    \r\n    drawDataFlowParticles() {\r\n        for (const particle of this.dataFlowParticles) {\r\n            this.ctx.fillStyle = `rgba(255, 215, 0, ${particle.life})`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(particle.x, particle.y, 2, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n    \r\n    drawAllocationEffects() {\r\n        // Draw growing effects for new allocations\r\n        for (const effect of this.allocationEffects) {\r\n            const progress = effect.time / effect.duration;\r\n            const scale = 0.5 + progress * 0.5; // Start at 50% size, grow to 100%\r\n            \r\n            this.ctx.save();\r\n            this.ctx.globalAlpha = 1 - progress;\r\n            this.ctx.fillStyle = '#4ECDC4';\r\n            this.ctx.fillRect(\r\n                effect.block.x - (effect.block.width * scale - effect.block.width) / 2,\r\n                effect.block.y - (effect.block.height * scale - effect.block.height) / 2,\r\n                effect.block.width * scale,\r\n                effect.block.height * scale\r\n            );\r\n            this.ctx.restore();\r\n        }\r\n        \r\n        // Draw shrinking effects for deallocations\r\n        for (const effect of this.deallocationEffects) {\r\n            const progress = effect.time / effect.duration;\r\n            const scale = 1 - progress * 0.5; // Start at 100% size, shrink to 50%\r\n            \r\n            this.ctx.save();\r\n            this.ctx.globalAlpha = 1 - progress;\r\n            this.ctx.fillStyle = '#FF6B6B';\r\n            this.ctx.fillRect(\r\n                effect.block.x - (effect.block.width * scale - effect.block.width) / 2,\r\n                effect.block.y - (effect.block.height * scale - effect.block.height) / 2,\r\n                effect.block.width * scale,\r\n                effect.block.height * scale\r\n            );\r\n            this.ctx.restore();\r\n        }\r\n    }\r\n    \r\n    drawGarbageCollectionEffects() {\r\n        // Draw GC particles\r\n        for (const particle of this.gcState.gcParticles) {\r\n            const alpha = particle.life;\r\n            \r\n            this.ctx.fillStyle = `${particle.color}${Math.floor(alpha * 255).toString(16).padStart(2, '0')}`;\r\n            this.ctx.beginPath();\r\n            this.ctx.arc(particle.x, particle.y, 2, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n        \r\n        // Draw GC phase indicator\r\n        if (this.gcState.isRunning) {\r\n            const phase = this.gcState.phase === 'mark' ? 'Mark Phase' : 'Sweep Phase';\r\n            const color = this.gcState.phase === 'mark' ? '#FFD700' : '#FF6B6B';\r\n            \r\n            this.ctx.fillStyle = color;\r\n            this.ctx.font = 'bold 14px Inter';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.fillText(`🗑️ ${phase}`, this.canvas.width / 2, 30);\r\n        }\r\n    }\r\n    \r\n    drawStatistics() {\r\n        // Only draw stats if showStats is true\r\n        if (!this.showStats) return;\r\n        \r\n        // Enhanced statistics panel with performance metrics - positioned in bottom right\r\n        const statsX = this.canvas.width - 390;\r\n        const statsY = this.canvas.height - 170;\r\n        \r\n        // Enhanced panel background with shadow and gradient\r\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.6)';\r\n        this.ctx.fillRect(statsX + 4, statsY + 4, 380, 160);\r\n        \r\n        const gradient = this.ctx.createLinearGradient(statsX, statsY, statsX, statsY + 160);\r\n        gradient.addColorStop(0, 'rgba(26, 26, 46, 0.98)');\r\n        gradient.addColorStop(0.3, 'rgba(26, 26, 46, 0.95)');\r\n        gradient.addColorStop(0.7, 'rgba(26, 26, 46, 0.92)');\r\n        gradient.addColorStop(1, 'rgba(26, 26, 46, 0.88)');\r\n        this.ctx.fillStyle = gradient;\r\n        this.ctx.fillRect(statsX, statsY, 380, 160);\r\n        \r\n        // Enhanced border with rounded corners and gradient\r\n        this.ctx.shadowColor = '#4ECDC4';\r\n        this.ctx.shadowBlur = 12;\r\n        this.ctx.lineWidth = 3;\r\n        \r\n        // Create gradient border\r\n        const statsBorderGradient = this.ctx.createLinearGradient(\r\n            statsX, statsY, \r\n            statsX + 380, statsY + 160\r\n        );\r\n        statsBorderGradient.addColorStop(0, '#4ECDC4');\r\n        statsBorderGradient.addColorStop(0.5, '#2ECC71');\r\n        statsBorderGradient.addColorStop(1, '#4ECDC4');\r\n        \r\n        this.ctx.strokeStyle = statsBorderGradient;\r\n        this.roundRect(statsX, statsY, 380, 160, 12);\r\n        this.ctx.stroke();\r\n        this.ctx.shadowBlur = 0;\r\n        \r\n        // Add inner highlight for 3D effect\r\n        const innerGradient = this.ctx.createLinearGradient(statsX, statsY, statsX, statsY + 30);\r\n        innerGradient.addColorStop(0, 'rgba(78, 205, 196, 0.1)');\r\n        innerGradient.addColorStop(1, 'rgba(78, 205, 196, 0)');\r\n        this.ctx.fillStyle = innerGradient;\r\n        this.ctx.fillRect(statsX, statsY, 380, 30);\r\n        \r\n        // Title with crisp font rendering\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.font = 'bold 16px Inter';\r\n        this.ctx.textAlign = 'left';\r\n        this.ctx.textBaseline = 'middle';\r\n        this.ctx.fillText('📊 Program Execution Stats', statsX + 15, statsY + 22);\r\n        \r\n        this.ctx.font = '12px Inter';\r\n        this.ctx.textBaseline = 'middle';\r\n        \r\n        // Basic stats with icons and better spacing\r\n        this.ctx.fillStyle = '#4ECDC4';\r\n        this.ctx.fillText(`📦 Allocations: ${this.totalAllocations}`, statsX + 15, statsY + 45);\r\n        this.ctx.fillText(`🗑️ Deallocations: ${this.totalDeallocations}`, statsX + 15, statsY + 62);\r\n        this.ctx.fillText(`💾 Memory Usage: ${this.currentMemoryUsage} bytes`, statsX + 15, statsY + 79);\r\n        this.ctx.fillText(`🔍 Memory Accesses: ${this.memoryAccessCount}`, statsX + 15, statsY + 96);\r\n        \r\n        // Performance metrics with enhanced colors\r\n        this.ctx.fillStyle = '#FFD700';\r\n        this.ctx.fillText(`⚡ Execution Cycles: ${this.performanceMetrics.totalCycles}`, statsX + 15, statsY + 113);\r\n        this.ctx.fillText(`📈 Memory Efficiency: ${this.performanceMetrics.memoryEfficiency.toFixed(1)}%`, statsX + 15, statsY + 130);\r\n        this.ctx.fillText(`🔧 Fragmentation Level: ${this.performanceMetrics.fragmentationLevel.toFixed(1)}%`, statsX + 15, statsY + 147);\r\n        \r\n        // Memory leak warning with enhanced styling\r\n        if (this.memoryLeaks > 0) {\r\n            this.ctx.fillStyle = '#FF6B6B';\r\n            this.ctx.fillText(`⚠️ Memory Leaks: ${this.memoryLeaks}`, statsX + 15, statsY + 164);\r\n        } else {\r\n            this.ctx.fillStyle = '#4ECDC4';\r\n            this.ctx.fillText(`✅ No Memory Leaks`, statsX + 15, statsY + 164);\r\n        }\r\n        \r\n        // Performance indicator\r\n        const efficiency = this.performanceMetrics.memoryEfficiency;\r\n        const efficiencyColor = efficiency > 80 ? '#4ECDC4' : efficiency > 60 ? '#F39C12' : '#FF6B6B';\r\n        this.ctx.fillStyle = efficiencyColor;\r\n        this.ctx.fillText(`🎯 Performance: ${efficiency > 80 ? 'Excellent' : efficiency > 60 ? 'Good' : 'Poor'}`, statsX + 10, statsY + 160);\r\n    }\r\n    \r\n    roundRect(x, y, width, height, radius) {\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x + radius, y);\r\n        this.ctx.lineTo(x + width - radius, y);\r\n        this.ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\r\n        this.ctx.lineTo(x + width, y + height - radius);\r\n        this.ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\r\n        this.ctx.lineTo(x + radius, y + height);\r\n        this.ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\r\n        this.ctx.lineTo(x, y + radius);\r\n        this.ctx.quadraticCurveTo(x, y, x + radius, y);\r\n        this.ctx.closePath();\r\n    }\r\n    \r\n\r\n    \r\n\r\n    \r\n    handleClick(x, y) {\r\n        // Check if click is within the heap panel\r\n        if (x >= this.heapPanel.x && x <= this.heapPanel.x + this.heapPanel.width &&\r\n            y >= this.heapPanel.y && y <= this.heapPanel.y + this.heapPanel.height) {\r\n            \r\n            // Only trigger GC if it's not already running\r\n            if (!this.gcState.isRunning) {\r\n                this.runGarbageCollection();\r\n            }\r\n        }\r\n    }\r\n    \r\n    handleButtonClick(action) {\r\n        switch (action) {\r\n            case 'auto':\r\n                this.isAutoRunning = !this.isAutoRunning;\r\n                break;\r\n            case 'reset':\r\n                this.resetExecution();\r\n                break;\r\n            case 'step':\r\n                if (this.animationState === 'idle') {\r\n                    this.executeNextStep();\r\n                }\r\n                break;\r\n        }\r\n    }\r\n    \r\n    resetExecution() {\r\n        this.initializeExecution();\r\n        this.startExecution();\r\n        this.resetPerformanceMetrics();\r\n    }\r\n    \r\n    reset() {\r\n        this.initializeExecution();\r\n        this.startExecution();\r\n        this.resetPerformanceMetrics();\r\n    }\r\n    \r\n    resetPerformanceMetrics() {\r\n        this.performanceMetrics = {\r\n            totalCycles: 0,\r\n            memoryEfficiency: 100,\r\n            fragmentationLevel: 0,\r\n            averageAccessTime: 0\r\n        };\r\n        this.executionStep = 0;\r\n        this.totalAllocations = 0;\r\n        this.totalDeallocations = 0;\r\n        this.memoryLeaks = 0;\r\n        this.currentMemoryUsage = 0;\r\n        this.memoryAccessCount = 0;\r\n    }\r\n    \r\n    getStats() {\r\n        return {\r\n            totalAllocations: this.totalAllocations,\r\n            totalDeallocations: this.totalDeallocations,\r\n            memoryLeaks: this.memoryLeaks,\r\n            currentMemoryUsage: this.currentMemoryUsage,\r\n            memoryAccessCount: this.memoryAccessCount,\r\n            callStackDepth: this.callStack.length,\r\n            currentFunction: this.program.functions[this.currentFunction].name\r\n        };\r\n    }\r\n    \r\n    resize() {\r\n        // Recalculate panel positions based on new canvas size\r\n        const canvasWidth = this.canvas.width;\r\n        const canvasHeight = this.canvas.height;\r\n        \r\n        // Adjust panel positions for better responsiveness\r\n        this.codePanel = { x: 50, y: 50, width: Math.min(400, canvasWidth * 0.3), height: 300 };\r\n        this.stackPanel = { x: canvasWidth - 350, y: 50, width: 300, height: 300 };\r\n        this.heapPanel = { x: 50, y: 400, width: Math.max(750, canvasWidth - 100), height: 200 };\r\n        this.outputPanel = { x: canvasWidth - 350, y: 400, width: 300, height: 200 };\r\n        \r\n        // Update free blocks positions\r\n        this.updateFreeBlocks();\r\n    }\r\n} ","// Blockchain Animation - Enhanced with Realistic Concepts\nexport class Blockchain {\n    constructor(ctx) {\n        this.ctx = ctx;\n        this.canvas = ctx.canvas;\n        \n        // Blockchain properties\n        this.blocks = [];\n        this.pendingTransactions = [];\n        this.miners = [];\n        this.networkNodes = [];\n        this.consensus = 'proof-of-work';\n        \n        // Animation properties\n        this.speed = 1.0;\n        // Block hashes are always visible\n        this.showHashes = true;\n        // Network and auto mining are always enabled\n        this.showNetwork = true;\n        this.autoMine = true;\n        \n        // Enhanced visual properties - improved sizing and positioning\n        this.blockWidth = 160; // Increased for better text spacing\n        this.blockHeight = 110; // Increased height for better text layout\n        this.blockSpacing = 40; // Increased spacing\n        this.chainStartX = 40; // Pushed to the left\n        this.chainStartY = 180; // Moved up for better balance\n        this.maxBlocksVisible = 12;\n        this.scrollOffset = 0;\n        \n        // Realistic mining properties\n        this.difficulty = 4;\n        this.targetHash = '0'.repeat(this.difficulty);\n        this.currentNonce = 0;\n        this.miningBlock = null;\n        this.isMining = false;\n        this.blockReward = 50; // Block reward in tokens\n        this.transactionFee = 0.1; // Transaction fee\n        \n        // Dynamic difficulty adjustment\n        this.targetBlockTime = 10000; // 10 seconds target\n        this.difficultyAdjustmentInterval = 10; // Adjust every 10 blocks\n        this.lastDifficultyAdjustment = 0;\n        this.blockTimes = []; // Track block times for difficulty adjustment\n        \n        // Network properties - improved positioning\n        this.nodeCount = 8; // More nodes for realistic network\n        this.nodeRadius = 25; // Slightly larger nodes\n        this.networkCenterX = 0;\n        this.networkCenterY = 0;\n        \n        // Dynamic network properties\n        this.maxNodes = 8; // Reduced for cleaner demo\n        this.minNodes = 6; // Minimum number of nodes\n        this.nodeJoinInterval = 10000; // Increased time between joins\n        this.nodeLeaveInterval = 15000; // Increased time between leaves\n        this.lastNodeJoin = 0;\n        this.lastNodeLeave = 0;\n        this.nodeJoinParticles = [];\n        this.nodeLeaveParticles = [];\n        this.nodeRedistributionTimer = 0;\n        this.redistributionInterval = 2000; // Time to wait before redistributing nodes\n        \n        // Enhanced transaction properties\n        this.transactionTypes = ['transfer', 'smart_contract', 'token_mint', 'stake'];\n        this.transactionColors = {\n            transfer: '#4CAF50',\n            smart_contract: '#2196F3',\n            token_mint: '#FF9800',\n            stake: '#9C27B0'\n        };\n        \n        // Animation state\n        this.animationPhase = 'idle';\n        this.phaseTime = 0;\n        this.phaseDuration = 3.0;\n        this.guidedMode = true;\n        this.phaseSteps = ['mining_success', 'validation', 'propagation', 'consensus', 'finalization'];\n        this.currentStep = 0;\n        this.stepDuration = 0.2; // Reduced for faster transitions\n        \n        // Enhanced particles and effects\n        this.miningParticles = [];\n        this.validationParticles = [];\n        this.networkParticles = [];\n        this.propagationArrows = [];\n        this.contractExecutionParticles = [];\n        this.blockCreationParticles = [];\n        this.hashCalculationParticles = [];\n        this.consensusParticles = [];\n        this.finalizationParticles = [];\n        this.rewardParticles = []; // New: block reward particles\n        this.rejectionParticles = []; // New: block rejection particles\n        \n        // Visual effects\n        this.blockGlow = 0;\n        this.miningGlow = 0;\n        this.networkPulse = 0;\n        this.chainPulse = 0; // New: chain pulse effect\n        \n        // Enhanced statistics\n        this.totalBlocks = 0;\n        this.totalTransactions = 0;\n        this.totalRewards = 0;\n        this.consensusTime = 0;\n        this.networkHashrate = 0;\n        this.averageBlockTime = 0;\n        this.lastBlockTimes = []; // Track last 10 block times\n        \n        // Mining success tracking\n        this.successfulMiner = null; // Track which miner found the block\n        this.minerBlockConnection = null; // Visual connection between miner and block\n        this.minerRewardDisplay = null; // Display miner's reward\n        \n        // Animation timing\n        this.lastBlockTime = 0;\n        this.blockInterval = 3000; // 3 seconds for more realistic timing\n        \n        // Mining cycle control\n        this.isStartingMining = false; // Prevent multiple mining start attempts\n        \n        // Consensus tracking\n        this.consensusCompleted = false;\n        this.consensusDecisions = 0;\n        \n        this.initializeBlockchain();\n        this.initializeNetwork();\n        this.startGenesisBlock();\n    }\n    \n    initializeBlockchain() {\n        // Create genesis block with realistic blockchain data\n        const genesisBlock = {\n            index: 0,\n            timestamp: Date.now(),\n            transactions: [\n                { \n                    id: 'genesis_1',\n                    from: 'Genesis', \n                    to: 'Alice', \n                    amount: 1000, \n                    type: 'token_mint', \n                    color: '#FF9800',\n                    fee: 0,\n                    description: 'Initial token distribution'\n                },\n                { \n                    id: 'genesis_2',\n                    from: 'Genesis', \n                    to: 'Bob', \n                    amount: 500, \n                    type: 'token_mint', \n                    color: '#FF9800',\n                    fee: 0,\n                    description: 'Initial token distribution'\n                },\n                { \n                    id: 'genesis_3',\n                    from: 'Genesis', \n                    to: 'Charlie', \n                    amount: 250, \n                    type: 'token_mint', \n                    color: '#FF9800',\n                    fee: 0,\n                    description: 'Initial token distribution'\n                }\n            ],\n            previousHash: '0000000000000000000000000000000000000000000000000000000000000000',\n            hash: '',\n            nonce: 0,\n            merkleRoot: '',\n            isGenesis: true,\n            creationTime: 0,\n            glowIntensity: 1.0,\n            blockReward: 0, // Genesis has no reward\n            totalFees: 0\n        };\n        \n        genesisBlock.merkleRoot = this.calculateMerkleRoot(genesisBlock.transactions);\n        genesisBlock.hash = this.calculateBlockHash(genesisBlock);\n        \n        this.blocks.push(genesisBlock);\n        this.totalBlocks = 1;\n        this.totalTransactions = 3;\n        \n        // Add realistic pending transactions\n        this.addPendingTransaction('Alice', 'Bob', 50, 'transfer', 'Payment for services');\n        this.addPendingTransaction('Bob', 'Charlie', 25, 'transfer', 'Coffee payment');\n        this.addPendingTransaction('Alice', 'Contract', 10, 'smart_contract', 'DeFi interaction');\n        this.addPendingTransaction('Charlie', 'Staking', 100, 'stake', 'Staking tokens');\n        this.addPendingTransaction('Bob', 'David', 15, 'transfer', 'Lunch payment');\n        \n        // Initialize dynamic transaction generation\n        this.lastTransactionTime = Date.now();\n        this.transactionInterval = 3000; // Generate new transaction every 3 seconds\n        this.transactionTypes = ['transfer', 'smart_contract', 'token_mint', 'stake', 'swap', 'liquidity'];\n        this.transactionColors = {\n            transfer: '#4CAF50',\n            smart_contract: '#2196F3',\n            token_mint: '#FF9800',\n            stake: '#9C27B0',\n            swap: '#E91E63',\n            liquidity: '#00BCD4'\n        };\n        this.users = ['Alice', 'Bob', 'Charlie', 'David', 'Eve', 'Frank', 'Grace', 'Henry', 'Ivy', 'Jack'];\n        this.contracts = ['DeFi_Protocol', 'DEX_Exchange', 'Lending_Pool', 'Staking_Contract', 'Yield_Farm'];\n    }\n    \n    initializeNetwork() {\n        const canvasWidth = this.ctx.canvas.width;\n        const canvasHeight = this.ctx.canvas.height;\n        \n        this.networkCenterX = canvasWidth - 250; // Moved further from edge\n        this.networkCenterY = canvasHeight - 200; // Moved down more for better spacing\n        \n        // Create network nodes with enhanced design\n        this.networkNodes = [];\n        this.nextNodeId = 1; // Track the next available node ID\n        for (let i = 0; i < this.nodeCount; i++) {\n            const angle = (i / this.nodeCount) * 2 * Math.PI;\n            const radius = 120; // Increased radius for better spacing\n            const x = this.networkCenterX + Math.cos(angle) * radius;\n            const y = this.networkCenterY + Math.sin(angle) * radius;\n            \n            this.networkNodes.push({\n                id: this.nextNodeId++,\n                x: x,\n                y: y,\n                isMining: false,\n                isValidating: false,\n                lastBlock: null,\n                connectionStrength: Math.random() * 0.5 + 0.5,\n                color: `hsl(${i * 60}, 80%, 65%)`,\n                pulseIntensity: 0,\n                isActive: false\n            });\n        }\n        \n        // Create miners\n        this.miners = this.networkNodes.slice(0, 3);\n        this.miners.forEach(miner => {\n            miner.isMining = true;\n            miner.currentNonce = 0;\n            miner.targetHash = this.targetHash;\n            miner.isActive = true;\n        });\n    }\n    \n    startGenesisBlock() {\n        setTimeout(() => {\n            this.startMining();\n        }, 1000); // Reduced from 3000ms\n    }\n    \n    startGuidedBlockAddition(block) {\n        this.guidedBlock = block;\n        this.currentStep = 0;\n        this.phaseTime = 0;\n        this.animationPhase = 'mining_success';\n        \n        // Reset network nodes for guided mode\n        this.networkNodes.forEach(node => {\n            node.isValidating = false;\n            node.consensusReached = false;\n            node.pulseIntensity = 1.0;\n            node.color = '#2196F3'; // Blue for mining success\n        });\n        \n\n        \n        // Add phase indicator\n        this.guidedPhaseIndicator = {\n            text: 'Mining Success',\n            alpha: 1.0,\n            pulseIntensity: 1.0,\n            color: '#00FF88', // Bright green for mining success\n            y: 350 // Y position over network nodes\n        };\n        \n        // Continue to next step after a delay\n        setTimeout(() => this.nextGuidedStep(), 1000);\n    }\n    \n    nextGuidedStep() {\n        // Safety check - if no guided block, exit\n        if (!this.guidedBlock) {\n            this.animationPhase = 'idle';\n            this.guidedPhaseIndicator = null;\n            return;\n        }\n        \n        this.currentStep++;\n        this.phaseTime = 0;\n        \n\n        \n        if (this.currentStep >= this.phaseSteps.length) {\n            // Wait for consensus to complete before checking\n            if (this.animationPhase === 'consensus' && !this.consensusCompleted) {\n                // Consensus is still in progress, wait a bit more\n                setTimeout(() => this.nextGuidedStep(), 500);\n                return;\n            }\n            \n            // Check if consensus was reached before finalizing\n            const consensusNodes = this.networkNodes.filter(node => node.consensusReached);\n            const consensusThreshold = this.networkNodes.length * 0.6;\n            \n            if (consensusNodes.length >= consensusThreshold) {\n                // Consensus reached, finalize the block\n                this.finalizeBlock();\n            } else {\n                // Consensus not reached, call finalization step to handle rejection\n                this.startFinalizationStep();\n            }\n            return;\n        }\n        \n        // Start the current phase\n        const currentPhase = this.phaseSteps[this.currentStep - 1];\n        \n        switch (currentPhase) {\n            case 'validation':\n                this.startValidationStep();\n                break;\n            case 'propagation':\n                this.startPropagationStep();\n                break;\n            case 'consensus':\n                this.startConsensusStep();\n                break;\n            case 'finalization':\n                this.startFinalizationStep();\n                break;\n        }\n        \n        // Continue to next step - use shorter duration\n        setTimeout(() => this.nextGuidedStep(), 1500); // Reduced to 1.5 seconds for faster transitions\n    }\n    \n    startValidationStep() {\n        // Simulate network validation with enhanced visual effects\n        this.networkNodes.forEach(node => {\n            node.isValidating = true;\n            node.pulseIntensity = 1.0;\n            node.color = '#FF6B35'; // Orange for validation\n        });\n        \n        // Create validation particles with distinct color\n        this.createValidationParticles();\n        \n        // Add phase indicator\n        this.guidedPhaseIndicator = {\n            text: 'VALIDATION',\n            color: '#FF6B35',\n            alpha: 1.0,\n            y: 350\n        };\n    }\n    \n    startPropagationStep() {\n        // Create propagation arrows with enhanced visibility\n        // this.createPropagationArrows(); // Disabled arrows\n        \n        // Create broadcast particles with distinct color\n        this.createBroadcastParticles();\n        \n        // Change node colors to blue for propagation\n        this.networkNodes.forEach(node => {\n            node.color = '#4A90E2'; // Blue for propagation\n            node.pulseIntensity = 0.8;\n        });\n        \n        // Simulate network propagation with latency\n        this.broadcastBlockWithLatency();\n        \n        // Add phase indicator\n        this.guidedPhaseIndicator = {\n            text: 'PROPAGATION',\n            color: '#4A90E2',\n            alpha: 1.0,\n            y: 350\n        };\n    }\n    \n    startConsensusStep() {\n        \n        // Simulate consensus mechanism with network latency\n        this.consensusCompleted = false; // Track consensus completion\n        this.consensusDecisions = 0; // Track how many nodes have decided\n        \n        this.networkNodes.forEach((node, index) => {\n            node.isValidating = false;\n            node.pulseIntensity = 1.2;\n            node.color = '#9C27B0'; // Purple for consensus\n            \n            // Simulate network latency for consensus with realistic probability\n            const latency = Math.random() * 800 + 200; // 200-1000ms latency\n            const consensusProbability = 0.7; // 70% chance of reaching consensus\n            \n            setTimeout(() => {\n                // Only some nodes reach consensus (more realistic)\n                if (Math.random() < consensusProbability) {\n                    node.consensusReached = true;\n                    node.pulseIntensity = 1.5;\n                } else {\n                    node.consensusReached = false;\n                    node.pulseIntensity = 0.5;\n                }\n                \n                // Track consensus completion\n                this.consensusDecisions++;\n                \n                if (this.consensusDecisions >= this.networkNodes.length) {\n                    this.consensusCompleted = true;\n                }\n            }, latency);\n        });\n        \n        // Create consensus particles with distinct color\n        this.createConsensusParticles();\n        \n        // Add phase indicator\n        this.guidedPhaseIndicator = {\n            text: 'CONSENSUS',\n            color: '#9C27B0',\n            alpha: 1.0,\n            y: 350\n        };\n    }\n    \n    simulateNetworkLatency(callback, minDelay = 100, maxDelay = 1000) {\n        // Simulate realistic network latency\n        const latency = Math.random() * (maxDelay - minDelay) + minDelay;\n        setTimeout(callback, latency);\n    }\n    \n    broadcastBlockWithLatency() {\n        // Simulate realistic network propagation with latency\n        this.networkNodes.forEach((node, index) => {\n            const latency = Math.random() * 700 + 100; // 100-800ms latency\n            \n            setTimeout(() => {\n                node.receivedBlock = true;\n                node.isValidating = true;\n                node.pulseIntensity = 1.0;\n                \n                // Create propagation particles for this node\n                this.createNodePropagationParticles(node);\n            }, latency);\n        });\n    }\n    \n    createNodePropagationParticles(node) {\n        for (let i = 0; i < 5; i++) {\n            this.networkParticles.push({\n                x: node.x,\n                y: node.y,\n                vx: (Math.random() - 0.5) * 80,\n                vy: (Math.random() - 0.5) * 80,\n                life: 1.5,\n                maxLife: 1.5,\n                color: '#4A90E2', // Blue for propagation\n                size: 3\n            });\n        }\n    }\n    \n    startFinalizationStep() {\n        \n        // Prepare for finalization with enhanced effects\n        this.networkNodes.forEach(node => {\n            node.pulseIntensity = 1.5;\n            node.color = '#4CAF50'; // Green for finalization\n        });\n        \n        // Validate consensus reached\n        const consensusNodes = this.networkNodes.filter(node => node.consensusReached);\n        const consensusThreshold = this.networkNodes.length * 0.6; // 60% consensus threshold\n        \n        if (consensusNodes.length >= consensusThreshold) {\n            // Consensus reached, proceed with finalization\n            this.createFinalizationParticles();\n            \n            // Add phase indicator\n            this.guidedPhaseIndicator = {\n                text: 'Block Finalized',\n                alpha: 1.0,\n                pulseIntensity: 1.0,\n                color: '#4CAF50', // Green for finalization\n                y: 350 // Y position\n            };\n            \n            // Continue to next step - use shorter duration\n            setTimeout(() => this.nextGuidedStep(), 1000); // Reduced to 1 second for faster finalization\n        } else {\n            // Consensus not reached, reject the block\n            \n            // Create rejection particles\n            this.createRejectionParticles();\n            \n            // Add rejection phase indicator\n            this.guidedPhaseIndicator = {\n                text: 'BLOCK REJECTED',\n                alpha: 1.0,\n                pulseIntensity: 1.0,\n                color: '#FF5722', // Red for rejection\n                y: 350 // Y position\n            };\n            \n            // Reset network nodes to default colors and states\n            this.networkNodes.forEach(node => {\n                node.consensusReached = false;\n                node.isValidating = false;\n                node.pulseIntensity = 1.0;\n                node.color = '#2196F3'; // Default blue\n            });\n            \n            // Clear guided mode state and restart mining after a delay\n            setTimeout(() => {\n                this.guidedBlock = null;\n                this.guidedPhaseIndicator = null;\n                this.animationPhase = 'idle';\n                this.currentStep = 0;\n                \n                // Restart mining process\n                this.startMining();\n            }, 1000); // Reduced to 1 second for faster restart\n        }\n    }\n    \n    addNodeToNetwork() {\n        if (this.networkNodes.length >= this.maxNodes) return;\n        \n        // Calculate optimal position for new node\n        const targetPosition = this.calculateOptimalNodePosition();\n        \n        // Start from outside the canvas\n        const startX = this.networkCenterX + Math.cos(targetPosition.angle) * 300;\n        const startY = this.networkCenterY + Math.sin(targetPosition.angle) * 300;\n        \n        const newNode = {\n            id: this.nextNodeId++,\n            x: startX,\n            y: startY,\n            targetX: targetPosition.x,\n            targetY: targetPosition.y,\n            isMining: false,\n            isValidating: false,\n            lastBlock: null,\n            connectionStrength: Math.random() * 0.5 + 0.5,\n            color: `hsl(${this.networkNodes.length * 60}, 80%, 65%)`,\n            pulseIntensity: 0,\n            isActive: false,\n            isJoining: true,\n            joinProgress: 0,\n            joinSpeed: 0.08\n        };\n        \n        this.networkNodes.push(newNode);\n        \n        // Create join particles\n        this.createNodeJoinParticles(startX, startY);\n        \n        // Schedule redistribution after node joins\n        this.scheduleNodeRedistribution();\n    }\n    \n    removeNodeFromNetwork() {\n        if (this.networkNodes.length <= this.minNodes) return;\n        \n        // Find a non-mining node to remove\n        const removableNodes = this.networkNodes.filter(node => !node.isMining);\n        if (removableNodes.length === 0) return;\n        \n        const nodeToRemove = removableNodes[Math.floor(Math.random() * removableNodes.length)];\n        const index = this.networkNodes.indexOf(nodeToRemove);\n        \n        if (index !== -1) {\n            nodeToRemove.isLeaving = true;\n            nodeToRemove.leaveProgress = 0;\n            nodeToRemove.leaveSpeed = 0.12;\n            \n            // Create leave particles\n            this.createNodeLeaveParticles(nodeToRemove.x, nodeToRemove.y);\n            \n            // Remove the node after animation\n            setTimeout(() => {\n                this.networkNodes.splice(index, 1);\n                // Schedule redistribution after node leaves\n                this.scheduleNodeRedistribution();\n            }, 1000);\n        }\n    }\n    \n    createNodeJoinParticles(x, y) {\n        for (let i = 0; i < 15; i++) {\n            this.nodeJoinParticles.push({\n                x: x,\n                y: y,\n                vx: (Math.random() - 0.5) * 200,\n                vy: (Math.random() - 0.5) * 200,\n                life: 2.0,\n                maxLife: 2.0,\n                color: '#4CAF50',\n                size: 4\n            });\n        }\n    }\n    \n    createNodeLeaveParticles(x, y) {\n        for (let i = 0; i < 12; i++) {\n            this.nodeLeaveParticles.push({\n                x: x,\n                y: y,\n                vx: (Math.random() - 0.5) * 180,\n                vy: (Math.random() - 0.5) * 180,\n                life: 2.5,\n                maxLife: 2.5,\n                color: '#FF5722',\n                size: 3\n            });\n        }\n    }\n    \n    updateNodeJoinParticles(deltaTime) {\n        this.nodeJoinParticles.forEach((particle, index) => {\n            particle.life -= deltaTime;\n            \n            if (particle.life <= 0) {\n                this.nodeJoinParticles.splice(index, 1);\n                return;\n            }\n            \n            particle.x += particle.vx * deltaTime;\n            particle.y += particle.vy * deltaTime;\n            particle.vy += 20 * deltaTime; // Gravity\n        });\n    }\n    \n    updateNodeLeaveParticles(deltaTime) {\n        this.nodeLeaveParticles.forEach((particle, index) => {\n            particle.life -= deltaTime;\n            \n            if (particle.life <= 0) {\n                this.nodeLeaveParticles.splice(index, 1);\n                return;\n            }\n            \n            particle.x += particle.vx * deltaTime;\n            particle.y += particle.vy * deltaTime;\n            particle.vy += 25 * deltaTime; // Gravity\n        });\n    }\n    \n    calculateOptimalNodePosition() {\n        const radius = 120;\n        const nodeCount = this.networkNodes.length;\n        \n        // Calculate evenly spaced positions around the circle\n        const angleStep = (2 * Math.PI) / this.maxNodes;\n        const targetIndex = nodeCount;\n        const angle = targetIndex * angleStep;\n        \n        const x = this.networkCenterX + Math.cos(angle) * radius;\n        const y = this.networkCenterY + Math.sin(angle) * radius;\n        \n        return { x, y, angle };\n    }\n    \n    scheduleNodeRedistribution() {\n        // Reset redistribution timer\n        this.nodeRedistributionTimer = 0;\n    }\n    \n    redistributeNodes() {\n        const radius = 120;\n        const nodeCount = this.networkNodes.length;\n        \n        if (nodeCount === 0) return;\n        \n        // Calculate evenly spaced positions\n        const angleStep = (2 * Math.PI) / this.maxNodes;\n        \n        this.networkNodes.forEach((node, index) => {\n            if (!node.isJoining && !node.isLeaving) {\n                const targetAngle = index * angleStep;\n                const targetX = this.networkCenterX + Math.cos(targetAngle) * radius;\n                const targetY = this.networkCenterY + Math.sin(targetAngle) * radius;\n                \n                // Smoothly move to new position\n                node.targetX = targetX;\n                node.targetY = targetY;\n                node.isMoving = true;\n                node.moveSpeed = 0.10;\n                node.moveProgress = 0;\n            }\n        });\n    }\n    \n    finalizeBlockDirectly(block) {\n        \n        // Add the block to the chain\n        this.blocks.push(block);\n        this.totalBlocks++;\n        \n\n        \n        // Update total transactions\n        this.totalTransactions += block.transactions.length;\n        \n        // Create celebration particles\n        this.createBlockCreationParticles();\n        \n        // Execute smart contracts in the block\n        this.executeSmartContracts(block);\n        \n        // Broadcast the new block to the network\n        this.broadcastBlock();\n        \n        // Create reward particles for the successful miner\n        this.createRewardParticles();\n        \n        // Clear the successful miner's pulsating effect\n        if (this.successfulMiner) {\n            this.successfulMiner.pulseIntensity = 0;\n            this.successfulMiner.color = this.successfulMiner.originalColor || `hsl(${this.miners.indexOf(this.successfulMiner) * 60}, 80%, 65%)`;\n        }\n        this.successfulMiner = null;\n        this.minerBlockConnection = null;\n        this.minerRewardDisplay = null;\n        \n\n        \n        // Start mining the next block after a delay\n        setTimeout(() => {\n            console.log(`[DIRECT BLOCK] 🔄 Starting mining for next block`);\n            this.startMining();\n        }, 2000);\n    }\n    \n    finalizeBlock() {\n        \n        if (!this.guidedBlock) {\n            return;\n        }\n        \n        // Add the block to the chain\n        this.blocks.push(this.guidedBlock);\n        this.totalBlocks++;\n        \n\n        \n        // Update total transactions\n        this.totalTransactions += this.guidedBlock.transactions.length;\n        \n        // Create celebration particles\n        this.createBlockCreationParticles();\n        \n        // Execute smart contracts in the block\n        this.executeSmartContracts(this.guidedBlock);\n        \n        // Broadcast the new block to the network\n        this.broadcastBlock();\n        \n        // Create reward particles for the successful miner\n        this.createRewardParticles();\n        \n        // Clear the successful miner's pulsating effect\n        if (this.successfulMiner) {\n            this.successfulMiner.pulseIntensity = 0;\n            this.successfulMiner.color = this.successfulMiner.originalColor || `hsl(${this.miners.indexOf(this.successfulMiner) * 60}, 80%, 65%)`;\n        }\n        this.successfulMiner = null;\n        this.minerBlockConnection = null;\n        this.minerRewardDisplay = null;\n        \n        // Reset network nodes to default colors and states after successful block addition\n        this.networkNodes.forEach(node => {\n            node.consensusReached = false;\n            node.isValidating = false;\n            node.pulseIntensity = 1.0;\n            node.color = '#2196F3'; // Default blue color\n        });\n        \n        // Clear guided mode state\n        this.guidedBlock = null;\n        this.guidedPhaseIndicator = null;\n        this.animationPhase = 'idle';\n        this.currentStep = 0;\n        \n\n        // Start mining the next block after a delay\n        setTimeout(() => {\n            this.startMining();\n        }, 2000);\n    }\n    \n    generateNewTransactions() {\n        const currentTime = Date.now();\n        \n        // Generate new transactions periodically\n        if (currentTime - this.lastTransactionTime > this.transactionInterval) {\n            // Generate 1-4 transactions at a time (more dynamic)\n            const numTransactions = Math.floor(Math.random() * 4) + 1;\n            \n            for (let i = 0; i < numTransactions; i++) {\n                const randomTx = this.generateRandomTransaction();\n                this.addPendingTransaction(\n                    randomTx.from,\n                    randomTx.to,\n                    randomTx.amount,\n                    randomTx.type,\n                    randomTx.description,\n                    randomTx.fee\n                );\n            }\n            \n            this.lastTransactionTime = currentTime;\n            \n            // More dynamic interval (1.5-3.5 seconds)\n            this.transactionInterval = 1500 + Math.random() * 2000;\n        }\n        \n        // Remove expired transactions (simulate real mempool behavior)\n        this.pendingTransactions = this.pendingTransactions.filter(tx => {\n            const age = currentTime - tx.timestamp;\n            // Remove transactions older than 30 seconds (simplified)\n            return age < 30000;\n        });\n        \n        // Add some random transaction failures (realistic)\n        if (Math.random() < 0.1 && this.pendingTransactions.length > 0) {\n            // Randomly remove a low-fee transaction (simulate rejection)\n            const lowFeeIndex = this.pendingTransactions.findIndex(tx => tx.fee < this.transactionFee * 0.5);\n            if (lowFeeIndex > -1) {\n                this.pendingTransactions.splice(lowFeeIndex, 1);\n            }\n        }\n    }\n    \n    generateRandomTransaction() {\n        const type = this.transactionTypes[Math.floor(Math.random() * this.transactionTypes.length)];\n        let from, to, amount, description;\n        \n        switch (type) {\n            case 'transfer':\n                from = this.users[Math.floor(Math.random() * this.users.length)];\n                to = this.users[Math.floor(Math.random() * this.users.length)];\n                while (to === from) {\n                    to = this.users[Math.floor(Math.random() * this.users.length)];\n                }\n                amount = Math.floor(Math.random() * 200) + 5; // 5-205 tokens\n                description = this.getRandomTransferDescription();\n                break;\n                \n            case 'smart_contract':\n                from = this.users[Math.floor(Math.random() * this.users.length)];\n                to = this.contracts[Math.floor(Math.random() * this.contracts.length)];\n                amount = Math.floor(Math.random() * 50) + 1; // 1-51 tokens\n                description = this.getRandomContractDescription();\n                break;\n                \n            case 'token_mint':\n                from = 'System';\n                to = this.users[Math.floor(Math.random() * this.users.length)];\n                amount = Math.floor(Math.random() * 100) + 10; // 10-110 tokens\n                description = 'Token minting';\n                break;\n                \n            case 'stake':\n                from = this.users[Math.floor(Math.random() * this.users.length)];\n                to = 'Staking_Contract';\n                amount = Math.floor(Math.random() * 150) + 20; // 20-170 tokens\n                description = 'Staking tokens for rewards';\n                break;\n                \n            case 'swap':\n                from = this.users[Math.floor(Math.random() * this.users.length)];\n                to = 'DEX_Exchange';\n                amount = Math.floor(Math.random() * 80) + 5; // 5-85 tokens\n                description = 'Token swap on DEX';\n                break;\n                \n            case 'liquidity':\n                from = this.users[Math.floor(Math.random() * this.users.length)];\n                to = 'Liquidity_Pool';\n                amount = Math.floor(Math.random() * 120) + 15; // 15-135 tokens\n                description = 'Adding liquidity to pool';\n                break;\n        }\n        \n        // Dynamic fee based on transaction type and amount\n        let fee = this.transactionFee;\n        if (type === 'smart_contract' || type === 'swap') {\n            fee = this.transactionFee * 2; // Higher fees for complex transactions\n        } else if (type === 'liquidity') {\n            fee = this.transactionFee * 1.5; // Medium fees for liquidity operations\n        }\n        \n        return { from, to, amount, type, description, fee };\n    }\n    \n    getRandomTransferDescription() {\n        const descriptions = [\n            'Payment for services',\n            'Coffee payment',\n            'Lunch payment',\n            'Rent payment',\n            'Grocery payment',\n            'Gas payment',\n            'Movie tickets',\n            'Restaurant bill',\n            'Shopping payment',\n            'Transportation fee'\n        ];\n        return descriptions[Math.floor(Math.random() * descriptions.length)];\n    }\n    \n    getRandomContractDescription() {\n        const descriptions = [\n            'DeFi interaction',\n            'Yield farming',\n            'Lending operation',\n            'Borrowing funds',\n            'Collateral deposit',\n            'Interest payment',\n            'Protocol interaction',\n            'Smart contract call',\n            'Automated trading',\n            'Liquidation protection'\n        ];\n        return descriptions[Math.floor(Math.random() * descriptions.length)];\n    }\n    \n    addPendingTransaction(from, to, amount, type, description = '', fee = null) {\n        // Validate transaction before adding\n        const tx = {\n            id: `tx_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            from: from,\n            to: to,\n            amount: amount,\n            type: type,\n            color: this.transactionColors[type] || '#4CAF50',\n            fee: fee || this.transactionFee,\n            description: description,\n            timestamp: Date.now()\n        };\n        \n        // Validate transaction\n        if (!this.validateTransaction(tx)) {\n            return false;\n        }\n        \n        // Check mempool size (simplified)\n        if (this.pendingTransactions.length >= 100) {\n            // Remove lowest fee transaction if mempool is full\n            this.pendingTransactions.sort((a, b) => b.fee - a.fee);\n            this.pendingTransactions.pop();\n        }\n        \n        this.pendingTransactions.push(tx);\n        this.totalTransactions++;\n        \n        return true;\n    }\n    \n    selectTransactionsForBlock() {\n        // Select transactions based on fee priority (realistic)\n        const sortedTransactions = [...this.pendingTransactions].sort((a, b) => b.fee - a.fee);\n        \n        // Dynamic block size based on transaction count (3-6 transactions)\n        const maxTransactions = Math.min(6, Math.max(3, Math.floor(this.pendingTransactions.length / 2)));\n        let selectedTransactions = sortedTransactions.slice(0, maxTransactions);\n        \n        // If no pending transactions, create a default transaction to keep mining active\n        if (selectedTransactions.length === 0) {\n            selectedTransactions = [{\n                id: `default_${Date.now()}`,\n                from: 'System',\n                to: 'Miner',\n                amount: 0,\n                type: 'transfer',\n                color: '#9E9E9E',\n                fee: 0,\n                description: 'Empty block reward'\n            }];\n        }\n        \n        // Remove selected transactions from pending pool\n        selectedTransactions.forEach(tx => {\n            const index = this.pendingTransactions.indexOf(tx);\n            if (index > -1) {\n                this.pendingTransactions.splice(index, 1);\n            }\n        });\n        \n        return selectedTransactions;\n    }\n    \n    calculateMerkleRoot(transactions) {\n        if (transactions.length === 0) return '';\n        \n        let hashes = transactions.map(tx => this.hashString(JSON.stringify(tx)));\n        \n        while (hashes.length > 1) {\n            const newHashes = [];\n            for (let i = 0; i < hashes.length; i += 2) {\n                const left = hashes[i];\n                const right = i + 1 < hashes.length ? hashes[i + 1] : left;\n                newHashes.push(this.hashString(left + right));\n            }\n            hashes = newHashes;\n        }\n        \n        return hashes[0];\n    }\n    \n    calculateBlockHash(block) {\n        const blockString = JSON.stringify({\n            index: block.index,\n            timestamp: block.timestamp,\n            transactions: block.transactions,\n            previousHash: block.previousHash,\n            merkleRoot: block.merkleRoot,\n            nonce: block.nonce\n        });\n        \n        return this.hashString(blockString);\n    }\n    \n    hashString(str) {\n        // Improved hash function that's more realistic\n        let hash = 0;\n        const prime = 31;\n        const mod = 1e9 + 7;\n        \n        for (let i = 0; i < str.length; i++) {\n            const char = str.charCodeAt(i);\n            hash = ((hash * prime) % mod + char) % mod;\n        }\n        \n        // Convert to hex and ensure consistent length\n        const hexHash = Math.abs(hash).toString(16).padStart(8, '0');\n        return hexHash.repeat(8); // 64-character hash\n    }\n    \n    validateBlock(block) {\n        // Validate block structure and content\n        if (!block || typeof block.index !== 'number') {\n            return false;\n        }\n        if (!block.transactions || !Array.isArray(block.transactions)) {\n            return false;\n        }\n        if (!block.previousHash || typeof block.previousHash !== 'string') {\n            return false;\n        }\n        if (typeof block.nonce !== 'number') {\n            return false;\n        }\n        \n        // Validate block index\n        if (block.index !== this.blocks.length) {\n            return false;\n        }\n        \n        // Validate previous hash (except for genesis)\n        if (block.index > 0) {\n            const lastBlock = this.blocks[this.blocks.length - 1];\n            if (block.previousHash !== lastBlock.hash) {\n                return false;\n            }\n        }\n        \n        // Allow empty blocks (remove transaction length validation)\n        // if (block.transactions.length === 0) return false;\n        \n        // Validate block size (simplified)\n        const blockSize = JSON.stringify(block).length;\n        if (blockSize > 1000000) {\n            return false;\n        }\n        \n        // Validate hash\n        const calculatedHash = this.calculateBlockHash(block);\n        if (block.hash !== calculatedHash) {\n            return false;\n        }\n        \n        return true;\n    }\n    \n    validateTransaction(tx) {\n        // Validate transaction structure\n        if (!tx || typeof tx.id !== 'string') return false;\n        if (!tx.from || !tx.to || typeof tx.amount !== 'number') return false;\n        if (tx.amount <= 0) return false;\n        if (typeof tx.fee !== 'number' || tx.fee < 0) return false;\n        \n        // Check for double spending (simplified)\n        const existingTx = this.pendingTransactions.find(t => t.id === tx.id);\n        if (existingTx) return false;\n        \n        return true;\n    }\n    \n    startMining() {\n        if (this.isMining || this.guidedBlock || this.isStartingMining) {\n            return;\n        }\n        \n        this.isStartingMining = true;\n        this.isMining = true;\n        this.animationPhase = 'mining';\n        this.phaseTime = 0;\n        this.miningGlow = 1.0;\n        \n        // Create new block with realistic data\n        const lastBlock = this.blocks[this.blocks.length - 1];\n        const selectedTransactions = this.selectTransactionsForBlock(); // Select transactions based on fee priority\n        \n        // Calculate total fees from selected transactions\n        const totalFees = selectedTransactions.reduce((sum, tx) => sum + tx.fee, 0);\n        \n        const newBlock = {\n            index: lastBlock.index + 1,\n            timestamp: Date.now(),\n            transactions: selectedTransactions,\n            previousHash: lastBlock.hash,\n            hash: '',\n            nonce: 0,\n            merkleRoot: '',\n            isGenesis: false,\n            creationTime: 0,\n            glowIntensity: 0,\n            blockReward: this.blockReward, // Block reward for miner\n            totalFees: totalFees // Total transaction fees\n        };\n        \n        newBlock.merkleRoot = this.calculateMerkleRoot(newBlock.transactions);\n        this.miningBlock = newBlock;\n        \n        // Start mining on all miners with different starting nonces\n        this.miners.forEach((miner, index) => {\n            miner.currentNonce = Math.floor(Math.random() * 1000) + (index * 1000);\n            miner.isMining = true;\n            miner.pulseIntensity = 1.0;\n            miner.lastHashRate = 0;\n        });\n        \n        // Create mining start particles\n        this.createMiningStartParticles();\n        \n        // Reset the flag after a short delay to allow the mining cycle to start\n        setTimeout(() => {\n            this.isStartingMining = false;\n        }, 100);\n    }\n    \n    adjustDifficulty() {\n        // Adjust difficulty based on recent block times\n        if (this.blocks.length % this.difficultyAdjustmentInterval !== 0) return;\n        \n        if (this.blockTimes.length < this.difficultyAdjustmentInterval) return;\n        \n        const averageBlockTime = this.blockTimes.reduce((sum, time) => sum + time, 0) / this.blockTimes.length;\n        const timeRatio = averageBlockTime / this.targetBlockTime;\n        \n        // Adjust difficulty based on time ratio\n        if (timeRatio > 1.2) {\n            // Blocks are taking too long, decrease difficulty\n            this.difficulty = Math.max(1, this.difficulty - 1);\n        } else if (timeRatio < 0.8) {\n            // Blocks are too fast, increase difficulty\n            this.difficulty = Math.min(8, this.difficulty + 1);\n        }\n        \n        // Update target hash\n        this.targetHash = '0'.repeat(this.difficulty);\n        \n        // Clear block times for next adjustment\n        this.blockTimes = [];\n        \n\n    }\n    \n    mineBlock() {\n        if (!this.isMining || !this.miningBlock || this.guidedBlock) {\n            return;\n        }\n        \n        // Ensure mining block index is current\n        const expectedIndex = this.blocks.length;\n        if (this.miningBlock.index !== expectedIndex) {\n            \n            // Create a fresh mining block with correct index and previous hash\n            const lastBlock = this.blocks[this.blocks.length - 1];\n            const selectedTransactions = this.selectTransactionsForBlock();\n            const totalFees = selectedTransactions.reduce((sum, tx) => sum + tx.fee, 0);\n            \n            this.miningBlock = {\n                index: expectedIndex,\n                timestamp: Date.now(),\n                transactions: selectedTransactions,\n                previousHash: lastBlock.hash,\n                hash: '',\n                nonce: 0,\n                merkleRoot: this.calculateMerkleRoot(selectedTransactions),\n                isGenesis: false,\n                creationTime: 0,\n                glowIntensity: 0,\n                blockReward: this.blockReward,\n                totalFees: totalFees\n            };\n            \n\n        }\n        \n        // Use dynamic difficulty\n        const targetHash = '0'.repeat(this.difficulty);\n        \n        // Calculate mining speed based on difficulty and animation speed\n        const baseNoncesPerFrame = 500; // Increased from 200 to 500 for faster mining\n        const difficultyMultiplier = Math.max(0.1, (9 - this.difficulty) * 0.8); // Increased multiplier for faster mining\n        const speedMultiplier = this.speed;\n        const noncesToTry = Math.max(50, Math.floor(baseNoncesPerFrame * difficultyMultiplier * speedMultiplier));\n        \n        // Update network hashrate\n        this.networkHashrate = this.miners.length * noncesToTry * 60; // H/s\n        \n        for (let i = 0; i < noncesToTry; i++) {\n            this.miningBlock.nonce++;\n            this.miningBlock.hash = this.calculateBlockHash(this.miningBlock);\n            \n            // Check if hash meets difficulty requirement\n            if (this.miningBlock.hash.startsWith(targetHash)) {\n                // Validate the block before accepting it\n                if (!this.validateBlock(this.miningBlock)) {\n                    return;\n                }\n                \n                // Determine which miner found the block (simplified)\n                const successfulMinerIndex = Math.floor(Math.random() * this.miners.length);\n                this.successfulMiner = this.miners[successfulMinerIndex];\n                \n                // Store original color for restoration\n                if (!this.successfulMiner.originalColor) {\n                    this.successfulMiner.originalColor = this.successfulMiner.color;\n                }\n                \n                // Create beaming/bouncing effect around successful miner (no arrow)\n                this.successfulMiner.pulseIntensity = 2.0;\n                this.successfulMiner.color = '#00FF88'; // Bright green for success\n                \n                // Block mined successfully\n                this.miningBlock.creationTime = Date.now();\n                this.miningBlock.glowIntensity = 1.0;\n                \n                // Record block time for difficulty adjustment\n                const blockTime = this.miningBlock.creationTime - this.lastBlockTime;\n                this.blockTimes.push(blockTime);\n                this.lastBlockTime = this.miningBlock.creationTime;\n                \n                // Adjust difficulty if needed\n                this.adjustDifficulty();\n                \n                // Enable guided mode for all difficulty levels\n                // Start guided step-by-step process\n                this.startGuidedBlockAddition(this.miningBlock);\n                \n                return; // Exit the loop since we found a valid hash\n            }\n        }\n    }\n    \n    createMinerBlockConnection() {\n        if (!this.successfulMiner || !this.miningBlock) return;\n        \n        // Calculate block position\n        const totalBlocks = this.blocks.length;\n        let blockX;\n        \n        if (totalBlocks <= 4) {\n            const visibleIndex = totalBlocks;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n        } else {\n            const visibleBlocks = [this.blocks[0], this.blocks[1], ...this.blocks.slice(-2)];\n            const visibleIndex = visibleBlocks.length;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n            \n            if (totalBlocks > 4) {\n                blockX += 80;\n            }\n        }\n        \n        const blockY = this.chainStartY + this.blockHeight / 2;\n        \n        // Create connection between miner and block\n        this.minerBlockConnection = {\n            startX: this.successfulMiner.x,\n            startY: this.successfulMiner.y,\n            endX: blockX,\n            endY: blockY,\n            progress: 0,\n            speed: 0.02,\n            color: '#00FF88', // Bright green for success - better visibility\n            width: 3,\n            alpha: 1.0,\n            pulseIntensity: 1.0\n        };\n        \n        // Create reward display\n        this.minerRewardDisplay = {\n            x: this.successfulMiner.x,\n            y: this.successfulMiner.y - 40,\n            text: `+${this.blockReward + this.miningBlock.totalFees} tokens`,\n            color: '#1E3A8A', // Dark blue for better visibility on white background\n            alpha: 1.0,\n            life: 3.0,\n            maxLife: 3.0,\n            velocity: -30 // Move upward\n        };\n    }\n    \n    createMiningStartParticles() {\n        this.miners.forEach(miner => {\n            for (let i = 0; i < 8; i++) {\n                this.miningParticles.push({\n                    x: miner.x,\n                    y: miner.y,\n                    vx: (Math.random() - 0.5) * 80,\n                    vy: (Math.random() - 0.5) * 80,\n                    life: 2.0,\n                    maxLife: 2.0,\n                    color: '#FF9800',\n                    size: 3,\n                    type: 'mining_start'\n                });\n            }\n        });\n    }\n    \n    createBlockCreationParticles() {\n        const lastBlock = this.blocks[this.blocks.length - 1];\n        // Calculate position based on new block layout\n        const totalBlocks = this.blocks.length;\n        let blockX;\n        \n        if (totalBlocks <= 4) {\n            // If 4 or fewer blocks, position based on actual index\n            const visibleIndex = totalBlocks - 1;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n        } else {\n            // For the last two blocks, position at the end of the visible chain\n            const visibleBlocks = [this.blocks[0], this.blocks[1], ...this.blocks.slice(-2)];\n            const visibleIndex = visibleBlocks.length - 1;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n            \n            // Add extra space for ellipses if there are more than 4 blocks\n            if (totalBlocks > 4) {\n                blockX += 80; // Updated space for ellipses\n            }\n        }\n        \n        const blockY = this.chainStartY + this.blockHeight / 2;\n        \n        for (let i = 0; i < 20; i++) {\n            this.blockCreationParticles.push({\n                x: blockX,\n                y: blockY,\n                vx: (Math.random() - 0.5) * 150,\n                vy: (Math.random() - 0.5) * 150,\n                life: 3.0,\n                maxLife: 3.0,\n                color: '#4CAF50',\n                size: 4,\n                type: 'block_creation'\n            });\n        }\n    }\n    \n    broadcastBlock() {\n        // Simulate network broadcast\n        this.networkNodes.forEach(node => {\n            node.isValidating = true;\n            node.lastBlock = this.blocks[this.blocks.length - 1];\n            node.pulseIntensity = 1.0;\n        });\n        \n        // Create animated propagation arrows\n        // this.createPropagationArrows(); // Disabled arrows\n        \n        // Create broadcast particles\n        this.createBroadcastParticles();\n    }\n    \n    createPropagationArrows() {\n        const lastBlock = this.blocks[this.blocks.length - 1];\n        // Calculate position based on new block layout\n        const totalBlocks = this.blocks.length;\n        let blockX;\n        \n        if (totalBlocks <= 4) {\n            // If 4 or fewer blocks, position based on actual index\n            const visibleIndex = totalBlocks - 1;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n        } else {\n            // For the last two blocks, position at the end of the visible chain\n            const visibleBlocks = [this.blocks[0], this.blocks[1], ...this.blocks.slice(-2)];\n            const visibleIndex = visibleBlocks.length - 1;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n            \n            // Add extra space for ellipses if there are more than 4 blocks\n            if (totalBlocks > 4) {\n                blockX += 80; // Updated space for ellipses\n            }\n        }\n        \n        const blockY = this.chainStartY + this.blockHeight / 2;\n        \n        this.networkNodes.forEach(node => {\n            this.propagationArrows.push({\n                startX: blockX,\n                startY: blockY,\n                endX: node.x,\n                endY: node.y,\n                progress: 0,\n                speed: 0.03,\n                color: '#4CAF50',\n                width: 4,\n                alpha: 1.0\n            });\n        });\n    }\n    \n    createBroadcastParticles() {\n        this.networkNodes.forEach(node => {\n            for (let i = 0; i < 8; i++) {\n                this.networkParticles.push({\n                    x: node.x,\n                    y: node.y,\n                    vx: (Math.random() - 0.5) * 100,\n                    vy: (Math.random() - 0.5) * 100,\n                    life: 1.8,\n                    maxLife: 1.8,\n                    color: '#4A90E2', // Blue for propagation\n                    size: 3\n                });\n            }\n        });\n    }\n    \n    updateNetworkParticles(deltaTime) {\n        this.networkParticles.forEach((particle, index) => {\n            particle.life -= deltaTime;\n            \n            if (particle.life <= 0) {\n                this.networkParticles.splice(index, 1);\n                return;\n            }\n            \n            // Move towards target\n            const dx = particle.targetX - particle.x;\n            const dy = particle.targetY - particle.y;\n            const distance = Math.sqrt(dx * dx + dy * dy);\n            \n            if (distance > 1) {\n                particle.vx = (dx / distance) * 120;\n                particle.vy = (dy / distance) * 120;\n            }\n            \n            particle.x += particle.vx * deltaTime;\n            particle.y += particle.vy * deltaTime;\n        });\n    }\n    \n    createMiningParticles() {\n        if (!this.isMining) return;\n        \n        // Adjust particle creation rate based on speed\n        const particleRate = 0.4 * this.speed;\n        \n        this.miners.forEach(miner => {\n            if (Math.random() < particleRate) {\n                this.miningParticles.push({\n                    x: miner.x,\n                    y: miner.y,\n                    vx: (Math.random() - 0.5) * 60,\n                    vy: (Math.random() - 0.5) * 60,\n                    life: 1.5,\n                    maxLife: 1.5,\n                    color: '#FF9800',\n                    size: 3,\n                    type: 'mining'\n                });\n            }\n        });\n    }\n    \n    createMiningSuccessParticles() {\n        this.miners.forEach(miner => {\n            for (let i = 0; i < 12; i++) {\n                this.miningParticles.push({\n                    x: miner.x,\n                    y: miner.y,\n                    vx: (Math.random() - 0.5) * 250,\n                    vy: (Math.random() - 0.5) * 250,\n                    life: 4.0,\n                    maxLife: 4.0,\n                    color: '#4CAF50',\n                    size: 5,\n                    type: 'success'\n                });\n            }\n        });\n    }\n    \n    executeSmartContracts(block) {\n        block.transactions.forEach(tx => {\n            if (tx.type === 'smart_contract') {\n                this.createSmartContractExecution(tx);\n            }\n        });\n    }\n    \n    createSmartContractExecution(tx) {\n        // Calculate position based on new block layout\n        const totalBlocks = this.blocks.length;\n        let contractX;\n        \n        if (totalBlocks <= 4) {\n            // If 4 or fewer blocks, position based on actual index\n            const visibleIndex = totalBlocks - 1;\n            contractX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n        } else {\n            // For the last two blocks, position at the end of the visible chain\n            const visibleBlocks = [this.blocks[0], this.blocks[1], ...this.blocks.slice(-2)];\n            const visibleIndex = visibleBlocks.length - 1;\n            contractX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n            \n            // Add extra space for ellipses if there are more than 4 blocks\n            if (totalBlocks > 4) {\n                contractX += 80; // Updated space for ellipses\n            }\n        }\n        \n        const contractY = this.chainStartY + this.blockHeight / 2;\n        \n        for (let i = 0; i < 15; i++) {\n            this.contractExecutionParticles.push({\n                x: contractX,\n                y: contractY,\n                vx: (Math.random() - 0.5) * 140,\n                vy: (Math.random() - 0.5) * 140,\n                life: 2.5,\n                maxLife: 2.5,\n                color: '#2196F3',\n                size: 4\n            });\n        }\n    }\n    \n    createValidationParticles() {\n        this.networkNodes.forEach(node => {\n            for (let i = 0; i < 10; i++) {\n                this.validationParticles.push({\n                    x: node.x,\n                    y: node.y,\n                    vx: (Math.random() - 0.5) * 150,\n                    vy: (Math.random() - 0.5) * 150,\n                    life: 2.0,\n                    maxLife: 2.0,\n                    color: '#FF6B35', // Orange for validation\n                    size: 4\n                });\n            }\n        });\n    }\n    \n    createConsensusParticles() {\n        this.networkNodes.forEach(node => {\n            for (let i = 0; i < 12; i++) {\n                this.consensusParticles.push({\n                    x: node.x,\n                    y: node.y,\n                    vx: (Math.random() - 0.5) * 120,\n                    vy: (Math.random() - 0.5) * 120,\n                    life: 2.5,\n                    maxLife: 2.5,\n                    color: '#9C27B0', // Purple for consensus\n                    size: 5\n                });\n            }\n        });\n    }\n    \n    createFinalizationParticles() {\n        // Create finalization particles around the last block\n        const lastBlock = this.blocks[this.blocks.length - 1];\n        const totalBlocks = this.blocks.length;\n        let blockX;\n        \n        if (totalBlocks <= 4) {\n            const visibleIndex = totalBlocks - 1;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n        } else {\n            const visibleBlocks = [this.blocks[0], this.blocks[1], ...this.blocks.slice(-2)];\n            const visibleIndex = visibleBlocks.length - 1;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n            \n            if (totalBlocks > 4) {\n                blockX += 80;\n            }\n        }\n        \n        const blockY = this.chainStartY + this.blockHeight / 2;\n        \n        for (let i = 0; i < 15; i++) {\n            this.finalizationParticles.push({\n                x: blockX,\n                y: blockY,\n                vx: (Math.random() - 0.5) * 120,\n                vy: (Math.random() - 0.5) * 120,\n                life: 2.5,\n                maxLife: 2.5,\n                color: '#4CAF50',\n                size: 3\n            });\n        }\n    }\n    \n    createRewardParticles() {\n        // Create reward particles around the last block\n        const lastBlock = this.blocks[this.blocks.length - 1];\n        const totalBlocks = this.blocks.length;\n        let blockX;\n        \n        if (totalBlocks <= 4) {\n            const visibleIndex = totalBlocks - 1;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n        } else {\n            const visibleBlocks = [this.blocks[0], this.blocks[1], ...this.blocks.slice(-2)];\n            const visibleIndex = visibleBlocks.length - 1;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n            \n            if (totalBlocks > 4) {\n                blockX += 80;\n            }\n        }\n        \n        const blockY = this.chainStartY + this.blockHeight / 2;\n        \n        for (let i = 0; i < 12; i++) {\n            this.rewardParticles.push({\n                x: blockX,\n                y: blockY,\n                vx: (Math.random() - 0.5) * 100,\n                vy: (Math.random() - 0.5) * 100,\n                life: 3.0,\n                maxLife: 3.0,\n                color: '#FFD700', // Gold color for rewards\n                size: 4\n            });\n        }\n    }\n    \n    updateMiningParticles(deltaTime) {\n        this.miningParticles.forEach((particle, index) => {\n            particle.life -= deltaTime;\n            \n            if (particle.life <= 0) {\n                this.miningParticles.splice(index, 1);\n                return;\n            }\n            \n            particle.x += particle.vx * deltaTime;\n            particle.y += particle.vy * deltaTime;\n            particle.vy += 25 * deltaTime; // Gravity\n        });\n    }\n    \n    updateBlockCreationParticles(deltaTime) {\n        this.blockCreationParticles.forEach((particle, index) => {\n            particle.life -= deltaTime;\n            \n            if (particle.life <= 0) {\n                this.blockCreationParticles.splice(index, 1);\n                return;\n            }\n            \n            particle.x += particle.vx * deltaTime;\n            particle.y += particle.vy * deltaTime;\n            particle.vy += 30 * deltaTime;\n        });\n    }\n    \n    updateContractExecutionParticles(deltaTime) {\n        this.contractExecutionParticles.forEach((particle, index) => {\n            particle.life -= deltaTime;\n            \n            if (particle.life <= 0) {\n                this.contractExecutionParticles.splice(index, 1);\n                return;\n            }\n            \n            particle.x += particle.vx * deltaTime;\n            particle.y += particle.vy * deltaTime;\n            particle.vy += 30 * deltaTime;\n        });\n    }\n    \n    updatePropagationArrows(deltaTime) {\n        this.propagationArrows.forEach((arrow, index) => {\n            arrow.progress += arrow.speed;\n            \n            if (arrow.progress >= 1) {\n                this.propagationArrows.splice(index, 1);\n                return;\n            }\n        });\n    }\n    \n    updateValidationParticles(deltaTime) {\n        this.validationParticles.forEach((particle, index) => {\n            particle.life -= deltaTime;\n            \n            if (particle.life <= 0) {\n                this.validationParticles.splice(index, 1);\n                return;\n            }\n            \n            particle.x += particle.vx * deltaTime;\n            particle.y += particle.vy * deltaTime;\n            particle.vy += 20 * deltaTime; // Gravity\n        });\n    }\n    \n    updateConsensusParticles(deltaTime) {\n        this.consensusParticles.forEach((particle, index) => {\n            particle.life -= deltaTime;\n            \n            if (particle.life <= 0) {\n                this.consensusParticles.splice(index, 1);\n                return;\n            }\n            \n            particle.x += particle.vx * deltaTime;\n            particle.y += particle.vy * deltaTime;\n            particle.vy += 25 * deltaTime; // Gravity\n        });\n    }\n    \n    updateFinalizationParticles(deltaTime) {\n        this.finalizationParticles.forEach((particle, index) => {\n            particle.life -= deltaTime;\n            \n            if (particle.life <= 0) {\n                this.finalizationParticles.splice(index, 1);\n                return;\n            }\n            \n            particle.x += particle.vx * deltaTime;\n            particle.y += particle.vy * deltaTime;\n            particle.vy += 30 * deltaTime; // Gravity\n        });\n    }\n    \n    updateRewardParticles(deltaTime) {\n        this.rewardParticles.forEach((particle, index) => {\n            particle.life -= deltaTime;\n            \n            if (particle.life <= 0) {\n                this.rewardParticles.splice(index, 1);\n                return;\n            }\n            \n            particle.x += particle.vx * deltaTime;\n            particle.y += particle.vy * deltaTime;\n            particle.vy += 30 * deltaTime; // Gravity\n        });\n    }\n    \n    updateRejectionParticles(deltaTime) {\n        this.rejectionParticles.forEach((particle, index) => {\n            particle.life -= deltaTime;\n            \n            if (particle.life <= 0) {\n                this.rejectionParticles.splice(index, 1);\n                return;\n            }\n            \n            particle.x += particle.vx * deltaTime;\n            particle.y += particle.vy * deltaTime;\n            particle.vy += 40 * deltaTime; // Stronger gravity for rejection\n        });\n    }\n    \n    setSpeed(speed) {\n        this.speed = speed;\n    }\n    \n\n    \n\n    \n\n    \n    setDifficulty(difficulty) {\n        this.difficulty = difficulty;\n        this.targetHash = '0'.repeat(this.difficulty);\n        \n        // Update all miners with new difficulty\n        this.miners.forEach(miner => {\n            miner.targetHash = this.targetHash;\n        });\n        \n        // If currently mining, update the mining block target\n        if (this.miningBlock) {\n            this.miningBlock.hash = this.calculateBlockHash(this.miningBlock);\n        }\n    }\n    \n    update(deltaTime) {\n        // Store original deltaTime for animations\n        const animationDeltaTime = deltaTime;\n        \n        // Apply speed only to mining-related operations\n        const miningDeltaTime = deltaTime * this.speed;\n        \n        // Update animation phase (use original deltaTime for consistent animations)\n        this.phaseTime += animationDeltaTime;\n        \n        // Update visual effects (use original deltaTime for consistent animations)\n        this.blockGlow = Math.max(0, this.blockGlow - animationDeltaTime * 2);\n        this.miningGlow = Math.max(0, this.miningGlow - animationDeltaTime * 1.5);\n        this.networkPulse = (this.networkPulse + animationDeltaTime * 3) % (2 * Math.PI);\n        \n        // Update dynamic network nodes (use original deltaTime for consistent movement)\n        this.updateDynamicNodes(animationDeltaTime);\n        \n        // Mine block if mining (use mining deltaTime for speed control)\n        if (this.isMining && this.miningBlock) {\n            this.mineBlock();\n        }\n        \n        // Update all particle types (use original deltaTime for consistent animations)\n        this.updateMiningParticles(animationDeltaTime);\n        this.updateNetworkParticles(animationDeltaTime);\n        this.updateContractExecutionParticles(animationDeltaTime);\n        this.updateBlockCreationParticles(animationDeltaTime);\n        // this.updatePropagationArrows(animationDeltaTime); // Disabled arrows\n        this.updateValidationParticles(animationDeltaTime);\n        this.updateConsensusParticles(animationDeltaTime);\n        this.updateFinalizationParticles(animationDeltaTime);\n        this.updateRewardParticles(animationDeltaTime);\n        this.updateRejectionParticles(animationDeltaTime);\n        this.updateNodeJoinParticles(animationDeltaTime);\n        this.updateNodeLeaveParticles(animationDeltaTime);\n        \n        // Create new particles\n        this.createMiningParticles();\n        \n        // Generate new transactions periodically\n        this.generateNewTransactions();\n        \n        // Update network validation (use original deltaTime for consistent animations)\n        this.networkNodes.forEach(node => {\n            if (node.isValidating && this.phaseTime > 1.5) {\n                node.isValidating = false;\n                node.pulseIntensity = 0;\n            }\n            node.pulseIntensity = Math.max(0, node.pulseIntensity - animationDeltaTime * 2);\n        });\n        \n        // Update block glow (use original deltaTime for consistent animations)\n        this.blocks.forEach(block => {\n            if (block.glowIntensity > 0) {\n                block.glowIntensity = Math.max(0, block.glowIntensity - animationDeltaTime * 1.5);\n            }\n        });\n        \n        // Update statistics\n        // Calculate hashrate based on user difficulty, speed, and number of miners\n        const baseHashrate = 1200;\n        const difficultyMultiplier = Math.pow(2, this.difficulty - 1);\n        const speedMultiplier = this.speed;\n        const effectiveHashrate = Math.floor(baseHashrate / difficultyMultiplier * speedMultiplier);\n        this.networkHashrate = this.miners.length * effectiveHashrate;\n        \n        // Update mining block glow if it exists (use original deltaTime for consistent animations)\n        if (this.miningBlock && this.miningBlock.glowIntensity > 0) {\n            this.miningBlock.glowIntensity = Math.max(0, this.miningBlock.glowIntensity - animationDeltaTime * 1.5);\n        }\n    }\n    \n    updateDynamicNodes(deltaTime) {\n        const currentTime = Date.now();\n        \n        // Update redistribution timer\n        this.nodeRedistributionTimer += deltaTime;\n        \n        // Check if it's time to redistribute nodes\n        if (this.nodeRedistributionTimer > this.redistributionInterval) {\n            this.redistributeNodes();\n            this.nodeRedistributionTimer = 0;\n        }\n        \n        // Check if it's time to add a new node\n        if (currentTime - this.lastNodeJoin > this.nodeJoinInterval && this.networkNodes.length < this.maxNodes) {\n            this.addNodeToNetwork();\n            this.lastNodeJoin = currentTime;\n        }\n        \n        // Check if it's time to remove a node\n        if (currentTime - this.lastNodeLeave > this.nodeLeaveInterval && this.networkNodes.length > this.minNodes) {\n            this.removeNodeFromNetwork();\n            this.lastNodeLeave = currentTime;\n        }\n        \n        // Update joining nodes\n        this.networkNodes.forEach(node => {\n            if (node.isJoining) {\n                node.joinProgress += node.joinSpeed;\n                \n                if (node.joinProgress >= 1) {\n                    node.x = node.targetX;\n                    node.y = node.targetY;\n                    node.isJoining = false;\n                    node.isActive = true;\n                } else {\n                    node.x = node.x + (node.targetX - node.x) * node.joinSpeed;\n                    node.y = node.y + (node.targetY - node.y) * node.joinSpeed;\n                }\n            }\n            \n            // Update leaving nodes\n            if (node.isLeaving) {\n                node.leaveProgress += node.leaveSpeed;\n                \n                if (node.leaveProgress >= 1) {\n                    // Node will be removed in the timeout\n                } else {\n                    // Move node away from center\n                    const angle = Math.atan2(node.y - this.networkCenterY, node.x - this.networkCenterX);\n                    node.x += Math.cos(angle) * 5;\n                    node.y += Math.sin(angle) * 5;\n                }\n            }\n            \n            // Update moving nodes (redistribution)\n            if (node.isMoving) {\n                node.moveProgress += node.moveSpeed;\n                \n                if (node.moveProgress >= 1) {\n                    node.x = node.targetX;\n                    node.y = node.targetY;\n                    node.isMoving = false;\n                } else {\n                    node.x = node.x + (node.targetX - node.x) * node.moveSpeed;\n                    node.y = node.y + (node.targetY - node.y) * node.moveSpeed;\n                }\n            }\n        });\n    }\n    \n    drawBlockchain() {\n        // Calculate which blocks to show: genesis, block 1, and last block\n        const totalBlocks = this.blocks.length;\n        let visibleBlocks = [];\n        \n        if (totalBlocks <= 3) {\n            // If 3 or fewer blocks, show all of them\n            visibleBlocks = this.blocks;\n        } else {\n            // Show genesis, block 1, and last block only\n            visibleBlocks = [\n                this.blocks[0], // Genesis block\n                this.blocks[1], // Block 1\n                this.blocks[totalBlocks - 1] // Last block only\n            ];\n        }\n        \n        // Calculate background width based on visible blocks\n        const visibleWidth = visibleBlocks.length * (this.blockWidth + this.blockSpacing);\n        \n        // Draw chain background with enhanced gradient\n        const gradient = this.ctx.createLinearGradient(this.chainStartX - 40, this.chainStartY - 40, \n                                                     this.chainStartX + visibleWidth + 40, \n                                                     this.chainStartY + this.blockHeight + 40);\n        gradient.addColorStop(0, 'rgba(33, 150, 243, 0.15)');\n        gradient.addColorStop(0.5, 'rgba(76, 175, 80, 0.1)');\n        gradient.addColorStop(1, 'rgba(33, 150, 243, 0.15)');\n        this.ctx.fillStyle = gradient;\n        this.ctx.fillRect(this.chainStartX - 40, this.chainStartY - 40, \n                         visibleWidth + 80, \n                         this.blockHeight + 80);\n        \n        // Draw blocks with enhanced design\n        visibleBlocks.forEach((block, visibleIndex) => {\n            let x = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing);\n            const y = this.chainStartY;\n            \n            // Add extra space for ellipses if this is after block 1 and there are more than 3 blocks\n            if (totalBlocks > 3 && visibleIndex >= 2) {\n                x += 40; // Space for ellipses\n            }\n            \n            // Enhanced block glow effect with modern styling\n            if (block.glowIntensity > 0) {\n                this.ctx.shadowColor = block.isGenesis ? '#4CAF50' : '#2196F3';\n                this.ctx.shadowBlur = 40 * block.glowIntensity;\n                this.ctx.shadowOffsetX = 0;\n                this.ctx.shadowOffsetY = 0;\n            }\n            \n            // Modern block background with enhanced gradient and depth\n            const blockGradient = this.ctx.createLinearGradient(x, y, x + this.blockWidth, y + this.blockHeight);\n            if (block.isGenesis) {\n                // Genesis block - special green gradient\n                blockGradient.addColorStop(0, '#4CAF50');\n                blockGradient.addColorStop(0.3, '#45A049');\n                blockGradient.addColorStop(0.7, '#388E3C');\n                blockGradient.addColorStop(1, '#2E7D32');\n            } else {\n                // Regular blocks - modern blue gradient\n                blockGradient.addColorStop(0, '#42A5F5');\n                blockGradient.addColorStop(0.3, '#2196F3');\n                blockGradient.addColorStop(0.7, '#1976D2');\n                blockGradient.addColorStop(1, '#1565C0');\n            }\n            this.ctx.fillStyle = blockGradient;\n            \n            // Draw rounded rectangle for modern look\n            this.roundRect(x, y, this.blockWidth, this.blockHeight, 12);\n            this.ctx.fill();\n            \n            // Modern block border with gradient and glow\n            const borderGradient = this.ctx.createLinearGradient(x, y, x + this.blockWidth, y + this.blockHeight);\n            borderGradient.addColorStop(0, 'rgba(255, 255, 255, 0.8)');\n            borderGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.4)');\n            borderGradient.addColorStop(1, 'rgba(255, 255, 255, 0.2)');\n            \n            this.ctx.strokeStyle = borderGradient;\n            this.ctx.lineWidth = 3;\n            this.ctx.lineCap = 'round';\n            this.ctx.lineJoin = 'round';\n            this.roundRect(x, y, this.blockWidth, this.blockHeight, 12);\n            this.ctx.stroke();\n            \n            // Add inner highlight for depth\n            const highlightGradient = this.ctx.createLinearGradient(x, y, x, y + this.blockHeight);\n            highlightGradient.addColorStop(0, 'rgba(255, 255, 255, 0.3)');\n            highlightGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.1)');\n            highlightGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\n            this.ctx.fillStyle = highlightGradient;\n            this.roundRect(x + 2, y + 2, this.blockWidth - 4, this.blockHeight / 3, 10);\n            this.ctx.fill();\n            \n            // Reset shadow\n            this.ctx.shadowBlur = 0;\n            \n            // Modern block content with enhanced typography and styling\n            this.ctx.textAlign = 'left';\n            \n            // Block title with modern styling\n            const title = block.isGenesis ? 'Genesis' : `Block #${block.index}`;\n            this.ctx.font = 'bold 20px Inter, Arial, sans-serif';\n            this.ctx.fillStyle = '#ffffff';\n            this.ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';\n            this.ctx.shadowBlur = 2;\n            this.ctx.fillText(title, x + 12, y + 28);\n            this.ctx.shadowBlur = 0;\n            \n            // Transaction count with icon\n            this.ctx.font = 'bold 16px Inter, Arial, sans-serif';\n            this.ctx.fillStyle = '#ffffff';\n            this.ctx.fillText(`📦 ${block.transactions.length} tx`, x + 12, y + 48);\n            \n            // Nonce with modern styling\n            this.ctx.font = '14px Inter, Arial, sans-serif';\n            this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\n            this.ctx.fillText(`Nonce: ${block.nonce.toLocaleString()}`, x + 12, y + 65);\n            \n            // Show reward and fees for non-genesis blocks with better spacing\n            if (!block.isGenesis) {\n                this.ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';\n                this.ctx.fillText(`💰 ${block.blockReward} | 💸 ${block.totalFees.toFixed(1)}`, x + 12, y + 82);\n            }\n            \n            // Hash with modern monospace styling\n            if (this.showHashes) {\n                this.ctx.font = '11px \"JetBrains Mono\", \"Fira Code\", monospace';\n                this.ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n                this.ctx.fillText(`🔗 ${block.hash.substring(0, 12)}...`, x + 12, y + 100);\n            }\n            \n            // Draw connection to next block with enhanced styling\n            if (visibleIndex < visibleBlocks.length - 1) {\n                const nextBlock = visibleBlocks[visibleIndex + 1];\n                let nextX = this.chainStartX + (visibleIndex + 1) * (this.blockWidth + this.blockSpacing);\n                \n                // Check if we need to show ellipses instead of arrow\n                const shouldShowEllipses = totalBlocks > 3 && visibleIndex === 1;\n                \n                if (shouldShowEllipses) {\n                    // Draw ellipses instead of arrow\n                    const ellipsesX = x + this.blockWidth + 20;\n                    const ellipsesY = y + this.blockHeight / 2;\n                    \n                    // Draw ellipses with arrow color (only once)\n                    this.ctx.fillStyle = '#4CAF50';\n                    this.ctx.font = 'bold 28px Inter, Arial, sans-serif';\n                    this.ctx.textAlign = 'center';\n                    this.ctx.fillText('⋯', ellipsesX, ellipsesY + 10);\n                    \n                    // Show count of hidden blocks\n                    const hiddenCount = totalBlocks - 3;\n                    this.ctx.fillStyle = '#666666';\n                    this.ctx.font = '13px Inter, Arial, sans-serif';\n                    this.ctx.fillText(`+${hiddenCount} blocks`, ellipsesX + 25, ellipsesY + 30);\n                    \n                    // Draw connection line to the last block (skip the ellipses)\n                    const lastBlockX = this.chainStartX + (visibleBlocks.length - 1) * (this.blockWidth + this.blockSpacing);\n                    const connectionGradient = this.ctx.createLinearGradient(ellipsesX + 30, y + this.blockHeight / 2, \n                                                                           lastBlockX, y + this.blockHeight / 2);\n                    connectionGradient.addColorStop(0, '#ffffff');\n                    connectionGradient.addColorStop(0.5, '#4CAF50');\n                    connectionGradient.addColorStop(1, '#ffffff');\n                    \n                    this.ctx.strokeStyle = connectionGradient;\n                    this.ctx.lineWidth = 6;\n                    this.ctx.lineCap = 'round';\n                    this.ctx.beginPath();\n                    this.ctx.moveTo(ellipsesX + 30, y + this.blockHeight / 2);\n                    this.ctx.lineTo(lastBlockX, y + this.blockHeight / 2);\n                    this.ctx.stroke();\n                    \n                    // Enhanced arrow to the last block\n                    this.ctx.fillStyle = '#4CAF50';\n                    this.ctx.beginPath();\n                    this.ctx.moveTo(lastBlockX - 15, y + this.blockHeight / 2 - 8);\n                    this.ctx.lineTo(lastBlockX, y + this.blockHeight / 2);\n                    this.ctx.lineTo(lastBlockX - 15, y + this.blockHeight / 2 + 8);\n                    this.ctx.fill();\n                } else {\n                    // Normal connection with arrow\n                    const connectionGradient = this.ctx.createLinearGradient(x + this.blockWidth, y + this.blockHeight / 2, \n                                                                           nextX, y + this.blockHeight / 2);\n                    connectionGradient.addColorStop(0, '#ffffff');\n                    connectionGradient.addColorStop(0.5, '#4CAF50');\n                    connectionGradient.addColorStop(1, '#ffffff');\n                    \n                    this.ctx.strokeStyle = connectionGradient;\n                    this.ctx.lineWidth = 6;\n                    this.ctx.lineCap = 'round';\n                    this.ctx.beginPath();\n                    this.ctx.moveTo(x + this.blockWidth, y + this.blockHeight / 2);\n                    this.ctx.lineTo(nextX, y + this.blockHeight / 2);\n                    this.ctx.stroke();\n                    \n                    // Enhanced arrow with better visibility\n                    this.ctx.fillStyle = '#4CAF50';\n                    this.ctx.beginPath();\n                    this.ctx.moveTo(nextX - 15, y + this.blockHeight / 2 - 8);\n                    this.ctx.lineTo(nextX, y + this.blockHeight / 2);\n                    this.ctx.lineTo(nextX - 15, y + this.blockHeight / 2 + 8);\n                    this.ctx.fill();\n                }\n            }\n        });\n        \n\n        \n        // Draw mining block with enhanced design and better positioning\n        if (this.miningBlock) {\n            let x = this.chainStartX + visibleBlocks.length * (this.blockWidth + this.blockSpacing);\n            \n            // Add gap between last block and mining block\n            x += 30; // Additional gap\n            \n            // Ensure mining block is visible on screen\n            const maxX = this.ctx.canvas.width - this.blockWidth - 50;\n            if (x > maxX) {\n                x = maxX;\n            }\n            \n            const y = this.chainStartY;\n            \n            // Enhanced mining glow effect with pulsing animation\n            if (this.miningGlow > 0) {\n                this.ctx.shadowColor = '#FF9800';\n                this.ctx.shadowBlur = 50 * this.miningGlow;\n                this.ctx.shadowOffsetX = 0;\n                this.ctx.shadowOffsetY = 0;\n            }\n            \n            // Modern mining block background with enhanced gradient\n            const miningGradient = this.ctx.createLinearGradient(x, y, x + this.blockWidth, y + this.blockHeight);\n            miningGradient.addColorStop(0, '#FFB74D');\n            miningGradient.addColorStop(0.3, '#FF9800');\n            miningGradient.addColorStop(0.7, '#F57C00');\n            miningGradient.addColorStop(1, '#E65100');\n            this.ctx.fillStyle = miningGradient;\n            \n            // Draw rounded rectangle for mining block\n            this.roundRect(x, y, this.blockWidth, this.blockHeight, 12);\n            this.ctx.fill();\n            \n            // Mining block border with animated glow\n            const miningBorderGradient = this.ctx.createLinearGradient(x, y, x + this.blockWidth, y + this.blockHeight);\n            miningBorderGradient.addColorStop(0, 'rgba(255, 255, 255, 0.9)');\n            miningBorderGradient.addColorStop(0.5, 'rgba(255, 193, 7, 0.6)');\n            miningBorderGradient.addColorStop(1, 'rgba(255, 152, 0, 0.8)');\n            \n            this.ctx.strokeStyle = miningBorderGradient;\n            this.ctx.lineWidth = 4;\n            this.ctx.lineCap = 'round';\n            this.ctx.lineJoin = 'round';\n            this.roundRect(x, y, this.blockWidth, this.blockHeight, 12);\n            this.ctx.stroke();\n            \n            // Add mining-specific inner highlight\n            const miningHighlightGradient = this.ctx.createLinearGradient(x, y, x, y + this.blockHeight);\n            miningHighlightGradient.addColorStop(0, 'rgba(255, 255, 255, 0.4)');\n            miningHighlightGradient.addColorStop(0.5, 'rgba(255, 193, 7, 0.2)');\n            miningHighlightGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\n            this.ctx.fillStyle = miningHighlightGradient;\n            this.roundRect(x + 2, y + 2, this.blockWidth - 4, this.blockHeight / 3, 10);\n            this.ctx.fill();\n            \n            // Reset shadow\n            this.ctx.shadowBlur = 0;\n            \n            // Modern mining block content with enhanced styling\n            this.ctx.textAlign = 'left';\n            \n            // Mining title with animated effect\n            this.ctx.font = 'bold 20px Inter, Arial, sans-serif';\n            this.ctx.fillStyle = '#ffffff';\n            this.ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';\n            this.ctx.shadowBlur = 2;\n            this.ctx.fillText('⛏️ Mining...', x + 12, y + 28);\n            this.ctx.shadowBlur = 0;\n            \n            // Nonce with modern formatting\n            this.ctx.font = 'bold 16px Inter, Arial, sans-serif';\n            this.ctx.fillStyle = '#ffffff';\n            this.ctx.fillText(`🔢 ${this.miningBlock.nonce.toLocaleString()}`, x + 12, y + 48);\n            \n            // Target hash with modern styling\n            this.ctx.font = '14px Inter, Arial, sans-serif';\n            this.ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\n            this.ctx.fillText(`🎯 ${this.targetHash}`, x + 12, y + 65);\n            \n            // Reward and fees with icons\n            this.ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';\n            this.ctx.fillText(`💰 ${this.blockReward} | 💸 ${this.miningBlock.totalFees.toFixed(1)}`, x + 12, y + 82);\n            \n            // Hash with modern monospace styling\n            if (this.showHashes) {\n                this.ctx.font = '11px \"JetBrains Mono\", \"Fira Code\", monospace';\n                this.ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n                this.ctx.fillText(`🔗 ${this.miningBlock.hash.substring(0, 12)}...`, x + 12, y + 100);\n            }\n            \n            // Modern mining progress indicator with enhanced styling\n            const progress = (this.miningBlock.nonce % 100) / 100;\n            \n            // Progress bar background with rounded corners\n            this.ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';\n            this.roundRect(x + 12, y + 105, 110, 10, 5);\n            this.ctx.fill();\n            \n            // Progress bar fill with gradient\n            const progressGradient = this.ctx.createLinearGradient(x + 12, y + 105, x + 12 + 110 * progress, y + 105);\n            progressGradient.addColorStop(0, '#FFB74D');\n            progressGradient.addColorStop(0.5, '#FF9800');\n            progressGradient.addColorStop(1, '#F57C00');\n            this.ctx.fillStyle = progressGradient;\n            this.roundRect(x + 12, y + 105, 110 * progress, 10, 5);\n            this.ctx.fill();\n            \n            // Progress bar border\n            this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.4)';\n            this.ctx.lineWidth = 1;\n            this.roundRect(x + 12, y + 105, 110, 10, 5);\n            this.ctx.stroke();\n        }\n    }\n    \n    drawNetwork() {\n        if (!this.showNetwork) return;\n        \n        // Draw network background with enhanced gradient\n        const networkGradient = this.ctx.createRadialGradient(this.networkCenterX, this.networkCenterY, 0, \n                                                             this.networkCenterX, this.networkCenterY, 180);\n        networkGradient.addColorStop(0, 'rgba(33, 150, 243, 0.15)');\n        networkGradient.addColorStop(0.7, 'rgba(33, 150, 243, 0.08)');\n        networkGradient.addColorStop(1, 'rgba(33, 150, 243, 0.03)');\n        this.ctx.fillStyle = networkGradient;\n        this.ctx.fillRect(this.networkCenterX - 180, this.networkCenterY - 180, 360, 360);\n        \n        // Draw connections between nodes with enhanced pulse effect\n        this.ctx.strokeStyle = `rgba(255, 255, 255, ${0.4 + 0.3 * Math.sin(this.networkPulse)})`;\n        this.ctx.lineWidth = 3;\n        this.ctx.lineCap = 'round';\n        \n        for (let i = 0; i < this.networkNodes.length; i++) {\n            for (let j = i + 1; j < this.networkNodes.length; j++) {\n                const node1 = this.networkNodes[i];\n                const node2 = this.networkNodes[j];\n                \n                // Calculate distance for connection strength\n                const dx = node2.x - node1.x;\n                const dy = node2.y - node1.y;\n                const distance = Math.sqrt(dx * dx + dy * dy);\n                \n                // Only draw connections between nearby nodes\n                if (distance < 200) {\n                    this.ctx.beginPath();\n                    this.ctx.moveTo(node1.x, node1.y);\n                    this.ctx.lineTo(node2.x, node2.y);\n                    this.ctx.stroke();\n                }\n            }\n        }\n        \n        // Draw nodes with enhanced design\n        this.networkNodes.forEach(node => {\n            // Skip nodes that are leaving\n            if (node.isLeaving) {\n                // Draw leaving node with fade effect\n                this.ctx.globalAlpha = 1 - node.leaveProgress;\n            }\n            \n            // Node pulse effect with enhanced visibility\n            const pulseRadius = this.nodeRadius + 8 * node.pulseIntensity * Math.sin(this.networkPulse * 2);\n            \n            // Modern node background with enhanced gradient and depth\n            const nodeGradient = this.ctx.createRadialGradient(node.x, node.y, 0, node.x, node.y, this.nodeRadius);\n            \n            // Enhanced color handling for different node types\n            let primaryColor, secondaryColor;\n            if (node.color.startsWith('hsl')) {\n                const hslMatch = node.color.match(/hsl\\((\\d+),\\s*(\\d+)%,\\s*(\\d+)%\\)/);\n                if (hslMatch) {\n                    const h = hslMatch[1];\n                    const s = hslMatch[2];\n                    const l = parseInt(hslMatch[3]);\n                    primaryColor = `hsl(${h}, ${s}%, ${l}%)`;\n                    secondaryColor = `hsl(${h}, ${s}%, ${Math.max(0, l - 30)}%)`;\n                } else {\n                    primaryColor = node.color;\n                    secondaryColor = node.color;\n                }\n            } else {\n                primaryColor = node.color;\n                secondaryColor = this.adjustColor(node.color, -30);\n            }\n            \n            nodeGradient.addColorStop(0, primaryColor);\n            nodeGradient.addColorStop(0.7, secondaryColor);\n            nodeGradient.addColorStop(1, this.adjustColor(secondaryColor, -20));\n            \n            this.ctx.fillStyle = nodeGradient;\n            this.ctx.beginPath();\n            this.ctx.arc(node.x, node.y, this.nodeRadius, 0, 2 * Math.PI);\n            this.ctx.fill();\n            \n            // Modern node border with gradient\n            const borderGradient = this.ctx.createRadialGradient(node.x, node.y, 0, node.x, node.y, this.nodeRadius);\n            borderGradient.addColorStop(0, 'rgba(255, 255, 255, 0.9)');\n            borderGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.6)');\n            borderGradient.addColorStop(1, 'rgba(255, 255, 255, 0.3)');\n            \n            this.ctx.strokeStyle = borderGradient;\n            this.ctx.lineWidth = 3;\n            this.ctx.lineCap = 'round';\n            this.ctx.beginPath();\n            this.ctx.arc(node.x, node.y, this.nodeRadius, 0, 2 * Math.PI);\n            this.ctx.stroke();\n            \n            // Add inner highlight for depth\n            const highlightGradient = this.ctx.createRadialGradient(\n                node.x - this.nodeRadius * 0.3, \n                node.y - this.nodeRadius * 0.3, \n                0, \n                node.x, \n                node.y, \n                this.nodeRadius * 0.8\n            );\n            highlightGradient.addColorStop(0, 'rgba(255, 255, 255, 0.4)');\n            highlightGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.1)');\n            highlightGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\n            this.ctx.fillStyle = highlightGradient;\n            this.ctx.beginPath();\n            this.ctx.arc(node.x, node.y, this.nodeRadius * 0.8, 0, 2 * Math.PI);\n            this.ctx.fill();\n            \n            // Special highlighting for successful miner with enhanced styling and zoom effect\n            if (node === this.successfulMiner) {\n                // Create pulsing zoom effect for successful miner\n                const zoomPulse = Math.sin(this.networkPulse * 2) * 0.3 + 1.0; // Pulsing between 0.7x and 1.3x\n                const zoomedRadius = this.nodeRadius * zoomPulse;\n                \n                // Draw success glow with enhanced effect and zoom\n                this.ctx.shadowColor = '#00FF88';\n                this.ctx.shadowBlur = 25 * zoomPulse;\n                this.ctx.fillStyle = 'rgba(0, 255, 136, 0.3)';\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, zoomedRadius + 15, 0, 2 * Math.PI);\n                this.ctx.fill();\n                \n                // Draw success ring with gradient and zoom\n                const successGradient = this.ctx.createRadialGradient(node.x, node.y, 0, node.x, node.y, zoomedRadius + 20);\n                successGradient.addColorStop(0, '#00FF88');\n                successGradient.addColorStop(0.5, '#00E676');\n                successGradient.addColorStop(1, '#00C853');\n                \n                this.ctx.strokeStyle = successGradient;\n                this.ctx.lineWidth = 4 * zoomPulse;\n                this.ctx.lineCap = 'round';\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, zoomedRadius + 18, 0, 2 * Math.PI);\n                this.ctx.stroke();\n                \n                // Draw additional pulsing rings for extra emphasis\n                const ringPulse = Math.sin(this.networkPulse * 3) * 0.5 + 0.5;\n                this.ctx.strokeStyle = `rgba(0, 255, 136, ${0.6 + ringPulse * 0.4})`;\n                this.ctx.lineWidth = 2;\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, zoomedRadius + 25, 0, 2 * Math.PI);\n                this.ctx.stroke();\n                \n                this.ctx.strokeStyle = `rgba(0, 255, 136, ${0.4 + ringPulse * 0.3})`;\n                this.ctx.lineWidth = 1.5;\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, zoomedRadius + 32, 0, 2 * Math.PI);\n                this.ctx.stroke();\n                \n                this.ctx.shadowBlur = 0;\n                \n                // Draw the actual node with zoom effect\n                const nodeGradient = this.ctx.createRadialGradient(node.x, node.y, 0, node.x, node.y, zoomedRadius);\n                \n                // Enhanced color handling for successful miner\n                let primaryColor, secondaryColor;\n                if (node.color.startsWith('hsl')) {\n                    const hslMatch = node.color.match(/hsl\\((\\d+),\\s*(\\d+)%,\\s*(\\d+)%\\)/);\n                    if (hslMatch) {\n                        const h = hslMatch[1];\n                        const s = hslMatch[2];\n                        const l = parseInt(hslMatch[3]);\n                        primaryColor = `hsl(${h}, ${s}%, ${l}%)`;\n                        secondaryColor = `hsl(${h}, ${s}%, ${Math.max(0, l - 30)}%)`;\n                    } else {\n                        primaryColor = node.color;\n                        secondaryColor = node.color;\n                    }\n                } else {\n                    primaryColor = node.color;\n                    secondaryColor = this.adjustColor(node.color, -30);\n                }\n                \n                nodeGradient.addColorStop(0, primaryColor);\n                nodeGradient.addColorStop(0.7, secondaryColor);\n                nodeGradient.addColorStop(1, this.adjustColor(secondaryColor, -20));\n                \n                this.ctx.fillStyle = nodeGradient;\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, zoomedRadius, 0, 2 * Math.PI);\n                this.ctx.fill();\n                \n                // Modern node border with gradient and zoom\n                const borderGradient = this.ctx.createRadialGradient(node.x, node.y, 0, node.x, node.y, zoomedRadius);\n                borderGradient.addColorStop(0, 'rgba(255, 255, 255, 0.9)');\n                borderGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.6)');\n                borderGradient.addColorStop(1, 'rgba(255, 255, 255, 0.3)');\n                \n                this.ctx.strokeStyle = borderGradient;\n                this.ctx.lineWidth = 3 * zoomPulse;\n                this.ctx.lineCap = 'round';\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, zoomedRadius, 0, 2 * Math.PI);\n                this.ctx.stroke();\n                \n                // Add inner highlight for depth with zoom\n                const highlightGradient = this.ctx.createRadialGradient(\n                    node.x - zoomedRadius * 0.3, \n                    node.y - zoomedRadius * 0.3, \n                    0, \n                    node.x, \n                    node.y, \n                    zoomedRadius * 0.8\n                );\n                highlightGradient.addColorStop(0, 'rgba(255, 255, 255, 0.4)');\n                highlightGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.1)');\n                highlightGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\n                this.ctx.fillStyle = highlightGradient;\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, zoomedRadius * 0.8, 0, 2 * Math.PI);\n                this.ctx.fill();\n                \n                // Enhanced node label with zoom effect\n                this.ctx.textAlign = 'center';\n                this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\n                this.ctx.shadowBlur = 2;\n                this.ctx.shadowOffsetX = 1;\n                this.ctx.shadowOffsetY = 1;\n                \n                this.ctx.fillStyle = '#ffffff';\n                this.ctx.font = `${Math.floor(11 * zoomPulse)}px Inter, Arial, sans-serif`;\n                this.ctx.fillText(`Node ${node.id}`, node.x, node.y + 5 * zoomPulse);\n                \n                this.ctx.shadowBlur = 0;\n                this.ctx.shadowOffsetX = 0;\n                this.ctx.shadowOffsetY = 0;\n                \n                // Skip the regular node drawing for successful miner since we've drawn it with zoom\n                // Reset alpha for next node\n                this.ctx.globalAlpha = 1;\n                return; // Use return instead of continue in forEach\n            }\n            \n            // Enhanced node status indicators with modern styling\n            if (node.isMining) {\n                // Mining indicator - multiple rings with enhanced pulsing effect\n                const miningPulse = Math.sin(this.networkPulse * 3) * 0.5 + 0.5;\n                \n                // Outer mining ring with glow effect\n                this.ctx.shadowColor = '#FF9800';\n                this.ctx.shadowBlur = 15;\n                this.ctx.strokeStyle = `rgba(255, 152, 0, ${0.9 + miningPulse * 0.1})`;\n                this.ctx.lineWidth = 5;\n                this.ctx.lineCap = 'round';\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, this.nodeRadius + 18, 0, 2 * Math.PI);\n                this.ctx.stroke();\n                \n                // Middle mining ring with enhanced visibility\n                this.ctx.shadowBlur = 8;\n                this.ctx.strokeStyle = `rgba(255, 235, 59, ${0.8 + miningPulse * 0.2})`;\n                this.ctx.lineWidth = 4;\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, this.nodeRadius + 14, 0, 2 * Math.PI);\n                this.ctx.stroke();\n                \n                // Inner mining ring with bright glow\n                this.ctx.shadowBlur = 12;\n                this.ctx.strokeStyle = `rgba(255, 193, 7, ${0.95 + miningPulse * 0.05})`;\n                this.ctx.lineWidth = 3;\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, this.nodeRadius + 10, 0, 2 * Math.PI);\n                this.ctx.stroke();\n                \n                // Reset shadow\n                this.ctx.shadowBlur = 0;\n                \n                // Mining particles around the node\n                for (let i = 0; i < 6; i++) {\n                    const angle = (i / 6) * 2 * Math.PI + this.networkPulse * 2;\n                    const radius = this.nodeRadius + 25 + Math.sin(this.networkPulse * 4 + i) * 5;\n                    const particleX = node.x + Math.cos(angle) * radius;\n                    const particleY = node.y + Math.sin(angle) * radius;\n                    \n                    this.ctx.fillStyle = `rgba(255, 152, 0, ${0.7 + Math.sin(this.networkPulse * 3 + i) * 0.3})`;\n                    this.ctx.beginPath();\n                    this.ctx.arc(particleX, particleY, 3, 0, 2 * Math.PI);\n                    this.ctx.fill();\n                }\n            }\n            \n            if (node.isValidating) {\n                // Validation indicator with glow effect\n                this.ctx.shadowColor = '#4CAF50';\n                this.ctx.shadowBlur = 10;\n                this.ctx.strokeStyle = '#4CAF50';\n                this.ctx.lineWidth = 4;\n                this.ctx.lineCap = 'round';\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, this.nodeRadius + 16, 0, 2 * Math.PI);\n                this.ctx.stroke();\n                this.ctx.shadowBlur = 0;\n            }\n            \n            // Special indicator for joining nodes with enhanced styling\n            if (node.isJoining) {\n                this.ctx.shadowColor = '#4CAF50';\n                this.ctx.shadowBlur = 12;\n                this.ctx.strokeStyle = '#4CAF50';\n                this.ctx.lineWidth = 5;\n                this.ctx.lineCap = 'round';\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, this.nodeRadius + 22, 0, 2 * Math.PI);\n                this.ctx.stroke();\n                this.ctx.shadowBlur = 0;\n            }\n            \n            // Special indicator for moving nodes (redistribution) with enhanced styling\n            if (node.isMoving) {\n                this.ctx.shadowColor = '#2196F3';\n                this.ctx.shadowBlur = 8;\n                this.ctx.strokeStyle = '#2196F3';\n                this.ctx.lineWidth = 4;\n                this.ctx.lineCap = 'round';\n                this.ctx.beginPath();\n                this.ctx.arc(node.x, node.y, this.nodeRadius + 20, 0, 2 * Math.PI);\n                this.ctx.stroke();\n                this.ctx.shadowBlur = 0;\n            }\n            \n            // Modern node label with enhanced styling\n            this.ctx.textAlign = 'center';\n            \n            // Add text shadow for better readability\n            this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\n            this.ctx.shadowBlur = 2;\n            this.ctx.shadowOffsetX = 1;\n            this.ctx.shadowOffsetY = 1;\n            \n            // Node label with modern typography\n            this.ctx.fillStyle = '#ffffff';\n            this.ctx.font = '11px Inter, Arial, sans-serif';\n            this.ctx.fillText(`Node ${node.id}`, node.x, node.y + 5);\n            \n            // Reset shadow\n            this.ctx.shadowBlur = 0;\n            this.ctx.shadowOffsetX = 0;\n            this.ctx.shadowOffsetY = 0;\n            \n            // Reset alpha for next node\n            this.ctx.globalAlpha = 1;\n        });\n    }\n    \n    adjustColor(color, amount) {\n        // Handle HSL colors (which are used for network nodes)\n        if (color.startsWith('hsl')) {\n            return color; // Return original color for HSL\n        }\n        \n        // Handle hex colors\n        if (color.startsWith('#')) {\n            const hex = color.replace('#', '');\n            if (hex.length === 6) {\n                const r = Math.max(0, Math.min(255, parseInt(hex.substr(0, 2), 16) + amount));\n                const g = Math.max(0, Math.min(255, parseInt(hex.substr(2, 2), 16) + amount));\n                const b = Math.max(0, Math.min(255, parseInt(hex.substr(4, 2), 16) + amount));\n                return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\n            }\n        }\n        \n        return color; // Return original color if not a valid hex\n    }\n    \n    roundRect(x, y, width, height, radius) {\n        this.ctx.beginPath();\n        this.ctx.moveTo(x + radius, y);\n        this.ctx.lineTo(x + width - radius, y);\n        this.ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\n        this.ctx.lineTo(x + width, y + height - radius);\n        this.ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n        this.ctx.lineTo(x + radius, y + height);\n        this.ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\n        this.ctx.lineTo(x, y + radius);\n        this.ctx.quadraticCurveTo(x, y, x + radius, y);\n        this.ctx.closePath();\n    }\n    \n    drawTransactions() {\n        const startX = 60;\n        const startY = 40; // Moved up to avoid overlap with blockchain\n        const txWidth = 220; // Increased width for more info\n        const txHeight = 120; // Increased height\n        const currentTime = Date.now();\n        \n        // Draw pending transactions with enhanced design and dynamic updates\n        this.pendingTransactions.slice(0, 3).forEach((tx, index) => {\n            const x = startX + index * (txWidth + 30);\n            const y = startY;\n            \n            // Calculate transaction age for visual effects\n            const age = currentTime - tx.timestamp;\n            const ageSeconds = Math.floor(age / 1000);\n            const ageOpacity = Math.max(0.6, 1 - (age / 30000)); // Fade out over 30 seconds\n            \n            // Dynamic gradient based on transaction age and type\n            const txGradient = this.ctx.createLinearGradient(x, y, x + txWidth, y + txHeight);\n            if (age > 20000) {\n                // Older transactions - more muted colors\n                txGradient.addColorStop(0, '#4B5563');\n                txGradient.addColorStop(0.3, '#6B7280');\n                txGradient.addColorStop(0.7, '#374151');\n                txGradient.addColorStop(1, '#1F2937');\n            } else {\n                // Fresh transactions - vibrant colors\n                txGradient.addColorStop(0, '#6A4C93');\n                txGradient.addColorStop(0.3, '#8B5CF6');\n                txGradient.addColorStop(0.7, '#7C3AED');\n                txGradient.addColorStop(1, '#5B21B6');\n            }\n            this.ctx.fillStyle = txGradient;\n            \n            // Apply age-based opacity\n            this.ctx.globalAlpha = ageOpacity;\n            \n            // Draw rounded rectangle for transactions\n            this.roundRect(x, y, txWidth, txHeight, 12);\n            this.ctx.fill();\n            \n            // Enhanced transaction border with dynamic glow effect\n            const borderColor = age > 20000 ? '#9CA3AF' : '#E0E7FF';\n            this.ctx.strokeStyle = borderColor;\n            this.ctx.lineWidth = 2;\n            this.ctx.shadowColor = age > 20000 ? '#6B7280' : '#8B5CF6';\n            this.ctx.shadowBlur = 8;\n            this.ctx.stroke();\n            this.ctx.shadowBlur = 0;\n            \n            // Reset opacity for text\n            this.ctx.globalAlpha = 1;\n            \n            // Transaction content with improved typography and dynamic info\n            this.ctx.fillStyle = '#ffffff';\n            this.ctx.font = 'bold 14px Inter, Arial, sans-serif';\n            this.ctx.textAlign = 'left';\n            this.ctx.fillText(`${tx.from} → ${tx.to}`, x + 15, y + 25);\n            \n            this.ctx.font = '12px Inter, Arial, sans-serif';\n            this.ctx.fillText(`Amount: ${tx.amount} tokens`, x + 15, y + 45);\n            this.ctx.fillText(`Type: ${tx.type.replace('_', ' ')}`, x + 15, y + 60);\n            this.ctx.fillText(`Fee: ${tx.fee.toFixed(1)} tokens`, x + 15, y + 75);\n            \n            // Dynamic time display with age indicator\n            const timeText = ageSeconds < 60 ? `${ageSeconds}s ago` : `${Math.floor(ageSeconds / 60)}m ago`;\n            this.ctx.fillText(`Age: ${timeText}`, x + 15, y + 90);\n            \n            // Priority indicator based on fee\n            const priorityColor = tx.fee > this.transactionFee * 1.5 ? '#10B981' : \n                                tx.fee > this.transactionFee ? '#F59E0B' : '#EF4444';\n            this.ctx.fillStyle = priorityColor;\n            this.ctx.fillText(`Priority: ${tx.fee > this.transactionFee * 1.5 ? 'High' : \n                             tx.fee > this.transactionFee ? 'Medium' : 'Low'}`, x + 15, y + 105);\n            \n            // Show description if available with better spacing\n            if (tx.description) {\n                this.ctx.font = '10px Inter, Arial, sans-serif';\n                this.ctx.fillStyle = '#E0E7FF';\n                const desc = tx.description.length > 25 ? tx.description.substring(0, 22) + '...' : tx.description;\n                this.ctx.fillText(desc, x + 15, y + 118);\n            }\n            \n            // Add pulsing effect for new transactions (first 5 seconds)\n            if (age < 5000) {\n                const pulse = Math.sin(currentTime * 0.01) * 0.3 + 0.7;\n                this.ctx.strokeStyle = `rgba(139, 92, 246, ${pulse})`;\n                this.ctx.lineWidth = 3;\n                this.ctx.lineCap = 'round';\n                this.roundRect(x, y, txWidth, txHeight, 12);\n                this.ctx.stroke();\n            }\n        });\n        \n        // Reset global alpha\n        this.ctx.globalAlpha = 1;\n    }\n    \n    drawParticles() {\n        // Draw mining particles\n        this.miningParticles.forEach(particle => {\n            this.ctx.fillStyle = particle.color;\n            this.ctx.globalAlpha = particle.life / particle.maxLife;\n            this.ctx.beginPath();\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, 2 * Math.PI);\n            this.ctx.fill();\n        });\n        this.ctx.globalAlpha = 1;\n        \n        // Draw network particles\n        this.networkParticles.forEach(particle => {\n            this.ctx.fillStyle = particle.color;\n            this.ctx.globalAlpha = particle.life / particle.maxLife;\n            this.ctx.beginPath();\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, 2 * Math.PI);\n            this.ctx.fill();\n        });\n        this.ctx.globalAlpha = 1;\n        \n        // Draw contract execution particles\n        this.contractExecutionParticles.forEach(particle => {\n            this.ctx.fillStyle = particle.color;\n            this.ctx.globalAlpha = particle.life / particle.maxLife;\n            this.ctx.beginPath();\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, 2 * Math.PI);\n            this.ctx.fill();\n        });\n        this.ctx.globalAlpha = 1;\n        \n        // Draw block creation particles\n        this.blockCreationParticles.forEach(particle => {\n            this.ctx.fillStyle = particle.color;\n            this.ctx.globalAlpha = particle.life / particle.maxLife;\n            this.ctx.beginPath();\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, 2 * Math.PI);\n            this.ctx.fill();\n        });\n        this.ctx.globalAlpha = 1;\n        \n        // Draw validation particles\n        this.validationParticles.forEach(particle => {\n            this.ctx.fillStyle = particle.color;\n            this.ctx.globalAlpha = particle.life / particle.maxLife;\n            this.ctx.beginPath();\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, 2 * Math.PI);\n            this.ctx.fill();\n        });\n        this.ctx.globalAlpha = 1;\n        \n        // Draw consensus particles\n        this.consensusParticles.forEach(particle => {\n            this.ctx.fillStyle = particle.color;\n            this.ctx.globalAlpha = particle.life / particle.maxLife;\n            this.ctx.beginPath();\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, 2 * Math.PI);\n            this.ctx.fill();\n        });\n        this.ctx.globalAlpha = 1;\n        \n        // Draw finalization particles\n        this.finalizationParticles.forEach(particle => {\n            this.ctx.fillStyle = particle.color;\n            this.ctx.globalAlpha = particle.life / particle.maxLife;\n            this.ctx.beginPath();\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, 2 * Math.PI);\n            this.ctx.fill();\n        });\n        this.ctx.globalAlpha = 1;\n        \n        // Draw reward particles\n        this.rewardParticles.forEach(particle => {\n            this.ctx.fillStyle = particle.color;\n            this.ctx.globalAlpha = particle.life / particle.maxLife;\n            this.ctx.beginPath();\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, 2 * Math.PI);\n            this.ctx.fill();\n        });\n        this.ctx.globalAlpha = 1;\n        \n        // Draw node join particles\n        this.nodeJoinParticles.forEach(particle => {\n            this.ctx.fillStyle = particle.color;\n            this.ctx.globalAlpha = particle.life / particle.maxLife;\n            this.ctx.beginPath();\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, 2 * Math.PI);\n            this.ctx.fill();\n        });\n        this.ctx.globalAlpha = 1;\n        \n        // Draw node leave particles\n        this.nodeLeaveParticles.forEach(particle => {\n            this.ctx.fillStyle = particle.color;\n            this.ctx.globalAlpha = particle.life / particle.maxLife;\n            this.ctx.beginPath();\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, 2 * Math.PI);\n            this.ctx.fill();\n        });\n        this.ctx.globalAlpha = 1;\n        \n        // Draw rejection particles\n        this.rejectionParticles.forEach(particle => {\n            this.ctx.fillStyle = particle.color;\n            this.ctx.globalAlpha = particle.life / particle.maxLife;\n            this.ctx.beginPath();\n            this.ctx.arc(particle.x, particle.y, particle.size, 0, 2 * Math.PI);\n            this.ctx.fill();\n        });\n        this.ctx.globalAlpha = 1;\n    }\n    \n    drawPropagationArrows() {\n        this.propagationArrows.forEach(arrow => {\n            const currentX = arrow.startX + (arrow.endX - arrow.startX) * arrow.progress;\n            const currentY = arrow.startY + (arrow.endY - arrow.startY) * arrow.progress;\n            \n            // Draw arrow line with glow\n            this.ctx.shadowColor = arrow.color;\n            this.ctx.shadowBlur = 8;\n            this.ctx.strokeStyle = arrow.color;\n            this.ctx.lineWidth = arrow.width;\n            this.ctx.lineCap = 'round';\n            this.ctx.beginPath();\n            this.ctx.moveTo(arrow.startX, arrow.startY);\n            this.ctx.lineTo(currentX, currentY);\n            this.ctx.stroke();\n            \n            // Draw arrow head\n            const angle = Math.atan2(arrow.endY - arrow.startY, arrow.endX - arrow.startX);\n            const headLength = 12;\n            const headAngle = Math.PI / 6;\n            \n            this.ctx.beginPath();\n            this.ctx.moveTo(currentX, currentY);\n            this.ctx.lineTo(\n                currentX - headLength * Math.cos(angle - headAngle),\n                currentY - headLength * Math.sin(angle - headAngle)\n            );\n            this.ctx.moveTo(currentX, currentY);\n            this.ctx.lineTo(\n                currentX - headLength * Math.cos(angle + headAngle),\n                currentY - headLength * Math.sin(angle + headAngle)\n            );\n            this.ctx.stroke();\n            \n            // Reset shadow\n            this.ctx.shadowBlur = 0;\n        });\n    }\n    \n    drawUnifiedInfoPanel() {\n        const panelX = 60;\n        const panelY = this.ctx.canvas.height - 200;\n        const panelWidth = 340; // Slightly wider for better layout\n        const panelHeight = 180;\n        \n        // Unified info panel background with enhanced transparency\n        const panelGradient = this.ctx.createLinearGradient(panelX, panelY, panelX, panelY + panelHeight);\n        panelGradient.addColorStop(0, 'rgba(0, 0, 0, 0.75)');\n        panelGradient.addColorStop(0.7, 'rgba(0, 0, 0, 0.65)');\n        panelGradient.addColorStop(1, 'rgba(0, 0, 0, 0.55)');\n        this.ctx.fillStyle = panelGradient;\n        this.ctx.fillRect(panelX, panelY, panelWidth, panelHeight);\n        \n        // Enhanced panel border with transparency\n        this.ctx.strokeStyle = 'rgba(33, 150, 243, 0.8)';\n        this.ctx.lineWidth = 2;\n        this.ctx.strokeRect(panelX, panelY, panelWidth, panelHeight);\n        \n        // Enhanced text styling with better contrast for transparency\n        this.ctx.fillStyle = '#ffffff';\n        this.ctx.font = 'bold 16px Inter, Arial, sans-serif';\n        this.ctx.textAlign = 'left';\n        \n        // Add text shadow for better readability on transparent background\n        this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\n        this.ctx.shadowBlur = 2;\n        this.ctx.shadowOffsetX = 1;\n        this.ctx.shadowOffsetY = 1;\n        \n        // Title\n        this.ctx.fillText('Blockchain Network Status', panelX + 15, panelY + 25);\n        \n        // Phase information with better formatting\n        const phaseText = this.animationPhase.charAt(0).toUpperCase() + this.animationPhase.slice(1).replace('_', ' ');\n        this.ctx.font = '14px Inter, Arial, sans-serif';\n        this.ctx.fillText(`Current Phase: ${phaseText}`, panelX + 15, panelY + 45);\n        \n        // Key statistics (left column)\n        this.ctx.font = '12px Inter, Arial, sans-serif';\n        this.ctx.fillText(`Total Blocks: ${this.totalBlocks}`, panelX + 15, panelY + 65);\n        this.ctx.fillText(`Total Transactions: ${this.totalTransactions}`, panelX + 15, panelY + 80);\n        this.ctx.fillText(`Pending Transactions: ${this.pendingTransactions.length}`, panelX + 15, panelY + 95);\n        \n        // Dynamic difficulty display\n        this.ctx.fillText(`Current Difficulty: ${this.difficulty}`, panelX + 15, panelY + 110);\n        \n        // Right column - mining info\n        if (this.miningBlock) {\n            this.ctx.fillText(`Current Nonce: ${this.miningBlock.nonce.toLocaleString()}`, panelX + 170, panelY + 65);\n            this.ctx.fillText(`Target Hash: ${this.targetHash}`, panelX + 170, panelY + 80);\n            this.ctx.fillText(`Network Hashrate: ${this.networkHashrate.toLocaleString()} H/s`, panelX + 170, panelY + 95);\n            this.ctx.fillText(`Active Miners: ${this.miners.length}`, panelX + 170, panelY + 110);\n        } else if (this.guidedMode && this.guidedBlock) {\n            this.ctx.fillText(`Process Step: ${this.currentStep + 1}/${this.phaseSteps.length}`, panelX + 170, panelY + 65);\n            this.ctx.fillText(`Block #${this.guidedBlock.index}`, panelX + 170, panelY + 80);\n            this.ctx.fillText(`Phase Time: ${this.phaseTime.toFixed(1)}s`, panelX + 170, panelY + 95);\n            this.ctx.fillText(`Total Rewards: ${this.totalRewards.toFixed(1)}`, panelX + 170, panelY + 110);\n        }\n        \n        // Bottom row - additional info\n        this.ctx.fillText(`Average Block Time: ${(this.averageBlockTime / 1000).toFixed(1)}s`, panelX + 15, panelY + 130);\n        this.ctx.fillText(`Network Nodes: ${this.networkNodes.length}`, panelX + 170, panelY + 130);\n        \n        // Consensus information\n        if (this.guidedMode && this.guidedBlock) {\n            const consensusNodes = this.networkNodes.filter(node => node.consensusReached);\n            const consensusPercentage = (consensusNodes.length / this.networkNodes.length * 100).toFixed(0);\n            this.ctx.fillText(`Consensus: ${consensusPercentage}%`, panelX + 15, panelY + 150);\n        }\n        \n        // Progress indicator for guided mode\n        if (this.guidedMode && this.guidedBlock) {\n            const progress = (this.currentStep + 1) / this.phaseSteps.length;\n            this.ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';\n            this.ctx.fillRect(panelX + 15, panelY + 150, 310, 6);\n            this.ctx.fillStyle = '#4CAF50';\n            this.ctx.fillRect(panelX + 15, panelY + 150, 310 * progress, 6);\n        }\n        \n        // Reset shadow for clean rendering\n        this.ctx.shadowBlur = 0;\n        this.ctx.shadowOffsetX = 0;\n        this.ctx.shadowOffsetY = 0;\n    }\n    \n    render() {\n        // Clear canvas and fill with dark background\n        this.ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';\n        this.ctx.fillRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\n        \n        // Draw components\n        this.drawBlockchain();\n        this.drawNetwork();\n        this.drawTransactions();\n        this.drawParticles();\n        // this.drawPropagationArrows(); // Disabled arrows\n        this.drawMinerRewardDisplay(); // Draw miner reward display\n        this.drawUnifiedInfoPanel();\n        \n        // Draw guided phase indicator if in guided mode\n        if (this.guidedPhaseIndicator) {\n            this.drawGuidedPhaseIndicator();\n        }\n        \n        // Draw miner reward display if active\n        if (this.minerRewardDisplay) {\n            this.drawMinerRewardDisplay();\n        }\n    }\n    \n    drawGuidedPhaseIndicator() {\n        if (!this.guidedPhaseIndicator) return;\n        \n        const centerX = this.ctx.canvas.width / 2;\n        const y = this.guidedPhaseIndicator.y || 350; // Default y position over network nodes\n        const color = this.guidedPhaseIndicator.color || '#00FF88'; // Default color if not set\n        \n        // Set font first to measure text accurately\n        this.ctx.font = 'bold 22px Inter, Arial, sans-serif';\n        this.ctx.textAlign = 'center';\n        \n        // Draw background banner with better sizing\n        const textWidth = this.ctx.measureText(this.guidedPhaseIndicator.text).width;\n        const bannerWidth = Math.max(textWidth + 80, 300); // Minimum width of 300px\n        const bannerHeight = 60;\n        \n        // Ensure we have valid coordinates for the gradient\n        const gradientStartX = centerX - bannerWidth / 2;\n        const gradientStartY = y - bannerHeight / 2;\n        const gradientEndX = centerX + bannerWidth / 2;\n        const gradientEndY = y + bannerHeight / 2;\n        \n        // Check for valid coordinates\n        if (isFinite(gradientStartX) && isFinite(gradientStartY) && \n            isFinite(gradientEndX) && isFinite(gradientEndY)) {\n            \n            // Create gradient background\n            const gradient = this.ctx.createLinearGradient(\n                gradientStartX, gradientStartY,\n                gradientEndX, gradientEndY\n            );\n            gradient.addColorStop(0, 'rgba(0, 0, 0, 0.9)');\n            gradient.addColorStop(0.5, 'rgba(20, 20, 20, 0.95)');\n            gradient.addColorStop(1, 'rgba(0, 0, 0, 0.9)');\n            \n            // Draw rounded rectangle background\n            this.ctx.fillStyle = gradient;\n            this.roundRect(centerX - bannerWidth / 2, y - bannerHeight / 2, bannerWidth, bannerHeight, 15);\n            this.ctx.fill();\n            \n            // Draw enhanced border with glow\n            this.ctx.strokeStyle = color;\n            this.ctx.lineWidth = 4;\n            this.ctx.shadowColor = color;\n            this.ctx.shadowBlur = 15;\n            this.ctx.stroke();\n            this.ctx.shadowBlur = 0;\n            \n            // Draw inner border for depth\n            this.ctx.strokeStyle = `rgba(255, 255, 255, 0.3)`;\n            this.ctx.lineWidth = 1;\n            this.roundRect(centerX - bannerWidth / 2 + 2, y - bannerHeight / 2 + 2, bannerWidth - 4, bannerHeight - 4, 13);\n            this.ctx.stroke();\n            \n            // Draw text with enhanced styling\n            this.ctx.fillStyle = color;\n            this.ctx.font = 'bold 22px Inter, Arial, sans-serif';\n            this.ctx.textAlign = 'center';\n            \n            // Add text shadow for better readability\n            this.ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\n            this.ctx.shadowBlur = 4;\n            this.ctx.shadowOffsetX = 1;\n            this.ctx.shadowOffsetY = 1;\n            this.ctx.fillText(this.guidedPhaseIndicator.text, centerX, y + 8);\n            \n            // Reset shadow\n            this.ctx.shadowBlur = 0;\n            this.ctx.shadowOffsetX = 0;\n            this.ctx.shadowOffsetY = 0;\n            \n            // Add pulsing effect\n            this.guidedPhaseIndicator.alpha = 0.8 + 0.2 * Math.sin(Date.now() * 0.005);\n            this.ctx.globalAlpha = this.guidedPhaseIndicator.alpha;\n            this.ctx.globalAlpha = 1.0; // Reset\n        }\n    }\n    \n    getStats() {\n        // Calculate dynamic difficulty\n        const baseDifficulty = this.difficulty;\n        const blockCount = this.blocks.length;\n        const dynamicDifficulty = Math.min(8, baseDifficulty + Math.floor(blockCount / 5));\n        \n        // Calculate consensus statistics\n        const consensusNodes = this.networkNodes.filter(node => node.consensusReached);\n        const consensusThreshold = this.networkNodes.length * 0.6;\n        const consensusPercentage = this.networkNodes.length > 0 ? \n            Math.round((consensusNodes.length / this.networkNodes.length) * 100) : 0;\n        \n        return {\n            blocks: this.totalBlocks,\n            transactions: this.totalTransactions,\n            pending: this.pendingTransactions.length,\n            difficulty: dynamicDifficulty,\n            hashrate: this.networkHashrate,\n            miners: this.miners.length,\n            nodes: this.networkNodes.length,\n            phase: this.animationPhase,\n            isMining: this.isMining,\n            totalRewards: this.totalRewards,\n            averageBlockTime: this.averageBlockTime / 1000,\n            consensusPercentage: consensusPercentage,\n            consensusThreshold: Math.round(consensusThreshold * 100 / this.networkNodes.length),\n            consensusReached: consensusNodes.length >= consensusThreshold\n        };\n    }\n    \n    reset() {\n        this.blocks = [];\n        this.pendingTransactions = [];\n        this.miningBlock = null;\n        this.isMining = false;\n        this.animationPhase = 'idle';\n        this.phaseTime = 0;\n        this.miningParticles = [];\n        this.validationParticles = [];\n        this.networkParticles = [];\n        this.propagationArrows = [];\n        this.contractExecutionParticles = [];\n        this.blockCreationParticles = [];\n        this.consensusParticles = [];\n        this.finalizationParticles = [];\n        this.rewardParticles = [];\n        this.rejectionParticles = [];\n        this.nodeJoinParticles = [];\n        this.nodeLeaveParticles = [];\n        this.guidedBlock = null;\n        this.currentStep = 0;\n        this.totalBlocks = 0;\n        this.totalTransactions = 0;\n        this.guidedPhaseIndicator = null; // Clear guided phase indicator\n        \n        // Reset miner tracking\n        this.successfulMiner = null;\n        this.minerBlockConnection = null;\n        this.minerRewardDisplay = null;\n        \n        // Reset dynamic network properties\n        this.lastNodeJoin = 0;\n        this.lastNodeLeave = 0;\n        this.nodeRedistributionTimer = 0;\n        this.nextNodeId = 1; // Reset node ID counter\n        \n        // Reset difficulty adjustment properties\n        this.blockTimes = [];\n        this.lastDifficultyAdjustment = 0;\n        this.lastBlockTime = 0;\n        \n        // Reset to default settings\n        this.difficulty = 4;\n        this.targetHash = '0'.repeat(this.difficulty);\n        this.speed = 1.0;\n        // Block hashes are always visible\n        this.showHashes = true;\n        // Network and auto mining are always enabled\n        this.showNetwork = true;\n        this.autoMine = true;\n        \n        // Reset control values in the UI\n        this.resetControls();\n        \n        this.initializeBlockchain();\n        this.initializeNetwork();\n        this.startGenesisBlock();\n    }\n    \n    resetControls() {\n        // Reset difficulty slider\n        const difficultySlider = document.getElementById('blockchainDifficulty');\n        const difficultyValue = document.getElementById('blockchainDifficultyValue');\n        if (difficultySlider && difficultyValue) {\n            difficultySlider.value = this.difficulty;\n            difficultyValue.textContent = this.difficulty;\n        }\n        \n        // Reset speed slider\n        const speedSlider = document.getElementById('blockchainSpeed');\n        const speedValue = document.getElementById('blockchainSpeedValue');\n        if (speedSlider && speedValue) {\n            speedSlider.value = this.speed;\n            speedValue.textContent = this.speed + 'x';\n        }\n    }\n    \n    drawMinerBlockConnection() {\n        if (!this.minerBlockConnection) return;\n        \n        const connection = this.minerBlockConnection;\n        \n        // Update connection progress\n        connection.progress += connection.speed;\n        if (connection.progress > 1) {\n            connection.progress = 1;\n        }\n        \n        // Calculate current position\n        const currentX = connection.startX + (connection.endX - connection.startX) * connection.progress;\n        const currentY = connection.startY + (connection.endY - connection.startY) * connection.progress;\n        \n        // Draw connection line\n        this.ctx.strokeStyle = connection.color;\n        this.ctx.lineWidth = connection.width;\n        this.ctx.globalAlpha = connection.alpha;\n        \n        // Add glow effect\n        this.ctx.shadowColor = connection.color;\n        this.ctx.shadowBlur = 10;\n        \n        this.ctx.beginPath();\n        this.ctx.moveTo(connection.startX, connection.startY);\n        this.ctx.lineTo(currentX, currentY);\n        this.ctx.stroke();\n        \n        // Draw arrow head at current position\n        const angle = Math.atan2(connection.endY - connection.startY, connection.endX - connection.startX);\n        const headLength = 15;\n        const headAngle = Math.PI / 6;\n        \n        this.ctx.beginPath();\n        this.ctx.moveTo(currentX, currentY);\n        this.ctx.lineTo(\n            currentX - headLength * Math.cos(angle - headAngle),\n            currentY - headLength * Math.sin(angle - headAngle)\n        );\n        this.ctx.moveTo(currentX, currentY);\n        this.ctx.lineTo(\n            currentX - headLength * Math.cos(angle + headAngle),\n            currentY - headLength * Math.sin(angle + headAngle)\n        );\n        this.ctx.stroke();\n        \n        // Reset shadow\n        this.ctx.shadowBlur = 0;\n        this.ctx.globalAlpha = 1.0;\n        \n        // Add pulsing effect\n        connection.pulseIntensity = 0.8 + 0.2 * Math.sin(Date.now() * 0.01);\n    }\n    \n    drawMinerRewardDisplay() {\n        if (!this.minerRewardDisplay) return;\n        \n        const reward = this.minerRewardDisplay;\n        \n        // Update reward display\n        reward.life -= 0.016; // 60 FPS\n        reward.y += reward.velocity * 0.016;\n        reward.alpha = reward.life / reward.maxLife;\n        \n        if (reward.life <= 0) {\n            this.minerRewardDisplay = null;\n            return;\n        }\n        \n        // Draw reward text\n        this.ctx.fillStyle = reward.color;\n        this.ctx.globalAlpha = reward.alpha;\n        this.ctx.font = 'bold 14px Inter, Arial, sans-serif';\n        this.ctx.textAlign = 'center';\n        this.ctx.fillText(reward.text, reward.x, reward.y);\n        \n        // Add glow effect\n        this.ctx.shadowColor = reward.color;\n        this.ctx.shadowBlur = 8;\n        this.ctx.fillText(reward.text, reward.x, reward.y);\n        this.ctx.shadowBlur = 0;\n        \n        this.ctx.globalAlpha = 1.0;\n    }\n    \n    createRejectionParticles() {\n        // Create rejection particles around the mining block position\n        const totalBlocks = this.blocks.length;\n        let blockX;\n\n        if (totalBlocks <= 4) {\n            const visibleIndex = totalBlocks;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n        } else {\n            const visibleBlocks = [this.blocks[0], this.blocks[1], ...this.blocks.slice(-2)];\n            const visibleIndex = visibleBlocks.length;\n            blockX = this.chainStartX + visibleIndex * (this.blockWidth + this.blockSpacing) + this.blockWidth / 2;\n\n            if (totalBlocks > 4) {\n                blockX += 80;\n            }\n        }\n\n        const blockY = this.chainStartY + this.blockHeight / 2;\n\n        for (let i = 0; i < 20; i++) {\n            this.rejectionParticles.push({\n                x: blockX,\n                y: blockY,\n                vx: (Math.random() - 0.5) * 150,\n                vy: (Math.random() - 0.5) * 150,\n                life: 2.5,\n                maxLife: 2.5,\n                color: '#FF5722', // Red for rejection\n                size: 5\n            });\n        }\n    }\n} ","import { BrownianMotion, Diffusion, GasLaws } from './animations/particle-physics.js';\r\nimport { Pendulum, OrbitalMotion, CollisionPhysics, FrictionInclinedPlanes } from './animations/classical-mechanics.js';\r\nimport { SoundWaves, WavePropagation } from './animations/wave-phenomena.js';\r\nimport { ElectricFields, MagneticFields, DiodeTransistor } from './animations/elelectro-magnetism.js';\r\nimport { WaveParticleDuality } from './animations/quantum-physics.js';\r\nimport { NuclearReactions } from './animations/nuclear-physics.js';\r\nimport { FluidFlow, Bernoulli } from './animations/fluid-dynamics.js';\r\nimport { NeuralNetwork, MemoryManagement } from './animations/computer-science.js';\r\nimport { Blockchain } from './animations/blockchain.js';\r\n\r\n// Main animations controller\r\nexport class ScientificAnimations {\r\n    constructor(canvas) {\r\n        this.canvas = canvas;\r\n        this.ctx = canvas.getContext('2d');\r\n        this.currentAnimation = 'brownian';\r\n        this.isRunning = true;\r\n        this.lastTime = 0;\r\n        \r\n        // Initialize animations\r\n        this.brownianMotion = new BrownianMotion(this.ctx);\r\n        this.pendulum = new Pendulum(this.ctx);\r\n        this.diffusion = new Diffusion(this.ctx);\r\n        this.waves = new WavePropagation(this.ctx);\r\n        this.orbital = new OrbitalMotion(this.ctx);\r\n        this.electricFields = new ElectricFields(this.ctx);\r\n\r\n        this.gasLaws = new GasLaws(this.ctx);\r\n        this.collisions = new CollisionPhysics(this.ctx);\r\n        this.friction = new FrictionInclinedPlanes(this.ctx);\r\n\r\n        this.magneticFields = new MagneticFields(this.ctx);\r\n        this.waveParticleDuality = new WaveParticleDuality(this.ctx);\r\n        this.nuclearReactions = new NuclearReactions(this.ctx);\r\n        \r\n        // Initialize fluid dynamics\r\n        this.fluidFlow = new FluidFlow(this.ctx);\r\n        this.bernoulli = new Bernoulli(this.ctx);\r\n        \r\n        // Initialize sound waves\r\n        this.soundWaves = new SoundWaves(this.ctx);\r\n        \r\n        // Initialize diode and transistor\r\n        this.diodeTransistor = new DiodeTransistor(this.ctx);\r\n        \r\n        // Initialize computer science animations\r\n        this.neuralNetwork = new NeuralNetwork(this.ctx);\r\n        this.memoryManagement = new MemoryManagement(this.ctx);\r\n        this.blockchain = new Blockchain(this.ctx);\r\n        \r\n        this.setupEventListeners();\r\n        this.resizeCanvas();\r\n        \r\n        // Initialize all control panels with default values after a short delay\r\n        setTimeout(() => {\r\n            this.initializeWaveControls();\r\n            this.initializeSoundWavesControls();\r\n            this.initializeDiodeTransistorControls();\r\n        }, 100);\r\n        \r\n        this.animate();\r\n    }\r\n    \r\n    setupEventListeners() {\r\n        // Category header clicks\r\n        document.querySelectorAll('.category-header').forEach(header => {\r\n            header.addEventListener('click', (e) => {\r\n                const categoryItem = e.currentTarget.closest('.category-item');\r\n                const category = categoryItem.dataset.category;\r\n                const sideNav = document.querySelector('.side-navigation');\r\n                const mainContent = document.querySelector('.main-content');\r\n                \r\n                // If navigation is collapsed, expand it and don't switch animations\r\n                if (sideNav.classList.contains('collapsed')) {\r\n                    sideNav.classList.remove('collapsed');\r\n                    mainContent.classList.remove('nav-collapsed');\r\n                    return;\r\n                }\r\n                \r\n                // Close all other categories\r\n                document.querySelectorAll('.category-item').forEach(item => {\r\n                    if (item !== categoryItem) {\r\n                        item.classList.remove('active');\r\n                    }\r\n                });\r\n                \r\n                // Toggle current category\r\n                categoryItem.classList.toggle('active');\r\n                \r\n                // If this category is now active, switch to its first animation\r\n                if (categoryItem.classList.contains('active')) {\r\n                    const firstAnimation = categoryItem.querySelector('.submenu-item');\r\n                    if (firstAnimation && !firstAnimation.classList.contains('active')) {\r\n                        this.switchAnimation(firstAnimation.dataset.animation);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n\r\n        // Submenu item clicks\r\n        document.querySelectorAll('.submenu-item').forEach(item => {\r\n            item.addEventListener('click', (e) => {\r\n                const animation = e.currentTarget.dataset.animation;\r\n                \r\n                // Remove active class from all submenu items\r\n                document.querySelectorAll('.submenu-item').forEach(subItem => {\r\n                    subItem.classList.remove('active');\r\n                });\r\n                \r\n                // Add active class to clicked item\r\n                e.currentTarget.classList.add('active');\r\n                \r\n                // Switch to the selected animation\r\n                this.switchAnimation(animation);\r\n            });\r\n        });\r\n\r\n        // Navigation toggle (collapse/expand)\r\n        const navToggleBtn = document.querySelector('.nav-toggle-btn');\r\n        const sideNav = document.querySelector('.side-navigation');\r\n        const mainContent = document.querySelector('.main-content');\r\n        \r\n        if (navToggleBtn) {\r\n            navToggleBtn.addEventListener('click', () => {\r\n                sideNav.classList.toggle('collapsed');\r\n                mainContent.classList.toggle('nav-collapsed');\r\n            });\r\n        }\r\n\r\n        // Mobile navigation toggle\r\n        const mobileNavToggle = document.getElementById('mobileNavToggle');\r\n        \r\n        if (mobileNavToggle && sideNav) {\r\n            mobileNavToggle.addEventListener('click', () => {\r\n                mobileNavToggle.classList.toggle('open');\r\n                sideNav.classList.toggle('open');\r\n            });\r\n        }\r\n\r\n        // Close mobile nav when clicking outside\r\n        document.addEventListener('click', (e) => {\r\n            if (window.innerWidth <= 768) {\r\n                if (!e.target.closest('.side-navigation') && \r\n                    !e.target.closest('.mobile-nav-toggle')) {\r\n                    if (mobileNavToggle && sideNav) {\r\n                        mobileNavToggle.classList.remove('open');\r\n                        sideNav.classList.remove('open');\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        \r\n        // Control buttons\r\n        document.getElementById('playPauseBtn').addEventListener('click', () => {\r\n            this.togglePlayPause();\r\n        });\r\n        \r\n        document.getElementById('resetBtn').addEventListener('click', () => {\r\n            this.resetAnimation();\r\n        });\r\n        \r\n        // Learn More button\r\n        document.getElementById('learnMoreBtn').addEventListener('click', () => {\r\n            this.showScienceExplanation();\r\n        });\r\n        \r\n        // Modal close button\r\n        document.getElementById('closeModal').addEventListener('click', () => {\r\n            this.closeModal();\r\n        });\r\n        \r\n        // Close modal when clicking outside\r\n        document.getElementById('scienceModal').addEventListener('click', (e) => {\r\n            if (e.target.id === 'scienceModal') {\r\n                this.closeModal();\r\n            }\r\n        });\r\n        \r\n        // Close modal with Escape key\r\n        document.addEventListener('keydown', (e) => {\r\n            if (e.key === 'Escape') {\r\n                this.closeModal();\r\n            }\r\n        });\r\n        \r\n        // Brownian Motion Controls\r\n        this.setupSliderControl('particleCount', 'particleCountValue', (value) => {\r\n            this.brownianMotion.setParticleCount(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('speed', 'speedValue', (value) => {\r\n            this.brownianMotion.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('temperature', 'temperatureValue', (value) => {\r\n            this.brownianMotion.setTemperature(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('brownianParticleSize', 'brownianParticleSizeValue', (value) => {\r\n            this.brownianMotion.setParticleSize(parseInt(value));\r\n        });\r\n        \r\n        document.getElementById('brownianVisualizationMode').addEventListener('change', (e) => {\r\n            this.updateBrownianVisualization(e.target.value);\r\n        });\r\n        \r\n        // Initialize Brownian visualization mode\r\n        this.updateBrownianVisualization('basic');\r\n        \r\n        // Pendulum Controls\r\n        this.setupSliderControl('pendulumLength', 'pendulumLengthValue', (value) => {\r\n            this.pendulum.setLength(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('pendulumSpeed', 'pendulumSpeedValue', (value) => {\r\n            this.pendulum.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('initialAngle', 'initialAngleValue', (value) => {\r\n            this.pendulum.setInitialAngle(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('gravity', 'gravityValue', (value) => {\r\n            this.pendulum.setGravity(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('damping', 'dampingValue', (value) => {\r\n            this.pendulum.setDamping(parseFloat(value));\r\n        });\r\n        \r\n        document.getElementById('pendulumVisualizationMode').addEventListener('change', (e) => {\r\n            this.updatePendulumVisualization(e.target.value);\r\n        });\r\n        \r\n        // Initialize pendulum visualization mode\r\n        this.updatePendulumVisualization('basic');\r\n        \r\n        // Diffusion Controls\r\n        this.setupSliderControl('diffusionParticles', 'diffusionParticlesValue', (value) => {\r\n            this.diffusion.setParticleCount(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('diffusionSpeed', 'diffusionSpeedValue', (value) => {\r\n            this.diffusion.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('diffusionRate', 'diffusionRateValue', (value) => {\r\n            this.diffusion.setDiffusionRate(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('concentrationGradient', 'concentrationGradientValue', (value) => {\r\n            this.diffusion.setConcentrationGradient(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('diffusionParticleSize', 'diffusionParticleSizeValue', (value) => {\r\n            this.diffusion.setParticleSize(parseInt(value));\r\n        });\r\n        \r\n        document.getElementById('diffusionVisualizationMode').addEventListener('change', (e) => {\r\n            this.updateDiffusionVisualization(e.target.value);\r\n        });\r\n        \r\n        // Remove the start diffusion button event listener since the button was removed\r\n        // Diffusion will now start on canvas click/touch\r\n        \r\n        // Initialize diffusion visualization mode\r\n        this.updateDiffusionVisualization('basic');\r\n        \r\n        // Wave Controls\r\n        const waveTypeElement = document.getElementById('waveType');\r\n        if (waveTypeElement) {\r\n            waveTypeElement.addEventListener('change', (e) => {\r\n                e.stopPropagation(); // Prevent event bubbling\r\n                e.preventDefault(); // Prevent default behavior\r\n            this.waves.setWaveType(e.target.value);\r\n        });\r\n        }\r\n        \r\n        this.setupSliderControl('waveSpeed', 'waveSpeedValue', (value) => {\r\n            this.waves.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('waveFrequency', 'waveFrequencyValue', (value) => {\r\n            this.waves.setFrequency(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('waveAmplitude', 'waveAmplitudeValue', (value) => {\r\n            this.waves.setAmplitude(parseFloat(value));\r\n        });\r\n        \r\n        const waveShowAnalyticsElement = document.getElementById('waveShowAnalytics');\r\n        if (waveShowAnalyticsElement) {\r\n            waveShowAnalyticsElement.addEventListener('change', (e) => {\r\n            this.waves.setShowAnalytics(e.target.checked);\r\n        });\r\n        }\r\n        \r\n        // Sound Waves Controls\r\n        this.setupSliderControl('soundFrequency', 'soundFrequencyValue', (value) => {\r\n            this.soundWaves.setFrequency(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('soundAmplitude', 'soundAmplitudeValue', (value) => {\r\n            this.soundWaves.setAmplitude(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('soundSpeed', 'soundSpeedValue', (value) => {\r\n            this.soundWaves.setWaveSpeed(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('soundParticles', 'soundParticlesValue', (value) => {\r\n            this.soundWaves.setParticleCount(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('soundAnimationSpeed', 'soundAnimationSpeedValue', (value) => {\r\n            this.soundWaves.setAnimationSpeed(parseFloat(value));\r\n        });\r\n        \r\n        // Sound waves select and checkbox controls\r\n        const soundWaveTypeSelect = document.getElementById('soundWaveType');\r\n        if (soundWaveTypeSelect) {\r\n            soundWaveTypeSelect.addEventListener('change', (e) => {\r\n                this.soundWaves.setWaveType(e.target.value);\r\n            });\r\n        }\r\n        \r\n        // Orbital Motion Controls\r\n        this.setupSliderControl('orbitalSpeed', 'orbitalSpeedValue', (value) => {\r\n            this.orbital.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('eccentricity', 'eccentricityValue', (value) => {\r\n            this.orbital.setEccentricity(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('semiMajorAxis', 'semiMajorAxisValue', (value) => {\r\n            this.orbital.setSemiMajorAxis(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('centralMass', 'centralMassValue', (value) => {\r\n            this.orbital.setCentralMass(parseFloat(value));\r\n        });\r\n        \r\n        document.getElementById('orbitalVisualizationMode').addEventListener('change', (e) => {\r\n            this.updateOrbitalVisualization(e.target.value);\r\n        });\r\n        \r\n        // Initialize orbital visualization mode\r\n        this.updateOrbitalVisualization('basic');\r\n        \r\n        // Electric Fields Controls\r\n        this.setupSliderControl('efSpeed', 'efSpeedValue', (value) => {\r\n            this.electricFields.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('efFieldStrength', 'efFieldStrengthValue', (value) => {\r\n            this.electricFields.setFieldStrength(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('efParticleCount', 'efParticleCountValue', (value) => {\r\n            this.electricFields.setParticleCount(parseInt(value));\r\n        });\r\n        \r\n        // Removed addChargeBtn and clearChargesBtn event listeners\r\n        \r\n\r\n        \r\n        // Magnetic Fields Controls\r\n        this.setupSliderControl('magneticSpeed', 'magneticSpeedValue', (value) => {\r\n            this.magneticFields.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('magneticFieldStrength', 'magneticFieldStrengthValue', (value) => {\r\n            this.magneticFields.setFieldStrength(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('magneticParticleCount', 'magneticParticleCountValue', (value) => {\r\n            this.magneticFields.setParticleCount(parseInt(value));\r\n        });\r\n        \r\n        document.getElementById('magneticShowFieldLines').addEventListener('change', (e) => {\r\n            this.magneticFields.setShowFieldLines(e.target.checked);\r\n        });\r\n        \r\n\r\n        \r\n        document.getElementById('magneticShowForceArrows').addEventListener('change', (e) => {\r\n            this.magneticFields.setShowForceArrows(e.target.checked);\r\n        });\r\n        \r\n        // Removed addMagnetBtn and clearMagnetsBtn event listeners\r\n        \r\n        // Canvas click for adding charges, magnets, toggling switch, starting diffusion, and neural network testing\r\n        this.canvas.addEventListener('click', (e) => {\r\n            const rect = this.canvas.getBoundingClientRect();\r\n            const x = e.clientX - rect.left;\r\n            const y = e.clientY - rect.top;\r\n            \r\n            if (this.currentAnimation === 'electric-fields') {\r\n                const chargeType = document.getElementById('efChargeType').value;\r\n                this.electricFields.addChargeAtPosition(chargeType, x, y);\r\n            } else if (this.currentAnimation === 'magnetic-fields') {\r\n                // Add complete magnet with both poles\r\n                this.magneticFields.addMagnetAtPosition(x, y);\r\n\r\n            } else if (this.currentAnimation === 'diffusion' && !this.diffusion.diffusionStarted) {\r\n                this.diffusion.startDiffusion();\r\n            } else if (this.currentAnimation === 'sound-waves') {\r\n                const sx = this.soundWaves.sourceX;\r\n                const sy = this.soundWaves.sourceY;\r\n                const distance = Math.sqrt((x - sx) ** 2 + (y - sy) ** 2);\r\n                if (distance <= 50) {\r\n                    this.soundWaves.triggerWavePulse();\r\n                }\r\n            } else if (this.currentAnimation === 'neural-network') {\r\n                this.neuralNetwork.handleCanvasClick(x, y);\r\n            } else if (this.currentAnimation === 'memory-management' && this.memoryManagement) {\r\n                this.memoryManagement.handleClick(x, y);\r\n            }\r\n        });\r\n        \r\n        // Gas Laws Controls\r\n        this.setupSliderControl('gasSpeed', 'gasSpeedValue', (value) => {\r\n            this.gasLaws.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('gasParticleCount', 'gasParticleCountValue', (value) => {\r\n            this.gasLaws.setParticleCount(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('gasTemperature', 'gasTemperatureValue', (value) => {\r\n            this.gasLaws.setTemperature(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('gasVolume', 'gasVolumeValue', (value) => {\r\n            this.gasLaws.setVolume(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('gasPressure', 'gasPressureValue', (value) => {\r\n            this.gasLaws.setPressure(parseFloat(value));\r\n        });\r\n        \r\n        document.getElementById('gasVisualizationMode').addEventListener('change', (e) => {\r\n            this.updateGasVisualization(e.target.value);\r\n        });\r\n        \r\n        document.getElementById('lawType').addEventListener('change', (e) => {\r\n            this.gasLaws.setLawType(e.target.value);\r\n        });\r\n        \r\n        // Initialize gas visualization mode\r\n        this.updateGasVisualization('basic');\r\n        \r\n\r\n        \r\n        // Collision Physics Controls\r\n        this.setupSliderControl('collisionSpeed', 'collisionSpeedValue', (value) => {\r\n            this.collisions.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('ballCount', 'ballCountValue', (value) => {\r\n            this.collisions.setBallCount(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('restitution', 'restitutionValue', (value) => {\r\n            this.collisions.setRestitution(parseFloat(value));\r\n        });\r\n        \r\n\r\n        \r\n        this.setupSliderControl('collisionGravity', 'collisionGravityValue', (value) => {\r\n            this.collisions.setGravity(parseFloat(value));\r\n        });\r\n        \r\n        document.getElementById('showAnalytics').addEventListener('change', (e) => {\r\n            this.collisions.setShowAnalytics(e.target.checked);\r\n        });\r\n        \r\n        document.getElementById('collisionType').addEventListener('change', (e) => {\r\n            this.collisions.setCollisionType(e.target.value);\r\n        });\r\n        \r\n        // Friction & Inclined Planes Controls\r\n        this.setupSliderControl('frictionSpeed', 'frictionSpeedValue', (value) => {\r\n            this.friction.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('inclineAngle', 'inclineAngleValue', (value) => {\r\n            this.friction.setInclineAngle(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('objectMass', 'objectMassValue', (value) => {\r\n            this.friction.setObjectMass(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('frictionGravity', 'frictionGravityValue', (value) => {\r\n            this.friction.setGravity(parseFloat(value));\r\n        });\r\n        \r\n        document.getElementById('showFrictionAnalytics').addEventListener('change', (e) => {\r\n            this.friction.setShowAnalytics(e.target.checked);\r\n        });\r\n        \r\n        this.setupSliderControl('frictionCoefficient', 'frictionCoefficientValue', (value) => {\r\n            this.friction.setFrictionCoefficient(parseFloat(value));\r\n        });\r\n        \r\n\r\n        \r\n        // Window resize\r\n        window.addEventListener('resize', () => {\r\n            this.resizeCanvas();\r\n        });\r\n        \r\n        // Comprehensive touch event handling for mobile support\r\n        this.canvas.addEventListener('touchstart', (e) => {\r\n            e.preventDefault();\r\n            const rect = this.canvas.getBoundingClientRect();\r\n            const touch = e.touches[0];\r\n            const x = touch.clientX - rect.left;\r\n            const y = touch.clientY - rect.top;\r\n            \r\n            // Handle different animations based on current animation\r\n            if (this.currentAnimation === 'diffusion' && !this.diffusion.diffusionStarted) {\r\n                this.diffusion.startDiffusion();\r\n            } else if (this.currentAnimation === 'electric-fields') {\r\n                const chargeType = document.getElementById('efChargeType').value;\r\n                this.electricFields.addChargeAtPosition(chargeType, x, y);\r\n            } else if (this.currentAnimation === 'magnetic-fields') {\r\n                // Add complete magnet with both poles\r\n                this.magneticFields.addMagnetAtPosition(x, y);\r\n            } else if (this.currentAnimation === 'sound-waves') {\r\n                const sx = this.soundWaves.sourceX;\r\n                const sy = this.soundWaves.sourceY;\r\n                const distance = Math.sqrt((x - sx) ** 2 + (y - sy) ** 2);\r\n                if (distance <= 50) {\r\n                    this.soundWaves.triggerWavePulse();\r\n                }\r\n            } else if (this.currentAnimation === 'neural-network') {\r\n                this.neuralNetwork.handleCanvasClick(x, y);\r\n            } else if (this.currentAnimation === 'memory-management' && this.memoryManagement) {\r\n                this.memoryManagement.handleClick(x, y);\r\n            } else if (this.currentAnimation === 'nuclear-reactions') {\r\n                // Start reacting particle movement for nuclear reactions\r\n                this.nuclearReactions.reactingParticles.forEach(particle => {\r\n                    if (!particle.moving) {\r\n                        this.nuclearReactions.findTargetForParticle(particle);\r\n                        particle.moving = true;\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        \r\n        // Prevent default touch behaviors that might interfere\r\n        this.canvas.addEventListener('touchmove', (e) => {\r\n            e.preventDefault();\r\n        });\r\n        \r\n        this.canvas.addEventListener('touchend', (e) => {\r\n            e.preventDefault();\r\n        });\r\n        \r\n\r\n        \r\n        // Wave-Particle Duality Controls\r\n        document.getElementById('dualityMode').addEventListener('change', (e) => {\r\n            this.waveParticleDuality.setMode(e.target.value);\r\n            this.updateDualityControls(e.target.value);\r\n        });\r\n        \r\n        this.setupSliderControl('dualitySpeed', 'dualitySpeedValue', (value) => {\r\n            this.waveParticleDuality.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('dualityEnergy', 'dualityEnergyValue', (value) => {\r\n            this.waveParticleDuality.setPhotonEnergy(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('dualityWavelength', 'dualityWavelengthValue', (value) => {\r\n            this.waveParticleDuality.setWavelength(parseFloat(value));\r\n        });\r\n        \r\n\r\n        \r\n\r\n        \r\n        document.getElementById('performMeasurementBtn').addEventListener('click', () => {\r\n            this.waveParticleDuality.performMeasurement();\r\n        });\r\n        \r\n        // Removed resetDualityBtn event listener - main Reset button handles this\r\n        \r\n        // Initialize duality controls based on current mode\r\n        const initialMode = document.getElementById('dualityMode').value;\r\n        this.updateDualityControls(initialMode);\r\n        \r\n        this.setupSliderControl('nuclearSpeed', 'nuclearSpeedValue', (value) => {\r\n            this.nuclearReactions.setSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('neutronEnergy', 'neutronEnergyValue', (value) => {\r\n            this.nuclearReactions.setNeutronEnergy(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('nuclearTemperature', 'nuclearTemperatureValue', (value) => {\r\n            this.nuclearReactions.setTemperature(parseFloat(value));\r\n        });\r\n        \r\n        document.getElementById('nuclearMode').addEventListener('change', (e) => {\r\n            this.nuclearReactions.setMode(e.target.value);\r\n        });\r\n        \r\n        // Fluid Flow Controls\r\n        this.setupSliderControl('fluidSpeed', 'fluidSpeedValue', (value) => {\r\n            this.fluidFlow.setFlowRate(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('flowRate', 'flowRateValue', (value) => {\r\n            this.fluidFlow.setFlowRate(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('viscosity', 'viscosityValue', (value) => {\r\n            this.fluidFlow.setViscosity(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('reynoldsNumber', 'reynoldsNumberValue', (value) => {\r\n            this.fluidFlow.setReynoldsNumber(parseInt(value));\r\n        });\r\n        \r\n        document.getElementById('fluidVisualizationMode').addEventListener('change', (e) => {\r\n            this.fluidFlow.setVisualizationMode(e.target.value);\r\n        });\r\n        \r\n        // Bernoulli's Principle Controls\r\n        this.setupSliderControl('bernoulliSpeed', 'bernoulliSpeedValue', (value) => {\r\n            this.bernoulli.setPressureDifference(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('pipeWidth', 'pipeWidthValue', (value) => {\r\n            this.bernoulli.setPipeWidth(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('fluidDensity', 'fluidDensityValue', (value) => {\r\n            this.bernoulli.setFluidDensity(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('pressureDifference', 'pressureDifferenceValue', (value) => {\r\n            this.bernoulli.setPressureDifference(parseFloat(value));\r\n        });\r\n        \r\n        document.getElementById('bernoulliVisualizationMode').addEventListener('change', (e) => {\r\n            this.bernoulli.setVisualizationMode(e.target.value);\r\n        });\r\n        \r\n        // Sound Waves Controls\r\n        this.setupSliderControl('soundAnimationSpeed', 'soundAnimationSpeedValue', (value) => {\r\n            this.soundWaves.setAnimationSpeed(parseFloat(value));\r\n        });\r\n        \r\n        this.setupSliderControl('soundFrequency', 'soundFrequencyValue', (value) => {\r\n            this.soundWaves.setFrequency(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('soundAmplitude', 'soundAmplitudeValue', (value) => {\r\n            this.soundWaves.setAmplitude(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('soundSpeed', 'soundSpeedValue', (value) => {\r\n            this.soundWaves.setWaveSpeed(parseInt(value));\r\n        });\r\n        \r\n        this.setupSliderControl('soundParticles', 'soundParticlesValue', (value) => {\r\n            this.soundWaves.setParticleCount(parseInt(value));\r\n        });\r\n        \r\n        document.getElementById('soundWaveType').addEventListener('change', (e) => {\r\n            this.soundWaves.setWaveType(e.target.value);\r\n        });\r\n        \r\n        this.canvas.addEventListener('click', (e) => {\r\n            if (this.currentAnimation === 'sound-waves') {\r\n                const rect = this.canvas.getBoundingClientRect();\r\n                const x = e.clientX - rect.left;\r\n                const y = e.clientY - rect.top;\r\n                const sx = this.soundWaves.sourceX;\r\n                const sy = this.soundWaves.sourceY;\r\n                const distance = Math.sqrt((x - sx) ** 2 + (y - sy) ** 2);\r\n                if (distance <= 50) { // Increased click radius from 30 to 50 pixels\r\n                    this.soundWaves.triggerWavePulse();\r\n                }\r\n            }\r\n        });\r\n\r\n        // Diode & Transistor Controls\r\n        const componentTypeSelect = document.getElementById('diodeComponentType');\r\n        const biasTypeSelect = document.getElementById('diodeBiasType');\r\n        \r\n        if (componentTypeSelect) {\r\n            componentTypeSelect.addEventListener('change', (e) => {\r\n                if (this.diodeTransistor) {\r\n                    this.diodeTransistor.setComponentType(e.target.value);\r\n                }\r\n            });\r\n        }\r\n        \r\n        if (biasTypeSelect) {\r\n            biasTypeSelect.addEventListener('change', (e) => {\r\n                if (this.diodeTransistor) {\r\n                    this.diodeTransistor.setBiasType(e.target.value);\r\n                }\r\n            });\r\n        }\r\n        \r\n        this.setupSliderControl('diodeInputVoltage', 'diodeInputVoltageValue', (value) => {\r\n            if (this.diodeTransistor) {\r\n                this.diodeTransistor.setInputVoltage(parseFloat(value));\r\n            }\r\n        });\r\n        \r\n        this.setupSliderControl('diodeBaseVoltage', 'diodeBaseVoltageValue', (value) => {\r\n            if (this.diodeTransistor) {\r\n                this.diodeTransistor.setBaseVoltage(parseFloat(value));\r\n            }\r\n        });\r\n        \r\n        this.setupSliderControl('diodeAnimationSpeed', 'diodeAnimationSpeedValue', (value) => {\r\n            if (this.diodeTransistor) {\r\n                this.diodeTransistor.setAnimationSpeed(parseFloat(value));\r\n            }\r\n        });\r\n        \r\n        // Neural Network Controls\r\n        this.setupSliderControl('neuralLearningRate', 'neuralLearningRateValue', (value) => {\r\n            if (this.neuralNetwork) {\r\n                this.neuralNetwork.setLearningRate(parseFloat(value));\r\n            }\r\n        });\r\n        \r\n        this.setupSliderControl('neuralSpeed', 'neuralSpeedValue', (value) => {\r\n            if (this.neuralNetwork) {\r\n                this.neuralNetwork.setSpeed(parseFloat(value));\r\n            }\r\n        });\r\n        \r\n        // Memory Management Controls\r\n        this.setupSliderControl('memorySpeed', 'memorySpeedValue', (value) => {\r\n            if (this.memoryManagement) {\r\n                this.memoryManagement.setAnimationSpeed(parseFloat(value));\r\n            }\r\n        });\r\n        \r\n        // Show Program Output toggle\r\n        const showOutputCheckbox = document.getElementById('showOutput');\r\n        if (showOutputCheckbox && this.memoryManagement) {\r\n            showOutputCheckbox.checked = this.memoryManagement.showOutput;\r\n            showOutputCheckbox.addEventListener('change', (e) => {\r\n                this.memoryManagement.setShowOutput(e.target.checked);\r\n            });\r\n        }\r\n\r\n        // Blockchain Controls\r\n        this.setupSliderControl('blockchainSpeed', 'blockchainSpeedValue', (value) => {\r\n            if (this.blockchain) {\r\n                this.blockchain.setSpeed(parseFloat(value));\r\n            }\r\n        });\r\n        \r\n        this.setupSliderControl('blockchainDifficulty', 'blockchainDifficultyValue', (value) => {\r\n            if (this.blockchain) {\r\n                this.blockchain.setDifficulty(parseInt(value));\r\n            }\r\n        });\r\n        \r\n\r\n        \r\n\r\n        \r\n\r\n\r\n        // Neural Network Mode Selector\r\n        const neuralMode = document.getElementById('neuralMode');\r\n        if (neuralMode) {\r\n            neuralMode.addEventListener('change', (e) => {\r\n                if (this.neuralNetwork) {\r\n                    const isTesting = e.target.value === 'testing';\r\n                    this.neuralNetwork.setTestingMode(isTesting);\r\n                    \r\n                    // Set appropriate defaults for each mode\r\n                    if (isTesting) {\r\n                        this.neuralNetwork.setShowWeights(true);\r\n                        this.neuralNetwork.setShowGradients(false);\r\n                        this.neuralNetwork.setShowLoss(false);\r\n                        this.neuralNetwork.setAutoTrain(false);\r\n                    } else {\r\n                        this.neuralNetwork.setShowWeights(true);\r\n                        this.neuralNetwork.setShowGradients(false);\r\n                        this.neuralNetwork.setShowLoss(true);\r\n                        this.neuralNetwork.setAutoTrain(true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        \r\n\r\n    }\r\n    \r\n    setupSliderControl(sliderId, valueId, callback) {\r\n        const slider = document.getElementById(sliderId);\r\n        const valueDisplay = document.getElementById(valueId);\r\n        \r\n        if (!slider) {\r\n            console.warn(`Slider not found: ${sliderId}`);\r\n            return;\r\n        }\r\n        \r\n        if (!valueDisplay) {\r\n            console.warn(`Value display not found: ${valueId}`);\r\n            return;\r\n        }\r\n        \r\n        slider.addEventListener('input', (e) => {\r\n            const value = e.target.value;\r\n            const unit = sliderId.includes('Speed') ? 'x' : \r\n                        sliderId.includes('Angle') ? '°' : \r\n                        sliderId.includes('Length') ? '' : \r\n                        sliderId.includes('Wavelength') ? ' px' :\r\n                        sliderId.includes('Frequency') ? ' Hz' : \r\n                        sliderId.includes('gasTemperature') ? 'K' : \r\n                        sliderId.includes('frictionCoefficient') ? '' : \r\n                        sliderId.includes('Voltage') ? 'V' : '';\r\n            \r\n            valueDisplay.textContent = value + unit;\r\n            callback(value);\r\n        });\r\n    }\r\n    \r\n    updateDualityControls(mode) {\r\n        const performMeasurementBtn = document.getElementById('performMeasurementBtn');\r\n        \r\n        // Show measurement button only for superposition and measurement modes\r\n        if (mode === 'superposition' || mode === 'measurement') {\r\n            performMeasurementBtn.style.display = 'inline-block';\r\n        } else {\r\n            performMeasurementBtn.style.display = 'none';\r\n        }\r\n    }\r\n    \r\n    updateBrownianVisualization(mode) {\r\n        // Reset all visualization options\r\n        this.brownianMotion.setShowTemperatureHeatmap(false);\r\n        this.brownianMotion.setShowVelocityDistribution(false);\r\n        this.brownianMotion.setShowMeanFreePath(false);\r\n        \r\n        // Enable features based on mode\r\n        switch(mode) {\r\n            case 'basic':\r\n                // Just basic particle motion, no extra visualizations\r\n                break;\r\n            case 'heatmap':\r\n                this.brownianMotion.setShowTemperatureHeatmap(true);\r\n                break;\r\n            case 'advanced':\r\n                // Show all advanced features\r\n                this.brownianMotion.setShowTemperatureHeatmap(true);\r\n                this.brownianMotion.setShowVelocityDistribution(true);\r\n                this.brownianMotion.setShowMeanFreePath(true);\r\n                break;\r\n        }\r\n    }\r\n    \r\n    updateDiffusionVisualization(mode) {\r\n        const diffusion = this.diffusion;\r\n        \r\n        switch (mode) {\r\n            case 'basic':\r\n                diffusion.setShowConcentration(false);\r\n                diffusion.setShowConcentrationProfile(false);\r\n                diffusion.setShowParticleTrails(false);\r\n                break;\r\n            case 'heatmap':\r\n                diffusion.setShowConcentration(true);\r\n                diffusion.setShowConcentrationProfile(false);\r\n                diffusion.setShowParticleTrails(false);\r\n                break;\r\n            case 'profile':\r\n                diffusion.setShowConcentration(false);\r\n                diffusion.setShowConcentrationProfile(true);\r\n                diffusion.setShowParticleTrails(false);\r\n                break;\r\n            case 'advanced':\r\n                diffusion.setShowConcentration(true);\r\n                diffusion.setShowConcentrationProfile(true);\r\n                diffusion.setShowParticleTrails(true);\r\n                break;\r\n        }\r\n    }\r\n    \r\n    updateGasVisualization(mode) {\r\n        const gasLaws = this.gasLaws;\r\n        \r\n        switch (mode) {\r\n            case 'basic':\r\n                gasLaws.setShowPressureGauge(true);\r\n                gasLaws.setShowPressureHeatmap(false);\r\n                gasLaws.setShowVelocityDistribution(false);\r\n                gasLaws.setShowGasLawGraph(false);\r\n                gasLaws.setShowParticleCollisions(false);\r\n                break;\r\n            case 'pressure':\r\n                gasLaws.setShowPressureGauge(true);\r\n                gasLaws.setShowPressureHeatmap(true);\r\n                gasLaws.setShowVelocityDistribution(false);\r\n                gasLaws.setShowGasLawGraph(true);\r\n                gasLaws.setShowParticleCollisions(false);\r\n                break;\r\n            case 'advanced':\r\n                gasLaws.setShowPressureGauge(true);\r\n                gasLaws.setShowPressureHeatmap(true);\r\n                gasLaws.setShowVelocityDistribution(true);\r\n                gasLaws.setShowGasLawGraph(true);\r\n                gasLaws.setShowParticleCollisions(true);\r\n                break;\r\n        }\r\n    }\r\n    \r\n    updatePendulumVisualization(mode) {\r\n        const pendulum = this.pendulum;\r\n        \r\n        switch (mode) {\r\n            case 'basic':\r\n                pendulum.setShowPath(false);\r\n                pendulum.setShowVelocityVectors(false);\r\n                pendulum.setShowForceVectors(true);\r\n                pendulum.setShowEnergyInfo(false);\r\n                pendulum.setShowPhaseSpace(false);\r\n                break;\r\n            case 'vectors':\r\n                pendulum.setShowPath(false);\r\n                pendulum.setShowVelocityVectors(true);\r\n                pendulum.setShowForceVectors(true);\r\n                pendulum.setShowEnergyInfo(false);\r\n                pendulum.setShowPhaseSpace(false);\r\n                break;\r\n            case 'advanced':\r\n                pendulum.setShowPath(true);\r\n                pendulum.setShowVelocityVectors(true);\r\n                pendulum.setShowForceVectors(true);\r\n                pendulum.setShowEnergyInfo(true);\r\n                pendulum.setShowPhaseSpace(true);\r\n                break;\r\n        }\r\n    }\r\n    \r\n    updateOrbitalVisualization(mode) {\r\n        switch(mode) {\r\n            case 'basic':\r\n                this.orbital.setShowOrbitPath(true);\r\n                this.orbital.setShowVelocityVector(false);\r\n                this.orbital.setShowKeplerInfo(false);\r\n                break;\r\n            case 'advanced':\r\n                this.orbital.setShowOrbitPath(true);\r\n                this.orbital.setShowVelocityVector(true);\r\n                this.orbital.setShowKeplerInfo(true);\r\n                break;\r\n        }\r\n    }\r\n    \r\n    switchCategory(category) {\r\n        \r\n        // Update category buttons\r\n        document.querySelectorAll('.category-btn').forEach(btn => {\r\n            btn.classList.remove('active');\r\n        });\r\n        \r\n        const categoryBtn = document.querySelector(`[data-category=\"${category}\"]`);\r\n        if (categoryBtn) {\r\n            categoryBtn.classList.add('active');\r\n        }\r\n        \r\n        // Hide all animation groups\r\n        document.querySelectorAll('.animation-group').forEach(group => {\r\n            group.classList.remove('active');\r\n        });\r\n        \r\n        // Show current category's animations\r\n        const animationGroup = document.getElementById(`${category}-animations`);\r\n        if (animationGroup) {\r\n            animationGroup.classList.add('active');\r\n        }\r\n        \r\n        // Switch to first available animation in category\r\n        const firstAnimation = document.querySelector(`#${category}-animations .nav-btn:not(.disabled)`);\r\n        if (firstAnimation) {\r\n            this.switchAnimation(firstAnimation.dataset.animation);\r\n        } else {\r\n            console.warn('No available animations found for category:', category);\r\n        }\r\n    }\r\n    \r\n    switchAnimation(animationType) {\r\n        if (animationType === this.currentAnimation) {\r\n            return;\r\n        }\r\n        \r\n        // Update active submenu item\r\n        document.querySelectorAll('.submenu-item').forEach(item => {\r\n            item.classList.remove('active');\r\n        });\r\n        \r\n        const activeItem = document.querySelector(`[data-animation=\"${animationType}\"]`);\r\n        if (activeItem) {\r\n            activeItem.classList.add('active');\r\n            \r\n            // Ensure the parent category is active\r\n            const categoryItem = activeItem.closest('.category-item');\r\n            if (categoryItem) {\r\n                // Close all other categories\r\n                document.querySelectorAll('.category-item').forEach(item => {\r\n                    if (item !== categoryItem) {\r\n                        item.classList.remove('active');\r\n                    }\r\n                });\r\n                \r\n                // Open the parent category\r\n                categoryItem.classList.add('active');\r\n            }\r\n        }\r\n        \r\n\r\n        \r\n        // Hide all control panels\r\n        document.querySelectorAll('.animation-controls').forEach(panel => {\r\n            panel.style.display = 'none';\r\n        });\r\n        \r\n        // Show current control panel\r\n        const controlPanel = document.getElementById(`${animationType}-controls`);\r\n        if (controlPanel) {\r\n            controlPanel.style.display = 'block';\r\n        }\r\n        \r\n        // Hide all info panels\r\n        document.querySelectorAll('.animation-info').forEach(panel => {\r\n            panel.style.display = 'none';\r\n        });\r\n        \r\n        // Show current info panel\r\n        const infoPanel = document.getElementById(`${animationType}-info`);\r\n        if (infoPanel) {\r\n            infoPanel.style.display = 'block';\r\n        }\r\n        \r\n        this.currentAnimation = animationType;\r\n        this.resetAnimation();\r\n        \r\n        // Initialize wave controls if switching to waves animation\r\n        if (animationType === 'waves') {\r\n            this.initializeWaveControls();\r\n        }\r\n        \r\n        // Initialize sound waves controls if switching to sound-waves animation\r\n        if (animationType === 'sound-waves') {\r\n            this.initializeSoundWavesControls();\r\n        }\r\n        \r\n        // Initialize diode-transistor controls if switching to diode-transistor animation\r\n        if (animationType === 'diode-transistor') {\r\n            // Wait for the control panel to be visible before initializing\r\n            setTimeout(() => {\r\n                this.initializeDiodeTransistorControls();\r\n            }, 50);\r\n        }\r\n        \r\n        // Initialize memory management animation if switching to memory-management animation\r\n        if (animationType === 'memory-management') {\r\n            // Ensure memory management starts immediately\r\n            setTimeout(() => {\r\n                if (this.memoryManagement) {\r\n                    this.memoryManagement.startExecution();\r\n                }\r\n            }, 100);\r\n        }\r\n        \r\n\r\n    }\r\n    \r\n    initializeWaveControls() {\r\n        // Synchronize control values with wave parameters\r\n        const speedSlider = document.getElementById('waveSpeed');\r\n        const frequencySlider = document.getElementById('waveFrequency');\r\n        const amplitudeSlider = document.getElementById('waveAmplitude');\r\n        \r\n        if (speedSlider && this.waves) {\r\n            speedSlider.value = this.waves.speed;\r\n            document.getElementById('waveSpeedValue').textContent = this.waves.speed + 'x';\r\n        }\r\n        \r\n        if (frequencySlider && this.waves) {\r\n            frequencySlider.value = this.waves.frequency;\r\n            document.getElementById('waveFrequencyValue').textContent = this.waves.frequency;\r\n        }\r\n        \r\n        if (amplitudeSlider && this.waves) {\r\n            amplitudeSlider.value = this.waves.amplitude;\r\n            document.getElementById('waveAmplitudeValue').textContent = this.waves.amplitude;\r\n        }\r\n        \r\n        // Recalculate wave parameters to ensure they're correct\r\n        if (this.waves) {\r\n            this.waves.calculateWaveParameters();\r\n        }\r\n    }\r\n    \r\n    initializeSoundWavesControls() {\r\n        \r\n        // Synchronize control values with sound waves parameters\r\n        const frequencySlider = document.getElementById('soundFrequency');\r\n        const amplitudeSlider = document.getElementById('soundAmplitude');\r\n        const speedSlider = document.getElementById('soundSpeed');\r\n        const particlesSlider = document.getElementById('soundParticles');\r\n        const animationSpeedSlider = document.getElementById('soundAnimationSpeed');\r\n        const waveTypeSelect = document.getElementById('soundWaveType');\r\n        \r\n        if (frequencySlider && this.soundWaves) {\r\n            frequencySlider.value = this.soundWaves.frequency;\r\n            document.getElementById('soundFrequencyValue').textContent = this.soundWaves.frequency + ' Hz';\r\n        }\r\n        \r\n        if (amplitudeSlider && this.soundWaves) {\r\n            amplitudeSlider.value = this.soundWaves.amplitude;\r\n            document.getElementById('soundAmplitudeValue').textContent = this.soundWaves.amplitude + '%';\r\n        }\r\n        \r\n        if (speedSlider && this.soundWaves) {\r\n            speedSlider.value = this.soundWaves.waveSpeed;\r\n            document.getElementById('soundSpeedValue').textContent = this.soundWaves.waveSpeed + ' m/s';\r\n        }\r\n        \r\n        if (particlesSlider && this.soundWaves) {\r\n            particlesSlider.value = this.soundWaves.particleCount;\r\n            document.getElementById('soundParticlesValue').textContent = this.soundWaves.particleCount;\r\n        }\r\n        \r\n        if (animationSpeedSlider && this.soundWaves) {\r\n            animationSpeedSlider.value = this.soundWaves.animationSpeed;\r\n            document.getElementById('soundAnimationSpeedValue').textContent = this.soundWaves.animationSpeed + 'x';\r\n        }\r\n        \r\n        if (waveTypeSelect && this.soundWaves) {\r\n            waveTypeSelect.value = this.soundWaves.waveType;\r\n        }\r\n    }\r\n    \r\n    initializeDiodeTransistorControls() {\r\n        const componentTypeSelect = document.getElementById('diodeComponentType');\r\n        const biasTypeSelect = document.getElementById('diodeBiasType');\r\n        \r\n        if (componentTypeSelect && this.diodeTransistor) {\r\n            componentTypeSelect.value = this.diodeTransistor.componentType;\r\n            componentTypeSelect.dispatchEvent(new Event('change'));\r\n        }\r\n        if (biasTypeSelect && this.diodeTransistor) {\r\n            biasTypeSelect.value = this.diodeTransistor.biasType;\r\n            biasTypeSelect.dispatchEvent(new Event('change'));\r\n        }\r\n    }\r\n    \r\n    togglePlayPause() {\r\n        this.isRunning = !this.isRunning;\r\n        const btn = document.getElementById('playPauseBtn');\r\n        btn.textContent = this.isRunning ? 'Pause' : 'Play';\r\n    }\r\n    \r\n    resetAnimation() {\r\n        switch(this.currentAnimation) {\r\n            case 'brownian':\r\n                this.brownianMotion.reset();\r\n                break;\r\n            case 'pendulum':\r\n                this.pendulum.reset();\r\n                break;\r\n            case 'diffusion':\r\n                this.diffusion.reset();\r\n                break;\r\n            case 'waves':\r\n                this.waves.reset();\r\n                break;\r\n            case 'orbital':\r\n                this.orbital.reset();\r\n                break;\r\n            case 'electric-fields':\r\n                this.electricFields.reset();\r\n                break;\r\n            case 'gas-laws':\r\n                this.gasLaws.reset();\r\n                break;\r\n            case 'collisions':\r\n                this.collisions.reset();\r\n                break;\r\n            case 'friction':\r\n                this.friction.reset();\r\n                break;\r\n\r\n            case 'magnetic-fields':\r\n                this.magneticFields.reset();\r\n                break;\r\n\r\n            case 'wave-particle-duality':\r\n                this.waveParticleDuality.reset();\r\n                break;   \r\n            case 'nuclear-reactions':\r\n                this.nuclearReactions.reset();\r\n                break;\r\n            case 'fluid-flow':\r\n                this.fluidFlow.reset();\r\n                break;\r\n            case 'bernoulli':\r\n                this.bernoulli.reset();\r\n                break;\r\n            case 'sound-waves':\r\n                this.soundWaves.reset();\r\n                break;\r\n            case 'diode-transistor':\r\n                this.diodeTransistor.reset();\r\n                break;\r\n            case 'neural-network':\r\n                this.neuralNetwork.reset();\r\n                break;\r\n            case 'memory-management':\r\n                this.memoryManagement.reset();\r\n                break;\r\n            case 'blockchain':\r\n                this.blockchain.reset();\r\n                break;\r\n        }\r\n    }\r\n    \r\n    resizeCanvas() {\r\n        const container = this.canvas.parentElement;\r\n        // Account for padding: container has 20px padding, animation-container has 20px padding\r\n        const availableWidth = container.clientWidth - 40; // 20px padding on each side\r\n        const maxWidth = Math.max(availableWidth, 800); // Minimum width of 800px\r\n        \r\n        // Maintain 4:3 aspect ratio with minimum height\r\n        this.canvas.width = maxWidth;\r\n        this.canvas.height = Math.max(maxWidth / 1.333, 400); // 4:3 aspect ratio (1.333) with min height of 400px\r\n        \r\n        // Update source and receiver positions for sound waves\r\n        if (this.soundWaves) {\r\n            this.soundWaves.setSourcePosition(100, this.canvas.height / 2);\r\n            this.soundWaves.setReceiverPosition(this.canvas.width - 100, this.canvas.height / 2);\r\n        }\r\n        \r\n        // Resize neural network to center it on the new canvas size\r\n        if (this.neuralNetwork) {\r\n            this.neuralNetwork.resize();\r\n        }\r\n        \r\n        // Initialize neural network if it hasn't been initialized yet\r\n        if (this.neuralNetwork && this.neuralNetwork.neurons.length === 0) {\r\n            this.neuralNetwork.initializeNetwork();\r\n        }\r\n    }\r\n    \r\n    animate(currentTime = 0) {\r\n        if (!this.isRunning) {\r\n            requestAnimationFrame((time) => this.animate(time));\r\n            return;\r\n        }\r\n        \r\n        // Initialize lastTime on first frame\r\n        if (this.lastTime === undefined) {\r\n            this.lastTime = currentTime;\r\n        }\r\n        \r\n        const deltaTime = currentTime - this.lastTime;\r\n        this.lastTime = currentTime;\r\n        \r\n        // Clear canvas\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        \r\n        // Update and render current animation\r\n        switch(this.currentAnimation) {\r\n            case 'brownian':\r\n                this.brownianMotion.update(deltaTime);\r\n                this.brownianMotion.render();\r\n                this.updateBrownianStats();\r\n                break;\r\n            case 'pendulum':\r\n                this.pendulum.update(deltaTime);\r\n                this.pendulum.render();\r\n                this.updatePendulumStats();\r\n                break;\r\n            case 'diffusion':\r\n                this.diffusion.update(deltaTime);\r\n                this.diffusion.render();\r\n                this.updateDiffusionStats();\r\n                break;\r\n            case 'waves':\r\n                this.waves.update(deltaTime);\r\n                this.waves.render();\r\n                this.updateWaveStats();\r\n                break;\r\n            case 'orbital':\r\n                this.orbital.update(deltaTime);\r\n                this.orbital.render();\r\n                this.updateOrbitalStats();\r\n                break;\r\n            case 'electric-fields':\r\n                this.electricFields.update(deltaTime);\r\n                this.electricFields.render();\r\n                this.updateElectricFieldsStats();\r\n                break;\r\n            case 'gas-laws':\r\n                this.gasLaws.update(deltaTime);\r\n                this.gasLaws.render();\r\n                this.updateGasLawsStats();\r\n                break;\r\n            case 'collisions':\r\n                this.collisions.update(deltaTime);\r\n                this.collisions.render();\r\n                this.updateCollisionStats();\r\n                break;\r\n            case 'friction':\r\n                this.friction.update(deltaTime);\r\n                this.friction.render();\r\n                this.updateFrictionStats();\r\n                break;\r\n\r\n            case 'magnetic-fields':\r\n                this.magneticFields.update(deltaTime);\r\n                this.magneticFields.render();\r\n                this.updateMagneticFieldsStats();\r\n                break;\r\n\r\n            case 'wave-particle-duality':\r\n                this.waveParticleDuality.update(deltaTime);\r\n                this.waveParticleDuality.render();\r\n                this.updateWaveParticleDualityStats();\r\n                break;\r\n            case 'nuclear-reactions':\r\n                this.nuclearReactions.update(deltaTime);\r\n                this.nuclearReactions.render();\r\n                break;\r\n            case 'fluid-flow':\r\n                if (this.fluidFlow) {\r\n                    this.fluidFlow.update(deltaTime);\r\n                    this.fluidFlow.render();\r\n                    this.updateFluidFlowStats();\r\n                }\r\n                break;\r\n            case 'bernoulli':\r\n                if (this.bernoulli) {\r\n                    this.bernoulli.update(deltaTime);\r\n                    this.bernoulli.render();\r\n                    this.updateBernoulliStats();\r\n                }\r\n                break;\r\n            case 'sound-waves':\r\n                if (this.soundWaves) {\r\n                    this.soundWaves.update(deltaTime);\r\n                    this.soundWaves.render();\r\n                    this.updateSoundWavesStats();\r\n                }\r\n                break;\r\n            case 'diode-transistor':\r\n                if (this.diodeTransistor) {\r\n                    this.diodeTransistor.update(deltaTime);\r\n                    this.diodeTransistor.render();\r\n                    this.updateDiodeTransistorStats();\r\n                }\r\n                break;\r\n            case 'neural-network':\r\n                if (this.neuralNetwork) {\r\n                    this.neuralNetwork.update(deltaTime);\r\n                    this.neuralNetwork.render();\r\n                    this.updateNeuralNetworkStats();\r\n                }\r\n                break;\r\n            case 'memory-management':\r\n                if (this.memoryManagement) {\r\n                    this.memoryManagement.update(deltaTime);\r\n                    this.memoryManagement.render();\r\n                    this.updateMemoryManagementStats();\r\n                }\r\n                break;\r\n            case 'blockchain':\r\n                if (this.blockchain) {\r\n                    this.blockchain.update(deltaTime);\r\n                    this.blockchain.render();\r\n                    this.updateBlockchainStats();\r\n                } else {\r\n                    console.error('Blockchain instance not found!');\r\n                }\r\n                break;\r\n        }\r\n        \r\n        requestAnimationFrame((time) => this.animate(time));\r\n    }\r\n    \r\n    updateBrownianStats() {\r\n        const stats = this.brownianMotion.getStats();\r\n        document.getElementById('activeParticles').textContent = stats.particleCount;\r\n        document.getElementById('avgSpeed').textContent = stats.avgSpeed.toFixed(2);\r\n        document.getElementById('simTime').textContent = (stats.time / 1000).toFixed(1) + 's';\r\n        \r\n        // Update new statistics if elements exist\r\n        const collisionElement = document.getElementById('brownianCollisionCount');\r\n        const meanFreePathElement = document.getElementById('brownianMeanFreePath');\r\n        const temperatureElement = document.getElementById('brownianTemperature');\r\n        \r\n        if (collisionElement) collisionElement.textContent = stats.collisionCount;\r\n        if (meanFreePathElement) meanFreePathElement.textContent = stats.meanFreePath.toFixed(1);\r\n        if (temperatureElement) temperatureElement.textContent = stats.temperature.toFixed(1);\r\n    }\r\n    \r\n    updatePendulumStats() {\r\n        const stats = this.pendulum.getStats();\r\n        document.getElementById('currentAngle').textContent = stats.angle.toFixed(1) + '°';\r\n        document.getElementById('angularVelocity').textContent = stats.angularVelocity.toFixed(2);\r\n        document.getElementById('period').textContent = stats.theoreticalPeriod.toFixed(2) + 's';\r\n        document.getElementById('pendulumTime').textContent = (stats.time / 1000).toFixed(1) + 's';\r\n        \r\n        // Update air resistance information\r\n        const airResistanceElement = document.getElementById('pendulumAirResistance');\r\n        const dampingElement = document.getElementById('pendulumDamping');\r\n        if (airResistanceElement) {\r\n            airResistanceElement.textContent = stats.airResistanceForce.toFixed(3);\r\n        }\r\n        if (dampingElement) {\r\n            dampingElement.textContent = stats.dampingCoefficient.toFixed(3);\r\n        }\r\n    }\r\n    \r\n    updateDiffusionStats() {\r\n        const stats = this.diffusion.getStats();\r\n        document.getElementById('diffusionParticleCount').textContent = stats.particleCount;\r\n        document.getElementById('diffusionAvgSpeed').textContent = stats.avgSpeed.toFixed(2);\r\n        document.getElementById('concentrationSpread').textContent = stats.concentrationSpread.toFixed(2);\r\n        document.getElementById('diffusionTime').textContent = (stats.time / 1000).toFixed(1) + 's';\r\n    }\r\n    \r\n\r\n    \r\n    updateWaveStats() {\r\n        const stats = this.waves.getStats();\r\n        document.getElementById('currentWaveType').textContent = stats.waveType;\r\n        document.getElementById('currentFrequency').textContent = stats.frequency + ' Hz';\r\n        document.getElementById('currentWavelength').textContent = stats.wavelength + ' px';\r\n        document.getElementById('currentAmplitude').textContent = stats.amplitude + ' px';\r\n        document.getElementById('currentWaveSpeed').textContent = stats.waveSpeed + ' px/s';\r\n        document.getElementById('currentWaveEnergy').textContent = stats.energy;\r\n        document.getElementById('wavesTime').textContent = stats.time + 's';\r\n    }\r\n    \r\n    updateOrbitalStats() {\r\n        const stats = this.orbital.getStats();\r\n        document.getElementById('orbitalPeriod').textContent = stats.period.toFixed(2) + 's';\r\n        document.getElementById('orbitalSpeed').textContent = stats.speed.toFixed(2);\r\n        document.getElementById('orbitalDistance').textContent = stats.distance.toFixed(1);\r\n        document.getElementById('orbitalTime').textContent = (stats.time / 1000).toFixed(1) + 's';\r\n        \r\n        // Display eccentricity value\r\n        if (stats.eccentricity !== undefined) {\r\n            document.getElementById('orbitalEccentricity').textContent = stats.eccentricity.toFixed(2);\r\n        }\r\n    }\r\n    \r\n    updateElectricFieldsStats() {\r\n        const stats = this.electricFields.getStats();\r\n        document.getElementById('activeCharges').textContent = stats.chargeCount;\r\n        document.getElementById('efParticleCount').textContent = stats.particleCount;\r\n        document.getElementById('efFieldStrength').textContent = stats.fieldStrength;\r\n        document.getElementById('efTime').textContent = stats.time + 's';\r\n    }\r\n    \r\n    updateGasLawsStats() {\r\n        const stats = this.gasLaws.getStats();\r\n        document.getElementById('gasParticleCount').textContent = stats.particleCount;\r\n        document.getElementById('gasTemperature').textContent = stats.temperature + 'K';\r\n        document.getElementById('gasPressure').textContent = stats.pressure.toFixed(2);\r\n        document.getElementById('gasVolume').textContent = stats.volume;\r\n    }\r\n    \r\n\r\n    \r\n    updateCollisionStats() {\r\n        const stats = this.collisions.getStats();\r\n        document.getElementById('collisionBallCount').textContent = stats.ballCount;\r\n        document.getElementById('collisionMomentum').textContent = stats.totalMomentum.toFixed(1);\r\n        document.getElementById('collisionEnergy').textContent = stats.totalEnergy.toFixed(1);\r\n        document.getElementById('collisionCount').textContent = stats.collisionCount;\r\n    }\r\n    \r\n    updateFrictionStats() {\r\n        const stats = this.friction.getStats();\r\n        document.getElementById('frictionSurface').textContent = stats.surfaceType;\r\n        document.getElementById('frictionAngle').textContent = stats.inclineAngle + '°';\r\n        document.getElementById('frictionNetForce').textContent = stats.netForce.toFixed(1);\r\n        document.getElementById('frictionAcceleration').textContent = stats.acceleration.toFixed(2);\r\n    }\r\n    \r\n\r\n    \r\n    updateMagneticFieldsStats() {\r\n        const stats = this.magneticFields.getStats();\r\n        document.getElementById('magneticFieldStrength').textContent = stats.fieldStrength;\r\n        document.getElementById('magneticParticleCount').textContent = stats.particleCount;\r\n        document.getElementById('magneticTime').textContent = stats.time + 's';\r\n    }\r\n    \r\n\r\n    \r\n    updateWaveParticleDualityStats() {\r\n        const stats = this.waveParticleDuality.getStats();\r\n        // Update stats display elements if they exist\r\n        const modeElement = document.getElementById('currentDualityMode');\r\n        const energyElement = document.getElementById('currentPhotonEnergy');\r\n        const wavelengthElement = document.getElementById('currentDualityWavelength');\r\n        const waveFunctionElement = document.getElementById('waveFunctionStatus');\r\n        const interferenceElement = document.getElementById('interferenceStatus');\r\n        const measurementElement = document.getElementById('measurementCount');\r\n        const timeElement = document.getElementById('dualityTime');\r\n        \r\n        if (modeElement) modeElement.textContent = stats.mode;\r\n        if (energyElement) energyElement.textContent = stats.photonEnergy + ' eV';\r\n        if (wavelengthElement) wavelengthElement.textContent = stats.wavelength + ' nm';\r\n        if (waveFunctionElement) waveFunctionElement.textContent = this.waveParticleDuality.showWaveFunction ? 'Active' : 'Hidden';\r\n        if (interferenceElement) interferenceElement.textContent = this.waveParticleDuality.showInterference ? 'Visible' : 'Hidden';\r\n        if (measurementElement) measurementElement.textContent = stats.measurementCount;\r\n        if (timeElement) timeElement.textContent = stats.time + 's';\r\n    }\r\n    \r\n    updateFluidFlowStats() {\r\n        if (!this.fluidFlow) return;\r\n        \r\n        const stats = this.fluidFlow.getStats();\r\n        // Update stats display elements if they exist\r\n        const flowRateElement = document.getElementById('fluidFlowRate');\r\n        const viscosityElement = document.getElementById('fluidViscosity');\r\n        const reynoldsElement = document.getElementById('reynoldsNumberValue');\r\n        const flowTypeElement = document.getElementById('flowType');\r\n        const avgVelocityElement = document.getElementById('averageVelocity');\r\n        const timeElement = document.getElementById('fluidTime');\r\n        \r\n        if (flowRateElement) flowRateElement.textContent = stats.flowRate.toFixed(1);\r\n        if (viscosityElement) viscosityElement.textContent = stats.viscosity.toFixed(1);\r\n        if (reynoldsElement) reynoldsElement.textContent = stats.reynoldsNumber;\r\n        if (flowTypeElement) flowTypeElement.textContent = stats.flowType;\r\n        if (avgVelocityElement) avgVelocityElement.textContent = stats.averageVelocity.toFixed(2);\r\n        if (timeElement) timeElement.textContent = (stats.time / 1000).toFixed(1) + 's';\r\n    }\r\n    \r\n    updateBernoulliStats() {\r\n        if (!this.bernoulli) return;\r\n        \r\n        const stats = this.bernoulli.getStats();\r\n        // Update stats display elements if they exist\r\n        const pipeWidthElement = document.getElementById('bernoulliPipeWidth');\r\n        const densityElement = document.getElementById('bernoulliDensity');\r\n        const pressureElement = document.getElementById('bernoulliPressureDiff');\r\n        const velocityRatioElement = document.getElementById('velocityRatio');\r\n        const energyElement = document.getElementById('energyConservation');\r\n        const timeElement = document.getElementById('bernoulliTime');\r\n        \r\n        if (pipeWidthElement) pipeWidthElement.textContent = stats.pipeWidth;\r\n        if (densityElement) densityElement.textContent = stats.fluidDensity.toFixed(1);\r\n        if (pressureElement) pressureElement.textContent = stats.pressureDifference.toFixed(1);\r\n        if (velocityRatioElement) velocityRatioElement.textContent = stats.velocityRatio.toFixed(1);\r\n        if (energyElement) energyElement.textContent = stats.energyConservation;\r\n        if (timeElement) timeElement.textContent = (stats.time / 1000).toFixed(1) + 's';\r\n    }\r\n    \r\n    updateSoundWavesStats() {\r\n        if (!this.soundWaves) return;\r\n        \r\n        const stats = this.soundWaves.getStats();\r\n        // Update stats display elements if they exist\r\n        const waveTypeElement = document.getElementById('soundWaveTypeDisplay');\r\n        const frequencyElement = document.getElementById('soundFrequency');\r\n        const wavelengthElement = document.getElementById('soundWavelength');\r\n        const waveSpeedElement = document.getElementById('soundWaveSpeed');\r\n        const amplitudeElement = document.getElementById('soundAmplitude');\r\n        const particleCountElement = document.getElementById('soundParticleCount');\r\n        const timeElement = document.getElementById('soundTime');\r\n        \r\n        if (waveTypeElement) waveTypeElement.textContent = stats.waveType.charAt(0).toUpperCase() + stats.waveType.slice(1);\r\n        if (frequencyElement) frequencyElement.textContent = stats.frequency + ' Hz';\r\n        if (wavelengthElement) wavelengthElement.textContent = stats.wavelength.toFixed(2) + ' m';\r\n        if (waveSpeedElement) waveSpeedElement.textContent = stats.waveSpeed + ' m/s';\r\n        if (amplitudeElement) amplitudeElement.textContent = stats.amplitude + '%';\r\n        if (particleCountElement) particleCountElement.textContent = stats.particleCount;\r\n        if (timeElement) timeElement.textContent = (stats.time / 1000).toFixed(1) + 's';\r\n    }\r\n    \r\n    updateDiodeTransistorStats() {\r\n        if (!this.diodeTransistor) return;\r\n        \r\n        const stats = this.diodeTransistor.getStats();\r\n        // Update stats display elements if they exist\r\n        const componentTypeElement = document.getElementById('diodeComponentTypeDisplay');\r\n        const biasTypeElement = document.getElementById('diodeBiasTypeDisplay');\r\n        const inputVoltageElement = document.getElementById('diodeInputVoltageDisplay');\r\n        const baseVoltageElement = document.getElementById('diodeBaseVoltageDisplay');\r\n        const currentElement = document.getElementById('diodeCurrent');\r\n        const powerElement = document.getElementById('diodePower');\r\n        const statusElement = document.getElementById('diodeStatus');\r\n        const temperatureElement = document.getElementById('diodeTemperature');\r\n        const timeElement = document.getElementById('diodeTime');\r\n        \r\n        if (componentTypeElement) componentTypeElement.textContent = stats.componentType.toUpperCase();\r\n        if (biasTypeElement) biasTypeElement.textContent = stats.biasType.toUpperCase();\r\n        if (inputVoltageElement) inputVoltageElement.textContent = stats.inputVoltage + 'V';\r\n        if (baseVoltageElement) baseVoltageElement.textContent = stats.baseVoltage + 'V';\r\n        if (currentElement) currentElement.textContent = stats.current.toFixed(1) + 'mA';\r\n        if (powerElement) powerElement.textContent = stats.power.toFixed(1) + 'mW';\r\n        if (statusElement) statusElement.textContent = stats.isActive ? 'ACTIVE' : 'INACTIVE';\r\n        if (temperatureElement) temperatureElement.textContent = stats.temperature + '°C';\r\n        if (timeElement) timeElement.textContent = (stats.time / 1000).toFixed(1) + 's';\r\n        \r\n        // Show/hide base voltage stat based on component type\r\n        const baseVoltageStat = document.getElementById('baseVoltageStat');\r\n        if (baseVoltageStat) {\r\n            baseVoltageStat.style.display = (stats.componentType === 'npn' || stats.componentType === 'pnp') ? 'block' : 'none';\r\n        }\r\n    }\r\n    \r\n    updateNeuralNetworkStats() {\r\n        if (!this.neuralNetwork) return;\r\n        \r\n        const stats = this.neuralNetwork.getStats();\r\n        // Update stats display elements if they exist\r\n        const epochElement = document.getElementById('neuralEpoch');\r\n        const lossElement = document.getElementById('neuralLoss');\r\n        const accuracyElement = document.getElementById('neuralAccuracy');\r\n        const learningRateElement = document.getElementById('neuralLearningRate');\r\n        const speedElement = document.getElementById('neuralSpeed');\r\n        const phaseElement = document.getElementById('neuralPhase');\r\n        const dataIndexElement = document.getElementById('neuralDataIndex');\r\n        \r\n        if (epochElement) epochElement.textContent = stats.epoch;\r\n        if (lossElement) lossElement.textContent = stats.currentLoss.toFixed(4);\r\n        if (accuracyElement) accuracyElement.textContent = (stats.currentAccuracy * 100).toFixed(1) + '%';\r\n        if (learningRateElement) learningRateElement.textContent = stats.learningRate;\r\n        if (speedElement) speedElement.textContent = stats.speed.toFixed(1) + 'x';\r\n        if (phaseElement) phaseElement.textContent = stats.animationPhase;\r\n        if (dataIndexElement) dataIndexElement.textContent = stats.trainingDataIndex;\r\n    }\r\n    \r\n    showScienceExplanation() {\r\n        const modal = document.getElementById('scienceModal');\r\n        const modalTitle = document.getElementById('modalTitle');\r\n        const modalContent = document.getElementById('modalContent');\r\n        \r\n        // Get content based on current animation\r\n        const content = this.getScienceContent();\r\n        \r\n        // Update modal content\r\n        modalTitle.textContent = content.title;\r\n        modalContent.innerHTML = content.html;\r\n        \r\n        // Show modal\r\n        modal.style.display = 'block';\r\n    }\r\n    \r\n    closeModal() {\r\n        const modal = document.getElementById('scienceModal');\r\n        modal.style.display = 'none';\r\n    }\r\n    \r\n    getCurrentAnimationState() {\r\n        const state = {\r\n            animation: this.currentAnimation,\r\n            controls: {},\r\n            stats: {}\r\n        };\r\n        \r\n        // Get current control values and stats based on animation type\r\n        switch(this.currentAnimation) {\r\n            case 'brownian':\r\n                state.controls = {\r\n                    particleCount: document.getElementById('brownianParticleCount')?.value || '15',\r\n                    temperature: document.getElementById('brownianTemperature')?.value || '1.0',\r\n                    speed: document.getElementById('brownianSpeed')?.value || '1.0'\r\n                };\r\n                state.stats = this.brownianMotion?.getStats() || {};\r\n                break;\r\n            case 'pendulum':\r\n                state.controls = {\r\n                    length: document.getElementById('pendulumLength')?.value || '100',\r\n                    gravity: document.getElementById('pendulumGravity')?.value || '9.8',\r\n                    damping: document.getElementById('pendulumDamping')?.value || '0.01'\r\n                };\r\n                state.stats = this.pendulum?.getStats() || {};\r\n                break;\r\n            case 'waves':\r\n                state.controls = {\r\n                    waveType: document.getElementById('waveType')?.value || 'transverse',\r\n                    frequency: document.getElementById('waveFrequency')?.value || '1.0',\r\n                    amplitude: document.getElementById('waveAmplitude')?.value || '50'\r\n                };\r\n                state.stats = this.wavePropagation?.getStats() || {};\r\n                break;\r\n            case 'electric-fields':\r\n                state.controls = {\r\n                    fieldStrength: document.getElementById('efFieldStrength')?.value || '1.0',\r\n                    particleCount: document.getElementById('efParticleCount')?.value || '20'\r\n                };\r\n                state.stats = this.electricFields?.getStats() || {};\r\n                break;\r\n            case 'magnetic-fields':\r\n                state.controls = {\r\n                    fieldStrength: document.getElementById('magneticFieldStrength')?.value || '1.0',\r\n                    particleCount: document.getElementById('magneticParticleCount')?.value || '15'\r\n                };\r\n                state.stats = this.magneticFields?.getStats() || {};\r\n                break;\r\n            case 'gas-laws':\r\n                state.controls = {\r\n                    temperature: document.getElementById('gasTemperature')?.value || '300',\r\n                    pressure: document.getElementById('gasPressure')?.value || '1.0',\r\n                    volume: document.getElementById('gasVolume')?.value || '300'\r\n                };\r\n                state.stats = this.gasLaws?.getStats() || {};\r\n                break;\r\n            case 'collisions':\r\n                state.controls = {\r\n                    ballCount: document.getElementById('ballCount')?.value || '5',\r\n                    restitution: document.getElementById('restitution')?.value || '0.8',\r\n                    gravity: document.getElementById('collisionGravity')?.value || '9.8'\r\n                };\r\n                state.stats = this.collisions?.getStats() || {};\r\n                break;\r\n            case 'friction':\r\n                state.controls = {\r\n                    angle: document.getElementById('inclineAngle')?.value || '20',\r\n                    frictionCoefficient: document.getElementById('frictionCoefficient')?.value || '0.3',\r\n                    mass: document.getElementById('objectMass')?.value || '1'\r\n                };\r\n                state.stats = this.friction?.getStats() || {};\r\n                break;\r\n\r\n            case 'wave-particle-duality':\r\n                state.controls = {\r\n                    mode: document.getElementById('dualityMode')?.value || 'wave',\r\n                    energy: document.getElementById('dualityEnergy')?.value || '5.0',\r\n                    wavelength: document.getElementById('dualityWavelength')?.value || '150'\r\n                };\r\n                state.stats = this.waveParticleDuality?.getStats() || {};\r\n                break;\r\n            case 'sound-waves':\r\n                state.controls = {\r\n                    waveType: document.getElementById('soundWaveType')?.value || 'transverse',\r\n                    frequency: document.getElementById('soundFrequency')?.value || '5',\r\n                    amplitude: document.getElementById('soundAmplitude')?.value || '50',\r\n                    waveSpeed: document.getElementById('soundSpeed')?.value || '343',\r\n                    particleCount: document.getElementById('soundParticles')?.value || '15',\r\n                    animationSpeed: document.getElementById('soundAnimationSpeed')?.value || '1.0'\r\n                };\r\n                state.stats = this.soundWaves?.getStats() || {};\r\n                break;\r\n            case 'diode-transistor':\r\n                state.controls = {\r\n                    componentType: document.getElementById('diodeComponentType')?.value || 'diode',\r\n                    biasType: document.getElementById('diodeBiasType')?.value || 'forward',\r\n                    inputVoltage: document.getElementById('diodeInputVoltage')?.value || '5',\r\n                    baseVoltage: document.getElementById('diodeBaseVoltage')?.value || '0.7',\r\n                    animationSpeed: document.getElementById('diodeAnimationSpeed')?.value || '1.0'\r\n                };\r\n                state.stats = this.diodeTransistor?.getStats() || {};\r\n                break;\r\n            case 'neural-network':\r\n                state.controls = {\r\n                    learningRate: document.getElementById('neuralLearningRate')?.value || '0.1',\r\n                    speed: document.getElementById('neuralSpeed')?.value || '1.0',\r\n                    mode: document.getElementById('neuralMode')?.value || 'training'\r\n                };\r\n                state.stats = this.neuralNetwork?.getStats() || {};\r\n                break;\r\n            case 'memory-management':\r\n                state.controls = {\r\n                    mode: document.getElementById('memoryMode')?.value || 'random',\r\n                    retentionRate: document.getElementById('retentionRate')?.value || '0.5',\r\n                    decayRate: document.getElementById('decayRate')?.value || '0.1'\r\n                };\r\n                state.stats = this.memoryManagement?.getStats() || {};\r\n                break;\r\n        }\r\n        \r\n        return state;\r\n    }\r\n    \r\n    getScienceContent() {\r\n        switch (this.currentAnimation) {\r\n            case 'brownian':\r\n                return {\r\n                    title: 'Brownian Motion - Random Particle Movement',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What is Brownian Motion?</h3>\r\n                            <p>Brownian motion is the random, erratic movement of particles suspended in a fluid (liquid or gas) caused by collisions with fast-moving molecules in the surrounding medium. This phenomenon was first observed by botanist Robert Brown in 1827 when studying pollen grains in water.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Molecular Motion:</strong> All particles are in constant motion due to thermal energy</li>\r\n                                <li><strong>Random Walk:</strong> Each collision changes the particle's direction randomly</li>\r\n                                <li><strong>Temperature Dependence:</strong> Higher temperature = faster molecular motion = more vigorous Brownian motion</li>\r\n                                <li><strong>Particle Size Effect:</strong> Smaller particles show more dramatic Brownian motion</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Particles moving in seemingly random directions</li>\r\n                                <li>No predictable path - each particle follows a \"random walk\"</li>\r\n                                <li>Particles occasionally changing direction due to collisions</li>\r\n                                <li>Faster movement at higher temperatures</li>\r\n                                <li>Different colored particles for easy tracking</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Diffusion of molecules in cells</li>\r\n                                <li>Particle movement in air pollution</li>\r\n                                <li>Understanding molecular motion in chemistry</li>\r\n                                <li>Brownian motion in financial markets</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Mathematical Description</h3>\r\n                            <p>The mean squared displacement (MSD) of a Brownian particle follows: <strong>MSD = 6Dt</strong>, where D is the diffusion coefficient and t is time. This relationship shows that the average distance a particle travels increases with the square root of time.</p>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'sound-waves':\r\n                return {\r\n                    title: 'Sound Waves - Wave Propagation',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What are Sound Waves?</h3>\r\n                            <p>Sound waves are mechanical waves that propagate through a medium (like air, water, or solids) by causing particles to vibrate. They are longitudinal waves, meaning the particles move back and forth in the same direction as the wave travels.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Longitudinal Waves:</strong> Particles oscillate parallel to wave direction</li>\r\n                                <li><strong>Transverse Waves:</strong> Particles oscillate perpendicular to wave direction</li>\r\n                                <li><strong>Compression & Rarefaction:</strong> High and low pressure regions in the medium</li>\r\n                                <li><strong>Wave Speed:</strong> v = fλ, where f is frequency and λ is wavelength</li>\r\n                                <li><strong>Amplitude:</strong> Maximum displacement of particles from equilibrium</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Wave pulse traveling from source to receiver</li>\r\n                                <li>Particles moving as the wave passes through</li>\r\n                                <li>Compression zones (orange) and rarefaction zones (cyan)</li>\r\n                                <li>Different wave types: transverse, longitudinal, and combined</li>\r\n                                <li>Wave speed and frequency effects on propagation</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Wave Types Explained</h3>\r\n                            <ul>\r\n                                <li><strong>Transverse:</strong> Like waves on a string - particles move up and down</li>\r\n                                <li><strong>Longitudinal:</strong> Like sound in air - particles move back and forth</li>\r\n                                <li><strong>Combined:</strong> Shows both transverse and longitudinal components</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Musical instruments and sound production</li>\r\n                                <li>Ultrasound imaging in medicine</li>\r\n                                <li>Seismic waves in earthquake detection</li>\r\n                                <li>Sonar and underwater communication</li>\r\n                                <li>Acoustic engineering and noise control</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Mathematical Description</h3>\r\n                            <p>For a sound wave: <strong>v = √(B/ρ)</strong>, where v is wave speed, B is bulk modulus, and ρ is density. The frequency determines pitch, while amplitude determines loudness. The relationship <strong>v = fλ</strong> connects speed, frequency, and wavelength.</p>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'diode-transistor':\r\n                return {\r\n                    title: 'Diode & Transistor - Electronic Components',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What are Diodes and Transistors?</h3>\r\n                            <p>Diodes and transistors are fundamental electronic components that control the flow of electrical current. Diodes allow current to flow in one direction only, while transistors can amplify signals and act as electronic switches.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Semiconductor Physics:</strong> Materials with conductivity between conductors and insulators</li>\r\n                                <li><strong>P-N Junction:</strong> Boundary between P-type (holes) and N-type (electrons) materials</li>\r\n                                <li><strong>Forward Bias:</strong> Positive voltage applied to P-side, negative to N-side</li>\r\n                                <li><strong>Reverse Bias:</strong> Opposite voltage polarity blocks current flow</li>\r\n                                <li><strong>Transistor Amplification:</strong> Small base current controls large collector current</li>\r\n                                <li><strong>Particle Flow:</strong> Electrons and holes flow in opposite directions but contribute to current in the same direction</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li><strong>Electrons (blue circles):</strong> Move from N-type to P-type material during forward bias</li>\r\n                                <li><strong>Holes (red outlined circles):</strong> Move from P-type to N-type material during forward bias</li>\r\n                                <li><strong>Current Flow:</strong> Only occurs in forward bias conditions with sufficient voltage</li>\r\n                                <li><strong>Voltage Drop:</strong> ~0.7V across diode in forward bias</li>\r\n                                <li><strong>Transistor Control:</strong> Base voltage controls collector current amplification</li>\r\n                                <li><strong>Energy Visualization:</strong> Pulsating circles represent electromagnetic field and power dissipation</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Component Behavior</h3>\r\n                            <ul>\r\n                                <li><strong>Diode Forward Bias:</strong> Current flows when voltage > 0.7V, voltage drop ~0.7V</li>\r\n                                <li><strong>Diode Reverse Bias:</strong> No current flow, acts as insulator</li>\r\n                                <li><strong>NPN Transistor:</strong> Electron flow from emitter to collector, base controls amplification</li>\r\n                                <li><strong>PNP Transistor:</strong> Hole flow from emitter to collector, base controls amplification</li>\r\n                                <li><strong>Amplification Factor:</strong> β = Ic/Ib (collector current / base current) ≈ 100</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Particle Physics</h3>\r\n                            <ul>\r\n                                <li><strong>Electrons:</strong> Filled blue circles representing negative charge carriers</li>\r\n                                <li><strong>Holes:</strong> Red outlined circles representing positive charge carriers (absence of electrons)</li>\r\n                                <li><strong>Flow Direction:</strong> Electrons and holes move in opposite directions but both contribute to conventional current flow</li>\r\n                                <li><strong>Energy Levels:</strong> Particles move faster and glow brighter with higher voltage</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Rectifiers in power supplies</li>\r\n                                <li>Amplifiers in audio systems</li>\r\n                                <li>Digital logic circuits</li>\r\n                                <li>Voltage regulators</li>\r\n                                <li>Radio frequency circuits</li>\r\n                                <li>Computer processors and memory</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Mathematical Description</h3>\r\n                            <p>For a diode: <strong>I = I₀(e^(V/Vₜ) - 1)</strong>, where I is current, V is voltage, and Vₜ is thermal voltage (~26mV at room temperature). For a transistor: <strong>Ic = β × Ib</strong>, where β is the current gain factor (typically 50-200).</p>\r\n                            \r\n                            <h3>Interactive Features</h3>\r\n                            <ul>\r\n                                <li>Switch between diode, NPN, and PNP transistor modes</li>\r\n                                <li>Adjust input voltage to see current flow changes</li>\r\n                                <li>Control base voltage for transistor amplification</li>\r\n                                <li>Observe different bias conditions (forward, reverse, off)</li>\r\n                                <li>Watch real-time current and power calculations</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'pendulum':\r\n                return {\r\n                    title: 'Simple Pendulum - Harmonic Oscillation',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What is a Simple Pendulum?</h3>\r\n                            <p>A simple pendulum consists of a point mass (bob) suspended from a fixed point by a massless, inextensible string. When displaced from its equilibrium position, it oscillates back and forth under the influence of gravity.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Simple Harmonic Motion:</strong> For small angles, the motion is approximately simple harmonic</li>\r\n                                <li><strong>Period Formula:</strong> T = 2π√(L/g), where L is length and g is gravitational acceleration</li>\r\n                                <li><strong>Energy Conservation:</strong> Kinetic and potential energy continuously convert between each other</li>\r\n                                <li><strong>Damping:</strong> Air resistance causes the amplitude to gradually decrease</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Regular back-and-forth oscillation</li>\r\n                                <li>Period remains constant regardless of amplitude (for small angles)</li>\r\n                                <li>Longer pendulum = longer period</li>\r\n                                <li>Gradual decrease in amplitude due to air resistance</li>\r\n                                <li>Maximum speed at the bottom, zero speed at the extremes</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Energy Transformations</h3>\r\n                            <ul>\r\n                                <li><strong>At extremes:</strong> Maximum potential energy, zero kinetic energy</li>\r\n                                <li><strong>At bottom:</strong> Maximum kinetic energy, minimum potential energy</li>\r\n                                <li><strong>Total energy:</strong> Gradually decreases due to air resistance</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Clock mechanisms (grandfather clocks)</li>\r\n                                <li>Seismometers for earthquake detection</li>\r\n                                <li>Metronomes for musical timing</li>\r\n                                <li>Amusement park rides</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'waves':\r\n                return {\r\n                    title: 'Wave Propagation - Energy Transfer',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What are Waves?</h3>\r\n                            <p>Waves are disturbances that transfer energy through a medium without transferring matter. They can be mechanical (requiring a medium) or electromagnetic (can travel through vacuum).</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Transverse Waves:</strong> Particles move perpendicular to wave direction (like water waves)</li>\r\n                                <li><strong>Longitudinal Waves:</strong> Particles move parallel to wave direction (like sound waves)</li>\r\n                                <li><strong>Wave Properties:</strong> Amplitude, frequency, wavelength, and speed</li>\r\n                                <li><strong>Wave Equation:</strong> v = fλ (speed = frequency × wavelength)</li>\r\n                                <li><strong>Interference:</strong> Waves can add together or cancel each other out</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Regular, repeating pattern of disturbance</li>\r\n                                <li>Waves traveling at constant speed</li>\r\n                                <li>Different wave types (transverse vs longitudinal)</li>\r\n                                <li>Interference patterns when waves overlap</li>\r\n                                <li>Energy transfer without matter movement</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Wave Characteristics</h3>\r\n                            <ul>\r\n                                <li><strong>Amplitude:</strong> Maximum displacement from equilibrium</li>\r\n                                <li><strong>Frequency:</strong> Number of complete cycles per second (Hz)</li>\r\n                                <li><strong>Wavelength:</strong> Distance between consecutive identical points</li>\r\n                                <li><strong>Period:</strong> Time for one complete cycle</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Sound waves in air and water</li>\r\n                                <li>Light waves and electromagnetic radiation</li>\r\n                                <li>Earthquake waves (seismic waves)</li>\r\n                                <li>Radio waves for communication</li>\r\n                                <li>Ocean waves and tides</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'diffusion':\r\n                return {\r\n                    title: 'Diffusion - Particle Spread',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What is Diffusion?</h3>\r\n                            <p>Diffusion is the process by which particles spread from regions of high concentration to regions of low concentration, driven by random molecular motion. This is a fundamental process in nature that leads to the uniform distribution of particles.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Fick's First Law:</strong> J = -D∇C (flux is proportional to concentration gradient)</li>\r\n                                <li><strong>Concentration Gradient:</strong> Difference in concentration between regions</li>\r\n                                <li><strong>Diffusion Coefficient:</strong> Measure of how quickly particles diffuse</li>\r\n                                <li><strong>Temperature Effect:</strong> Higher temperature increases diffusion rate</li>\r\n                                <li><strong>Particle Size:</strong> Smaller particles diffuse faster</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Particles spreading from concentrated areas</li>\r\n                                <li>Gradual mixing of different particle types</li>\r\n                                <li>Faster diffusion at higher temperatures</li>\r\n                                <li>Concentration gradient decreasing over time</li>\r\n                                <li>Eventually uniform distribution</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Diffusion Process</h3>\r\n                            <ul>\r\n                                <li><strong>Initial State:</strong> High concentration in one region</li>\r\n                                <li><strong>Random Motion:</strong> Particles move randomly due to thermal energy</li>\r\n                                <li><strong>Net Movement:</strong> More particles move from high to low concentration</li>\r\n                                <li><strong>Equilibrium:</strong> Eventually uniform concentration throughout</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Oxygen diffusion in lungs</li>\r\n                                <li>Nutrient absorption in cells</li>\r\n                                <li>Perfume spreading in air</li>\r\n                                <li>Salt dissolving in water</li>\r\n                                <li>Heat conduction in materials</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'orbital':\r\n                return {\r\n                    title: 'Orbital Motion - Gravitational Dynamics',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What is Orbital Motion?</h3>\r\n                            <p>Orbital motion describes the path of one object around another under the influence of gravity. This fundamental concept explains planetary orbits, satellite motion, and many other celestial phenomena.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Kepler's Laws:</strong> Three laws describing planetary motion</li>\r\n                                <li><strong>Gravitational Force:</strong> F = GMm/r² (inverse square law)</li>\r\n                                <li><strong>Orbital Velocity:</strong> v = √(GM/r) for circular orbits</li>\r\n                                <li><strong>Eccentricity:</strong> Measure of how elliptical an orbit is (0 = circular, 1 = parabolic)</li>\r\n                                <li><strong>Conservation of Angular Momentum:</strong> Orbital angular momentum remains constant</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Elliptical or circular paths around central mass</li>\r\n                                <li>Faster motion when closer to the center (Kepler's Second Law)</li>\r\n                                <li>Slower motion when farther from the center</li>\r\n                                <li>Different orbital shapes based on eccentricity</li>\r\n                                <li>Consistent orbital period for same central mass</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Kepler's Three Laws</h3>\r\n                            <ol>\r\n                                <li><strong>First Law:</strong> Orbits are ellipses with the central mass at one focus</li>\r\n                                <li><strong>Second Law:</strong> Equal areas are swept in equal times (faster when closer)</li>\r\n                                <li><strong>Third Law:</strong> Orbital period squared is proportional to semi-major axis cubed</li>\r\n                            </ol>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Planetary orbits around the Sun</li>\r\n                                <li>Satellite orbits around Earth</li>\r\n                                <li>Electron orbits in atoms (Bohr model)</li>\r\n                                <li>Binary star systems</li>\r\n                                <li>Spacecraft trajectories</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'electric-fields':\r\n                return {\r\n                    title: 'Electric Fields - Charged Particle Interactions',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What are Electric Fields?</h3>\r\n                            <p>Electric fields are regions of space around charged particles where other charges experience forces. They are invisible but can be visualized through their effects on test charges and field lines.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Coulomb's Law:</strong> F = kq₁q₂/r² (force between charges)</li>\r\n                                <li><strong>Electric Field:</strong> E = F/q (force per unit charge)</li>\r\n                                <li><strong>Field Lines:</strong> Imaginary lines showing field direction</li>\r\n                                <li><strong>Superposition:</strong> Total field is sum of individual fields</li>\r\n                                <li><strong>Conservation of Charge:</strong> Net charge remains constant</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Test particles moving along field lines</li>\r\n                                <li>Positive particles repelled by positive charges</li>\r\n                                <li>Negative particles attracted to positive charges</li>\r\n                                <li>Field strength decreases with distance</li>\r\n                                <li>Complex field patterns with multiple charges</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Field Properties</h3>\r\n                            <ul>\r\n                                <li><strong>Direction:</strong> Field lines point away from positive, toward negative</li>\r\n                                <li><strong>Strength:</strong> Closer lines indicate stronger fields</li>\r\n                                <li><strong>Superposition:</strong> Fields add vectorially</li>\r\n                                <li><strong>Conservative:</strong> Work done is path-independent</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Electrostatic precipitators</li>\r\n                                <li>Capacitors and electronic circuits</li>\r\n                                <li>Lightning and atmospheric electricity</li>\r\n                                <li>Particle accelerators</li>\r\n                                <li>Electron microscopes</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'gas-laws':\r\n                return {\r\n                    title: 'Gas Laws - Pressure, Volume, Temperature Relationships',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What are Gas Laws?</h3>\r\n                            <p>Gas laws describe the relationships between pressure, volume, temperature, and amount of gas. These fundamental laws help us understand how gases behave under different conditions.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Boyle's Law:</strong> P₁V₁ = P₂V₂ (inverse relationship between pressure and volume)</li>\r\n                                <li><strong>Charles's Law:</strong> V₁/T₁ = V₂/T₂ (direct relationship between volume and temperature)</li>\r\n                                <li><strong>Gay-Lussac's Law:</strong> P₁/T₁ = P₂/T₂ (direct relationship between pressure and temperature)</li>\r\n                                <li><strong>Combined Gas Law:</strong> P₁V₁/T₁ = P₂V₂/T₂</li>\r\n                                <li><strong>Ideal Gas Law:</strong> PV = nRT (universal gas law)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Particles moving faster at higher temperatures</li>\r\n                                <li>More frequent collisions at higher pressure</li>\r\n                                <li>Particles spreading out in larger volumes</li>\r\n                                <li>Pressure changes with volume and temperature</li>\r\n                                <li>Random motion of gas particles</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Gas Law Relationships</h3>\r\n                            <ul>\r\n                                <li><strong>Boyle's Law:</strong> Decrease volume → increase pressure</li>\r\n                                <li><strong>Charles's Law:</strong> Increase temperature → increase volume</li>\r\n                                <li><strong>Gay-Lussac's Law:</strong> Increase temperature → increase pressure</li>\r\n                                <li><strong>Avogadro's Law:</strong> More particles → larger volume</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Internal combustion engines</li>\r\n                                <li>Refrigeration and air conditioning</li>\r\n                                <li>Weather and atmospheric pressure</li>\r\n                                <li>Scuba diving and pressure changes</li>\r\n                                <li>Hot air balloons</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'collisions':\r\n                return {\r\n                    title: 'Collision Physics - Momentum and Energy Conservation',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What are Collisions?</h3>\r\n                            <p>Collisions are interactions between objects that result in changes in their motion. Understanding collisions involves principles of momentum conservation and energy transfer.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Momentum Conservation:</strong> Total momentum before = total momentum after</li>\r\n                                <li><strong>Elastic Collisions:</strong> Kinetic energy is conserved</li>\r\n                                <li><strong>Inelastic Collisions:</strong> Some kinetic energy is lost</li>\r\n                                <li><strong>Impulse:</strong> Change in momentum = force × time</li>\r\n                                <li><strong>Coefficient of Restitution:</strong> Measure of collision elasticity</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Objects changing direction after collision</li>\r\n                                <li>Speed changes based on collision type</li>\r\n                                <li>Energy transfer between objects</li>\r\n                                <li>Momentum conservation in all collisions</li>\r\n                                <li>Different outcomes for elastic vs inelastic collisions</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Collision Types</h3>\r\n                            <ul>\r\n                                <li><strong>Elastic:</strong> Perfect bounce, energy conserved</li>\r\n                                <li><strong>Inelastic:</strong> Objects stick together, energy lost</li>\r\n                                <li><strong>Partially Elastic:</strong> Some energy lost, some bounce</li>\r\n                                <li><strong>Explosive:</strong> Energy added, objects separate</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Car crash safety design</li>\r\n                                <li>Sports equipment design</li>\r\n                                <li>Particle physics experiments</li>\r\n                                <li>Billiards and pool</li>\r\n                                <li>Rocket propulsion</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'friction':\r\n                return {\r\n                    title: 'Friction & Inclined Planes - Force Analysis',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What is Friction?</h3>\r\n                            <p>Friction is a force that opposes the relative motion of objects in contact. On inclined planes, friction plays a crucial role in determining whether objects slide or remain stationary.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Static Friction:</strong> Prevents motion when object is at rest</li>\r\n                                <li><strong>Kinetic Friction:</strong> Opposes motion when object is sliding</li>\r\n                                <li><strong>Friction Force:</strong> f = μN (coefficient × normal force)</li>\r\n                                <li><strong>Normal Force:</strong> Component of weight perpendicular to surface</li>\r\n                                <li><strong>Net Force:</strong> Determines acceleration down the incline</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Objects sliding down inclined surfaces</li>\r\n                                <li>Different sliding speeds based on friction</li>\r\n                                <li>Objects stopping when friction is high</li>\r\n                                <li>Force vectors showing gravity and friction</li>\r\n                                <li>Acceleration changes with angle and friction</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Force Analysis</h3>\r\n                            <ul>\r\n                                <li><strong>Gravity Component:</strong> mg sin(θ) down the incline</li>\r\n                                <li><strong>Normal Force:</strong> mg cos(θ) perpendicular to surface</li>\r\n                                <li><strong>Friction Force:</strong> μmg cos(θ) opposing motion</li>\r\n                                <li><strong>Net Force:</strong> mg sin(θ) - μmg cos(θ)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Vehicle braking systems</li>\r\n                                <li>Walking and running mechanics</li>\r\n                                <li>Rock climbing and mountaineering</li>\r\n                                <li>Industrial conveyor systems</li>\r\n                                <li>Sports equipment design</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'magnetic-fields':\r\n                return {\r\n                    title: 'Magnetic Fields - Magnetic Force Interactions',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What are Magnetic Fields?</h3>\r\n                            <p>Magnetic fields are regions of space around magnets where magnetic materials and moving charges experience forces. They are fundamental to electromagnetism and many modern technologies.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Magnetic Force:</strong> F = qvB sin(θ) on moving charges</li>\r\n                                <li><strong>Field Lines:</strong> Imaginary lines showing field direction</li>\r\n                                <li><strong>Right-Hand Rule:</strong> Determines force direction on moving charges</li>\r\n                                <li><strong>Field Strength:</strong> Measured in Tesla (T) or Gauss</li>\r\n                                <li><strong>Superposition:</strong> Total field is sum of individual fields</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Charged particles moving in curved paths</li>\r\n                                <li>Different motion for positive vs negative charges</li>\r\n                                <li>Circular motion in uniform magnetic fields</li>\r\n                                <li>Field lines showing magnetic field direction</li>\r\n                                <li>Force perpendicular to both velocity and field</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Magnetic Field Properties</h3>\r\n                            <ul>\r\n                                <li><strong>Direction:</strong> Field lines point from north to south pole</li>\r\n                                <li><strong>Strength:</strong> Decreases with distance from magnet</li>\r\n                                <li><strong>Force Direction:</strong> Perpendicular to both velocity and field</li>\r\n                                <li><strong>No Work:</strong> Magnetic force does no work on charges</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Electric motors and generators</li>\r\n                                <li>Magnetic resonance imaging (MRI)</li>\r\n                                <li>Particle accelerators</li>\r\n                                <li>Magnetic levitation trains</li>\r\n                                <li>Compass navigation</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'wave-particle-duality':\r\n                return {\r\n                    title: 'Wave-Particle Duality - Quantum Mechanics',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What is Wave-Particle Duality?</h3>\r\n                            <p>Wave-particle duality is a fundamental concept in quantum mechanics where particles exhibit both wave-like and particle-like properties depending on how we observe them. This challenges our classical understanding of matter.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>De Broglie Wavelength:</strong> λ = h/p (wavelength = Planck's constant/momentum)</li>\r\n                                <li><strong>Wave Function:</strong> Mathematical description of quantum state</li>\r\n                                <li><strong>Superposition:</strong> Particles can exist in multiple states simultaneously</li>\r\n                                <li><strong>Measurement Effect:</strong> Observation affects the system</li>\r\n                                <li><strong>Interference:</strong> Wave-like behavior in experiments</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Wave-like interference patterns</li>\r\n                                <li>Particle-like discrete measurements</li>\r\n                                <li>Superposition of states</li>\r\n                                <li>Measurement affecting the system</li>\r\n                                <li>Dual behavior depending on observation method</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Quantum Phenomena</h3>\r\n                            <ul>\r\n                                <li><strong>Double-Slit Experiment:</strong> Shows both wave and particle behavior</li>\r\n                                <li><strong>Uncertainty Principle:</strong> Can't know position and momentum precisely</li>\r\n                                <li><strong>Quantum Tunneling:</strong> Particles can pass through barriers</li>\r\n                                <li><strong>Entanglement:</strong> Particles can be correlated across distance</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Electron microscopes</li>\r\n                                <li>Quantum computing</li>\r\n                                <li>Quantum cryptography</li>\r\n                                <li>Semiconductor technology</li>\r\n                                <li>Quantum sensors</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'nuclear-reactions':\r\n                return {\r\n                    title: 'Nuclear Reactions - Fission and Fusion',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What are Nuclear Reactions?</h3>\r\n                            <p>Nuclear reactions involve changes in the nucleus of atoms, releasing or absorbing tremendous amounts of energy. Fission (splitting) and fusion (combining) are the two main types of nuclear reactions.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Nuclear Fission:</strong> Heavy nucleus splits into lighter nuclei + energy</li>\r\n                                <li><strong>Nuclear Fusion:</strong> Light nuclei combine to form heavier nucleus + energy</li>\r\n                                <li><strong>Mass-Energy Equivalence:</strong> E = mc² (Einstein's equation)</li>\r\n                                <li><strong>Chain Reaction:</strong> Neutrons from one fission trigger more fissions</li>\r\n                                <li><strong>Critical Mass:</strong> Minimum mass needed for sustained chain reaction</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Nuclei splitting or combining</li>\r\n                                <li>Energy release in the form of particles</li>\r\n                                <li>Neutrons triggering additional reactions</li>\r\n                                <li>Chain reactions spreading through material</li>\r\n                                <li>Different reaction rates based on conditions</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Nuclear Processes</h3>\r\n                            <ul>\r\n                                <li><strong>Fission:</strong> Uranium-235 + neutron → lighter nuclei + 2-3 neutrons + energy</li>\r\n                                <li><strong>Fusion:</strong> Hydrogen nuclei → Helium + energy (like in stars)</li>\r\n                                <li><strong>Radioactive Decay:</strong> Unstable nuclei emit particles</li>\r\n                                <li><strong>Neutron Capture:</strong> Nuclei absorb neutrons</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Nuclear power plants</li>\r\n                                <li>Nuclear weapons</li>\r\n                                <li>Medical radiation therapy</li>\r\n                                <li>Radioactive dating</li>\r\n                                <li>Fusion power research</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'fluid-flow':\r\n                return {\r\n                    title: 'Fluid Flow - Laminar and Turbulent Dynamics',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What is Fluid Flow?</h3>\r\n                            <p>Fluid flow describes how liquids and gases move through space. Understanding flow patterns is crucial for engineering applications, from blood flow in arteries to air flow over airplane wings.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Laminar Flow:</strong> Smooth, parallel streamlines with no mixing between layers</li>\r\n                                <li><strong>Turbulent Flow:</strong> Chaotic, swirling motion with rapid mixing</li>\r\n                                <li><strong>Reynolds Number:</strong> Re = ρvL/μ (determines flow type)</li>\r\n                                <li><strong>Viscosity:</strong> Internal friction that resists flow</li>\r\n                                <li><strong>Boundary Layer:</strong> Region near surfaces where flow is affected by friction</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Smooth, parallel streamlines in laminar flow</li>\r\n                                <li>Chaotic, swirling patterns in turbulent flow</li>\r\n                                <li>Flow separation around obstacles</li>\r\n                                <li>Velocity changes with viscosity</li>\r\n                                <li>Reynolds number transitions</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Flow Regimes</h3>\r\n                            <ul>\r\n                                <li><strong>Re < 2300:</strong> Laminar flow (smooth, predictable)</li>\r\n                                <li><strong>2300 < Re < 4000:</strong> Transitional flow (unstable)</li>\r\n                                <li><strong>Re > 4000:</strong> Turbulent flow (chaotic, mixing)</li>\r\n                                <li><strong>High Re:</strong> Inertia dominates over viscosity</li>\r\n                                <li><strong>Low Re:</strong> Viscosity dominates over inertia</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Blood flow in cardiovascular system</li>\r\n                                <li>Air flow over aircraft wings</li>\r\n                                <li>Water flow in pipes and channels</li>\r\n                                <li>Weather patterns and atmospheric flow</li>\r\n                                <li>Industrial mixing and processing</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'bernoulli':\r\n                return {\r\n                    title: \"Bernoulli's Principle - Energy Conservation in Fluids\",\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What is Bernoulli's Principle?</h3>\r\n                            <p>Bernoulli's principle states that in a flowing fluid, an increase in velocity is accompanied by a decrease in pressure. This is a consequence of energy conservation in fluid flow.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Bernoulli's Equation:</strong> P + ½ρv² + ρgh = constant</li>\r\n                                <li><strong>Energy Conservation:</strong> Total energy remains constant along a streamline</li>\r\n                                <li><strong>Pressure-Velocity Trade-off:</strong> Higher velocity = lower pressure</li>\r\n                                <li><strong>Continuity Equation:</strong> A₁v₁ = A₂v₂ (mass conservation)</li>\r\n                                <li><strong>Venturi Effect:</strong> Pressure drop in constricted flow</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>Fluid speeding up in narrow sections</li>\r\n                                <li>Pressure decreasing in constricted areas</li>\r\n                                <li>Energy conservation maintained</li>\r\n                                <li>Velocity and pressure inversely related</li>\r\n                                <li>Flow rate remains constant</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Energy Components</h3>\r\n                            <ul>\r\n                                <li><strong>Pressure Energy:</strong> P (work done by pressure)</li>\r\n                                <li><strong>Kinetic Energy:</strong> ½ρv² (energy of motion)</li>\r\n                                <li><strong>Potential Energy:</strong> ρgh (gravitational energy)</li>\r\n                                <li><strong>Total Energy:</strong> Sum remains constant</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Airplane wing lift generation</li>\r\n                                <li>Carburetor fuel mixing</li>\r\n                                <li>Venturi meters for flow measurement</li>\r\n                                <li>Spray bottles and atomizers</li>\r\n                                <li>Blood flow in arteries</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n                        case 'neural-network':\r\n                return {\r\n                    title: 'Neural Network Training - Object Recognition',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What are Neural Networks?</h3>\r\n                            <p>Neural networks are computational models inspired by biological neurons in the brain. They consist of interconnected nodes (neurons) organized in layers that process information and learn patterns from data. This animation demonstrates how neural networks learn to recognize and classify different geometric objects.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Artificial Neurons:</strong> Mathematical functions that receive inputs, apply weights, and produce outputs. Each neuron computes: output = σ(Σ(inputs × weights) + bias)</li>\r\n                                <li><strong>Network Architecture:</strong> Input layer (2 neurons) → Hidden layer 1 (4 neurons) → Hidden layer 2 (3 neurons) → Output layer (1 neuron)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Why This Architecture?</h3>\r\n                            <ul>\r\n                                <li><strong>2 Input Neurons:</strong> Perfect for our 2-feature problem (symmetry, edges)</li>\r\n                                <li><strong>4 Hidden Neurons:</strong> Provides enough capacity to learn non-linear patterns without overfitting</li>\r\n                                <li><strong>3 Hidden Neurons:</strong> Allows further feature refinement and abstraction</li>\r\n                                <li><strong>1 Output Neuron:</strong> Binary classification (simple vs complex objects)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Layer Size Effects</h3>\r\n                            <ul>\r\n                                <li><strong>Too Few Neurons:</strong> Network can't learn complex patterns (underfitting)</li>\r\n                                <li><strong>Too Many Neurons:</strong> Network memorizes training data (overfitting)</li>\r\n                                <li><strong>Optimal Size:</strong> Balances learning capacity with generalization</li>\r\n                                <li><strong>Our Choice:</strong> 4→3 hidden layers provide sufficient complexity for this task</li>\r\n                            </ul>\r\n                                <li><strong>Weights & Biases:</strong> Numerical values that determine connection strength and neuron activation thresholds</li>\r\n                                <li><strong>Sigmoid Activation:</strong> σ(x) = 1/(1 + e^(-x)) - transforms any input to a value between 0 and 1</li>\r\n                                <li><strong>Backpropagation:</strong> Algorithm that calculates how much each weight should change to reduce prediction errors</li>\r\n                                <li><strong>Learning Rate:</strong> Controls how big weight updates are during training</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Training Process Explained</h3>\r\n                            <ol>\r\n                                <li><strong>Forward Propagation:</strong> Input features flow through the network, each neuron computes its output using weights and activation function</li>\r\n                                <li><strong>Loss Calculation:</strong> Compare network output with target value using Mean Squared Error: Loss = (target - output)²</li>\r\n                                <li><strong>Backward Propagation:</strong> Calculate error gradients for each weight using chain rule of calculus</li>\r\n                                <li><strong>Weight Updates:</strong> Adjust weights using gradient descent: Δw = learning_rate × gradient</li>\r\n                            </ol>\r\n                            \r\n                            <h3>Object Recognition Task</h3>\r\n                            <p>This network learns to classify geometric objects based on their complexity using 2 features:</p>\r\n                            <ul>\r\n                                <li><strong>Feature 1 - Symmetry Score (0-1):</strong> How symmetrical the object is (high = simple)</li>\r\n                                <li><strong>Feature 2 - Edge Complexity (0-1):</strong> How many edges/corners the object has (high = complex)</li>\r\n                                <li><strong>Simple Objects:</strong> Circle [0.9,0.1], Square [0.8,0.3] → Output: 0 (classified as simple)</li>\r\n                                <li><strong>Complex Objects:</strong> Triangle [0.6,0.5], Star [0.3,0.9] → Output: 1 (classified as complex)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li><strong>Training Mode:</strong> Watch data flow forward (blue particles), errors flow backward (red particles), and weights update (flashing connections)</li>\r\n                                <li><strong>Testing Mode:</strong> See how the trained network processes new inputs and makes predictions with confidence scores</li>\r\n                                <li><strong>Visual Indicators:</strong> Active neurons pulse, weight changes are highlighted, and prediction accuracy improves over time</li>\r\n                                <li><strong>Object Context:</strong> Each training example shows the actual geometric object being learned</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Mathematical Foundation</h3>\r\n                            <ul>\r\n                                <li><strong>Neuron Output:</strong> y = σ(w₁x₁ + w₂x₂ + ... + wₙxₙ + b)</li>\r\n                                <li><strong>Loss Function:</strong> L = (y_target - y_predicted)²</li>\r\n                                <li><strong>Weight Update:</strong> w_new = w_old - α × ∂L/∂w</li>\r\n                                <li><strong>Gradient Calculation:</strong> ∂L/∂w = ∂L/∂y × ∂y/∂w (chain rule)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li><strong>Computer Vision:</strong> Image classification, object detection, facial recognition</li>\r\n                                <li><strong>Natural Language Processing:</strong> Text classification, language translation, chatbots</li>\r\n                                <li><strong>Speech Recognition:</strong> Voice assistants, transcription services</li>\r\n                                <li><strong>Autonomous Systems:</strong> Self-driving cars, robotics, drones</li>\r\n                                <li><strong>Medical Diagnosis:</strong> Disease detection, medical image analysis</li>\r\n                                <li><strong>Financial Analysis:</strong> Fraud detection, stock prediction, risk assessment</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Educational Insights</h3>\r\n                            <ul>\r\n                                <li><strong>Learning Process:</strong> Neural networks learn by adjusting weights to minimize prediction errors</li>\r\n                                <li><strong>Feature Learning:</strong> Hidden layers automatically learn useful features from raw input data</li>\r\n                                <li><strong>Generalization:</strong> Well-trained networks can make accurate predictions on unseen data</li>\r\n                                <li><strong>Overfitting:</strong> Networks can memorize training data instead of learning general patterns</li>\r\n                                <li><strong>Hyperparameters:</strong> Learning rate, network architecture, and activation functions affect training success</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Interactive Features</h3>\r\n                            <ul>\r\n                                <li><strong>Training Mode:</strong> Watch the network learn through forward/backward propagation cycles</li>\r\n                                <li><strong>Testing Mode:</strong> Test the trained network on different objects and see predictions</li>\r\n                                <li><strong>Parameter Control:</strong> Adjust learning rate and animation speed to observe different training behaviors</li>\r\n                                <li><strong>Visual Feedback:</strong> See real-time loss, accuracy, and confidence metrics</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Advanced Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Gradient Descent:</strong> Optimization algorithm that finds the best weights by following the steepest descent</li>\r\n                                <li><strong>Vanishing Gradients:</strong> Problem where gradients become very small in deep networks</li>\r\n                                <li><strong>Regularization:</strong> Techniques to prevent overfitting (dropout, weight decay)</li>\r\n                                <li><strong>Batch Processing:</strong> Training on multiple examples simultaneously for better gradient estimates</li>\r\n                                <li><strong>Transfer Learning:</strong> Using pre-trained networks for new tasks</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'sound-waves':\r\n                return {\r\n                    title: 'Sound Waves - Wave Propagation in Air',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What are Sound Waves?</h3>\r\n                            <p>Sound waves are longitudinal mechanical waves that travel through a medium (like air, water, or solids) by compressing and rarefying the particles of the medium. These waves carry energy and information, allowing us to hear sounds.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Longitudinal Waves:</strong> Particles oscillate parallel to wave direction (compression and rarefaction)</li>\r\n                                <li><strong>Transverse Waves:</strong> Particles oscillate perpendicular to wave direction (like guitar strings)</li>\r\n                                <li><strong>Wave Properties:</strong> Frequency (pitch), amplitude (loudness), wavelength, and speed</li>\r\n                                <li><strong>Wave Equation:</strong> v = fλ (speed = frequency × wavelength)</li>\r\n                                <li><strong>Pressure Variations:</strong> High pressure (compression) and low pressure (rarefaction) zones</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li><strong>Transverse Mode:</strong> Particles moving up and down like a guitar string</li>\r\n                                <li><strong>Longitudinal Mode:</strong> Particles moving back and forth in the direction of wave travel</li>\r\n                                <li><strong>Pressure Zones:</strong> Red areas (compression) and blue areas (rarefaction) in longitudinal waves</li>\r\n                                <li><strong>Wave Speed:</strong> How fast the wave pattern travels through the medium</li>\r\n                                <li><strong>Frequency Effect:</strong> Higher frequency = shorter wavelength = higher pitch</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Wave Characteristics</h3>\r\n                            <ul>\r\n                                <li><strong>Frequency (f):</strong> Number of complete cycles per second (Hz) - determines pitch</li>\r\n                                <li><strong>Amplitude (A):</strong> Maximum displacement from equilibrium - determines loudness</li>\r\n                                <li><strong>Wavelength (λ):</strong> Distance between consecutive identical points</li>\r\n                                <li><strong>Wave Speed (v):</strong> How fast the wave travels through the medium</li>\r\n                                <li><strong>Period (T):</strong> Time for one complete cycle (T = 1/f)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Musical instruments (guitar strings, air columns)</li>\r\n                                <li>Human speech and hearing</li>\r\n                <li>Ultrasound imaging in medicine</li>\r\n                                <li>Sonar for underwater detection</li>\r\n                                <li>Acoustic engineering and sound design</li>\r\n                                <li>Earthquake detection (seismic waves)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Mathematical Relationships</h3>\r\n                            <ul>\r\n                                <li><strong>Wave Equation:</strong> v = fλ (speed = frequency × wavelength)</li>\r\n                                <li><strong>Period and Frequency:</strong> T = 1/f (period = 1/frequency)</li>\r\n                                <li><strong>Energy:</strong> E ∝ A²f² (energy proportional to amplitude² × frequency²)</li>\r\n                                <li><strong>Intensity:</strong> I ∝ A² (intensity proportional to amplitude squared)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Wave Types Comparison</h3>\r\n                            <ul>\r\n                                <li><strong>Transverse Waves:</strong> Guitar strings, water waves, light waves</li>\r\n                                <li><strong>Longitudinal Waves:</strong> Sound waves in air, seismic P-waves</li>\r\n                                <li><strong>Combined Waves:</strong> Complex wave patterns with both components</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'neural-network':\r\n                return {\r\n                    title: 'Neural Network Training - Object Recognition',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What are Neural Networks?</h3>\r\n                            <p>Neural networks are computational models inspired by biological neurons in the brain. They consist of interconnected nodes (neurons) organized in layers that process information and learn patterns from data. This animation demonstrates how neural networks learn to recognize and classify different geometric objects.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Artificial Neurons:</strong> Mathematical functions that receive inputs, apply weights, and produce outputs. Each neuron computes: output = σ(Σ(inputs × weights) + bias)</li>\r\n                                <li><strong>Network Architecture:</strong> Input layer (2 neurons) → Hidden layer 1 (4 neurons) → Hidden layer 2 (3 neurons) → Output layer (1 neuron)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Why This Architecture?</h3>\r\n                            <ul>\r\n                                <li><strong>2 Input Neurons:</strong> Perfect for our 2-feature problem (symmetry, edges)</li>\r\n                                <li><strong>4 Hidden Neurons:</strong> Provides enough capacity to learn non-linear patterns without overfitting</li>\r\n                                <li><strong>3 Hidden Neurons:</strong> Allows further feature refinement and abstraction</li>\r\n                                <li><strong>1 Output Neuron:</strong> Binary classification (simple vs complex objects)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Layer Size Effects</h3>\r\n                            <ul>\r\n                                <li><strong>Too Few Neurons:</strong> Network can't learn complex patterns (underfitting)</li>\r\n                                <li><strong>Too Many Neurons:</strong> Network memorizes training data (overfitting)</li>\r\n                                <li><strong>Optimal Size:</strong> Balances learning capacity with generalization</li>\r\n                                <li><strong>Our Choice:</strong> 4→3 hidden layers provide sufficient complexity for this task</li>\r\n                            </ul>\r\n                                <li><strong>Weights & Biases:</strong> Numerical values that determine connection strength and neuron activation thresholds</li>\r\n                                <li><strong>Sigmoid Activation:</strong> σ(x) = 1/(1 + e^(-x)) - transforms any input to a value between 0 and 1</li>\r\n                                <li><strong>Backpropagation:</strong> Algorithm that calculates how much each weight should change to reduce prediction errors</li>\r\n                                <li><strong>Learning Rate:</strong> Controls how big weight updates are during training</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Training Process Explained</h3>\r\n                            <ol>\r\n                                <li><strong>Forward Propagation:</strong> Input features flow through the network, each neuron computes its output using weights and activation function</li>\r\n                                <li><strong>Loss Calculation:</strong> Compare network output with target value using Mean Squared Error: Loss = (target - output)²</li>\r\n                                <li><strong>Backward Propagation:</strong> Calculate error gradients for each weight using chain rule of calculus</li>\r\n                                <li><strong>Weight Updates:</strong> Adjust weights using gradient descent: Δw = learning_rate × gradient</li>\r\n                            </ol>\r\n                            \r\n                            <h3>Object Recognition Task</h3>\r\n                            <p>This network learns to classify geometric objects based on their complexity using 2 features:</p>\r\n                            <ul>\r\n                                <li><strong>Feature 1 - Symmetry Score (0-1):</strong> How symmetrical the object is (high = simple)</li>\r\n                                <li><strong>Feature 2 - Edge Complexity (0-1):</strong> How many edges/corners the object has (high = complex)</li>\r\n                                <li><strong>Simple Objects:</strong> Circle [0.9,0.1], Square [0.8,0.3] → Output: 0 (classified as simple)</li>\r\n                                <li><strong>Complex Objects:</strong> Triangle [0.6,0.5], Star [0.3,0.9] → Output: 1 (classified as complex)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li><strong>Training Mode:</strong> Watch data flow forward (blue particles), errors flow backward (red particles), and weights update (flashing connections)</li>\r\n                                <li><strong>Testing Mode:</strong> See how the trained network processes new inputs and makes predictions with confidence scores</li>\r\n                                <li><strong>Visual Indicators:</strong> Active neurons pulse, weight changes are highlighted, and prediction accuracy improves over time</li>\r\n                                <li><strong>Object Context:</strong> Each training example shows the actual geometric object being learned</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Mathematical Foundation</h3>\r\n                            <ul>\r\n                                <li><strong>Neuron Output:</strong> y = σ(w₁x₁ + w₂x₂ + ... + wₙxₙ + b)</li>\r\n                                <li><strong>Loss Function:</strong> L = (y_target - y_predicted)²</li>\r\n                                <li><strong>Weight Update:</strong> w_new = w_old - α × ∂L/∂w</li>\r\n                                <li><strong>Gradient Calculation:</strong> ∂L/∂w = ∂L/∂y × ∂y/∂w (chain rule)</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li><strong>Computer Vision:</strong> Image classification, object detection, facial recognition</li>\r\n                                <li><strong>Natural Language Processing:</strong> Text classification, language translation, chatbots</li>\r\n                                <li><strong>Speech Recognition:</strong> Voice assistants, transcription services</li>\r\n                                <li><strong>Autonomous Systems:</strong> Self-driving cars, robotics, drones</li>\r\n                                <li><strong>Medical Diagnosis:</strong> Disease detection, medical image analysis</li>\r\n                                <li><strong>Financial Analysis:</strong> Fraud detection, stock prediction, risk assessment</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Educational Insights</h3>\r\n                            <ul>\r\n                                <li><strong>Learning Process:</strong> Neural networks learn by adjusting weights to minimize prediction errors</li>\r\n                                <li><strong>Feature Learning:</strong> Hidden layers automatically learn useful features from raw input data</li>\r\n                                <li><strong>Generalization:</strong> Well-trained networks can make accurate predictions on unseen data</li>\r\n                                <li><strong>Overfitting:</strong> Networks can memorize training data instead of learning general patterns</li>\r\n                                <li><strong>Hyperparameters:</strong> Learning rate, network architecture, and activation functions affect training success</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Interactive Features</h3>\r\n                            <ul>\r\n                                <li><strong>Training Mode:</strong> Watch the network learn through forward/backward propagation cycles</li>\r\n                                <li><strong>Testing Mode:</strong> Test the trained network on different objects and see predictions</li>\r\n                                <li><strong>Parameter Control:</strong> Adjust learning rate and animation speed to observe different training behaviors</li>\r\n                                <li><strong>Visual Feedback:</strong> See real-time loss, accuracy, and confidence metrics</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Advanced Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Gradient Descent:</strong> Optimization algorithm that finds the best weights by following the steepest descent</li>\r\n                                <li><strong>Vanishing Gradients:</strong> Problem where gradients become very small in deep networks</li>\r\n                                <li><strong>Regularization:</strong> Techniques to prevent overfitting (dropout, weight decay)</li>\r\n                                <li><strong>Batch Processing:</strong> Training on multiple examples simultaneously for better gradient estimates</li>\r\n                                <li><strong>Transfer Learning:</strong> Using pre-trained networks for new tasks</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'memory-management':\r\n                return {\r\n                    title: 'Program Execution - Code, Memory, and Data Flow',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What is Program Execution?</h3>\r\n                            <p>Program execution is the process by which a computer runs code, manages memory, and processes data. This animation visualizes how a real program is executed, showing the flow of control, function calls, memory allocation and deallocation, and the movement of data between stack and heap. It provides a unique window into what happens \"under the hood\" when a computer runs software.</p>\r\n                            <h3>Key Concepts Demonstrated</h3>\r\n                            <ul>\r\n                                <li><strong>Code Execution:</strong> Step-by-step execution of a real program, including function calls and returns</li>\r\n                                <li><strong>Call Stack Visualization:</strong> See how function calls create stack frames and how the stack grows and shrinks</li>\r\n                                <li><strong>Heap Memory Management:</strong> Watch memory blocks being allocated (malloc) and freed (free), and observe fragmentation and memory usage</li>\r\n                                <li><strong>Data Flow:</strong> Visualize how data moves between functions, stack, and heap during program execution</li>\r\n                                <li><strong>Garbage Collection:</strong> Observe how unreachable memory is detected and cleaned up (if enabled)</li>\r\n                                <li><strong>Performance Metrics:</strong> Track memory usage, allocation/deallocation counts, fragmentation, and efficiency</li>\r\n                            </ul>\r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li>How function calls and returns affect the call stack</li>\r\n                                <li>How memory is allocated and deallocated on the heap</li>\r\n                                <li>How data is passed between functions and stored in memory</li>\r\n                                <li>How memory fragmentation and leaks can occur</li>\r\n                                <li>How the program completes its execution and cleans up resources</li>\r\n                            </ul>\r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li>Understanding how operating systems and programming languages manage memory</li>\r\n                                <li>Debugging and optimizing software for performance and reliability</li>\r\n                                <li>Learning about stack overflows, memory leaks, and efficient resource management</li>\r\n                                <li>Building better software by understanding what happens at runtime</li>\r\n                            </ul>\r\n                            <h3>Interactive Features</h3>\r\n                            <ul>\r\n                                <li>Step through program execution or watch it run automatically</li>\r\n                                <li>View real-time statistics and performance metrics</li>\r\n                                <li>Observe visual effects for memory allocation, deallocation, and data flow</li>\r\n                                <li>Toggle output and statistics panels for deeper insights</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            case 'blockchain':\r\n                return {\r\n                    title: 'Blockchain - Distributed Ledger Technology',\r\n                    html: `\r\n                        <div class=\"science-content\">\r\n                            <h3>What is Blockchain?</h3>\r\n                            <p>Blockchain is a distributed ledger technology that enables secure, transparent, and tamper-resistant record-keeping across a network of computers. Each block contains a list of transactions, and blocks are linked together in a chain using cryptographic hashes, creating an immutable record of all transactions.</p>\r\n                            \r\n                            <h3>Key Scientific Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Cryptographic Hashing:</strong> Mathematical function that converts data into a fixed-size string (hash) - any change in data produces a completely different hash</li>\r\n                                <li><strong>Proof of Work:</strong> Consensus mechanism where miners solve complex mathematical puzzles to validate transactions and create new blocks</li>\r\n                                <li><strong>Distributed Network:</strong> Multiple nodes maintain identical copies of the blockchain, ensuring redundancy and security</li>\r\n                                <li><strong>Merkle Trees:</strong> Data structure that efficiently verifies transaction integrity by creating a single hash from multiple transactions</li>\r\n                                <li><strong>Difficulty Adjustment:</strong> Network automatically adjusts mining difficulty to maintain consistent block creation rate</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Block Structure</h3>\r\n                            <ul>\r\n                                <li><strong>Block Header:</strong> Contains metadata including previous block hash, timestamp, nonce, and Merkle root</li>\r\n                                <li><strong>Transactions:</strong> List of validated transactions waiting to be included in the block</li>\r\n                                <li><strong>Nonce:</strong> Number that miners change to find a hash meeting the difficulty requirement</li>\r\n                                <li><strong>Hash:</strong> Unique fingerprint of the block's content - any change invalidates the hash</li>\r\n                                <li><strong>Previous Hash:</strong> Links each block to its predecessor, creating the chain</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Mining Process Explained</h3>\r\n                            <ol>\r\n                                <li><strong>Transaction Collection:</strong> Network collects pending transactions into a candidate block</li>\r\n                                <li><strong>Hash Calculation:</strong> Block header is hashed using SHA-256 algorithm</li>\r\n                                <li><strong>Difficulty Check:</strong> Hash must start with a specific number of zeros (target)</li>\r\n                                <li><strong>Nonce Increment:</strong> If hash doesn't meet target, nonce is incremented and process repeats</li>\r\n                                <li><strong>Block Discovery:</strong> When valid hash is found, block is broadcast to network</li>\r\n                                <li><strong>Network Validation:</strong> Other nodes verify the block and add it to their chain</li>\r\n                            </ol>\r\n                            \r\n                            <h3>What You Should Observe</h3>\r\n                            <ul>\r\n                                <li><strong>Modern Block Design:</strong> Rounded blocks with gradients, inner highlights, and modern typography</li>\r\n                                <li><strong>Enhanced Mining Process:</strong> Watch miners (orange nodes with pulsing rings) working to find valid hashes</li>\r\n                                <li><strong>Successful Miner Zoom:</strong> The successful miner node pulses and zooms to draw attention</li>\r\n                                <li><strong>Dynamic Transaction Blocks:</strong> Transactions fade over time, show age indicators, and have priority colors</li>\r\n                                <li><strong>Block Creation:</strong> See new blocks being added to the chain with celebration particles</li>\r\n                                <li><strong>Network Propagation:</strong> Observe animated arrows showing blocks spreading through the network</li>\r\n                                <li><strong>Transaction Flow:</strong> Watch pending transactions being included in blocks with real-time updates</li>\r\n                                <li><strong>Difficulty Effects:</strong> Lower difficulty = faster mining, higher difficulty = slower mining</li>\r\n                                <li><strong>Dynamic Network:</strong> Nodes join and leave the network automatically with enhanced visual effects</li>\r\n                                <li><strong>Block Hashes:</strong> Always visible with modern monospace font (truncated for readability)</li>\r\n                                <li><strong>Consensus Process:</strong> Watch network nodes reach agreement during guided mode</li>\r\n                                <li><strong>Block Rejection:</strong> See blocks rejected with red particles when consensus fails (60% threshold)</li>\r\n                                <li><strong>Transparent Info Panel:</strong> Network status panel with reduced opacity for better integration</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Block Rejection & Consensus</h3>\r\n                            <p>In guided mode (difficulty 2+), the network implements a realistic consensus mechanism:</p>\r\n                            <ul>\r\n                                <li><strong>Consensus Threshold:</strong> 60% of network nodes must agree to accept a block</li>\r\n                                <li><strong>Rejection Process:</strong> If consensus fails, the block is rejected with visual feedback</li>\r\n                                <li><strong>Red Particles:</strong> Rejection particles appear around the mining block position</li>\r\n                                <li><strong>Automatic Recovery:</strong> Mining automatically restarts after rejection</li>\r\n                                <li><strong>Network Reset:</strong> All nodes return to default state after rejection</li>\r\n                                <li><strong>Statistics Update:</strong> Phase indicator shows consensus percentage and rejection status</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Guided Mode (Difficulty 2+)</h3>\r\n                            <p>When mining difficulty is set to 2 or higher, the simulation automatically activates a step-by-step guided mode that walks you through the entire block addition process:</p>\r\n                            <ol>\r\n                                <li><strong>Mining Success:</strong> Block is successfully mined with valid hash</li>\r\n                                <li><strong>Validation:</strong> Network nodes validate the block's transactions and hash</li>\r\n                                <li><strong>Propagation:</strong> Block spreads through the network via peer-to-peer communication</li>\r\n                                <li><strong>Consensus:</strong> Network reaches agreement on block validity (requires 60% of nodes)</li>\r\n                                <li><strong>Finalization:</strong> Block is permanently added to the blockchain OR rejected if consensus fails</li>\r\n                            </ol>\r\n                            <p><strong>Consensus Mechanism:</strong> The network requires 60% of nodes to reach consensus. If consensus fails, the block is rejected and mining restarts automatically.</p>\r\n                            <p><strong>Note:</strong> For difficulty levels 1, blocks are added directly without guided mode for faster simulation.</p>\r\n                            \r\n                            <h3>Cryptographic Security</h3>\r\n                            <ul>\r\n                                <li><strong>Hash Function:</strong> SHA-256 produces 256-bit hashes - practically impossible to reverse</li>\r\n                                <li><strong>Chain Integrity:</strong> Changing any block invalidates all subsequent blocks</li>\r\n                                <li><strong>Immutability:</strong> Once added, blocks cannot be modified without detection</li>\r\n                                <li><strong>Digital Signatures:</strong> Transactions are cryptographically signed to prevent forgery</li>\r\n                                <li><strong>51% Attack Resistance:</strong> Network security depends on honest majority of computing power</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Network Architecture</h3>\r\n                            <ul>\r\n                                <li><strong>Full Nodes:</strong> Store complete blockchain and validate all transactions</li>\r\n                                <li><strong>Mining Nodes:</strong> Specialized nodes that create new blocks through proof of work</li>\r\n                                <li><strong>Light Nodes:</strong> Store only block headers for efficiency</li>\r\n                                <li><strong>Peer-to-Peer:</strong> Direct communication between nodes without central authority</li>\r\n                                <li><strong>Fork Resolution:</strong> Network automatically chooses the longest valid chain</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Mathematical Foundation</h3>\r\n                            <ul>\r\n                                <li><strong>Hash Function:</strong> H(x) = SHA-256(block_header) - deterministic and collision-resistant</li>\r\n                                <li><strong>Difficulty Target:</strong> T = 2^(256-D) where D is difficulty level</li>\r\n                                <li><strong>Mining Probability:</strong> P = T/2^256 - probability of finding valid hash in one attempt</li>\r\n                                <li><strong>Expected Time:</strong> E[T] = 1/P attempts to find valid block</li>\r\n                                <li><strong>Hashrate:</strong> H = attempts_per_second × network_size</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Real-World Applications</h3>\r\n                            <ul>\r\n                                <li><strong>Cryptocurrencies:</strong> Bitcoin, Ethereum, and other digital currencies</li>\r\n                                <li><strong>Smart Contracts:</strong> Self-executing contracts with predefined conditions</li>\r\n                                <li><strong>Supply Chain:</strong> Transparent tracking of goods from source to consumer</li>\r\n                                <li><strong>Digital Identity:</strong> Secure, decentralized identity management</li>\r\n                                <li><strong>Voting Systems:</strong> Tamper-resistant electronic voting</li>\r\n                                <li><strong>Decentralized Finance (DeFi):</strong> Financial services without intermediaries</li>\r\n                                <li><strong>NFTs:</strong> Non-fungible tokens for digital asset ownership</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Visual Enhancements</h3>\r\n                            <ul>\r\n                                <li><strong>Modern Block Design:</strong> Rounded corners, gradient backgrounds, inner highlights, and enhanced typography</li>\r\n                                <li><strong>Golden Genesis Block:</strong> Special golden gradient to distinguish the first block</li>\r\n                                <li><strong>Enhanced Node Design:</strong> Multi-stop gradients, gradient borders, and inner highlights for depth</li>\r\n                                <li><strong>Successful Miner Zoom:</strong> Pulsing zoom effect (0.7x-1.3x) with additional rings for emphasis</li>\r\n                                <li><strong>Dynamic Transaction Display:</strong> Age-based fading, priority indicators, and real-time updates</li>\r\n                                <li><strong>Transaction Priority Colors:</strong> Green (High), Orange (Medium), Red (Low) based on fees</li>\r\n                                <li><strong>Pulsing New Transactions:</strong> Fresh transactions have animated borders for 5 seconds</li>\r\n                                <li><strong>Transparent Info Panel:</strong> Reduced opacity (75%-55%) with text shadows for readability</li>\r\n                                <li><strong>Enhanced Typography:</strong> Modern fonts, better spacing, and improved readability</li>\r\n                                <li><strong>Realistic Transaction Aging:</strong> Transactions expire after 30 seconds with visual feedback</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Interactive Features</h3>\r\n                            <ul>\r\n                                <li><strong>Mining Difficulty (1-8):</strong> Control how hard it is to mine blocks - affects block creation speed and guided mode activation</li>\r\n                                <li><strong>Simulation Speed (0.1x-3x):</strong> Control how fast the entire simulation runs</li>\r\n                                <li><strong>Auto Mining:</strong> Always enabled - simulation continuously mines new blocks</li>\r\n                                <li><strong>Network Visualization:</strong> Always visible - watch nodes join, leave, and validate blocks</li>\r\n                                <li><strong>Block Hashes:</strong> Always visible with modern monospace font (truncated for readability)</li>\r\n                                <li><strong>Real-time Statistics:</strong> Monitor blocks, transactions, hashrate, network status, and current phase</li>\r\n                                <li><strong>Guided Mode:</strong> Automatically activates for difficulty 2+ with step-by-step process visualization</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Dynamic Transaction System</h3>\r\n                            <ul>\r\n                                <li><strong>Real-time Generation:</strong> 1-4 new transactions every 1.5-3.5 seconds</li>\r\n                                <li><strong>Transaction Types:</strong> Transfer, Smart Contract, Token Mint, Stake, Swap, Liquidity</li>\r\n                                <li><strong>Dynamic Fees:</strong> Fees vary based on transaction type and complexity</li>\r\n                                <li><strong>Age-based Fading:</strong> Transactions fade over 30 seconds with visual feedback</li>\r\n                                <li><strong>Priority System:</strong> High/Medium/Low priority based on fee amounts</li>\r\n                                <li><strong>Automatic Expiration:</strong> Transactions older than 30 seconds are removed</li>\r\n                                <li><strong>Random Failures:</strong> 10% chance of low-fee transactions being rejected</li>\r\n                                <li><strong>Mempool Management:</strong> Maximum 100 transactions with fee-based replacement</li>\r\n                                <li><strong>Realistic Descriptions:</strong> Dynamic transaction descriptions for each type</li>\r\n                                <li><strong>Visual Age Indicators:</strong> \"Xs ago\" display instead of absolute timestamps</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Advanced Concepts</h3>\r\n                            <ul>\r\n                                <li><strong>Consensus Mechanisms:</strong> Proof of Work, Proof of Stake, Delegated Proof of Stake</li>\r\n                                <li><strong>Forking:</strong> Temporary chain splits that resolve through consensus</li>\r\n                                <li><strong>Mempool:</strong> Pool of unconfirmed transactions waiting to be mined</li>\r\n                                <li><strong>Block Rewards:</strong> Incentive system for miners to secure the network</li>\r\n                                <li><strong>Transaction Fees:</strong> Additional incentive for miners to prioritize transactions</li>\r\n                                <li><strong>Lightning Network:</strong> Layer 2 scaling solution for faster, cheaper transactions</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Security Considerations</h3>\r\n                            <ul>\r\n                                <li><strong>Double Spending:</strong> Prevented through consensus and transaction ordering</li>\r\n                                <li><strong>Sybil Attacks:</strong> Mitigated through proof of work cost</li>\r\n                                <li><strong>51% Attacks:</strong> Theoretical but economically unfeasible for large networks</li>\r\n                                <li><strong>Quantum Resistance:</strong> Future consideration for post-quantum cryptography</li>\r\n                                <li><strong>Privacy:</strong> Techniques like zero-knowledge proofs for transaction privacy</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Current Control Panel</h3>\r\n                            <ul>\r\n                                <li><strong>Mining Difficulty:</strong> Set to 1-8 (default: 4) - controls mining speed and guided mode activation</li>\r\n                                <li><strong>Simulation Speed:</strong> Set to 0.1x-3x (default: 1.0x) - controls overall animation speed</li>\r\n                                <li><strong>Reset Button:</strong> Resets the entire simulation to initial state</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Always Active Features</h3>\r\n                            <ul>\r\n                                <li><strong>Auto Mining:</strong> Continuously mines new blocks</li>\r\n                                <li><strong>Network Visualization:</strong> Shows all nodes and their activities</li>\r\n                                <li><strong>Block Hashes:</strong> Always visible in blocks (truncated for readability)</li>\r\n                                <li><strong>Real-time Statistics:</strong> Live updates of all blockchain metrics</li>\r\n                            </ul>\r\n                            \r\n                            <h3>Educational Insights</h3>\r\n                            <ul>\r\n                                <li><strong>Decentralization:</strong> No single point of failure or control</li>\r\n                                <li><strong>Transparency:</strong> All transactions are publicly verifiable</li>\r\n                                <li><strong>Immutability:</strong> Historical record cannot be altered</li>\r\n                                <li><strong>Trustlessness:</strong> Participants don't need to trust each other, only the protocol</li>\r\n                                <li><strong>Incentive Alignment:</strong> Economic incentives ensure network security and participation</li>\r\n                            </ul>\r\n                        </div>\r\n                    `\r\n                };\r\n            default:\r\n                return {\r\n                    title: 'Animation Information',\r\n                    html: '<p>Select an animation to learn more about the physics concepts it demonstrates.</p>'\r\n                };\r\n        }\r\n    }\r\n    \r\n    updateMemoryManagementStats() {\r\n        if (!this.memoryManagement) return;\r\n        const stats = this.memoryManagement.getStats();\r\n        const buildingsElement = document.getElementById('memoryBuildings');\r\n        const allocatedElement = document.getElementById('memoryAllocated');\r\n        const gcCyclesElement = document.getElementById('memoryGCCycles');\r\n        const efficiencyElement = document.getElementById('memoryEfficiency');\r\n        \r\n        if (buildingsElement) buildingsElement.textContent = stats.totalHeapUsed || 0;\r\n        if (allocatedElement) allocatedElement.textContent = stats.totalHeapUsed || 0;\r\n        if (gcCyclesElement) gcCyclesElement.textContent = stats.gcCycles || 0;\r\n        if (efficiencyElement) {\r\n            const efficiency = stats.fragmentation ? (100 - stats.fragmentation) : 100;\r\n            efficiencyElement.textContent = efficiency.toFixed(1) + '%';\r\n        }\r\n    }\r\n    \r\n    updateBlockchainStats() {\r\n        if (!this.blockchain) return;\r\n        const stats = this.blockchain.getStats();\r\n        const blocksElement = document.getElementById('blockchainBlocks');\r\n        const transactionsElement = document.getElementById('blockchainTransactions');\r\n        const pendingElement = document.getElementById('blockchainPending');\r\n        const difficultyElement = document.getElementById('blockchainDifficulty');\r\n        const hashrateElement = document.getElementById('blockchainHashrate');\r\n        const minersElement = document.getElementById('blockchainMiners');\r\n        const nodesElement = document.getElementById('blockchainNodes');\r\n        const phaseElement = document.getElementById('blockchainPhase');\r\n        const miningElement = document.getElementById('blockchainMining');\r\n        \r\n        if (blocksElement) blocksElement.textContent = stats.blocks || 0;\r\n        if (transactionsElement) transactionsElement.textContent = stats.transactions || 0;\r\n        if (pendingElement) pendingElement.textContent = stats.pending || 0;\r\n        if (difficultyElement) difficultyElement.textContent = stats.difficulty || 0;\r\n        if (hashrateElement) hashrateElement.textContent = (stats.hashrate || 0) + ' H/s';\r\n        if (minersElement) minersElement.textContent = stats.miners || 0;\r\n        if (nodesElement) nodesElement.textContent = stats.nodes || 0;\r\n        \r\n        // Update phase with consensus information\r\n        if (phaseElement) {\r\n            let phaseText = stats.phase || 'idle';\r\n            if (stats.phase === 'finalization' && stats.consensusPercentage !== undefined) {\r\n                if (stats.consensusReached) {\r\n                    phaseText = `Finalization (${stats.consensusPercentage}% consensus)`;\r\n                } else {\r\n                    phaseText = `Rejection (${stats.consensusPercentage}% < ${stats.consensusThreshold}%)`;\r\n                }\r\n            }\r\n            phaseElement.textContent = phaseText;\r\n        }\r\n        \r\n        if (miningElement) miningElement.textContent = stats.isMining ? 'Yes' : 'No';\r\n    }\r\n}\r\n","import { ScientificAnimations } from './animations.js';\n\n// Initialize the application when the page loads\ndocument.addEventListener('DOMContentLoaded', () => {\n    const canvas = document.getElementById('animationCanvas');\n    new ScientificAnimations(canvas);\n    \n    // Initialize controls panel toggle\n    initializeControlsToggle();\n});\n\n// Controls panel toggle functionality\nfunction initializeControlsToggle() {\n    const controlsPanel = document.querySelector('.controls-panel');\n    const toggleButton = document.querySelector('.controls-toggle');\n    \n    if (!controlsPanel || !toggleButton) return;\n    \n    // Check if user has a preference stored\n    const isCollapsed = localStorage.getItem('controlsCollapsed') === 'true';\n    \n    if (isCollapsed) {\n        controlsPanel.classList.add('collapsed');\n    }\n    \n    toggleButton.addEventListener('click', () => {\n        const isCurrentlyCollapsed = controlsPanel.classList.contains('collapsed');\n        \n        if (isCurrentlyCollapsed) {\n            // Expand the panel\n            controlsPanel.classList.remove('collapsed');\n            localStorage.setItem('controlsCollapsed', 'false');\n        } else {\n            // Collapse the panel\n            controlsPanel.classList.add('collapsed');\n            localStorage.setItem('controlsCollapsed', 'true');\n        }\n    });\n    \n    // Add keyboard shortcut (Ctrl/Cmd + T)\n    document.addEventListener('keydown', (e) => {\n        if ((e.ctrlKey || e.metaKey) && e.key === 't') {\n            e.preventDefault();\n            toggleButton.click();\n        }\n    });\n} "],"names":["BrownianMotion","ctx","i","vx","vy","velocity","count","speed","temp","show","p","size","deltaTime","dt","particle","index","oldX","oldY","j","other","dx","dy","distance","tempVx","tempVy","overlap","moveX","moveY","totalDistance","sum","normalizedVelocity","t","cols","rows","centerX","centerY","localTemp","particleCount","alpha","graphX","graphY","histogram","maxVelocity","binIndex","maxCount","barWidth","barHeight","avgSpeed","Diffusion","startRegion","gridSize","x","rate","gradient","gridX","gridY","concentrationDiff","_a","_b","timeFactor","velocityFactor","baseColor","profileY","profileWidth","bins","binWidth","concentrationProfile","maxConcentration","scale","y","labelGradient","barrierX","barrierGradient","text","textWidth","textGradient","leftParticles","rightParticles","concentrationSpread","GasLaws","speedFactor","vol","pressure","law","currentPressure","particleDensity","calculatedPressure","pressureDiff","boyleConstant","charlesConstant","gayLussacConstant","combinedConstant","canvasWidth","panelX","panelY","panelWidth","panelHeight","lawNames","pressureValue","angle","localPressure","maxPressure","minPressure","maxVolume","minVolume","maxTemp","minTemp","xLabel","yLabel","Pendulum","length","gravity","damping","mass","acceleration","velocityMagnitude","airResistanceForce","dampingAcceleration","period","kineticEnergy","potentialEnergy","bobX","bobY","totalEnergy","energyRatio","bobColor","gravityLength","tensionLength","tensionX","tensionY","tensionMagnitude","unitX","unitY","velocityX","velocityY","airResistanceLength","unitVX","unitVY","scaledVX","scaledVY","kineticRatio","potentialRatio","plotX","plotY","angles","velocities","minAngle","maxAngle","minVel","maxVel","avgPeriod","theoreticalPeriod","OrbitalMotion","r","eccentricity","axis","normalizedVX","normalizedVY","arrowLength","perigeeX","perigeeY","apogeeAngle","apogeeX","apogeeY","textX","startY","currentDistance","currentSpeed","CollisionPhysics","restitution","type","canvasHeight","positions","pos","spacing","startX","effect","ball","ball1","ball2","nx","ny","dvx","dvy","relativeVelocity","effectiveRestitution","impulse","separationX","separationY","preCollisionEnergy","radius","ringRadius","ringAlpha","sparkleX","sparkleY","colors","labelX","labelY","totalMomentum","momentum","energy","FrictionInclinedPlanes","coefficient","angleRad","inclineLength","endY","maxEndY","verticalOffset","adjustedStartY","weight","normalForce","parallelForce","frictionForce","netForce","endX","adjustedEndY","objectSize","surfaceColor","textureColor","surfaceGradient","objectGradient","drawArrow","fromX","fromY","color","label","len","normDX","normDY","arrowLen","frictionDir","frictionMagnitude","WavePropagation","speedSlider","frequencySlider","amplitudeSlider","waveTypeSelect","analyticsCheckbox","freq","amp","wavelength","speedMultiplier","phase","timePhase","displacement","longitudinalAmplitude","wave1","wave2","numPoints","particleIndex","lowIndex","highIndex","fraction","lowY","highY","springRadius","totalLength","waveDisplacement","coilOffset","waveSpeed","arrowX","waveTypeLabel","velocityRatio","g","b","particleSize","barX","barY","maxEnergy","energyWidth","energyGradient","SoundWaves","e","rect","touch","active","pulse","waveActive","pulsePhase","waveProgress","elapsed","pulseDuration","waveSpeedScale","waveTravelDistance","wavePacketWidth","wavePacketStart","wavePacketEnd","particlePositionInPacket","particleX","amplitudeDisplacement","intensity","wavePosition","zoneHeight","zoneY","relativeX","visualSpeed","ElectricFields","strength","charge","ex","ey","k","force","sign","field","magnitude","point","particleGradient","arrowGradient","panelGradient","bannerY","bannerGradient","MagneticFields","magnetLength","magnet","Bx","By","fieldStrength","forceX","forceY","magnetGroups","magnetGroup","northPole","m","southPole","magnetAngle","pole","poleType","drawProgress","currentEndX","currentEndY","lineColor","lineWidth","arrowAngle","direction","tipX","tipY","leftX","leftY","rightX","rightY","arrowColor","northPoles","southPoles","animationOffset","animatedLength","actualEndX","actualEndY","bodyGradient","poleGradient","trailGradient","bannerWidth","bannerHeight","bannerX","DiodeTransistor","bias","voltage","voltageDrop","baseCurrent","beta","spark","time","waveRadius","waveAlpha","glowColor","labelGlow","isForward","isReverse","glow","pulseEffect","glowIntensity","symbolColor","leadLength","baseCurrentColor","typeColor","biasType","biasText","biasColor","x1","x2","y1","y2","dash","electron","hole","baseVoltageEffect","bulbGlow","bulbColor","filamentPulse","trailPoint","dashOffset","arrowOffset","arrowGlow","pulseIntensity","particleProgress","particleY","WaveParticleDuality","mode","wave","screenHeight","slit1X","slit2X","slitY","screenX","screenY","distance1","distance2","pathDifference","phaseDifference","amplitude1","amplitude2","totalAmplitude","distanceFromSlit1","distanceFromSlit2","screenGradient","activePulse","started","timeOffset","animatedIntensity","dotSize","arrowPulse","lineHeight","NuclearReactions","row","col","neutron","nucleus","additionalNeutrons","product","randomAngle","neutronCount","energyParticleCount","life","hNucleus","closestNucleus","closestDistance","elementSymbol","nucleonCount","FluidFlow","canvas","visc","re","flowVelocity","turbulence","obstacle","maxVariation","spongeGradient","holeX","holeY","holeGradient","outlineGradient","blockGradient","isMouseAffected","hue","saturation","lightness","particleColor","nextX","nextY","opacity","blue","red","green","firstPoint","borderGradient","innerGradient","flowTypeColor","efficiency","efficiencyColor","amount","hex","avgVelocity","Bernoulli","width","density","leftGradient","middleGradient","rightGradient","trailColor","NeuralNetwork","totalNetworkWidth","networkCenterY","layerIndex","layerNeurons","layerSize","neuronIndex","preTrainedWeights","preTrainedBiases","currentLayerSize","nextLayerSize","layerWeights","neuronWeights","layerBiases","auto","currentData","rawWeights","rawBiases","layer","w","trainingEpochs","originalLearningRate","epoch","dataIndex","data","inputs","currentLayer","nextLayer","targets","outputLayer","error","biasChange","weightChange","loss","correct","fromNeuron","toNeuron","value","isError","testing","objectType","predicted","confidence","isCorrect","previousLayer","neuron","output","expectedOutput","distanceFromTarget","weightAbs","weightUpdateEffect","pulseSize","delta","phaseX","phaseY","phaseText","phaseColor","phaseDescription","progressBarX","progressBarY","progressBarWidth","progressBarHeight","progress","detailsX","detailsY","objects","objX","objY","clickRadius","objectY","objType","outerRadius","innerRadius","infoY","object","buttonSize","isTrainingComplete","isSelected","height","lossData","accuracyData","maxLoss","minLoss","maxAcc","minAcc","chartX","normalizedLoss","chartY","normalizedAcc","totalTests","correctTests","accuracy","recentResults","resultY","result","status","currentTrainingObject","progressWidth","progressHeight","progressX","progressY","MemoryManagement","currentFunc","line","match","funcName","functionIndex","f","varName","altMatch1","altMatch2","address","caller","callingLine","varMatch","returnAddress","bestBlock","freeBlockIndex","block","heapWidth","heapHeight","sizeRatio","blockWidth","blockHeight","newBlock","position","blockIndex","operation","heapArea","overlaps","existingBlock","maxAttempts","attempt","block1","block2","totalHeapSize","usedSpace","total","freeSpace","fragmentedBlocks","lastBlock","freeBlock","sortedBlocks","a","currentAddress","gapSize","gapWidth","gapHeight","totalFreeSize","largestFreeBlock","fragmentation","unreachableBlocks","access","highlight","connection","frag","hexSize","offset","px","py","radialGradient","stackBorderGradient","frame","func","currentY","heapBorderGradient","blockBorderGradient","fontSize","sizeFontSize","addrFontSize","freeGradient","startIndex","current","next","midX","midY","usageX","usageY","usageWidth","usageHeight","usagePercent","barGradient","layoutY","layoutHeight","layoutX","layoutWidth","segmentX","segmentWidth","fragBlock","fragX","fragWidth","statsX","statsY","statsBorderGradient","action","Blockchain","genesisBlock","miner","node","consensusNodes","consensusThreshold","latency","consensusProbability","callback","minDelay","maxDelay","targetPosition","newNode","removableNodes","nodeToRemove","nodeCount","angleStep","targetAngle","targetX","targetY","currentTime","numTransactions","randomTx","tx","lowFeeIndex","from","to","description","fee","descriptions","sortedTransactions","maxTransactions","selectedTransactions","transactions","hashes","newHashes","left","right","blockString","str","hash","prime","mod","char","calculatedHash","totalFees","timeRatio","expectedIndex","targetHash","baseNoncesPerFrame","difficultyMultiplier","noncesToTry","successfulMinerIndex","blockTime","totalBlocks","blockX","visibleIndex","blockY","particleRate","contractX","contractY","arrow","difficulty","animationDeltaTime","baseHashrate","effectiveHashrate","visibleBlocks","visibleWidth","highlightGradient","title","ellipsesX","ellipsesY","hiddenCount","lastBlockX","connectionGradient","maxX","miningGradient","miningBorderGradient","miningHighlightGradient","progressGradient","networkGradient","node1","node2","nodeGradient","primaryColor","secondaryColor","hslMatch","h","s","l","zoomPulse","zoomedRadius","successGradient","ringPulse","miningPulse","age","ageSeconds","ageOpacity","txGradient","borderColor","timeText","priorityColor","desc","currentX","headLength","headAngle","consensusPercentage","gradientStartX","gradientStartY","gradientEndX","gradientEndY","baseDifficulty","blockCount","dynamicDifficulty","difficultySlider","difficultyValue","speedValue","reward","ScientificAnimations","header","categoryItem","sideNav","mainContent","item","firstAnimation","animation","subItem","navToggleBtn","mobileNavToggle","waveTypeElement","waveShowAnalyticsElement","soundWaveTypeSelect","chargeType","sx","sy","initialMode","componentTypeSelect","biasTypeSelect","showOutputCheckbox","neuralMode","isTesting","sliderId","valueId","slider","valueDisplay","unit","performMeasurementBtn","diffusion","gasLaws","pendulum","category","btn","categoryBtn","group","animationGroup","animationType","activeItem","panel","controlPanel","infoPanel","particlesSlider","animationSpeedSlider","availableWidth","maxWidth","stats","collisionElement","meanFreePathElement","temperatureElement","airResistanceElement","dampingElement","modeElement","energyElement","wavelengthElement","waveFunctionElement","interferenceElement","measurementElement","timeElement","flowRateElement","viscosityElement","reynoldsElement","flowTypeElement","avgVelocityElement","pipeWidthElement","densityElement","pressureElement","velocityRatioElement","frequencyElement","waveSpeedElement","amplitudeElement","particleCountElement","componentTypeElement","biasTypeElement","inputVoltageElement","baseVoltageElement","currentElement","powerElement","statusElement","baseVoltageStat","epochElement","lossElement","accuracyElement","learningRateElement","speedElement","phaseElement","dataIndexElement","modal","modalTitle","modalContent","content","state","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","_m","_n","_o","_p","_q","_r","_s","_t","_u","_v","_w","_x","_y","_z","_A","_B","_C","_D","_E","_F","_G","_H","_I","_J","_K","_L","_M","_N","_O","_P","_Q","_R","_S","_T","_U","_V","_W","_X","_Y","_Z","__","_$","_aa","buildingsElement","allocatedElement","gcCyclesElement","efficiencyElement","blocksElement","transactionsElement","pendingElement","difficultyElement","hashrateElement","minersElement","nodesElement","miningElement","initializeControlsToggle","controlsPanel","toggleButton"],"mappings":"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"}